/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{525:function(e,t,n){(function(e){e.exports=function(){"use strict";var t,o;function r(){return t.apply(null,arguments)}function l(e){t=e}function c(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function h(input){return null!=input&&"[object Object]"===Object.prototype.toString.call(input)}function f(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function d(input){return void 0===input}function y(input){return"number"==typeof input||"[object Number]"===Object.prototype.toString.call(input)}function v(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(e,t){var i,n=[];for(i=0;i<e.length;++i)n.push(t(e[i],i));return n}function m(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function w(a,b){for(var i in b)m(b,i)&&(a[i]=b[i]);return m(b,"toString")&&(a.toString=b.toString),m(b,"valueOf")&&(a.valueOf=b.valueOf),a}function C(input,e,t,n){return oo(input,e,t,n,!0).utc()}function S(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function k(e){return null==e._pf&&(e._pf=S()),e._pf}function R(e){if(null==e._isValid){var t=k(e),n=o.call(t.parsedDateParts,(function(i){return null!=i})),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function O(e){var t=C(NaN);return null!=e?w(k(t),e):k(t).userInvalidated=!0,t}o=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1};var E=r.momentProperties=[];function T(e,t){var i,n,o;if(d(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),d(t._i)||(e._i=t._i),d(t._f)||(e._f=t._f),d(t._l)||(e._l=t._l),d(t._strict)||(e._strict=t._strict),d(t._tzm)||(e._tzm=t._tzm),d(t._isUTC)||(e._isUTC=t._isUTC),d(t._offset)||(e._offset=t._offset),d(t._pf)||(e._pf=k(t)),d(t._locale)||(e._locale=t._locale),E.length>0)for(i=0;i<E.length;i++)d(o=t[n=E[i]])||(e[n]=o);return e}var A=!1;function M(e){T(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===A&&(A=!0,r.updateOffset(this),A=!1)}function x(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function _(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function P(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=_(t)),n}function I(e,t,n){var i,o=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),l=0;for(i=0;i<o;i++)(n&&e[i]!==t[i]||!n&&P(e[i])!==P(t[i]))&&l++;return l+r}function H(e){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function D(e,t){var n=!0;return w((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){for(var o,l=[],i=0;i<arguments.length;i++){if(o="","object"==typeof arguments[i]){for(var c in o+="\n["+i+"] ",arguments[0])o+=c+": "+arguments[0][c]+", ";o=o.slice(0,-2)}else o=arguments[i];l.push(o)}H(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var N,j={};function L(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),j[e]||(H(t),j[e]=!0)}function B(input){return input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function V(e){var t,i;for(i in e)B(t=e[i])?this[i]=t:this["_"+i]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function F(e,t){var n,o=w({},e);for(n in t)m(t,n)&&(h(e[n])&&h(t[n])?(o[n]={},w(o[n],e[n]),w(o[n],t[n])):null!=t[n]?o[n]=t[n]:delete o[n]);for(n in e)m(e,n)&&!m(t,n)&&h(e[n])&&(o[n]=w({},o[n]));return o}function W(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,N=Object.keys?Object.keys:function(e){var i,t=[];for(i in e)m(e,i)&&t.push(i);return t};var U={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function z(e,t,n){var output=this._calendar[e]||this._calendar.sameElse;return B(output)?output.call(t,n):output}var Y={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function G(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])}var K="Invalid date";function $(){return this._invalidDate}var X="%d",Z=/\d{1,2}/;function Q(e){return this._ordinal.replace("%d",e)}var J={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ee(e,t,n,o){var output=this._relativeTime[n];return B(output)?output(e,t,n,o):output.replace(/%d/i,e)}function te(e,output){var t=this._relativeTime[e>0?"future":"past"];return B(t)?t(output):t.replace(/%s/i,output)}var ne={};function oe(e,t){var n=e.toLowerCase();ne[n]=ne[n+"s"]=ne[t]=e}function re(e){return"string"==typeof e?ne[e]||ne[e.toLowerCase()]:void 0}function ie(e){var t,n,o={};for(n in e)m(e,n)&&(t=re(n))&&(o[t]=e[n]);return o}var ae={};function le(e,t){ae[e]=t}function se(e){var t=[];for(var u in e)t.push({unit:u,priority:ae[u]});return t.sort((function(a,b){return a.priority-b.priority})),t}function ue(e,t,n){var o=""+Math.abs(e),r=t-o.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+o}var ce=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,he=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,fe={},de={};function pe(e,t,n,o){var r=o;"string"==typeof o&&(r=function(){return this[o]()}),e&&(de[e]=r),t&&(de[t[0]]=function(){return ue(r.apply(this,arguments),t[1],t[2])}),n&&(de[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function ye(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function ge(e){var i,t,n=e.match(ce);for(i=0,t=n.length;i<t;i++)de[n[i]]?n[i]=de[n[i]]:n[i]=ye(n[i]);return function(o){var i,output="";for(i=0;i<t;i++)output+=B(n[i])?n[i].call(o,e):n[i];return output}}function ve(e,t){return e.isValid()?(t=me(t,e.localeData()),fe[t]=fe[t]||ge(t),fe[t](e)):e.localeData().invalidDate()}function me(e,t){var i=5;function n(input){return t.longDateFormat(input)||input}for(he.lastIndex=0;i>=0&&he.test(e);)e=e.replace(he,n),he.lastIndex=0,i-=1;return e}var be=/\d/,we=/\d\d/,Ce=/\d{3}/,Se=/\d{4}/,ke=/[+-]?\d{6}/,Re=/\d\d?/,Oe=/\d\d\d\d?/,Ee=/\d\d\d\d\d\d?/,Te=/\d{1,3}/,Ae=/\d{1,4}/,Me=/[+-]?\d{1,6}/,xe=/\d+/,_e=/[+-]?\d+/,Pe=/Z|[+-]\d\d:?\d\d/gi,Ie=/Z|[+-]\d\d(?::?\d\d)?/gi,He=/[+-]?\d+(\.\d{1,3})?/,De=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ne={};function je(e,t,n){Ne[e]=B(t)?t:function(e,o){return e&&n?n:t}}function Le(e,t){return m(Ne,e)?Ne[e](t._strict,t._locale):new RegExp(Be(e))}function Be(s){return Ve(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,o,r){return t||n||o||r})))}function Ve(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Fe={};function We(e,t){var i,n=t;for("string"==typeof e&&(e=[e]),y(t)&&(n=function(input,e){e[t]=P(input)}),i=0;i<e.length;i++)Fe[e[i]]=n}function Ue(e,t){We(e,(function(input,e,n,o){n._w=n._w||{},t(input,n._w,n,o)}))}function ze(e,input,t){null!=input&&m(Fe,e)&&Fe[e](input,t._a,t,e)}var Ye=0,Ge=1,Ke=2,$e=3,Xe=4,qe=5,Ze=6,Qe=7,Je=8;function et(e){return tt(e)?366:365}function tt(e){return e%4==0&&e%100!=0||e%400==0}pe("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),pe(0,["YY",2],0,(function(){return this.year()%100})),pe(0,["YYYY",4],0,"year"),pe(0,["YYYYY",5],0,"year"),pe(0,["YYYYYY",6,!0],0,"year"),oe("year","y"),le("year",1),je("Y",_e),je("YY",Re,we),je("YYYY",Ae,Se),je("YYYYY",Me,ke),je("YYYYYY",Me,ke),We(["YYYYY","YYYYYY"],Ye),We("YYYY",(function(input,e){e[Ye]=2===input.length?r.parseTwoDigitYear(input):P(input)})),We("YY",(function(input,e){e[Ye]=r.parseTwoDigitYear(input)})),We("Y",(function(input,e){e[Ye]=parseInt(input,10)})),r.parseTwoDigitYear=function(input){return P(input)+(P(input)>68?1900:2e3)};var nt,ot=at("FullYear",!0);function it(){return tt(this.year())}function at(e,t){return function(n){return null!=n?(st(this,e,n),r.updateOffset(this,t),this):lt(this,e)}}function lt(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function st(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&tt(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),ft(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function ut(e){return B(this[e=re(e)])?this[e]():this}function ct(e,t){if("object"==typeof e)for(var n=se(e=ie(e)),i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit]);else if(B(this[e=re(e)]))return this[e](t);return this}function ht(e,t){return(e%t+t)%t}function ft(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=ht(t,12);return e+=(t-n)/12,1===n?tt(e)?29:28:31-n%7%2}nt=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var i;for(i=0;i<this.length;++i)if(this[i]===e)return i;return-1},pe("M",["MM",2],"Mo",(function(){return this.month()+1})),pe("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),pe("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),oe("month","M"),le("month",8),je("M",Re),je("MM",Re,we),je("MMM",(function(e,t){return t.monthsShortRegex(e)})),je("MMMM",(function(e,t){return t.monthsRegex(e)})),We(["M","MM"],(function(input,e){e[Ge]=P(input)-1})),We(["MMM","MMMM"],(function(input,e,t,n){var o=t._locale.monthsParse(input,n,t._strict);null!=o?e[Ge]=o:k(t).invalidMonth=input}));var pt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,yt="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function gt(e,t){return e?c(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||pt).test(t)?"format":"standalone"][e.month()]:c(this._months)?this._months:this._months.standalone}var vt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function mt(e,t){return e?c(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[pt.test(t)?"format":"standalone"][e.month()]:c(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bt(e,t,n){var i,o,r,l=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=C([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(o=nt.call(this._shortMonthsParse,l))?o:null:-1!==(o=nt.call(this._longMonthsParse,l))?o:null:"MMM"===t?-1!==(o=nt.call(this._shortMonthsParse,l))||-1!==(o=nt.call(this._longMonthsParse,l))?o:null:-1!==(o=nt.call(this._longMonthsParse,l))||-1!==(o=nt.call(this._shortMonthsParse,l))?o:null}function wt(e,t,n){var i,o,r;if(this._monthsParseExact)return bt.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(o=C([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(r="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[i]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function Ct(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=P(t);else if(!y(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),ft(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function St(e){return null!=e?(Ct(this,e),r.updateOffset(this,!0),this):lt(this,"Month")}function kt(){return ft(this.year(),this.month())}var Rt=De;function Ot(e){return this._monthsParseExact?(m(this,"_monthsRegex")||At.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=Rt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}var Et=De;function Tt(e){return this._monthsParseExact?(m(this,"_monthsRegex")||At.call(this),e?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=Et),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function At(){function e(a,b){return b.length-a.length}var i,t,n=[],o=[],r=[];for(i=0;i<12;i++)t=C([2e3,i]),n.push(this.monthsShort(t,"")),o.push(this.months(t,"")),r.push(this.months(t,"")),r.push(this.monthsShort(t,""));for(n.sort(e),o.sort(e),r.sort(e),i=0;i<12;i++)n[i]=Ve(n[i]),o[i]=Ve(o[i]);for(i=0;i<24;i++)r[i]=Ve(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function Mt(e,t,n,o,r,s,l){var c;return e<100&&e>=0?(c=new Date(e+400,t,n,o,r,s,l),isFinite(c.getFullYear())&&c.setFullYear(e)):c=new Date(e,t,n,o,r,s,l),c}function xt(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function _t(e,t,n){var o=7+t-n;return-(7+xt(e,0,o).getUTCDay()-t)%7+o-1}function Pt(e,t,n,o,r){var l,c,h=1+7*(t-1)+(7+n-o)%7+_t(e,o,r);return h<=0?c=et(l=e-1)+h:h>et(e)?(l=e+1,c=h-et(e)):(l=e,c=h),{year:l,dayOfYear:c}}function It(e,t,n){var o,r,l=_t(e.year(),t,n),c=Math.floor((e.dayOfYear()-l-1)/7)+1;return c<1?o=c+Ht(r=e.year()-1,t,n):c>Ht(e.year(),t,n)?(o=c-Ht(e.year(),t,n),r=e.year()+1):(r=e.year(),o=c),{week:o,year:r}}function Ht(e,t,n){var o=_t(e,t,n),r=_t(e+1,t,n);return(et(e)-o+r)/7}function Dt(e){return It(e,this._week.dow,this._week.doy).week}pe("w",["ww",2],"wo","week"),pe("W",["WW",2],"Wo","isoWeek"),oe("week","w"),oe("isoWeek","W"),le("week",5),le("isoWeek",5),je("w",Re),je("ww",Re,we),je("W",Re),je("WW",Re,we),Ue(["w","ww","W","WW"],(function(input,e,t,n){e[n.substr(0,1)]=P(input)}));var Nt={dow:0,doy:6};function jt(){return this._week.dow}function Lt(){return this._week.doy}function Bt(input){var e=this.localeData().week(this);return null==input?e:this.add(7*(input-e),"d")}function Vt(input){var e=It(this,1,4).week;return null==input?e:this.add(7*(input-e),"d")}function Ft(input,e){return"string"!=typeof input?input:isNaN(input)?"number"==typeof(input=e.weekdaysParse(input))?input:null:parseInt(input,10)}function Wt(input,e){return"string"==typeof input?e.weekdaysParse(input)%7||7:isNaN(input)?null:input}function Ut(e,t){return e.slice(t,7).concat(e.slice(0,t))}pe("d",0,"do","day"),pe("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),pe("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),pe("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),pe("e",0,0,"weekday"),pe("E",0,0,"isoWeekday"),oe("day","d"),oe("weekday","e"),oe("isoWeekday","E"),le("day",11),le("weekday",11),le("isoWeekday",11),je("d",Re),je("e",Re),je("E",Re),je("dd",(function(e,t){return t.weekdaysMinRegex(e)})),je("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),je("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ue(["dd","ddd","dddd"],(function(input,e,t,n){var o=t._locale.weekdaysParse(input,n,t._strict);null!=o?e.d=o:k(t).invalidWeekday=input})),Ue(["d","e","E"],(function(input,e,t,n){e[n]=P(input)}));var zt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Yt(e,t){var n=c(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ut(n,this._week.dow):e?n[e.day()]:n}var Gt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Kt(e){return!0===e?Ut(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var $t="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Xt(e){return!0===e?Ut(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function qt(e,t,n){var i,o,r,l=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=C([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(o=nt.call(this._weekdaysParse,l))?o:null:"ddd"===t?-1!==(o=nt.call(this._shortWeekdaysParse,l))?o:null:-1!==(o=nt.call(this._minWeekdaysParse,l))?o:null:"dddd"===t?-1!==(o=nt.call(this._weekdaysParse,l))||-1!==(o=nt.call(this._shortWeekdaysParse,l))||-1!==(o=nt.call(this._minWeekdaysParse,l))?o:null:"ddd"===t?-1!==(o=nt.call(this._shortWeekdaysParse,l))||-1!==(o=nt.call(this._weekdaysParse,l))||-1!==(o=nt.call(this._minWeekdaysParse,l))?o:null:-1!==(o=nt.call(this._minWeekdaysParse,l))||-1!==(o=nt.call(this._weekdaysParse,l))||-1!==(o=nt.call(this._shortWeekdaysParse,l))?o:null}function Zt(e,t,n){var i,o,r;if(this._weekdaysParseExact)return qt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(o=C([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(r="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[i]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}}function Qt(input){if(!this.isValid())return null!=input?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=Ft(input,this.localeData()),this.add(input-e,"d")):e}function Jt(input){if(!this.isValid())return null!=input?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==input?e:this.add(input-e,"d")}function en(input){if(!this.isValid())return null!=input?this:NaN;if(null!=input){var e=Wt(input,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}var tn=De;function nn(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||sn.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=tn),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var on=De;function rn(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||sn.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=on),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var an=De;function ln(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||sn.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=an),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function sn(){function e(a,b){return b.length-a.length}var i,t,n,o,r,l=[],c=[],h=[],f=[];for(i=0;i<7;i++)t=C([2e3,1]).day(i),n=this.weekdaysMin(t,""),o=this.weekdaysShort(t,""),r=this.weekdays(t,""),l.push(n),c.push(o),h.push(r),f.push(n),f.push(o),f.push(r);for(l.sort(e),c.sort(e),h.sort(e),f.sort(e),i=0;i<7;i++)c[i]=Ve(c[i]),h[i]=Ve(h[i]),f[i]=Ve(f[i]);this._weekdaysRegex=new RegExp("^("+f.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+l.join("|")+")","i")}function un(){return this.hours()%12||12}function cn(){return this.hours()||24}function hn(e,t){pe(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function fn(e,t){return t._meridiemParse}function dn(input){return"p"===(input+"").toLowerCase().charAt(0)}pe("H",["HH",2],0,"hour"),pe("h",["hh",2],0,un),pe("k",["kk",2],0,cn),pe("hmm",0,0,(function(){return""+un.apply(this)+ue(this.minutes(),2)})),pe("hmmss",0,0,(function(){return""+un.apply(this)+ue(this.minutes(),2)+ue(this.seconds(),2)})),pe("Hmm",0,0,(function(){return""+this.hours()+ue(this.minutes(),2)})),pe("Hmmss",0,0,(function(){return""+this.hours()+ue(this.minutes(),2)+ue(this.seconds(),2)})),hn("a",!0),hn("A",!1),oe("hour","h"),le("hour",13),je("a",fn),je("A",fn),je("H",Re),je("h",Re),je("k",Re),je("HH",Re,we),je("hh",Re,we),je("kk",Re,we),je("hmm",Oe),je("hmmss",Ee),je("Hmm",Oe),je("Hmmss",Ee),We(["H","HH"],$e),We(["k","kk"],(function(input,e,t){var n=P(input);e[$e]=24===n?0:n})),We(["a","A"],(function(input,e,t){t._isPm=t._locale.isPM(input),t._meridiem=input})),We(["h","hh"],(function(input,e,t){e[$e]=P(input),k(t).bigHour=!0})),We("hmm",(function(input,e,t){var n=input.length-2;e[$e]=P(input.substr(0,n)),e[Xe]=P(input.substr(n)),k(t).bigHour=!0})),We("hmmss",(function(input,e,t){var n=input.length-4,o=input.length-2;e[$e]=P(input.substr(0,n)),e[Xe]=P(input.substr(n,2)),e[qe]=P(input.substr(o)),k(t).bigHour=!0})),We("Hmm",(function(input,e,t){var n=input.length-2;e[$e]=P(input.substr(0,n)),e[Xe]=P(input.substr(n))})),We("Hmmss",(function(input,e,t){var n=input.length-4,o=input.length-2;e[$e]=P(input.substr(0,n)),e[Xe]=P(input.substr(n,2)),e[qe]=P(input.substr(o))}));var pn=/[ap]\.?m?\.?/i;function yn(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var gn,vn=at("Hours",!0),mn={calendar:U,longDateFormat:Y,invalidDate:K,ordinal:X,dayOfMonthOrdinalParse:Z,relativeTime:J,months:yt,monthsShort:vt,week:Nt,weekdays:zt,weekdaysMin:$t,weekdaysShort:Gt,meridiemParse:pn},bn={},wn={};function Cn(e){return e?e.toLowerCase().replace("_","-"):e}function Sn(e){for(var t,n,o,r,i=0;i<e.length;){for(t=(r=Cn(e[i]).split("-")).length,n=(n=Cn(e[i+1]))?n.split("-"):null;t>0;){if(o=kn(r.slice(0,t).join("-")))return o;if(n&&n.length>=t&&I(r,n,!0)>=t-1)break;t--}i++}return gn}function kn(t){var o=null;if(!bn[t]&&void 0!==e&&e&&e.exports)try{o=gn._abbr,n(562)("./"+t),Rn(o)}catch(e){}return bn[t]}function Rn(e,t){var data;return e&&((data=d(t)?Tn(e):On(e,t))?gn=data:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),gn._abbr}function On(e,t){if(null!==t){var n,o=mn;if(t.abbr=e,null!=bn[e])L("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=bn[e]._config;else if(null!=t.parentLocale)if(null!=bn[t.parentLocale])o=bn[t.parentLocale]._config;else{if(null==(n=kn(t.parentLocale)))return wn[t.parentLocale]||(wn[t.parentLocale]=[]),wn[t.parentLocale].push({name:e,config:t}),null;o=n._config}return bn[e]=new W(F(o,t)),wn[e]&&wn[e].forEach((function(e){On(e.name,e.config)})),Rn(e),bn[e]}return delete bn[e],null}function En(e,t){if(null!=t){var n,o,r=mn;null!=(o=kn(e))&&(r=o._config),(n=new W(t=F(r,t))).parentLocale=bn[e],bn[e]=n,Rn(e)}else null!=bn[e]&&(null!=bn[e].parentLocale?bn[e]=bn[e].parentLocale:null!=bn[e]&&delete bn[e]);return bn[e]}function Tn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return gn;if(!c(e)){if(t=kn(e))return t;e=[e]}return Sn(e)}function An(){return N(bn)}function Mn(e){var t,a=e._a;return a&&-2===k(e).overflow&&(t=a[Ge]<0||a[Ge]>11?Ge:a[Ke]<1||a[Ke]>ft(a[Ye],a[Ge])?Ke:a[$e]<0||a[$e]>24||24===a[$e]&&(0!==a[Xe]||0!==a[qe]||0!==a[Ze])?$e:a[Xe]<0||a[Xe]>59?Xe:a[qe]<0||a[qe]>59?qe:a[Ze]<0||a[Ze]>999?Ze:-1,k(e)._overflowDayOfYear&&(t<Ye||t>Ke)&&(t=Ke),k(e)._overflowWeeks&&-1===t&&(t=Qe),k(e)._overflowWeekday&&-1===t&&(t=Je),k(e).overflow=t),e}function xn(a,b,e){return null!=a?a:null!=b?b:e}function _n(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Pn(e){var i,t,n,o,r,input=[];if(!e._d){for(n=_n(e),e._w&&null==e._a[Ke]&&null==e._a[Ge]&&In(e),null!=e._dayOfYear&&(r=xn(e._a[Ye],n[Ye]),(e._dayOfYear>et(r)||0===e._dayOfYear)&&(k(e)._overflowDayOfYear=!0),t=xt(r,0,e._dayOfYear),e._a[Ge]=t.getUTCMonth(),e._a[Ke]=t.getUTCDate()),i=0;i<3&&null==e._a[i];++i)e._a[i]=input[i]=n[i];for(;i<7;i++)e._a[i]=input[i]=null==e._a[i]?2===i?1:0:e._a[i];24===e._a[$e]&&0===e._a[Xe]&&0===e._a[qe]&&0===e._a[Ze]&&(e._nextDay=!0,e._a[$e]=0),e._d=(e._useUTC?xt:Mt).apply(null,input),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[$e]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(k(e).weekdayMismatch=!0)}}function In(e){var t,n,o,r,l,c,h,f;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)l=1,c=4,n=xn(t.GG,e._a[Ye],It(ro(),1,4).year),o=xn(t.W,1),((r=xn(t.E,1))<1||r>7)&&(f=!0);else{l=e._locale._week.dow,c=e._locale._week.doy;var d=It(ro(),l,c);n=xn(t.gg,e._a[Ye],d.year),o=xn(t.w,d.week),null!=t.d?((r=t.d)<0||r>6)&&(f=!0):null!=t.e?(r=t.e+l,(t.e<0||t.e>6)&&(f=!0)):r=l}o<1||o>Ht(n,l,c)?k(e)._overflowWeeks=!0:null!=f?k(e)._overflowWeekday=!0:(h=Pt(n,o,r,l,c),e._a[Ye]=h.year,e._dayOfYear=h.dayOfYear)}var Hn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Dn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Nn=/Z|[+-]\d\d(?::?\d\d)?/,jn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Ln=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Bn=/^\/?Date\((\-?\d+)/i;function Vn(e){var i,t,n,o,r,l,c=e._i,h=Hn.exec(c)||Dn.exec(c);if(h){for(k(e).iso=!0,i=0,t=jn.length;i<t;i++)if(jn[i][1].exec(h[1])){o=jn[i][0],n=!1!==jn[i][2];break}if(null==o)return void(e._isValid=!1);if(h[3]){for(i=0,t=Ln.length;i<t;i++)if(Ln[i][1].exec(h[3])){r=(h[2]||" ")+Ln[i][0];break}if(null==r)return void(e._isValid=!1)}if(!n&&null!=r)return void(e._isValid=!1);if(h[4]){if(!Nn.exec(h[4]))return void(e._isValid=!1);l="Z"}e._f=o+(r||"")+(l||""),qn(e)}else e._isValid=!1}var Fn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Wn(e,t,n,o,r,l){var c=[Un(e),vt.indexOf(t),parseInt(n,10),parseInt(o,10),parseInt(r,10)];return l&&c.push(parseInt(l,10)),c}function Un(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function zn(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Yn(e,t,n){return!e||Gt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(k(n).weekdayMismatch=!0,n._isValid=!1,!1)}var Gn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Kn(e,t,n){if(e)return Gn[e];if(t)return 0;var o=parseInt(n,10),r=o%100;return(o-r)/100*60+r}function $n(e){var t=Fn.exec(zn(e._i));if(t){var n=Wn(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Yn(t[1],n,e))return;e._a=n,e._tzm=Kn(t[8],t[9],t[10]),e._d=xt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),k(e).rfc2822=!0}else e._isValid=!1}function Xn(e){var t=Bn.exec(e._i);null===t?(Vn(e),!1===e._isValid&&(delete e._isValid,$n(e),!1===e._isValid&&(delete e._isValid,r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function qn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],k(e).empty=!0;var i,t,n,o,l,c=""+e._i,h=c.length,f=0;for(n=me(e._f,e._locale).match(ce)||[],i=0;i<n.length;i++)o=n[i],(t=(c.match(Le(o,e))||[])[0])&&((l=c.substr(0,c.indexOf(t))).length>0&&k(e).unusedInput.push(l),c=c.slice(c.indexOf(t)+t.length),f+=t.length),de[o]?(t?k(e).empty=!1:k(e).unusedTokens.push(o),ze(o,t,e)):e._strict&&!t&&k(e).unusedTokens.push(o);k(e).charsLeftOver=h-f,c.length>0&&k(e).unusedInput.push(c),e._a[$e]<=12&&!0===k(e).bigHour&&e._a[$e]>0&&(k(e).bigHour=void 0),k(e).parsedDateParts=e._a.slice(0),k(e).meridiem=e._meridiem,e._a[$e]=Zn(e._locale,e._a[$e],e._meridiem),Pn(e),Mn(e)}else $n(e);else Vn(e)}function Zn(e,t,n){var o;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((o=e.isPM(n))&&t<12&&(t+=12),o||12!==t||(t=0),t):t}function Qn(e){var t,n,o,i,r;if(0===e._f.length)return k(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=T({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],qn(t),R(t)&&(r+=k(t).charsLeftOver,r+=10*k(t).unusedTokens.length,k(t).score=r,(null==o||r<o)&&(o=r,n=t));w(e,n||t)}function Jn(e){if(!e._d){var i=ie(e._i);e._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],(function(e){return e&&parseInt(e,10)})),Pn(e)}}function eo(e){var t=new M(Mn(to(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function to(e){var input=e._i,t=e._f;return e._locale=e._locale||Tn(e._l),null===input||void 0===t&&""===input?O({nullInput:!0}):("string"==typeof input&&(e._i=input=e._locale.preparse(input)),x(input)?new M(Mn(input)):(v(input)?e._d=input:c(t)?Qn(e):t?qn(e):no(e),R(e)||(e._d=null),e))}function no(e){var input=e._i;d(input)?e._d=new Date(r.now()):v(input)?e._d=new Date(input.valueOf()):"string"==typeof input?Xn(e):c(input)?(e._a=map(input.slice(0),(function(e){return parseInt(e,10)})),Pn(e)):h(input)?Jn(e):y(input)?e._d=new Date(input):r.createFromInputFallback(e)}function oo(input,e,t,n,o){var r={};return!0!==t&&!1!==t||(n=t,t=void 0),(h(input)&&f(input)||c(input)&&0===input.length)&&(input=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=t,r._i=input,r._f=e,r._strict=n,eo(r)}function ro(input,e,t,n){return oo(input,e,t,n,!1)}r.createFromInputFallback=D("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var io=D("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=ro.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:O()})),ao=D("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=ro.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:O()}));function lo(e,t){var n,i;if(1===t.length&&c(t[0])&&(t=t[0]),!t.length)return ro();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}function so(){return lo("isBefore",[].slice.call(arguments,0))}function uo(){return lo("isAfter",[].slice.call(arguments,0))}var co=function(){return Date.now?Date.now():+new Date},ho=["year","quarter","month","week","day","hour","minute","second","millisecond"];function fo(e){for(var t in e)if(-1===nt.call(ho,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,i=0;i<ho.length;++i)if(e[ho[i]]){if(n)return!1;parseFloat(e[ho[i]])!==P(e[ho[i]])&&(n=!0)}return!0}function po(){return this._isValid}function yo(){return jo(NaN)}function go(e){var t=ie(e),n=t.year||0,o=t.quarter||0,r=t.month||0,l=t.week||t.isoWeek||0,c=t.day||0,h=t.hour||0,f=t.minute||0,d=t.second||0,y=t.millisecond||0;this._isValid=fo(t),this._milliseconds=+y+1e3*d+6e4*f+1e3*h*60*60,this._days=+c+7*l,this._months=+r+3*o+12*n,this._data={},this._locale=Tn(),this._bubble()}function vo(e){return e instanceof go}function mo(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function bo(e,t){pe(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+ue(~~(e/60),2)+t+ue(~~e%60,2)}))}bo("Z",":"),bo("ZZ",""),je("Z",Ie),je("ZZ",Ie),We(["Z","ZZ"],(function(input,e,t){t._useUTC=!0,t._tzm=Co(Ie,input)}));var wo=/([\+\-]|\d\d)/gi;function Co(e,t){var n=(t||"").match(e);if(null===n)return null;var o=((n[n.length-1]||[])+"").match(wo)||["-",0,0],r=60*o[1]+P(o[2]);return 0===r?0:"+"===o[0]?r:-r}function So(input,e){var t,n;return e._isUTC?(t=e.clone(),n=(x(input)||v(input)?input.valueOf():ro(input).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),r.updateOffset(t,!1),t):ro(input).local()}function ko(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ro(input,e,t){var n,o=this._offset||0;if(!this.isValid())return null!=input?this:NaN;if(null!=input){if("string"==typeof input){if(null===(input=Co(Ie,input)))return this}else Math.abs(input)<16&&!t&&(input*=60);return!this._isUTC&&e&&(n=ko(this)),this._offset=input,this._isUTC=!0,null!=n&&this.add(n,"m"),o!==input&&(!e||this._changeInProgress?Wo(this,jo(input-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:ko(this)}function Oo(input,e){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,e),this):-this.utcOffset()}function Eo(e){return this.utcOffset(0,e)}function To(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(ko(this),"m")),this}function Ao(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Co(Pe,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Mo(input){return!!this.isValid()&&(input=input?ro(input).utcOffset():0,(this.utcOffset()-input)%60==0)}function xo(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function _o(){if(!d(this._isDSTShifted))return this._isDSTShifted;var e={};if(T(e,this),(e=to(e))._a){var t=e._isUTC?C(e._a):ro(e._a);this._isDSTShifted=this.isValid()&&I(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Po(){return!!this.isValid()&&!this._isUTC}function Io(){return!!this.isValid()&&this._isUTC}function Ho(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Do=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,No=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function jo(input,e){var t,n,o,r=input,l=null;return vo(input)?r={ms:input._milliseconds,d:input._days,M:input._months}:y(input)?(r={},e?r[e]=input:r.milliseconds=input):(l=Do.exec(input))?(t="-"===l[1]?-1:1,r={y:0,d:P(l[Ke])*t,h:P(l[$e])*t,m:P(l[Xe])*t,s:P(l[qe])*t,ms:P(mo(1e3*l[Ze]))*t}):(l=No.exec(input))?(t="-"===l[1]?-1:1,r={y:Lo(l[2],t),M:Lo(l[3],t),w:Lo(l[4],t),d:Lo(l[5],t),h:Lo(l[6],t),m:Lo(l[7],t),s:Lo(l[8],t)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(o=Vo(ro(r.from),ro(r.to)),(r={}).ms=o.milliseconds,r.M=o.months),n=new go(r),vo(input)&&m(input,"_locale")&&(n._locale=input._locale),n}function Lo(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Bo(base,e){var t={};return t.months=e.month()-base.month()+12*(e.year()-base.year()),base.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+base.clone().add(t.months,"M"),t}function Vo(base,e){var t;return base.isValid()&&e.isValid()?(e=So(e,base),base.isBefore(e)?t=Bo(base,e):((t=Bo(e,base)).milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function Fo(e,t){return function(n,o){var r;return null===o||isNaN(+o)||(L(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=o,o=r),Wo(this,jo(n="string"==typeof n?+n:n,o),e),this}}function Wo(e,t,n,o){var l=t._milliseconds,c=mo(t._days),h=mo(t._months);e.isValid()&&(o=null==o||o,h&&Ct(e,lt(e,"Month")+h*n),c&&st(e,"Date",lt(e,"Date")+c*n),l&&e._d.setTime(e._d.valueOf()+l*n),o&&r.updateOffset(e,c||h))}jo.fn=go.prototype,jo.invalid=yo;var Uo=Fo(1,"add"),zo=Fo(-1,"subtract");function Yo(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Go(time,e){var t=time||ro(),n=So(t,this).startOf("day"),o=r.calendarFormat(this,n)||"sameElse",output=e&&(B(e[o])?e[o].call(this,t):e[o]);return this.format(output||this.localeData().calendar(o,this,ro(t)))}function Ko(){return new M(this)}function $o(input,e){var t=x(input)?input:ro(input);return!(!this.isValid()||!t.isValid())&&("millisecond"===(e=re(e)||"millisecond")?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf())}function Xo(input,e){var t=x(input)?input:ro(input);return!(!this.isValid()||!t.isValid())&&("millisecond"===(e=re(e)||"millisecond")?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf())}function qo(e,t,n,o){var r=x(e)?e:ro(e),l=x(t)?t:ro(t);return!!(this.isValid()&&r.isValid()&&l.isValid())&&("("===(o=o||"()")[0]?this.isAfter(r,n):!this.isBefore(r,n))&&(")"===o[1]?this.isBefore(l,n):!this.isAfter(l,n))}function Zo(input,e){var t,n=x(input)?input:ro(input);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=re(e)||"millisecond")?this.valueOf()===n.valueOf():(t=n.valueOf(),this.clone().startOf(e).valueOf()<=t&&t<=this.clone().endOf(e).valueOf()))}function Qo(input,e){return this.isSame(input,e)||this.isAfter(input,e)}function Jo(input,e){return this.isSame(input,e)||this.isBefore(input,e)}function er(input,e,t){var n,o,output;if(!this.isValid())return NaN;if(!(n=So(input,this)).isValid())return NaN;switch(o=6e4*(n.utcOffset()-this.utcOffset()),e=re(e)){case"year":output=nr(this,n)/12;break;case"month":output=nr(this,n);break;case"quarter":output=nr(this,n)/3;break;case"second":output=(this-n)/1e3;break;case"minute":output=(this-n)/6e4;break;case"hour":output=(this-n)/36e5;break;case"day":output=(this-n-o)/864e5;break;case"week":output=(this-n-o)/6048e5;break;default:output=this-n}return t?output:_(output)}function nr(a,b){var e=12*(b.year()-a.year())+(b.month()-a.month()),t=a.clone().add(e,"months");return-(e+(b-t<0?(b-t)/(t-a.clone().add(e-1,"months")):(b-t)/(a.clone().add(e+1,"months")-t)))||0}function or(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function rr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?ve(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):B(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",ve(n,"Z")):ve(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ir(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',o=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",l=t+'[")]';return this.format(n+o+r+l)}function ar(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var output=ve(this,e);return this.localeData().postformat(output)}function lr(time,e){return this.isValid()&&(x(time)&&time.isValid()||ro(time).isValid())?jo({to:this,from:time}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function sr(e){return this.from(ro(),e)}function ur(time,e){return this.isValid()&&(x(time)&&time.isValid()||ro(time).isValid())?jo({from:this,to:time}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function cr(e){return this.to(ro(),e)}function fr(e){var t;return void 0===e?this._locale._abbr:(null!=(t=Tn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var dr=D("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function pr(){return this._locale}var yr=1e3,gr=60*yr,vr=60*gr,mr=3506328*vr;function wr(e,t){return(e%t+t)%t}function Cr(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-mr:new Date(e,t,n).valueOf()}function Sr(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-mr:Date.UTC(e,t,n)}function kr(e){var time;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;var t=this._isUTC?Sr:Cr;switch(e){case"year":time=t(this.year(),0,1);break;case"quarter":time=t(this.year(),this.month()-this.month()%3,1);break;case"month":time=t(this.year(),this.month(),1);break;case"week":time=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=t(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf(),time-=wr(time+(this._isUTC?0:this.utcOffset()*gr),vr);break;case"minute":time=this._d.valueOf(),time-=wr(time,gr);break;case"second":time=this._d.valueOf(),time-=wr(time,yr)}return this._d.setTime(time),r.updateOffset(this,!0),this}function Rr(e){var time;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;var t=this._isUTC?Sr:Cr;switch(e){case"year":time=t(this.year()+1,0,1)-1;break;case"quarter":time=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=t(this.year(),this.month()+1,1)-1;break;case"week":time=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf(),time+=vr-wr(time+(this._isUTC?0:this.utcOffset()*gr),vr)-1;break;case"minute":time=this._d.valueOf(),time+=gr-wr(time,gr)-1;break;case"second":time=this._d.valueOf(),time+=yr-wr(time,yr)-1}return this._d.setTime(time),r.updateOffset(this,!0),this}function Or(){return this._d.valueOf()-6e4*(this._offset||0)}function Er(){return Math.floor(this.valueOf()/1e3)}function Tr(){return new Date(this.valueOf())}function Ar(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Mr(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function xr(){return this.isValid()?this.toISOString():null}function _r(){return R(this)}function Pr(){return w({},k(this))}function Ir(){return k(this).overflow}function Hr(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dr(e,t){pe(0,[e,e.length],0,t)}function Nr(input){return Vr.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function jr(input){return Vr.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function Lr(){return Ht(this.year(),1,4)}function Br(){var e=this.localeData()._week;return Ht(this.year(),e.dow,e.doy)}function Vr(input,e,t,n,o){var r;return null==input?It(this,n,o).year:(e>(r=Ht(input,n,o))&&(e=r),Fr.call(this,input,e,t,n,o))}function Fr(e,t,n,o,r){var l=Pt(e,t,n,o,r),c=xt(l.year,0,l.dayOfYear);return this.year(c.getUTCFullYear()),this.month(c.getUTCMonth()),this.date(c.getUTCDate()),this}function Wr(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)}pe(0,["gg",2],0,(function(){return this.weekYear()%100})),pe(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Dr("gggg","weekYear"),Dr("ggggg","weekYear"),Dr("GGGG","isoWeekYear"),Dr("GGGGG","isoWeekYear"),oe("weekYear","gg"),oe("isoWeekYear","GG"),le("weekYear",1),le("isoWeekYear",1),je("G",_e),je("g",_e),je("GG",Re,we),je("gg",Re,we),je("GGGG",Ae,Se),je("gggg",Ae,Se),je("GGGGG",Me,ke),je("ggggg",Me,ke),Ue(["gggg","ggggg","GGGG","GGGGG"],(function(input,e,t,n){e[n.substr(0,2)]=P(input)})),Ue(["gg","GG"],(function(input,e,t,n){e[n]=r.parseTwoDigitYear(input)})),pe("Q",0,"Qo","quarter"),oe("quarter","Q"),le("quarter",7),je("Q",be),We("Q",(function(input,e){e[Ge]=3*(P(input)-1)})),pe("D",["DD",2],"Do","date"),oe("date","D"),le("date",9),je("D",Re),je("DD",Re,we),je("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),We(["D","DD"],Ke),We("Do",(function(input,e){e[Ke]=P(input.match(Re)[0])}));var Ur=at("Date",!0);function zr(input){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?e:this.add(input-e,"d")}pe("DDD",["DDDD",3],"DDDo","dayOfYear"),oe("dayOfYear","DDD"),le("dayOfYear",4),je("DDD",Te),je("DDDD",Ce),We(["DDD","DDDD"],(function(input,e,t){t._dayOfYear=P(input)})),pe("m",["mm",2],0,"minute"),oe("minute","m"),le("minute",14),je("m",Re),je("mm",Re,we),We(["m","mm"],Xe);var Yr=at("Minutes",!1);pe("s",["ss",2],0,"second"),oe("second","s"),le("second",15),je("s",Re),je("ss",Re,we),We(["s","ss"],qe);var Gr,Kr=at("Seconds",!1);for(pe("S",0,0,(function(){return~~(this.millisecond()/100)})),pe(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),pe(0,["SSS",3],0,"millisecond"),pe(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),pe(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),pe(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),pe(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),pe(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),pe(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),oe("millisecond","ms"),le("millisecond",16),je("S",Te,be),je("SS",Te,we),je("SSS",Te,Ce),Gr="SSSS";Gr.length<=9;Gr+="S")je(Gr,xe);function $r(input,e){e[Ze]=P(1e3*("0."+input))}for(Gr="S";Gr.length<=9;Gr+="S")We(Gr,$r);var Xr=at("Milliseconds",!1);function qr(){return this._isUTC?"UTC":""}function Zr(){return this._isUTC?"Coordinated Universal Time":""}pe("z",0,0,"zoneAbbr"),pe("zz",0,0,"zoneName");var Qr=M.prototype;function Jr(input){return ro(1e3*input)}function ei(){return ro.apply(null,arguments).parseZone()}function ti(e){return e}Qr.add=Uo,Qr.calendar=Go,Qr.clone=Ko,Qr.diff=er,Qr.endOf=Rr,Qr.format=ar,Qr.from=lr,Qr.fromNow=sr,Qr.to=ur,Qr.toNow=cr,Qr.get=ut,Qr.invalidAt=Ir,Qr.isAfter=$o,Qr.isBefore=Xo,Qr.isBetween=qo,Qr.isSame=Zo,Qr.isSameOrAfter=Qo,Qr.isSameOrBefore=Jo,Qr.isValid=_r,Qr.lang=dr,Qr.locale=fr,Qr.localeData=pr,Qr.max=ao,Qr.min=io,Qr.parsingFlags=Pr,Qr.set=ct,Qr.startOf=kr,Qr.subtract=zo,Qr.toArray=Ar,Qr.toObject=Mr,Qr.toDate=Tr,Qr.toISOString=rr,Qr.inspect=ir,Qr.toJSON=xr,Qr.toString=or,Qr.unix=Er,Qr.valueOf=Or,Qr.creationData=Hr,Qr.year=ot,Qr.isLeapYear=it,Qr.weekYear=Nr,Qr.isoWeekYear=jr,Qr.quarter=Qr.quarters=Wr,Qr.month=St,Qr.daysInMonth=kt,Qr.week=Qr.weeks=Bt,Qr.isoWeek=Qr.isoWeeks=Vt,Qr.weeksInYear=Br,Qr.isoWeeksInYear=Lr,Qr.date=Ur,Qr.day=Qr.days=Qt,Qr.weekday=Jt,Qr.isoWeekday=en,Qr.dayOfYear=zr,Qr.hour=Qr.hours=vn,Qr.minute=Qr.minutes=Yr,Qr.second=Qr.seconds=Kr,Qr.millisecond=Qr.milliseconds=Xr,Qr.utcOffset=Ro,Qr.utc=Eo,Qr.local=To,Qr.parseZone=Ao,Qr.hasAlignedHourOffset=Mo,Qr.isDST=xo,Qr.isLocal=Po,Qr.isUtcOffset=Io,Qr.isUtc=Ho,Qr.isUTC=Ho,Qr.zoneAbbr=qr,Qr.zoneName=Zr,Qr.dates=D("dates accessor is deprecated. Use date instead.",Ur),Qr.months=D("months accessor is deprecated. Use month instead",St),Qr.years=D("years accessor is deprecated. Use year instead",ot),Qr.zone=D("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Oo),Qr.isDSTShifted=D("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",_o);var ni=W.prototype;function oi(e,t,n,o){var r=Tn(),l=C().set(o,t);return r[n](l,e)}function ri(e,t,n){if(y(e)&&(t=e,e=void 0),e=e||"",null!=t)return oi(e,t,n,"month");var i,o=[];for(i=0;i<12;i++)o[i]=oi(e,i,n,"month");return o}function ii(e,t,n,o){"boolean"==typeof e?(y(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,y(t)&&(n=t,t=void 0),t=t||"");var i,r=Tn(),l=e?r._week.dow:0;if(null!=n)return oi(t,(n+l)%7,o,"day");var c=[];for(i=0;i<7;i++)c[i]=oi(t,(i+l)%7,o,"day");return c}function ai(e,t){return ri(e,t,"months")}function si(e,t){return ri(e,t,"monthsShort")}function ui(e,t,n){return ii(e,t,n,"weekdays")}function ci(e,t,n){return ii(e,t,n,"weekdaysShort")}function hi(e,t,n){return ii(e,t,n,"weekdaysMin")}ni.calendar=z,ni.longDateFormat=G,ni.invalidDate=$,ni.ordinal=Q,ni.preparse=ti,ni.postformat=ti,ni.relativeTime=ee,ni.pastFuture=te,ni.set=V,ni.months=gt,ni.monthsShort=mt,ni.monthsParse=wt,ni.monthsRegex=Tt,ni.monthsShortRegex=Ot,ni.week=Dt,ni.firstDayOfYear=Lt,ni.firstDayOfWeek=jt,ni.weekdays=Yt,ni.weekdaysMin=Xt,ni.weekdaysShort=Kt,ni.weekdaysParse=Zt,ni.weekdaysRegex=nn,ni.weekdaysShortRegex=rn,ni.weekdaysMinRegex=ln,ni.isPM=dn,ni.meridiem=yn,Rn("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var b=e%10;return e+(1===P(e%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),r.lang=D("moment.lang is deprecated. Use moment.locale instead.",Rn),r.langData=D("moment.langData is deprecated. Use moment.localeData instead.",Tn);var fi=Math.abs;function di(){var data=this._data;return this._milliseconds=fi(this._milliseconds),this._days=fi(this._days),this._months=fi(this._months),data.milliseconds=fi(data.milliseconds),data.seconds=fi(data.seconds),data.minutes=fi(data.minutes),data.hours=fi(data.hours),data.months=fi(data.months),data.years=fi(data.years),this}function pi(e,input,t,n){var o=jo(input,t);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function yi(input,e){return pi(this,input,e,1)}function gi(input,e){return pi(this,input,e,-1)}function vi(e){return e<0?Math.floor(e):Math.ceil(e)}function mi(){var e,t,n,o,r,l=this._milliseconds,c=this._days,h=this._months,data=this._data;return l>=0&&c>=0&&h>=0||l<=0&&c<=0&&h<=0||(l+=864e5*vi(wi(h)+c),c=0,h=0),data.milliseconds=l%1e3,e=_(l/1e3),data.seconds=e%60,t=_(e/60),data.minutes=t%60,n=_(t/60),data.hours=n%24,c+=_(n/24),h+=r=_(bi(c)),c-=vi(wi(r)),o=_(h/12),h%=12,data.days=c,data.months=h,data.years=o,this}function bi(e){return 4800*e/146097}function wi(e){return 146097*e/4800}function Ci(e){if(!this.isValid())return NaN;var t,n,o=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+o/864e5,n=this._months+bi(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(wi(this._months)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}}function Si(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*P(this._months/12):NaN}function ki(e){return function(){return this.as(e)}}var Ri=ki("ms"),Oi=ki("s"),Ei=ki("m"),Ti=ki("h"),Ai=ki("d"),Mi=ki("w"),xi=ki("M"),_i=ki("Q"),Pi=ki("y");function Ii(){return jo(this)}function Hi(e){return e=re(e),this.isValid()?this[e+"s"]():NaN}function Di(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ni=Di("milliseconds"),ji=Di("seconds"),Li=Di("minutes"),Bi=Di("hours"),Vi=Di("days"),Fi=Di("months"),Wi=Di("years");function Ui(){return _(this.days()/7)}var zi=Math.round,Yi={ss:44,s:45,m:45,h:22,d:26,M:11};function Gi(e,t,n,o,r){return r.relativeTime(t||1,!!n,e,o)}function Ki(e,t,n){var o=jo(e).abs(),r=zi(o.as("s")),l=zi(o.as("m")),c=zi(o.as("h")),h=zi(o.as("d")),f=zi(o.as("M")),d=zi(o.as("y")),a=r<=Yi.ss&&["s",r]||r<Yi.s&&["ss",r]||l<=1&&["m"]||l<Yi.m&&["mm",l]||c<=1&&["h"]||c<Yi.h&&["hh",c]||h<=1&&["d"]||h<Yi.d&&["dd",h]||f<=1&&["M"]||f<Yi.M&&["MM",f]||d<=1&&["y"]||["yy",d];return a[2]=t,a[3]=+e>0,a[4]=n,Gi.apply(null,a)}function $i(e){return void 0===e?zi:"function"==typeof e&&(zi=e,!0)}function Xi(e,t){return void 0!==Yi[e]&&(void 0===t?Yi[e]:(Yi[e]=t,"s"===e&&(Yi.ss=t-1),!0))}function qi(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),output=Ki(this,!e,t);return e&&(output=t.pastFuture(+this,output)),t.postformat(output)}var Zi=Math.abs;function Qi(e){return(e>0)-(e<0)||+e}function Ji(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Zi(this._milliseconds)/1e3,o=Zi(this._days),r=Zi(this._months);e=_(n/60),t=_(e/60),n%=60,e%=60;var l=_(r/12),c=r%=12,h=o,f=t,d=e,s=n?n.toFixed(3).replace(/\.?0+$/,""):"",y=this.asSeconds();if(!y)return"P0D";var v=y<0?"-":"",m=Qi(this._months)!==Qi(y)?"-":"",w=Qi(this._days)!==Qi(y)?"-":"",C=Qi(this._milliseconds)!==Qi(y)?"-":"";return v+"P"+(l?m+l+"Y":"")+(c?m+c+"M":"")+(h?w+h+"D":"")+(f||d||s?"T":"")+(f?C+f+"H":"")+(d?C+d+"M":"")+(s?C+s+"S":"")}var ea=go.prototype;return ea.isValid=po,ea.abs=di,ea.add=yi,ea.subtract=gi,ea.as=Ci,ea.asMilliseconds=Ri,ea.asSeconds=Oi,ea.asMinutes=Ei,ea.asHours=Ti,ea.asDays=Ai,ea.asWeeks=Mi,ea.asMonths=xi,ea.asQuarters=_i,ea.asYears=Pi,ea.valueOf=Si,ea._bubble=mi,ea.clone=Ii,ea.get=Hi,ea.milliseconds=Ni,ea.seconds=ji,ea.minutes=Li,ea.hours=Bi,ea.days=Vi,ea.weeks=Ui,ea.months=Fi,ea.years=Wi,ea.humanize=qi,ea.toISOString=Ji,ea.toString=Ji,ea.toJSON=Ji,ea.locale=fr,ea.localeData=pr,ea.toIsoString=D("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ji),ea.lang=dr,pe("X",0,0,"unix"),pe("x",0,0,"valueOf"),je("x",_e),je("X",He),We("X",(function(input,e,t){t._d=new Date(1e3*parseFloat(input,10))})),We("x",(function(input,e,t){t._d=new Date(P(input))})),r.version="2.24.0",l(ro),r.fn=Qr,r.min=so,r.max=uo,r.now=co,r.utc=C,r.unix=Jr,r.months=ai,r.isDate=v,r.locale=Rn,r.invalid=O,r.duration=jo,r.isMoment=x,r.weekdays=ui,r.parseZone=ei,r.localeData=Tn,r.isDuration=vo,r.monthsShort=si,r.weekdaysMin=hi,r.defineLocale=On,r.updateLocale=En,r.locales=An,r.weekdaysShort=ci,r.normalizeUnits=re,r.relativeTimeRounding=$i,r.relativeTimeThreshold=Xi,r.calendarFormat=Yo,r.prototype=Qr,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()}).call(this,n(298)(e))},561:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return D}));var o=n(602),r=n(0);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){v(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,p){return(C=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?S(e):t}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=w(e);if(t){var r=w(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return k(this,n)}}var O=Symbol("unassigned"),E=null;function T(source){var e=o.a.hooks.getRegistered(),t={};for(var n in Object.assign(t,o.a.DefaultSettings),t)t[n]={default:O};for(var i=0;i<e.length;i++)t[e[i]]={default:O};return t.settings={default:O},"HotTable"===source&&(t.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},t.wrapperRendererCacheSize={type:Number,default:3e3}),t}function A(e){var t={},n=e.settings;if(n!==O)for(var o in n)n.hasOwnProperty(o)&&n[o]!==O&&(t[o]=n[o]);for(var r in e)e.hasOwnProperty(r)&&"settings"!==r&&e[r]!==O&&(t[r]=e[r]);return t}function M(e,t){var n=A(e),o=e.settings?e.settings:n,r=e.settings?n:null,l={};for(var c in o)!o.hasOwnProperty(c)||void 0===o[c]||t&&"data"!==c&&P(t[c],o[c])||(l[c]=o[c]);for(var h in r)!r.hasOwnProperty(h)||"id"===h||"settings"===h||"wrapperRendererCacheSize"===h||void 0===r[h]||t&&"data"!==h&&P(t[h],r[h])||(l[h]=r[h]);return l}function x(e,t){var n=null;return e.every((function(slot,e){return!slot.data||!slot.data.attrs||void 0===slot.data.attrs[t]||(n=slot,!1)})),n}function _(e,t,n,data){var o=t.$el?t.$el.ownerDocument:document,r={propsData:n,parent:t,data:data};E||((E=o.createElement("DIV")).id="vueHotComponents",o.body.appendChild(E));var l=o.createElement("DIV");return E.appendChild(l),new e.componentOptions.Ctor(r).$mount(l)}function P(e,t){return JSON.stringify(e)===JSON.stringify(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;var I=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){!function(e){var t=Symbol("newer"),n=Symbol("older");function o(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function r(e,o){this.key=e,this.value=o,this[t]=void 0,this[n]=void 0}e.LRUMap=o,o.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][n]=e[n]),e[n]&&(e[n][t]=e[t]),e[t]=void 0,e[n]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},o.prototype.assign=function(e){var o,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var c=e[Symbol.iterator](),h=c.next();!h.done;h=c.next()){var f=new r(h.value[0],h.value[1]);if(this._keymap.set(f.key,f),o?(o[t]=f,f[n]=o):this.oldest=f,o=f,0==l--)throw new Error("overflow")}this.newest=o,this.size=this._keymap.size},o.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},o.prototype.set=function(e,o){var l=this._keymap.get(e);return l?(l.value=o,this._markEntryAsUsed(l),this):(this._keymap.set(e,l=new r(e,o)),this.newest?(this.newest[t]=l,l[n]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},o.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[n]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]},o.prototype.has=function(e){return this._keymap.has(e)}}(t)})).LRUMap;function H(template,style,script,e,t,n,o,r,l,c){"boolean"!=typeof o&&(l=r,r=o,o=!1);const h="function"==typeof script?script.options:script;let f;if(template&&template.render&&(h.render=template.render,h.staticRenderFns=template.staticRenderFns,h._compiled=!0,t&&(h.functional=!0)),e&&(h._scopeId=e),n?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),style&&style.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},h._ssrRegister=f):style&&(f=o?function(e){style.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){style.call(this,r(e))}),f)if(h.functional){const e=h.render;h.render=function(t,n){return f.call(n),e(t,n)}}else{const e=h.beforeCreate;h.beforeCreate=e?[].concat(e,f):[f]}return script}var D=H({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:e.id}},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"HotTable",props:T("HotTable"),watch:{mergedHotSettings:function(e){this.hotInstance&&void 0!==e&&(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,t=new I(this.wrapperRendererCacheSize);return t.shift=function(){var e=I.prototype.shift.call(this);return e[1].component.$destroy(),e},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:t,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(t){e.__hotInstance=t}}},computed:{mergedHotSettings:function(){return M(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var component,e=this.getGlobalRendererVNode(),t=this.getGlobalEditorVNode(),n=M(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,t&&(n.editor=this.getEditorClass(t,this),t.child.$destroy()),e&&(n.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new o.a.Core(this.$el,n),this.hotInstance.init(),(component=this).hotInstance&&(component.hotInstance.addHook("beforeChange",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateCol",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveCol",(function(){component.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,data=this.hotInstance.getSourceData(),n=[],o=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),l=this.hotInstance.isColumnModificationAllowed(),c=0;if(data&&data.length!==r&&data.length<r)for(var h=data.length;h<r;h++)n.push(h);if(l)if(c=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),data&&data[0]&&(null===(t=data[0])||void 0===t?void 0:t.length)!==c&&data[0].length<c)for(var f=data[0].length;f<c;f++)o.push(f);this.hotInstance.batch((function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(r-1,data.length-r),l&&0!==data.length&&(o.length>0?e.hotInstance.columnIndexMapper.removeIndexes(o):e.hotInstance.columnIndexMapper.insertIndexes(c-1,data[0].length-c))}))}},getGlobalRendererVNode:function(){return x(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return x(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var e=this.$children.filter((function(e){return"HotColumn"===e.$options.name})),t=!1,n=e.map((function(e){return e.usesRendererComponent&&(t=!0),c({},e.columnSettings)}));return t&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(e,t){var n=this;return function(o,r,l,col,c,h,f){if(r&&!r.getAttribute("ghost-table")){var d=n.rendererCache,y={hotInstance:o,TD:r,row:l,col:col,prop:c,value:h,cellProperties:f,isRenderer:!0};if(d&&!d.has("".concat(l,"-").concat(col))){var v=_(e,t,e.componentOptions.propsData,y);d.set("".concat(l,"-").concat(col),{component:v,lastUsedTD:null})}var m=d.get("".concat(l,"-").concat(col)),w=m.component,C=m.lastUsedTD;if(Object.assign(w.$data,y),!w.$el.parentElement||C!==r){for(;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(w.$el),m.lastUsedTD=r}}return r}},getEditorClass:function(e,t){var n=e.key?e.key.toString():null,o=e.componentOptions.Ctor.options.name,r=n?"".concat(o,":").concat(n):o,l=this.editorCache,c=null;return l.has(r)?c=l.get(r):(c=_(e,t,e.componentOptions.propsData,{isEditor:!0}),l.set(r,c)),c.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"9.0.2"},undefined,false,undefined,!1,void 0,void 0,void 0);T("HotColumn");function N(e){return(N="function"==typeof Symbol&&"symbol"===h(Symbol.iterator)?function(e){return h(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":h(e)})(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){return function(e){if(Array.isArray(e)){for(var i=0,t=new Array(e.length);i<e.length;i++)t[i]=e[i];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function B(){return"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function V(e,t){F(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(n){F(e.prototype,t.prototype,n)})),Object.getOwnPropertyNames(t).forEach((function(n){F(e,t,n)}))}function F(e,t,n){(n?Reflect.getOwnMetadataKeys(t,n):Reflect.getOwnMetadataKeys(t)).forEach((function(o){var r=n?Reflect.getOwnMetadata(o,t,n):Reflect.getOwnMetadata(o,t);n?Reflect.defineMetadata(o,r,e,n):Reflect.defineMetadata(o,r,e)}))}var W={__proto__:[]}instanceof Array;function U(e,t){var n=t.prototype._init;t.prototype._init=function(){var t=this,n=Object.getOwnPropertyNames(e);if(e.$options.props)for(var o in e.$options.props)e.hasOwnProperty(o)||n.push(o);n.forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},configurable:!0})}))};var data=new t;t.prototype._init=n;var o={};return Object.keys(data).forEach((function(e){void 0!==data[e]&&(o[e]=data[e])})),o}var z=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(e){if("constructor"!==e)if(z.indexOf(e)>-1)t[e]=n[e];else{var o=Object.getOwnPropertyDescriptor(n,e);void 0!==o.value?"function"==typeof o.value?(t.methods||(t.methods={}))[e]=o.value:(t.mixins||(t.mixins=[])).push({data:function(){return j({},e,o.value)}}):(o.get||o.set)&&((t.computed||(t.computed={}))[e]={get:o.get,set:o.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return U(this,e)}});var o=e.__decorators__;o&&(o.forEach((function(e){return e(t)})),delete e.__decorators__);var l=Object.getPrototypeOf(e.prototype),c=l instanceof r.a?l.constructor:r.a,h=c.extend(t);return K(h,e,c),B()&&V(h,e),h}var G={prototype:!0,arguments:!0,callee:!0,caller:!0};function K(e,t,n){Object.getOwnPropertyNames(t).forEach((function(o){if(!G[o]){var r=Object.getOwnPropertyDescriptor(e,o);if(!r||r.configurable){var l,c,h=Object.getOwnPropertyDescriptor(t,o);if(!W){if("cid"===o)return;var f=Object.getOwnPropertyDescriptor(n,o);if(l=h.value,c=N(l),null!=l&&("object"===c||"function"===c)&&f&&f.value===h.value)return}Object.defineProperty(e,o,h)}}}))}function $(e){return"function"==typeof e?Y(e):function(t){return Y(t,e)}}$.registerHooks=function(e){z.push.apply(z,L(e))};var X=function(e){m(n,e);var t=R(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).name="BaseEditorComponent",e.instance=null,e.row=null,e.col=null,e.prop=null,e.TD=null,e.originalValue=null,e.cellProperties=null,e.state=null,e.hot=null,e}return y(n,[{key:"mounted",value:function(){var e,t=this;this.$data.hotCustomEditorClass=(e=function(e){m(o,e);var n=R(o);function o(e,r,col,l,c,h){var d;return f(this,o),d=n.call(this,e,r,col,l,c,h),t.$data.hotCustomEditorInstance=S(d),d}return y(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),o}(o.a.editors.BaseEditor),Object.getOwnPropertyNames(o.a.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return(e=t[n]).call.apply(e,[this].concat(r))})})),e)}},{key:"_fireCallbacks",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=o.a.editors.BaseEditor.prototype._fireCallbacks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.beginEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.cancelChanges).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.checkEditorSection).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.close).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.discardEditor).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.enableFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.extend).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.finishEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.focus).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.getValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.init).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.isInFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.isOpened).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.isWaiting).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.open).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(e,col,t,n,r,l){return this.$data.hotInstance=l.instance,this.$data.row=e,this.$data.col=col,this.$data.prop=t,this.$data.TD=n,this.$data.originalValue=r,this.$data.cellProperties=l,o.a.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,e,col,t,n,r,l)}},{key:"saveValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.saveValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.setValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.addHook).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.removeHooksByKey).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.clearHooks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.getEditedCell).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.a.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(r.a);X=function(e,t,n,desc){var o,r=arguments.length,l=r<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(r<3?o(l):r>3?o(t,n,l):o(t,n))||l);return r>3&&l&&Object.defineProperty(t,n,l),l}([$({})],X)}).call(this,n(65))},564:function(e,t,n){var content=n(670);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(13).default)("73309d30",content,!0,{sourceMap:!1})},602:function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"requestAnimationFrame",(function(){return H})),n.d(o,"isClassListSupported",(function(){return D})),n.d(o,"isTextContentSupported",(function(){return N})),n.d(o,"isGetComputedStyleSupported",(function(){return j})),n.d(o,"cancelAnimationFrame",(function(){return L})),n.d(o,"isTouchSupported",(function(){return B})),n.d(o,"hasCaptionProblem",(function(){return V})),n.d(o,"getComparisonFunction",(function(){return F})),n.d(o,"isPassiveEventSupported",(function(){return W}));var r={};n.r(r),n.d(r,"to2dArray",(function(){return U})),n.d(r,"extendArray",(function(){return z})),n.d(r,"pivot",(function(){return Y})),n.d(r,"arrayReduce",(function(){return G})),n.d(r,"arrayFilter",(function(){return K})),n.d(r,"arrayMap",(function(){return $})),n.d(r,"arrayEach",(function(){return X})),n.d(r,"arraySum",(function(){return Z})),n.d(r,"arrayMax",(function(){return Q})),n.d(r,"arrayMin",(function(){return J})),n.d(r,"arrayAvg",(function(){return ee})),n.d(r,"arrayFlatten",(function(){return te})),n.d(r,"arrayUnique",(function(){return ne})),n.d(r,"getDifferenceOfArrays",(function(){return oe})),n.d(r,"getIntersectionOfArrays",(function(){return re})),n.d(r,"getUnionOfArrays",(function(){return ie})),n.d(r,"stringToArray",(function(){return ae}));var l={};n.r(l),n.d(l,"duckSchema",(function(){return ue})),n.d(l,"inherit",(function(){return ce})),n.d(l,"extend",(function(){return he})),n.d(l,"deepExtend",(function(){return fe})),n.d(l,"deepClone",(function(){return de})),n.d(l,"clone",(function(){return pe})),n.d(l,"mixin",(function(){return ye})),n.d(l,"isObjectEqual",(function(){return ge})),n.d(l,"isObject",(function(){return ve})),n.d(l,"defineGetter",(function(){return me})),n.d(l,"objectEach",(function(){return be})),n.d(l,"getProperty",(function(){return we})),n.d(l,"setProperty",(function(){return Ce})),n.d(l,"deepObjectSize",(function(){return Se})),n.d(l,"createObjectPropListener",(function(){return ke})),n.d(l,"hasOwnProperty",(function(){return Re}));var c={};n.r(c),n.d(c,"setBrowserMeta",(function(){return Ae})),n.d(c,"setPlatformMeta",(function(){return Me})),n.d(c,"isChrome",(function(){return xe})),n.d(c,"isChromeWebKit",(function(){return _e})),n.d(c,"isFirefox",(function(){return Pe})),n.d(c,"isFirefoxWebKit",(function(){return Ie})),n.d(c,"isSafari",(function(){return He})),n.d(c,"isEdge",(function(){return De})),n.d(c,"isEdgeWebKit",(function(){return Ne})),n.d(c,"isIE",(function(){return je})),n.d(c,"isIE9",(function(){return Le})),n.d(c,"isMSBrowser",(function(){return Be})),n.d(c,"isMobileBrowser",(function(){return Ve})),n.d(c,"isIOS",(function(){return Fe})),n.d(c,"isIpadOS",(function(){return We})),n.d(c,"isWindowsOS",(function(){return Ue})),n.d(c,"isMacOS",(function(){return ze})),n.d(c,"isLinuxOS",(function(){return Ye}));var h={};n.r(h),n.d(h,"stringify",(function(){return ot})),n.d(h,"isDefined",(function(){return it})),n.d(h,"isUndefined",(function(){return at})),n.d(h,"isEmpty",(function(){return lt})),n.d(h,"isRegExp",(function(){return st})),n.d(h,"_injectProductInfo",(function(){return St}));var f={};n.r(f),n.d(f,"toUpperCaseFirst",(function(){return kt})),n.d(f,"equalsIgnoreCase",(function(){return Rt})),n.d(f,"randomString",(function(){return Ot})),n.d(f,"isPercentValue",(function(){return Et})),n.d(f,"substitute",(function(){return Tt})),n.d(f,"stripTags",(function(){return At})),n.d(f,"sanitize",(function(){return Mt}));var d={};n.r(d),n.d(d,"getParent",(function(){return Pt})),n.d(d,"getFrameElement",(function(){return It})),n.d(d,"getParentWindow",(function(){return Ht})),n.d(d,"hasAccessToParentWindow",(function(){return Dt})),n.d(d,"closest",(function(){return Nt})),n.d(d,"closestDown",(function(){return jt})),n.d(d,"isChildOf",(function(){return Lt})),n.d(d,"index",(function(){return Bt})),n.d(d,"overlayContainsElement",(function(){return Vt})),n.d(d,"hasClass",(function(){return zt})),n.d(d,"addClass",(function(){return Yt})),n.d(d,"removeClass",(function(){return Gt})),n.d(d,"removeTextNodes",(function(){return Kt})),n.d(d,"empty",(function(){return $t})),n.d(d,"HTML_CHARACTERS",(function(){return qt})),n.d(d,"fastInnerHTML",(function(){return Zt})),n.d(d,"fastInnerText",(function(){return Qt})),n.d(d,"isVisible",(function(){return Jt})),n.d(d,"offset",(function(){return en})),n.d(d,"getWindowScrollTop",(function(){return tn})),n.d(d,"getWindowScrollLeft",(function(){return nn})),n.d(d,"getScrollTop",(function(){return on})),n.d(d,"getScrollLeft",(function(){return rn})),n.d(d,"getScrollableElement",(function(){return an})),n.d(d,"getTrimmingContainer",(function(){return ln})),n.d(d,"getStyle",(function(){return sn})),n.d(d,"matchesCSSRules",(function(){return un})),n.d(d,"getComputedStyle",(function(){return cn})),n.d(d,"outerWidth",(function(){return hn})),n.d(d,"outerHeight",(function(){return fn})),n.d(d,"innerHeight",(function(){return dn})),n.d(d,"innerWidth",(function(){return pn})),n.d(d,"addEvent",(function(){return yn})),n.d(d,"removeEvent",(function(){return gn})),n.d(d,"getCaretPosition",(function(){return vn})),n.d(d,"getSelectionEndPosition",(function(){return mn})),n.d(d,"getSelectionText",(function(){return bn})),n.d(d,"clearTextSelection",(function(){return wn})),n.d(d,"setCaretPosition",(function(){return Cn})),n.d(d,"getScrollbarWidth",(function(){return kn})),n.d(d,"hasVerticalScrollbar",(function(){return Rn})),n.d(d,"hasHorizontalScrollbar",(function(){return On})),n.d(d,"setOverlayPosition",(function(){return En})),n.d(d,"getCssTransform",(function(){return Tn})),n.d(d,"resetCssTransform",(function(){return An})),n.d(d,"isInput",(function(){return Mn})),n.d(d,"isOutsideInput",(function(){return xn})),n.d(d,"selectElementIfAllowed",(function(){return _n})),n.d(d,"isDetached",(function(){return Pn}));var y={};n.r(y),n.d(y,"isFunction",(function(){return In})),n.d(y,"throttle",(function(){return Hn})),n.d(y,"throttleAfterHits",(function(){return Dn})),n.d(y,"debounce",(function(){return Nn})),n.d(y,"pipe",(function(){return jn})),n.d(y,"partial",(function(){return Ln})),n.d(y,"curry",(function(){return Bn})),n.d(y,"curryRight",(function(){return Vn}));var v={};n.r(v),n.d(v,"KEY_CODES",(function(){return Un})),n.d(v,"isPrintableChar",(function(){return Yn})),n.d(v,"isFunctionKey",(function(){return Gn})),n.d(v,"isCtrlKey",(function(){return Kn})),n.d(v,"isCtrlMetaKey",(function(){return $n})),n.d(v,"isKey",(function(){return Xn}));var m={};n.r(m),n.d(m,"stopImmediatePropagation",(function(){return qn})),n.d(m,"isImmediatePropagationStopped",(function(){return Zn})),n.d(m,"isRightClick",(function(){return Qn})),n.d(m,"isLeftClick",(function(){return Jn}));var w={};n.r(w),n.d(w,"instanceToHTML",(function(){return rr})),n.d(w,"_dataToHTML",(function(){return ir})),n.d(w,"htmlToGridSettings",(function(){return ar}));var C={};n.r(C),n.d(C,"isNumeric",(function(){return sr})),n.d(C,"rangeEach",(function(){return ur})),n.d(C,"rangeEachReverse",(function(){return cr})),n.d(C,"valueAccordingPercent",(function(){return fr}));var S={};n.r(S),n.d(S,"spreadsheetColumnLabel",(function(){return Au})),n.d(S,"spreadsheetColumnIndex",(function(){return Mu})),n.d(S,"createSpreadsheetData",(function(){return xu})),n.d(S,"createSpreadsheetObjectData",(function(){return _u})),n.d(S,"createEmptySpreadsheetData",(function(){return Pu})),n.d(S,"translateRowsToColumns",(function(){return Iu})),n.d(S,"cellMethodLookupFactory",(function(){return Hu})),n.d(S,"dataRowToChangesArray",(function(){return Du})),n.d(S,"countFirstRowKeys",(function(){return Nu})),n.d(S,"isArrayOfArrays",(function(){return ju})),n.d(S,"isArrayOfObjects",(function(){return Lu}));var k={};n.r(k),n.d(k,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return Dh})),n.d(k,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return Nh})),n.d(k,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return jh})),n.d(k,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return Lh})),n.d(k,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return Bh})),n.d(k,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return Vh})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return Fh})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return Wh})),n.d(k,"CONTEXTMENU_ITEMS_UNDO",(function(){return Uh})),n.d(k,"CONTEXTMENU_ITEMS_REDO",(function(){return zh})),n.d(k,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return Yh})),n.d(k,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return Gh})),n.d(k,"CONTEXTMENU_ITEMS_COPY",(function(){return Kh})),n.d(k,"CONTEXTMENU_ITEMS_CUT",(function(){return $h})),n.d(k,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return Xh})),n.d(k,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return qh})),n.d(k,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return Zh})),n.d(k,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return Qh})),n.d(k,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return Jh})),n.d(k,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return ef})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return tf})),n.d(k,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return nf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return of})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return rf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return af})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return lf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return sf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return uf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return cf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return hf})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS",(function(){return ff})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return df})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return pf})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return yf})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return gf})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return vf})),n.d(k,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return mf})),n.d(k,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return bf})),n.d(k,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return wf})),n.d(k,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return Cf})),n.d(k,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return Sf})),n.d(k,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return kf})),n.d(k,"FILTERS_NAMESPACE",(function(){return Rf})),n.d(k,"FILTERS_CONDITIONS_NAMESPACE",(function(){return Of})),n.d(k,"FILTERS_CONDITIONS_NONE",(function(){return Ef})),n.d(k,"FILTERS_CONDITIONS_EMPTY",(function(){return Tf})),n.d(k,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return Af})),n.d(k,"FILTERS_CONDITIONS_EQUAL",(function(){return Mf})),n.d(k,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return xf})),n.d(k,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return _f})),n.d(k,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return Pf})),n.d(k,"FILTERS_CONDITIONS_CONTAINS",(function(){return If})),n.d(k,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return Hf})),n.d(k,"FILTERS_CONDITIONS_BY_VALUE",(function(){return Df})),n.d(k,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return Nf})),n.d(k,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return jf})),n.d(k,"FILTERS_CONDITIONS_LESS_THAN",(function(){return Lf})),n.d(k,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return Bf})),n.d(k,"FILTERS_CONDITIONS_BETWEEN",(function(){return Vf})),n.d(k,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return Ff})),n.d(k,"FILTERS_CONDITIONS_AFTER",(function(){return Wf})),n.d(k,"FILTERS_CONDITIONS_BEFORE",(function(){return Uf})),n.d(k,"FILTERS_CONDITIONS_TODAY",(function(){return zf})),n.d(k,"FILTERS_CONDITIONS_TOMORROW",(function(){return Yf})),n.d(k,"FILTERS_CONDITIONS_YESTERDAY",(function(){return Gf})),n.d(k,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return Kf})),n.d(k,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return $f})),n.d(k,"FILTERS_LABELS_CONJUNCTION",(function(){return Xf})),n.d(k,"FILTERS_LABELS_DISJUNCTION",(function(){return qf})),n.d(k,"FILTERS_VALUES_BLANK_CELLS",(function(){return Zf})),n.d(k,"FILTERS_BUTTONS_SELECT_ALL",(function(){return Qf})),n.d(k,"FILTERS_BUTTONS_CLEAR",(function(){return Jf})),n.d(k,"FILTERS_BUTTONS_OK",(function(){return ed})),n.d(k,"FILTERS_BUTTONS_CANCEL",(function(){return nd})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return od})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return rd})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return id}));var R={};n.r(R),n.d(R,"getNormalizedDate",(function(){return mg}));n(658),n(286),n(153),n(505),n(25),n(33),n(60),n(26),n(48),n(36),n(438),n(563),n(8),n(56),n(665),n(5),n(46),n(19),n(51),n(152),n(37),n(38),n(28),n(429),n(47),n(57),n(7),n(72),n(207),n(62),n(80),n(59);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}for(var E,T,A,M=0,x=["ms","moz","webkit","o"],_=window.requestAnimationFrame,P=window.cancelAnimationFrame,I=0;I<x.length&&!_;++I)_=window["".concat(x[I],"RequestAnimationFrame")],P=window["".concat(x[I],"CancelAnimationFrame")]||window["".concat(x[I],"CancelRequestAnimationFrame")];function H(e){return _.call(window,e)}function D(){return!!document.documentElement.classList}function N(){return!!document.createTextNode("test").textContent}function j(){return!!window.getComputedStyle}function L(e){P.call(window,e)}function B(){return"ontouchstart"in window}function V(){return void 0===E&&function(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),E=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),E}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return T||(T="object"===("undefined"==typeof Intl?"undefined":O(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return"".concat(a).localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}function W(){if(void 0!==A)return A;try{var e={get passive(){A=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){A=!1}return A}_||(_=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-M)),o=window.setTimeout((function(){e(t+n)}),n);return M=t+n,o}),P||(P=function(e){clearTimeout(e)});n(496);function U(e){for(var t=e.length,i=0;i<t;)e[i]=[e[i]],i+=1}function z(e,t){for(var n=t.length,i=0;i<n;)e.push(t[i]),i+=1}function Y(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,o=e[0].length,i=0;i<n;i++)for(var r=0;r<o;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t}function G(e,t,n,o){var r=-1,l=e,c=n;Array.isArray(e)||(l=Array.from(e));var h=l.length;for(o&&h&&(c=l[r+=1]),r+=1;r<h;)c=t(c,l[r],r,l),r+=1;return c}function K(e,t){var n=0,o=e;Array.isArray(e)||(o=Array.from(e));for(var r=o.length,l=[],c=-1;n<r;){var h=o[n];t(h,n,o)&&(l[c+=1]=h),n+=1}return l}function $(e,t){var n=0,o=e;Array.isArray(e)||(o=Array.from(e));for(var r=o.length,l=[],c=-1;n<r;){var h=o[n];l[c+=1]=t(h,n,o),n+=1}return l}function X(e,t){var n=0,o=e;Array.isArray(e)||(o=Array.from(e));for(var r=o.length;n<r&&!1!==t(o[n],n,o);)n+=1;return e}function Z(e){return G(e,(function(a,b){return a+b}),0)}function Q(e){return G(e,(function(a,b){return a>b?a:b}),Array.isArray(e)?e[0]:void 0)}function J(e){return G(e,(function(a,b){return a<b?a:b}),Array.isArray(e)?e[0]:void 0)}function ee(e){return e.length?Z(e)/e.length:0}function te(e){return G(e,(function(e,t){return e.concat(Array.isArray(t)?te(t):t)}),[])}function ne(e){var t=[];return X(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=[].concat(t),r=o[0],l=o.slice(1),c=r;return X(l,(function(e){c=c.filter((function(t){return!e.includes(t)}))})),c}function re(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=[].concat(t),r=o[0],l=o.slice(1),c=r;return X(l,(function(e){c=c.filter((function(t){return e.includes(t)}))})),c}function ie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=[].concat(t),r=o[0],l=o.slice(1),c=new Set(r);return X(l,(function(e){X(e,(function(e){c.has(e)||c.add(e)}))})),Array.from(c)}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(object){var e;return Array.isArray(object)?e=[]:(e={},be(object,(function(t,n){"__children"!==n&&(t&&"object"===se(t)&&!Array.isArray(t)?e[n]=ue(t):Array.isArray(t)?t.length&&"object"===se(t[0])&&!Array.isArray(t[0])?e[n]=[ue(t[0])]:e[n]=[]:e[n]=null)}))),e}function ce(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function he(e,t,n){var o=Array.isArray(n);return be(t,(function(t,r){(!1===o||n.includes(r))&&(e[r]=t)})),e}function fe(e,t){be(t,(function(n,o){t[o]&&"object"===se(t[o])?(e[o]||(Array.isArray(t[o])?e[o]=[]:"[object Date]"===Object.prototype.toString.call(t[o])?e[o]=t[o]:e[o]={}),fe(e[o],t[o])):e[o]=t[o]}))}function de(e){return"object"===se(e)?JSON.parse(JSON.stringify(e)):e}function pe(object){var e={};return be(object,(function(t,n){e[n]=t})),e}function ye(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return X(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),be(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:(o=n,r=t,l="_".concat(o),function(){var e;return void 0===this[l]&&(this[l]=(e=r,(Array.isArray(e)||ve(e))&&(e=de(e)),e)),this[l]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}var o,r,l}))})),e}function ge(e,t){return JSON.stringify(e)===JSON.stringify(t)}function ve(object){return"[object Object]"===Object.prototype.toString.call(object)}function me(object,e,t,n){n.value=t,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(object,e,n)}function be(object,e){for(var t in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,t))&&!1===e(object[t],t,object))break;return object}function we(object,e){var t=e.split("."),n=object;return be(t,(function(e){if(void 0===(n=n[e]))return n=void 0,!1})),n}function Ce(object,e,t){var n=e.split("."),o=object;n.forEach((function(e,r){r!==n.length-1?(Re(o,e)||(o[e]={}),o=o[e]):o[e]=t}))}function Se(object){if(!ve(object))return 0;return function e(t){var n=0;return ve(t)?be(t,(function(t,o){"__children"!==o&&(n+=e(t))})):n+=1,n}(object)}function ke(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",o="_".concat(n),r=(le(t={_touched:!1},o,e),le(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(r,n,{get:function(){return this[o]},set:function(e){this._touched=!0,this[o]=e},enumerable:!0,configurable:!0}),r}function Re(object,e){return Object.prototype.hasOwnProperty.call(object,e)}var Oe=function(e){var t={value:!1,test:function(n,o){t.value=e(n,o)}};return t},Ee={chrome:Oe((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:Oe((function(e){return/CriOS/.test(e)})),edge:Oe((function(e){return/Edge/.test(e)})),edgeWebKit:Oe((function(e){return/EdgiOS/.test(e)})),firefox:Oe((function(e){return/Firefox/.test(e)})),firefoxWebKit:Oe((function(e){return/FxiOS/.test(e)})),ie:Oe((function(e){return/Trident/.test(e)})),ie9:Oe((function(){return!!document.documentMode})),mobile:Oe((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:Oe((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},Te={mac:Oe((function(e){return/^Mac/.test(e)})),win:Oe((function(e){return/^Win/.test(e)})),linux:Oe((function(e){return/^Linux/.test(e)})),ios:Oe((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,o=e.vendor,r=void 0===o?navigator.vendor:o;be(Ee,(function(e){(0,e.test)(n,r)}))}function Me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;be(Te,(function(e){(0,e.test)(n)}))}function xe(){return Ee.chrome.value}function _e(){return Ee.chromeWebKit.value}function Pe(){return Ee.firefox.value}function Ie(){return Ee.firefoxWebKit.value}function He(){return Ee.safari.value}function De(){return Ee.edge.value}function Ne(){return Ee.edgeWebKit.value}function je(){return Ee.ie.value}function Le(){return Ee.ie9.value}function Be(){return Ee.ie.value||Ee.edge.value}function Ve(){return Ee.mobile.value}function Fe(){return Te.ios.value}function We(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Te.mac.value}function Ue(){return Te.win.value}function ze(){return Te.mac.value}function Ye(){return Te.linux.value}Ae(),Me();var Ge,Ke,$e,Xe,qe,Ze,Qe=n(660),Je=(n(206),n(659),n(481),n(525));function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var r=G(e,(function(e,t,o){return e+t.replace(/\r?\n\s*/g,"")+(n[o]?n[o]:"")}),"");return r.trim()}function tt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e){var t;switch(nt(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function it(e){return void 0!==e}function at(e){return void 0===e}function lt(e){return null===e||""===e||at(e)}function st(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var ut,ct,ht,ft="length",pt=function(e){return parseInt(e,16)},yt=function(e){return parseInt(e,10)},gt=function(e,s,t){return e.substr(s,t)},vt=function(e){return e.codePointAt(0)-65},mt=function(e){return"".concat(e).replace(/\-/g,"")},bt=!1,wt={invalid:function(){return et(Ge||(Ge=tt(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return et(Ke||(Ke=tt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return et($e||($e=tt(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},Ct={invalid:function(){return et(Xe||(Xe=tt(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return et(qe||(qe=tt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return et(Ze||(Ze=tt(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function St(e,element){var t,n,o=!lt(e),r="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),l="9.0.2",c="invalid",h="invalid",f=function(e){var t=[][ft],p=t;if(e[ft]!==vt("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=vt(i.shift());o;o=vt(i.shift()||"A"))--o<""[ft]?p|=(yt("".concat(yt(pt(n)+(pt(gt(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=gt(e,o,o?1===i[ft]?9:8:6);return p===t}(e=mt(e||""));if(o||r||f)if(f){var d=Je("28/07/2021","DD/MM/YYYY"),y=Math.floor(d.toDate().getTime()/864e5),v=pt(gt(mt(n=e),pt("12"),vt("F")))/(pt(gt(mt(n),vt("B"),~~![][ft]))||9);if(t=Je(864e5*(v+1),"x").format("MMMM DD, YYYY"),y>v){var m=Je().diff(d,"days");c=m<=1?"valid":"expired",h=m<=15?"valid":"expired"}else c="valid",h="valid"}else r?(c="non_commercial",h="valid"):(c="invalid",h="invalid");else c="missing",h="missing";("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(c="valid",h="valid"),bt||"valid"===c)||(wt[c]({keyValidityDate:t,hotVersion:l})&&console["non_commercial"===c?"info":"warn"](wt[c]({keyValidityDate:t,hotVersion:l})),bt=!0);if("valid"!==h&&element.parentNode&&Ct[h]({keyValidityDate:t,hotVersion:l})){var w=document.createElement("div");w.id="hot-display-license-info",w.innerHTML=Ct[h]({keyValidityDate:t,hotVersion:l}),element.parentNode.insertBefore(w,element.nextSibling)}}function kt(e){return e[0].toUpperCase()+e.substr(1)}function Rt(){for(var e=[],t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(var r=n.length;r;){var l=ot(n[r-=1]).toLowerCase();-1===e.indexOf(l)&&e.push(l)}return 1===e.length}function Ot(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function Et(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Tt(template){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}function At(e){return Mt("".concat(e),{ALLOWED_TAGS:[]})}function Mt(e,t){return Qe.sanitize(e,t)}function xt(e){return function(e){if(Array.isArray(e))return _t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _t(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Pt(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=-1,n=null,o=element;null!==o;){if(t===e){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return n}function It(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Ht(e){return It(e)&&e.parent}function Dt(e){return!!Object.getPrototypeOf(e.parent)}function Nt(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,r=n.DOCUMENT_FRAGMENT_NODE,l=element;null!=l&&l!==t;){var c=l,h=c.nodeType,f=c.nodeName;if(h===o&&(e.includes(f)||e.includes(l)))return l;var d=l,y=d.host;l=y&&h===r?y:l.parentNode}return null}function jt(element,e,t){for(var n=[],o=element;o&&(o=Nt(o,e,t))&&(!t||t.contains(o));)n.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var r=n.length;return r?n[r-1]:null}function Lt(e,t){var n=e.parentNode,o=[];for("string"==typeof t?o=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):o.push(t);null!==n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Bt(element){var i=0,e=element;if(e.previousSibling)for(;e=e.previousSibling;)i+=1;return i}function Vt(e,element,t){var n=t.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(element):null}function Ft(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(D()){var Wt=function(e){var element=e.createElement("div");return element.classList.add("test","test2"),element.classList.contains("test2")};ut=function(element,e){return void 0!==element.classList&&"string"==typeof e&&""!==e&&element.classList.contains(e)},ct=function(element,e){var t,n=element.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=Ft(o)).length>0)if(Wt(n))(t=element.classList).add.apply(t,xt(o));else for(var r=0;o&&o[r];)element.classList.add(o[r]),r+=1},ht=function(element,e){var t,n=element.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=Ft(o)).length>0)if(Wt(n))(t=element.classList).remove.apply(t,xt(o));else for(var r=0;o&&o[r];)element.classList.remove(o[r]),r+=1}}else{var Ut=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};ut=function(element,e){return void 0!==element.className&&Ut(e).test(element.className)},ct=function(element,e){var t=element.className,n=e;if("string"==typeof n&&(n=n.split(" ")),n=Ft(n),""===t)t=n.join(" ");else for(var o=0;o<n.length;o++)n[o]&&!Ut(n[o]).test(t)&&(t+=" ".concat(n[o]));element.className=t},ht=function(element,e){var t=0,n=element.className,o=e;for("string"==typeof o&&(o=o.split(" ")),o=Ft(o);o&&o[t];)n=n.replace(Ut(o[t])," ").trim(),t+=1;element.className!==n&&(element.className=n)}}function zt(element,e){return ut(element,e)}function Yt(element,e){ct(element,e)}function Gt(element,e){ht(element,e)}function Kt(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1)for(var e=element.childNodes,i=e.length-1;i>=0;i--)Kt(e[i])}function $t(element){for(var e;e=element.lastChild;)element.removeChild(e)}var Xt,qt=/(<(.*)>|&(.*);)/;function Zt(element,content){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];qt.test(content)?element.innerHTML=e?Mt(content):content:Qt(element,content)}function Qt(element,content){var e=element.firstChild;e&&3===e.nodeType&&null===e.nextSibling?N?e.textContent=content:e.data=content:($t(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function Jt(element){for(var e=element.ownerDocument.documentElement,t=element;t!==e;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return Jt(t.host.impl);if(t.host)return Jt(t.host);throw new Error("Lost in Web Components world")}return!1}if(t.style&&"none"===t.style.display)return!1;t=t.parentNode}return!0}function en(element){var e,t,n,o,r=element.ownerDocument,l=r.defaultView,c=r.documentElement,h=element;if(V()&&h.firstChild&&"CAPTION"===h.firstChild.nodeName)return{top:(o=h.getBoundingClientRect()).top+(l.pageYOffset||c.scrollTop)-(c.clientTop||0),left:o.left+(l.pageXOffset||c.scrollLeft)-(c.clientLeft||0)};for(e=h.offsetLeft,t=h.offsetTop,n=h;(h=h.offsetParent)&&h!==r.body;)e+=h.offsetLeft,t+=h.offsetTop,n=h;return n&&"fixed"===n.style.position&&(e+=l.pageXOffset||c.scrollLeft,t+=l.pageYOffset||c.scrollTop),{left:e,top:t}}function tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function nn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function on(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?tn(e):element.scrollTop}function rn(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?nn(e):element.scrollLeft}function an(element){var e=element.ownerDocument,t=e?e.defaultView:void 0;e||(t=(e=element.document?element.document:element).defaultView);for(var n=["auto","scroll"],o=j(),r=element.parentNode;r&&r.style&&e.body!==r;){var l=r.style,c=l.overflow,h=l.overflowX,f=l.overflowY;if([c,h,f].includes("scroll"))return r;if(o){var d=t.getComputedStyle(r);if(c=d.overflow,h=d.overflowX,f=d.overflowY,n.includes(c)||n.includes(h)||n.includes(f))return r}if(r.clientHeight<=r.scrollHeight+1&&(n.includes(f)||n.includes(c)))return r;if(r.clientWidth<=r.scrollWidth+1&&(n.includes(h)||n.includes(c)))return r;r=r.parentNode}return t}function ln(base){for(var e=base.ownerDocument,t=e.defaultView,n=base.parentNode;n&&n.style&&e.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var o=cn(n,t),r=["scroll","hidden","auto"],l=o.getPropertyValue("overflow"),c=o.getPropertyValue("overflow-y"),h=o.getPropertyValue("overflow-x");if(r.includes(l)||r.includes(c)||r.includes(h))return n;n=n.parentNode}return t}function sn(element,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(element){if(element===t)return"width"===e?"".concat(t.innerWidth,"px"):"height"===e?"".concat(t.innerHeight,"px"):void 0;var n=element.style[e];if(""!==n&&void 0!==n)return n;var o=cn(element,t);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}}function un(element,e){var t=e.selectorText,n=!1;return e.type===CSSRule.STYLE_RULE&&t&&(element.msMatchesSelector?n=element.msMatchesSelector(t):element.matches&&(n=element.matches(t))),n}function cn(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element.currentStyle||e.getComputedStyle(element)}function hn(element){return Math.ceil(element.getBoundingClientRect().width)}function fn(element){return V()&&element.firstChild&&"CAPTION"===element.firstChild.nodeName?element.offsetHeight+element.firstChild.offsetHeight:element.offsetHeight}function dn(element){return element.clientHeight||element.innerHeight}function pn(element){return element.clientWidth||element.innerWidth}function yn(element,e,t){element.addEventListener(e,t,!1)}function gn(element,e,t){element.removeEventListener(e,t,!1)}function vn(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var o=e.createTextRange(),r=o.duplicate();return o.moveToBookmark(n.getBookmark()),r.setEndPoint("EndToStart",o),r.text.length}return 0}function mn(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function bn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,text="";return e.getSelection?text=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(text=t.selection.createRange().text),text}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Cn(element,e,t){if(void 0===t&&(t=e),element.setSelectionRange){element.focus();try{element.setSelectionRange(e,t)}catch(r){var n=element.parentNode,o=n.style.display;n.style.display="block",element.setSelectionRange(e,t),n.style.display=o}}}function Sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var o=t.offsetWidth;n.style.overflow="scroll";var r=t.offsetWidth;return o===r&&(r=n.clientWidth),(e.body||e.documentElement).removeChild(n),o-r}function kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Xt&&(Xt=Sn(e)),Xt}function Rn(element){return element.offsetWidth!==element.clientWidth}function On(element){return element.offsetHeight!==element.clientHeight}function En(e,t,n){Le()?(e.style.top=n,e.style.left=t):He()?(e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"),e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)")):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function Tn(element){var e;return element.style.transform&&""!==(e=element.style.transform)?["transform",e]:element.style["-webkit-transform"]&&""!==(e=element.style["-webkit-transform"])?["-webkit-transform",e]:-1}function An(element){element.style.transform&&""!==element.style.transform?element.style.transform="":element.style["-webkit-transform"]&&""!==element.style["-webkit-transform"]&&(element.style["-webkit-transform"]="")}function Mn(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function xn(element){return Mn(element)&&!1===element.hasAttribute("data-hot-input")}function _n(element){xn(element.ownerDocument.activeElement)||element.select()}function Pn(element){return!element.parentNode}function In(e){return"function"==typeof e}function Hn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,o={lastCallThrottled:!0},r=null;function l(){for(var l=this,c=arguments.length,h=new Array(c),f=0;f<c;f++)h[f]=arguments[f];var d=Date.now(),y=!1;o.lastCallThrottled=!0,n||(n=d,y=!0);var v=t-(d-n);return y?(o.lastCallThrottled=!1,e.apply(this,h)):(r&&clearTimeout(r),r=setTimeout((function(){o.lastCallThrottled=!1,e.apply(l,h),n=0,r=void 0}),v)),o}return l}function Dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=Hn(e,t),r=n;function l(){r=n}function c(){for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return r?(r-=1,e.apply(this,n)):o.apply(this,n)}return c.clearHits=l,c}function Nn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;function r(){for(var r=this,l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return o&&clearTimeout(o),o=setTimeout((function(){t=e.apply(r,c)}),n),t}return r}function jn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t[0],r=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return G(r,(function(e,t){return t(e)}),o.apply(this,t))}}function Ln(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(){for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return e.apply(this,n.concat(o))}}function Bn(e){var t=e.length;return function n(o){return function(){for(var r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];var h=o.concat(l);return h.length>=t?e.apply(this,h):n(h)}}([])}function Vn(e){var t=e.length;return function n(o){return function(){for(var r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];var h=o.concat(l.reverse());return h.length>=t?e.apply(this,h):n(h)}}([])}n(461);function Fn(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=null,this.col=null,void 0!==t&&void 0!==n&&(this.row=t,this.col=n)}var t,n,o;return t=e,(n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col)}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&Fn(t.prototype,n),o&&Fn(t,o),e}(),Un={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Pe()?182:174,AUDIO_MUTE:Pe()?181:173,AUDIO_UP:Pe()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},zn=[Un.ALT,Un.ARROW_DOWN,Un.ARROW_LEFT,Un.ARROW_RIGHT,Un.ARROW_UP,Un.AUDIO_DOWN,Un.AUDIO_MUTE,Un.AUDIO_UP,Un.BACKSPACE,Un.CAPS_LOCK,Un.DELETE,Un.END,Un.ENTER,Un.ESCAPE,Un.F1,Un.F2,Un.F3,Un.F4,Un.F5,Un.F6,Un.F7,Un.F8,Un.F9,Un.F10,Un.F11,Un.F12,Un.F13,Un.F14,Un.F15,Un.F16,Un.F17,Un.F18,Un.F19,Un.HOME,Un.INSERT,Un.MEDIA_NEXT,Un.MEDIA_PLAY_PAUSE,Un.MEDIA_PREV,Un.MEDIA_STOP,Un.NULL,Un.NUM_LOCK,Un.PAGE_DOWN,Un.PAGE_UP,Un.PAUSE,Un.SCROLL_LOCK,Un.SHIFT,Un.TAB];function Yn(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Gn(e){return zn.includes(e)}function Kn(e){var t=[];return ze()?t.push(Un.COMMAND_LEFT,Un.COMMAND_RIGHT,Un.COMMAND_FIREFOX):t.push(Un.CONTROL),t.includes(e)}function $n(e){return[Un.CONTROL,Un.COMMAND_LEFT,Un.COMMAND_RIGHT,Un.COMMAND_FIREFOX].includes(e)}function Xn(e,t){var n=t.split("|"),o=!1;return X(n,(function(t){if(e===Un[t])return o=!0,!1})),o}function qn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Zn(e){return!1===e.isImmediatePropagationEnabled}function Qn(e){return 2===e.button}function Jn(e){return 0===e.button}var eo;n(436);function to(){var e;it(console)&&(e=console).warn.apply(e,arguments)}function no(){var e;it(console)&&(e=console).error.apply(e,arguments)}function oo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ro,io,ao=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],lo=et(eo||(ro=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(io=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(io=ro.slice(0)),eo=Object.freeze(Object.defineProperties(ro,{raw:{value:Object.freeze(io)}})))),so=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),uo=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),co=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalBucket=this.createEmptyBucket()}var t,n,o;return t=e,o=[{key:"getSingleton",value:function(){return ho}}],(n=[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return X(ao,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))X(t,(function(t){return n.add(e,t,o)}));else{so.has(e)&&to(Tt(lo,{hookName:e,removedInVersion:so.get(e)})),uo.has(e)&&to(uo.get(e));var r=this.getBucket(o);if(void 0===r[e]&&(this.register(e),r[e]=[]),t.skip=!1,-1===r[e].indexOf(t)){var l=!1;t.initialHook&&X(r[e],(function(n,i){if(n.initialHook)return r[e][i]=t,l=!0,!1})),l||r[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?X(t,(function(t){return n.once(e,t,o)})):(t.runOnce=!0,this.add(e,t,o))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this.getBucket(n);return void 0!==o[e]&&o[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,o,r,l,c,h){var f=this.globalBucket[t],d=f?f.length:0,y=0;if(d)for(;y<d;)if(f[y]&&!f[y].skip){var v=f[y].call(e,n,o,r,l,c,h);void 0!==v&&(n=v),f[y]&&f[y].runOnce&&this.remove(t,f[y]),y+=1}else y+=1;var m=this.getBucket(e)[t],w=m?m.length:0,C=0;if(w)for(;C<w;)if(m[C]&&!m[C].skip){var S=m[C].call(e,n,o,r,l,c,h);void 0!==S&&(n=S),m[C]&&m[C].runOnce&&this.remove(t,m[C],e),C+=1}else C+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;be(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||ao.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&ao.splice(ao.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return uo.has(e)||so.has(e)}},{key:"isRegistered",value:function(e){return ao.indexOf(e)>=0}},{key:"getRegistered",value:function(){return ao}}])&&oo(t.prototype,n),o&&oo(t,o),e}(),ho=new co;var fo=co;function po(e){return function(e){if(Array.isArray(e))return yo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yo(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var go=new Map;function vo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";go.has(e)||go.set(e,new Map);var t=go.get(e);function n(e,n){t.set(e,n)}function o(e){return t.get(e)}function r(e){return t.has(e)}function l(){return po(t.keys())}function c(){return po(t.values())}return{register:n,getItem:o,hasItem:r,getNames:l,getValues:c}}var mo=new WeakMap,bo=vo("editors"),wo=bo.register,Co=bo.getItem,So=bo.hasItem,ko=bo.getNames;bo.getValues;function Ro(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},fo.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Oo(e,t){var n;if("function"==typeof e)mo.get(e)||To(null,e),n=mo.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=Co(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function Eo(e){if(!So(e))throw Error('No registered editor found under "'.concat(e,'" name'));return Co(e).getConstructor()}function To(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new Ro(t);"string"==typeof e&&wo(e,n),mo.set(t,n)}function Ao(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xo=0;function _o(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),qn(this)},e}var Po=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Ao(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}var t,n,o;return t=e,(n=[{key:"addEventListener",value:function(element,e,t){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function r(e){t.call(this,_o(e))}return"boolean"==typeof o||W()||(o=!1),this.context.eventListeners.push({element:element,event:e,callback:t,callbackProxy:r,options:o,eventManager:this}),element.addEventListener(e,r,o),xo+=1,function(){n.removeEventListener(element,e,t)}}},{key:"removeEventListener",value:function(element,e,t){for(var n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;r;)if(r-=1,(n=this.context.eventListeners[r]).event===e&&n.element===element){if(t&&t!==n.callback)continue;if(o&&n.eventManager!==this)continue;this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),xo-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];n&&this.removeEventListener(n.element,n.event,n.callback,e)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(element,e){var t=element.document,n=element;t||(n=(t=element.ownerDocument?element.ownerDocument:element).defaultView);var o,r={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};t.createEvent?(o=t.createEvent("MouseEvents")).initMouseEvent(e,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||t.body.parentNode):o=t.createEventObject(),element.dispatchEvent?element.dispatchEvent(o):element.fireEvent("on".concat(e),o)}}])&&Mo(t.prototype,n),o&&Mo(t,o),e}();n(430),n(77);var Io={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;X(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;be(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};me(Io,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var Ho=Io;function Do(e){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function No(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jo(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Lo(e,p){return(Lo=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Fo(e);if(t){var r=Fo(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Vo(this,n)}}function Vo(e,t){return!t||"object"!==Do(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fo(e){return(Fo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var zo=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Yo=function(){function e(t){Wo(this,e),this.hot=t,this.instance=t,this.state=zo.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var t,n,o;return t=e,o=[{key:"EDITOR_TYPE",get:function(){return"base"}}],(n=[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,col,t,td,n,o){this.TD=td,this.row=e,this.col=col,this.prop=t,this.originalValue=n,this.cellProperties=o,this.state=zo.VIRGIN}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}(n,e);var t=Bo(n);function n(){return Wo(this,n),t.apply(this,arguments)}return n}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,o,r,l;if(t){var c=this.hot.getSelectedLast();n=Math.max(Math.min(c[0],c[2]),0),o=Math.max(Math.min(c[1],c[3]),0),r=Math.max(c[0],c[2]),l=Math.max(c[1],c[3])}else{var h=[this.row,this.col,null,null];n=h[0],o=h[1],r=h[2],l=h[3]}var f=this.hot.runHooks("modifyGetCellCoords",n,o);if(Array.isArray(f)){var d=No(f,2);n=d[0],o=d[1]}this.hot.populateFromArray(n,o,e,r,l,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===zo.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(new Wn(o,r)),this.state=zo.EDITING,this.isInFullEditMode()){var l="string"==typeof e?e:ot(this.originalValue);this.setValue(l)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var o,r=this;if(n){var l=this._closeCallback;this._closeCallback=function(e){l&&l(e),n(e),r.hot.view.render()}}if(!this.isWaiting())if(this.state!==zo.VIRGIN){if(this.state===zo.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var c=this.getValue();o=this.hot.getSettings().trimWhitespace?[["string"==typeof c?String.prototype.trim.call(c||""):c]]:[[c]],this.state=zo.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){r.state=zo.FINISHED,r.discardEditor(e)})):(this.state=zo.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){r._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=zo.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===zo.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=zo.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=zo.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===zo.WAITING}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(section="left"),section}}])&&Uo(t.prototype,n),o&&Uo(t,o),e}();function Go(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Ko(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ko(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ko(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function $o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ye(Yo,Ho);var Xo=function(){function e(t,n,o){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.selection=o,this.eventManager=new Po(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",(function(e){return r.onAfterDocumentKeyDown(e)}));for(var l=this.instance.rootWindow;l;)this.eventManager.addEventListener(l.document.documentElement,"keydown",(function(e){r.destroyed||r.instance.runHooks("afterDocumentKeyDown",e)})),l=Ht(l);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!r.destroyed&&r.activeEditor&&!r.activeEditor.isOpened()&&r.instance.isListening()&&r.openEditor("",e)})),this.instance.view.wt.update("onCellDblClick",(function(e,t,n){return r.onCellDblClick(e,t,n)}))}var t,n,o;return t=e,(n=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,n=t.row,col=t.col,o=this.instance.runHooks("modifyGetCellCoords",n,col),r=n,l=col;if(Array.isArray(o)){var c=Go(o,2);r=c[0],l=c[1]}this.cellProperties=this.instance.getCellMeta(r,l);var h=this.instance.rootDocument.activeElement;if(h&&h.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var f=this.instance.getCellEditor(this.cellProperties),td=this.instance.getCell(n,col,!0);if(f&&td){var d=this.instance.colToProp(l),y=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(r),l);this.activeEditor=Oo(f,this.instance),this.activeEditor.prepare(n,col,d,td,y,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"moveSelectionUp",value:function(e){e?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(e){e?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(e){e?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(e){e?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(e){if(this.instance.isListening()){this.instance.runHooks("beforeKeyDown",e);var t=e.keyCode;if(!this.destroyed&&229!==t&&!Zn(e)&&(this.lastKeyCode=t,this.selection.isSelected())){var n=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Gn(t)||$n(t)||n||this.isEditorOpened()){var o,r=e.shiftKey,l=r?this.selection.setRangeEnd:this.selection.setRangeStart;switch(t){case Un.A:!this.isEditorOpened()&&n&&(this.instance.selectAll(),e.preventDefault(),e.stopPropagation());break;case Un.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionUp(r),e.preventDefault(),e.stopPropagation();break;case Un.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionDown(r),e.preventDefault(),e.stopPropagation();break;case Un.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionRight(r),e.preventDefault(),e.stopPropagation();break;case Un.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(n),this.moveSelectionLeft(r),e.preventDefault(),e.stopPropagation();break;case Un.TAB:o="function"==typeof this.tableMeta.tabMoves?this.tableMeta.tabMoves(e):this.tableMeta.tabMoves,r?this.selection.transformStart(-o.row,-o.col):this.selection.transformStart(o.row,o.col,!0),e.preventDefault(),e.stopPropagation();break;case Un.BACKSPACE:case Un.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),e.preventDefault();break;case Un.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e),e.preventDefault();break;case Un.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==zo.WAITING&&this.closeEditorAndSaveChanges(n),this.moveSelectionAfterEnter(r)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,e)):this.moveSelectionAfterEnter(r),e.preventDefault(),qn(e);break;case Un.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(n),this.activeEditor.focus()),e.preventDefault();break;case Un.HOME:e.ctrlKey||e.metaKey?l.call(this.selection,new Wn(this.instance.rowIndexMapper.getFirstNotHiddenIndex(0,1),this.selection.selectedRange.current().from.col)):l.call(this.selection,new Wn(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(0,1))),e.preventDefault(),e.stopPropagation();break;case Un.END:e.ctrlKey||e.metaKey?l.call(this.selection,new Wn(this.instance.rowIndexMapper.getFirstNotHiddenIndex(this.instance.countRows()-1,-1),this.selection.selectedRange.current().from.col)):l.call(this.selection,new Wn(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(this.instance.countCols()-1,-1))),e.preventDefault(),e.stopPropagation();break;case Un.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break;case Un.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation()}}else this.openEditor("",e)}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&$o(t.prototype,n),o&&$o(t,o),e}(),qo=new WeakMap;Xo.getInstance=function(e,t,n){var o=qo.get(e);return o||(o=new Xo(e,t,n),qo.set(e,o)),o};var Zo=Xo;n(58),n(9),n(125),n(666),n(558),n(211);function Qo(e){return function(e){if(Array.isArray(e))return Jo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jo(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var er={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},nr=new RegExp(Object.keys(er).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function or(element){return"TABLE"===(element&&element.nodeName||"")}function rr(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),o=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],data=e.getData.apply(e,o),r=data.length,l=r>0?data[0].length:0,c=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],f=["<tbody>","</tbody>"],d=n?1:0,y=t?1:0,v=0;v<r;v+=1){for(var m=t&&0===v,w=[],C=0;C<l;C+=1){var S=!m&&n&&0===C,k="";if(m)k="<th>".concat(e.getColHeader(C-d),"</th>");else if(S)k="<th>".concat(e.getRowHeader(v-y),"</th>");else{var R=data[v][C],O=e.getCellMeta(v-y,C-d),E=O.hidden,T=O.rowspan,A=O.colspan;if(!E){var M=[];if(T&&M.push('rowspan="'.concat(T,'"')),A&&M.push('colspan="'.concat(A,'"')),lt(R))k="<td ".concat(M.join(" "),"></td>");else{var x=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");k="<td ".concat(M.join(" "),">").concat(x,"</td>")}}}w.push(k)}var _=["<tr>"].concat(w,["</tr>"]).join("");m?h.splice(1,0,_):f.splice(-1,0,_)}return c.splice(1,0,h.join(""),f.join("")),c.join("")}function ir(input){for(var e=input.length,t=["<table>"],n=0;n<e;n+=1){var o=input[n],r=o.length,l=[];0===n&&t.push("<tbody>");for(var c=0;c<r;c+=1){var h=o[c],f=lt(h)?"":h.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(f,"</td>"))}t.push.apply(t,["<tr>"].concat(l,["</tr>"])),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function ar(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,t={},n=e.createDocumentFragment(),o=e.createElement("div");n.appendChild(o);var r=element;if("string"==typeof r){var l=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));o.insertAdjacentHTML("afterbegin","".concat(l)),r=o.querySelector("table")}if(r&&or(r)){var c=o.querySelector('meta[name$="enerator"]'),h=null!==r.querySelector("tbody th"),f=r.querySelector("tr"),d=f?Array.from(f.cells).reduce((function(e,t){return e+t.colSpan}),0)-(h?1:0):0,y=r.tFoot&&Array.from(r.tFoot.rows)||[],v=[],m=!1,w=0,C=0;if(r.tHead){var S=Array.from(r.tHead.rows).filter((function(tr){var e=null!==tr.querySelector("td");return e&&v.push(tr),!e}));m=(w=S.length)>0,w>1?t.nestedHeaders=Array.from(S).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,header,t){if(h&&0===t)return e;var n=header.colSpan,o=header.innerHTML,r=n>1?{label:o,colspan:n}:o;return e.push(r),e}),[]);return e.push(n),e}),[]):m&&(t.colHeaders=Array.from(S[0].children).reduce((function(e,header,t){return h&&0===t||e.push(header.innerHTML),e}),[]))}v.length&&(t.fixedRowsTop=v.length),y.length&&(t.fixedRowsBottom=y.length);var k=[].concat(v,Qo(Array.from(r.tBodies).reduce((function(e,section){return e.push.apply(e,Qo(Array.from(section.rows))),e}),[])),Qo(y));C=k.length;for(var R=new Array(C),O=0;O<C;O++)R[O]=new Array(d);for(var E=[],T=[],A=0;A<C;A++)for(var tr=k[A],M=Array.from(tr.cells),x=M.length,_=0;_<x;_++){var P=M[_],I=P.nodeName,H=P.innerHTML,D=P.rowSpan,N=P.colSpan,col=R[A].findIndex((function(e){return void 0===e}));if("TD"===I){if(D>1||N>1){for(var j=A;j<A+D;j++)if(j<C)for(var L=col;L<col+N;L++)R[j][L]=null;var B=P.getAttribute("style"),V=B&&B.includes("mso-ignore:colspan");V||E.push({col:col,row:A,rowspan:D,colspan:N})}var F="";F=c&&/excel/gi.test(c.content)?H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):H.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),R[A][col]=F.replace(nr,(function(e){return er[e]}))}else T.push(H)}return E.length&&(t.mergeCells=E),T.length&&(t.rowHeaders=T),R.length&&(t.data=R),t}}function lr(e){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e){var t=lr(e);return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function ur(e,t,n){var o=-1;for("function"==typeof t?(n=t,t=e):o=e-1;++o<=t&&!1!==n(o););}function cr(e,t,n){var o=e+1;for("function"==typeof t&&(n=t,t=0);--o>=t&&!1!==n(o););}function fr(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100,10)}function dr(e){return function(e){if(Array.isArray(e))return gr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||yr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pr(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||yr(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){if(e){if("string"==typeof e)return gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gr(e,t):void 0}}function gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var vr="asc",mr=new Map([[vr,[-1,1]],["desc",[1,-1]]]),wr=function(e){return"The priority '".concat(e,"' is already declared in a map.")},Cr=function(e){return"The priority '".concat(e,"' is not a number.")};n(115);function Sr(e){return function(e){if(Array.isArray(e))return Or(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Rr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||Rr(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(e,t){if(e){if("string"==typeof e)return Or(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(e,t):void 0}}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Er=function(e){return"The id '".concat(e,"' is already declared in a map.")};function Tr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function o(e,o){if(f(e))throw new Error(t(e));n.set(e,o)}function r(){n.clear()}function l(e){var t=h().find((function(t){var n=kr(t,2),o=n[0],element=n[1];return e===element&&o}))||[null];return kr(t,1)[0]}function c(e){return n.get(e)}function h(){return Sr(n)}function f(e){return n.has(e)}return t=In(t)?t:Er,{addItem:o,clear:r,getId:l,getItem:c,getItems:h,hasItem:f}}function Ar(e){return function(e){if(Array.isArray(e))return Mr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var xr=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function _r(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||Ir(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(e){return function(e){if(Array.isArray(e))return Hr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ir(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){if(e){if("string"==typeof e)return Hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hr(e,t):void 0}}function Hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Dr=function(e){return'There is already registered "'.concat(e,'" plugin.')},Nr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,o=new Map;function r(e,r){if(!sr(e))throw new Error(n(e));if(o.has(e))throw new Error(t(e));o.set(e,r)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vr,t=mr.get(e)||mr.get(vr),n=pr(t,2),r=n[0],l=n[1];return dr(o).sort((function(a,b){return a[0]<b[0]?r:l})).map((function(e){return e[1]}))}return t=In(t)?t:wr,n=In(n)?n:Cr,{addItem:r,getItems:l}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function o(e){if(n.has(e))throw new Error(t(e));n.add(e)}function r(){return Ar(n)}return t=In(t)?t:xr,{addItem:o,getItems:r}}({errorItemExists:Dr}),Lr=Tr({errorIdExists:Dr});function Br(){return[].concat(Pr(Nr.getItems()),Pr(jr.getItems()))}function Vr(e){var t=kt(e);return Lr.getItem(t)}function Fr(e,t,n){var o=_r(function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),3);e=o[0],t=o[1],n=o[2],void 0===Vr(e)&&function(e,t,n){var o=kt(e);if(Lr.hasItem(o))throw new Error(Dr(o));void 0===n?jr.addItem(o):Nr.addItem(n,o);Lr.addItem(o,t)}(e,t,n)}var Wr=vo("renderers"),Ur=Wr.register,zr=Wr.getItem,Yr=Wr.hasItem,Gr=Wr.getNames;Wr.getValues;function Kr(e){if("function"==typeof e)return e;if(!Yr(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return zr(e)}function $r(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),Ur(e,t)}var Xr=vo("validators"),qr=Xr.register,Zr=Xr.getItem,Qr=Xr.hasItem,Jr=Xr.getNames;Xr.getValues;function ei(e){if("function"==typeof e)return e;if(!Qr(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Zr(e)}function ti(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),qr(e,t)}function ni(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var oi=new WeakMap,ri=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Po(t),oi.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n,o;return t=e,(n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",(function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout((function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))}),200)}))};Ve()?t():(B()&&t(),e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=oi.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var o=[n.row,t.selectedCellBeforeTouchEnd.from.row],r=o[0],l=o[1],c=[n.col,t.selectedCellBeforeTouchEnd.from.col];return r===l&&c[0]===c[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=jt(e,["TD","TH"],this.instance.wtTable.TABLE);return n?(t.coords=this.instance.wtTable.getCoords(n),t.TD=n):zt(e,"wtBorder")&&zt(e,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):zt(e,"wtBorder")&&zt(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=oi.get(this),n=this.instance.rootDocument.activeElement,o=Ln(Pt,e.target),r=e.target;if(r!==n&&o(0)!==n&&o(1)!==n){var l=this.parentCell(r);zt(r,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,r):l.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,l.coords,l.TD,this.instance),(0===e.button||this.instance.touchApplied)&&l.TD&&(t.dblClickOrigin[0]=l.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.instance.getSetting("onCellContextMenu",e,t.coords,t.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(this.instance.hasSetting("onCellMouseOver")){var table=this.instance.wtTable.TABLE,td=jt(e.target,["TD","TH"],table),t=this.instance.cloneSource||this.instance;td&&td!==t.lastMouseOver&&Lt(td,table)&&(t.lastMouseOver=td,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(td),td,this.instance))}}},{key:"onMouseOut",value:function(e){if(this.instance.hasSetting("onCellMouseOut")){var table=this.instance.wtTable.TABLE,t=jt(e.target,["TD","TH"],table),n=jt(e.relatedTarget,["TD","TH"],table);t&&t!==n&&Lt(t,table)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(t),t,this.instance)}}},{key:"onMouseUp",value:function(e){var t=oi.get(this),n=this.parentCell(e.target);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,this.instance),(0===e.button||this.instance.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(zt(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",e,n.coords,n.TD,this.instance),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){oi.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,o=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,r=it(o)&&o.row>=0&&o.col>=0;e.cancelable&&r&&this.instance.getSetting("isDataViewInstance")&&(Fe()&&(_e()||Ie())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()),this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=oi.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}])&&ni(t.prototype,n),o&&ni(t,o),e}(),ii="top",ai="bottom",si="left",ui="top_left_corner",ci="bottom_left_corner",hi=[ii,ai,si,ui,ci],fi={};function di(e){var t=e.OVERLAY_NAME;if(-1===hi.indexOf(t))throw new Error("Unsupported overlay (".concat(t,")."));yi(t)||(fi[t]=e)}function pi(e,t){return new fi[e](t)}function yi(e){return void 0!==fi[e]}function gi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var vi=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=o}var t,n,o;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&gi(t.prototype,n),o&&gi(t,o),e}();function mi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bi=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=o}var t,n,o;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&mi(t.prototype,n),o&&mi(t,o),e}();function wi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ci=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n,o;return t=e,(n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}])&&wi(t.prototype,n),o&&wi(t,o),e}();function Si(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ki=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=new Ci,this.workingSpace=0,this.sharedSize=null}var t,n,o;return t=e,(n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof Ci}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}])&&Si(t.prototype,n),o&&Si(t,o),e}();function Ri(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Oi=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new ki,this.childNodeType=o.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n,o;return t=e,(n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var element=e.firstElementChild;element;){if(element.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;element=element.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),o=t.getViewSize().nextSize,r=this.getRenderedChildCount();r<o;){var l=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(l):e.insertBefore(l,e.firstChild),r+=1}for(var c=n&&t.isPlaceOn(1);r>o;)e.removeChild(c?e.firstChild:e.lastChild),r-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var o=e.childNodes[n];if(o.tagName!==this.childNodeType){var r=this.nodesPool();e.replaceChild(r,o),o=r}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}])&&Ri(t.prototype,n),o&&Ri(t,o),e}();function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ti(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ai(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mi(e,p){return(Mi=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function xi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Pi(e);if(t){var r=Pi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return _i(this,n)}}function _i(e,t){return!t||"object"!==Ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pi(e){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ii=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mi(e,t)}(l,e);var t,n,o,r=xi(l);function l(){return Ti(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}])&&Ai(t.prototype,n),o&&Ai(t,o),l}(Oi);function Hi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Di=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}var t,n,o;return t=e,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&Hi(t.prototype,n),o&&Hi(t,o),e}();function Ni(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ji=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new Di(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}var t,n,o;return t=e,(n=[{key:"setTable",value:function(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&Ni(t.prototype,n),o&&Ni(t,o),e}();function Li(e){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vi(e,p){return(Vi=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Fi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ui(e);if(t){var r=Ui(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Wi(this,n)}}function Wi(e,t){return!t||"object"!==Li(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ui(e){return(Ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vi(e,t)}(l,e);var t,n,o,r=Fi(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=r.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=l,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Ii(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,o=e.rowHeadersCount,r=e.rows,l=e.cells,c=0;c<t;c++){var h=this.table.renderedRowToSource(c),f=r.getRenderedNode(c);this.sourceRowIndex=h;var d=this.obtainOrderView(f),y=l.obtainOrderView(f);d.appendView(y).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<o;v++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),n[v](h,m,v)}d.end()}}}])&&Bi(t.prototype,n),o&&Bi(t,o),l}(ji);function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ki(e,p){return(Ki=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function $i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=qi(e);if(t){var r=qi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Xi(this,n)}}function Xi(e,t){return!t||"object"!==Yi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qi(e){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(l,e);var t,n,o,r=$i(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.call(this,null,e)}return t=l,(n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,o=this.rootNode.firstChild;if(t){for(var r=this.table.columnsToRender+n,i=0,l=t;i<l;i++){for((o=this.rootNode.childNodes[i])||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<r;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>r;)o.removeChild(o.lastChild),this.renderedNodes-=1}var c=this.rootNode.childNodes.length;if(c>t)for(var h=t;h<c;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&$t(o)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,o=n.columnHeaderFunctions,r=n.columnsToRender,l=n.rowHeadersCount,c=this.rootNode.childNodes[t],h=-1*l;h<r;h+=1){var f=this.table.renderedColumnToSource(h),d=c.childNodes[h+l];d.className="",d.removeAttribute("style"),o[t](f,d,t)}}}])&&Gi(t.prototype,n),o&&Gi(t,o),l}(ji);function Qi(e){return(Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ji(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ea(e,p){return(ea=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=oa(e);if(t){var r=oa(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return na(this,n)}}function na(e,t){return!t||"object"!==Qi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oa(e){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ra,ia=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ea(e,t)}(l,e);var t,n,o,r=ta(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.call(this,null,e)}return t=l,(n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,o=0;o<n;o++){var r=this.table.renderedColumnToSource(o),l=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[o].style.width="".concat(l,"px")}for(var c=0;c<t;c++){var h=this.table.renderedColumnToSource(c),f=this.table.columnUtils.getStretchedColumnWidth(h);this.rootNode.childNodes[c+n].style.width="".concat(f,"px")}var d=this.rootNode.firstChild;d&&Yt(d,"rowHeader")}}])&&Ji(t.prototype,n),o&&Ji(t,o),l}(ji);function aa(e){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function la(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sa(e,p){return(sa=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ha(e);if(t){var r=ha(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ca(this,n)}}function ca(e,t){return!t||"object"!==aa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ha(e){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fa=!1,da=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(l,e);var t,n,o,r=ua(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,"TR",e)).orderView=new Oi(e,(function(e){return t.nodesPool.obtain(e)}),t.nodeType),t}return t=l,(n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!fa&&e>1e3&&(fa=!0,to(et(ra||(ra=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}])&&la(t.prototype,n),o&&la(t,o),l}(ji);function pa(e){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ya(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ga(e,p){return(ga=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ba(e);if(t){var r=ba(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ma(this,n)}}function ma(e,t){return!t||"object"!==pa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ba(e){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ga(e,t)}(l,e);var t,n,o,r=va(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=r.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=l,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Ii(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,o=e.rows,r=e.rowHeaders,l=0;l<t;l++){var c=this.table.renderedRowToSource(l),h=o.getRenderedNode(l);this.sourceRowIndex=c;var f=this.obtainOrderView(h),d=r.obtainOrderView(h);f.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<n;y++){f.render();var v=f.getCurrentNode(),m=this.table.renderedColumnToSource(y);zt(v,"hide")||(v.className=""),v.removeAttribute("style"),this.table.cellRenderer(c,m,v)}f.end()}}}])&&ya(t.prototype,n),o&&ya(t,o),l}(ji);function Ca(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ka=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.cellRenderer;Ca(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=o}var t,n,o;return t=e,(n=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,o=e.colGroup,r=e.rows,l=e.cells;t.setTable(this),n.setTable(this),o.setTable(this),r.setTable(this),l.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=o,this.rows=r,this.cells=l}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var o=t.getRenderedNode(n);if(o.firstChild){var r=this.renderedRowToSource(n),l=this.rowUtils.getHeight(r);o.firstChild.style.height=l?"".concat(l-1,"px"):""}}}}])&&Sa(t.prototype,n),o&&Sa(t,o),e}();function Ra(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,o=t.THEAD,r=t.COLGROUP,l=t.TBODY,c=t.rowUtils,h=t.columnUtils,f=t.cellRenderer;Ra(this,e),this.renderer=new ka(n,{cellRenderer:f}),this.renderer.setRenderers({rowHeaders:new zi,columnHeaders:new Zi(o),colGroup:new ia(r),rows:new da(l),cells:new wa}),this.renderer.setAxisUtils(c,h)}var t,n,o;return t=e,(n=[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&Oa(t.prototype,n),o&&Oa(t,o),e}();function Ta(e){return(Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ma=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.headerWidths=new Map}var t,n,o;return t=e,(n=[{key:"getWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===Ta(t)&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getWidth(e),n=this.wot.wtViewport.columnsRenderCalculator,o=null!=t?t:this.wot.wtSettings.settings.defaultColumnWidth;if(n){var r=n.getStretchedColumnWidth(e,o);r&&(o=r)}return o}},{key:"getHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=e.cloneSource,r=o?o.wtTable.holder:t.holder,l=r.offsetHeight<r.scrollHeight?kn():0,c=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-l),null!=(c=e.getSetting("onModifyRowHeaderWidth",c)))for(var h=e.getSetting("rowHeaders").length,f=e.getSetting("defaultColumnWidth"),d=0;d<h;d++){var y=Array.isArray(c)?c[d]:c;y=null==y?f:y,this.headerWidths.set(d,y)}}}])&&Aa(t.prototype,n),o&&Aa(t,o),e}();function xa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n,o;return t=e,(n=[{key:"getHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}])&&xa(t.prototype,n),o&&xa(t,o),e}();function Pa(e){return function(e){if(Array.isArray(e))return Da(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ha(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||Ha(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ha(e,t){if(e){if("string"==typeof e)return Da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Da(e,t):void 0}}function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Na(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ja=function(){function e(t,table){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isMaster=!t.cloneOverlay,this.wot=t,this.instance=this.wot,this.TABLE=table,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,Kt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(o)},this.rowUtils=new _a(this.wot),this.columnUtils=new Ma(this.wot),this.tableRenderer=new Ea({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}var t,n,o;return t=e,(n=[{key:"is",value:function(e){return t=this.wot.cloneOverlay,n=e,!(!t||!fi[n])&&t instanceof fi[n];var t,n}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(e.createElement("TR"))}},{key:"createSpreader",value:function(table){var e,t=table.parentNode;return t&&t.nodeType===Node.ELEMENT_NODE&&zt(t,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtSpreader",t&&t.insertBefore(e,table),e.appendChild(table)),e.style.position="relative",e}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&zt(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&zt(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable"),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtOverlays,o=t.wtViewport,r=t.getSetting("totalRows"),l=t.getSetting("totalColumns"),c=t.getSetting("rowHeaders"),h=c.length,f=t.getSetting("columnHeaders"),d=f.length,y=!1,v=e;if(this.isMaster&&(this.holderOffset=en(this.holder),v=o.createRenderCalculators(v),h&&!t.getSetting("fixedColumnsLeft"))){var m=n.leftOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=m>0,w!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(y=n.prepareOverlays()),v)this.isMaster&&o.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=en(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var C=r>0?this.getFirstRenderedRow():0,S=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new bi(C,r,d),this.columnFilter=new vi(S,l,h);var k,R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var O={};this.wot.getSetting("beforeDraw",!0,O),R=!0!==O.skipRender}if(R)if(this.tableRenderer.setHeaderContentRenderers(c,f),(this.is(ai)||this.is(ci))&&this.tableRenderer.setHeaderContentRenderers(c,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(k=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ai))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var E=hn(this.hider),T=hn(this.TABLE);0!==E&&T!==E&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),k!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is(ai)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var A=n.topOverlay.resetFixedPosition();n.bottomOverlay.clone&&(A=n.bottomOverlay.resetFixedPosition()||A),A=n.leftOverlay.resetFixedPosition()||A,n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition(),A&&(n.refreshAll(),n.adjustElementsSize())}return this.refreshSelections(v),y&&n.syncScrollWithMaster(),t.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(col){for(var e,t,n,o=this.wot.wtTable.columnFilter.renderedToSource(col),r=this.wot.getSetting("columnHeaders").length,l=this.wot.wtSettings.settings.defaultRowHeight,c=this.wot.getSetting("columnHeaderHeight")||[];r;)r-=1,e=this.wot.wtTable.getColumnHeaderHeight(r),(t=this.wot.wtTable.getColumnHeader(o,r))&&(n=dn(t),(!e&&l<n||e<n)&&(this.wot.wtViewport.oversizedColumnHeaders[r]=n),Array.isArray(c)?null!==c[r]&&void 0!==c[r]&&(this.wot.wtViewport.oversizedColumnHeaders[r]=c[r]):isNaN(c)||(this.wot.wtViewport.oversizedColumnHeaders[r]=c),this.wot.wtViewport.oversizedColumnHeaders[r]<(c[r]||c)&&(this.wot.wtViewport.oversizedColumnHeaders[r]=c[r]||c))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,t=e.wtTable.THEAD.childNodes,n=e.wtViewport.oversizedColumnHeaders,i=0,o=e.getSetting("columnHeaders").length;i<o;i++)if(n[i]){if(!t[i]||0===t[i].childNodes.length)return;t[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if((this.isMaster||this.is(ai))&&!e.getSetting("externalRowCalculator"))for(var t=this.getRenderedRowsCount(),n=0;n<t;n++){var o=this.rowFilter.renderedToSource(n);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[o]&&(e.wtViewport.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),i=0,n=t.length;i<n;i++)Gt(t[i],e)}},{key:"refreshSelections",value:function(e){var t=this.wot;if(t.selections){var n=Array.from(t.selections),o=n.length;if(e){for(var r=[],i=0;i<o;i++){for(var l=n[i].settings,c=l.highlightHeaderClassName,h=l.highlightRowClassName,f=l.highlightColumnClassName,d=n[i].classNames,y=d.length,v=0;v<y;v++)r.includes(d[v])||r.push(d[v]);c&&!r.includes(c)&&r.push(c),h&&!r.includes(h)&&r.push(h),f&&!r.includes(f)&&r.push(f)}var m=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(m))for(var w=0;w<m.length;w++)r.push(m[w]);for(var C=r.length,S=0;S<C;S++)this.removeClassFromCells(r[S])}for(var k=0;k<o;k++)n[k].draw(t,e)}}},{key:"getCell",value:function(e){var t,n=e.row,o=e.col,r=this.wot.getSetting("onModifyGetCellCoords",n,o);if(r&&Array.isArray(r)){var l=Ia(r,2);n=l[0],o=l[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;if(!(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw new Error("TR was expected to be rendered but is not");var c=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!c&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return c}},{key:"getColumnHeader",value:function(col){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=this.THEAD.childNodes[e];return null==t?void 0:t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var o=e.childNodes[n];o&&t.push(o)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wot.getSetting("rowHeaders").length;if(!(t>=n)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==o?void 0:o.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wot.getSetting("rowHeaders").length,o=0;o<n;o++){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],l=null==r?void 0:r.childNodes[o];l&&t.push(l)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Nt(t,["TD","TH"])),null===t)return null;var n=t.parentNode,o=n.parentNode,r=Bt(n),col=t.cellIndex;return Vt(ui,t,this.wtRootElement)||Vt(ii,t,this.wtRootElement)?"THEAD"===o.nodeName&&(r-=o.childNodes.length):r=Vt(ci,t,this.wtRootElement)||Vt(ai,t,this.wtRootElement)?this.wot.getSetting("totalRows")-o.childNodes.length+r:o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r),col=Vt(ui,t,this.wtRootElement)||Vt(si,t,this.wtRootElement)||Vt(ci,t,this.wtRootElement)?this.columnFilter.offsettedTH(col):this.columnFilter.visibleRowHeadedColumnToSourceColumn(col),new Wn(r,col)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,t,n,o,r,l=this.TBODY.childNodes.length;if(l*this.wot.wtSettings.settings.defaultRowHeight!=dn(this.TBODY)-1||this.wot.getSetting("fixedRowsBottom"))for(;l;)l-=1,n=this.rowFilter.renderedToSource(l),e=this.getRowHeight(n),t=(r=(o=this.getTrForRow(n)).querySelector("th"))?dn(r):dn(o)-1,(!e&&this.wot.wtSettings.settings.defaultRowHeight<t||e<t)&&(t+=1,this.wot.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return Jt(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=In(e)?e():null;return Array.isArray(t)?(t=Pa(t))[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}])&&Na(t.prototype,n),o&&Na(t,o),e}(),La={getFirstRenderedRow:function(){var e=this.wot.getSetting("totalRows"),t=this.wot.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};me(La,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Ba=La,Va={getFirstRenderedColumn:function(){return 0===this.wot.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};me(Va,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});var Fa=Va;function Wa(e){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function za(e,p){return(za=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Ya(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ka(e);if(t){var r=Ka(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ga(this,n)}}function Ga(e,t){return!t||"object"!==Wa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ka(e){return(Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&za(e,t)}(n,e);var t=Ya(n);function n(){return Ua(this,n),t.apply(this,arguments)}return n}(ja);ye($a,Ba),ye($a,Fa);var Xa=$a;function qa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Za=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),me(this,"wot",t,{writable:!1});var n=this.wot.wtTable,o=n.TABLE,r=n.hider,l=n.spreader,c=n.holder,h=n.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=o,this.hider=r,this.spreader=l,this.holder=c,this.wtRootElement=h,this.trimmingContainer=ln(this.hider.parentNode.parentNode),this.updateStateOfRendering()}var t,n,o;return t=e,(n=[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=ln(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot,t=e.wtTable;"hidden"===e.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=an(t.TABLE)}},{key:"getRelativeCellPosition",value:function(element,e,t){if(!1!==this.clone.wtTable.holder.contains(element)){var n=this.mainTableScrollableElement===this.wot.rootWindow,o=t<this.wot.getSetting("fixedColumnsLeft"),r=e<this.wot.getSetting("fixedRowsTop"),l=e>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),c={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},h={left:element.offsetLeft,top:element.offsetTop};return n?this.getRelativeCellPositionWithinWindow(r,o,h,c):this.getRelativeCellPositionWithinHolder(r,l,o,h,c)}to("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,o){var r=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,c=0;return l=t?r.left<=0?-1*r.left:0:o.left,c=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-r.top:o.top,{left:n.left+l,top:n.top+c}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,o,r){var l=this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),c=this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition(),h=0,f=0;if(n||(h=l-r.left),t){var d=this.wot.wtTable.wtRootElement.getBoundingClientRect();f=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+d.top}else e||(f=c-r.top);return{left:o.left-h,top:o.top-f}}},{key:"makeClone",value:function(e){if(-1===hi.indexOf(e))throw new Error('Clone type "'.concat(e,'" is not supported.'));var t=this.wot,n=t.wtTable,o=t.rootDocument,r=t.rootWindow,l=o.createElement("DIV"),c=o.createElement("TABLE"),h=n.wtRootElement.parentNode;l.className="ht_clone_".concat(e," handsontable"),l.style.position="absolute",l.style.top=0,l.style.left=0,l.style.overflow="visible",c.className=n.TABLE.className,l.appendChild(c),this.type=e,h.appendChild(l);var f=this.wot.getSetting("preventOverflow");return!0===f||"horizontal"===f&&this.type===ii||"vertical"===f&&this.type===si?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(h).getPropertyValue("overflow")?this.mainTableScrollableElement=n.holder:this.mainTableScrollableElement=an(n.TABLE),new this.wot.constructor({cloneSource:this.wot,cloneOverlay:this,table:c})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;X([e.style,t.style,e.parentNode.style],(function(style){style.width="",style.height=""}))}}},{key:"destroy",value:function(){new Po(this.clone).destroy()}}])&&qa(t.prototype,n),o&&qa(t,o),e}();function Qa(e){return(Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t,n){return(Ja=rl()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&tl(o,n.prototype),o}).apply(null,arguments)}function el(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tl(e,p){return(tl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function nl(e,t){return!t||"object"!==Qa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function il(e){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var al=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tl(e,t)}(h,e);var t,n,o,r,l,c=(t=h,n=rl(),function(){var e,o=il(t);if(n){var r=il(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return nl(this,e)});function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=c.call(this,e)).clone=t.makeClone(ci),t}return o=h,l=[{key:"OVERLAY_NAME",get:function(){return ci}}],(r=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ja(Xa,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderBottomOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),e.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===e.rootWindow){var n,o,r=this.wot,l=r.rootDocument,c=r.wtTable.hider.getBoundingClientRect(),h=Math.ceil(c.bottom),f=Math.ceil(c.left),d=l.documentElement.clientHeight;n=f<0?-f:0,o=h>d?h-d:0,o+="px",n+="px",t.style.left=n,t.style.bottom=o}else An(t),this.repositionOverlay();var y=fn(this.clone.wtTable.TABLE),v=hn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(y=0),t.style.height="".concat(y,"px"),t.style.width="".concat(v,"px"),!1}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,o=this.clone.wtTable.holder.parentNode,r=kn(n);t.holder.clientHeight===t.holder.offsetHeight&&(r=0),o.style.bottom="".concat(r,"px")}}])&&el(o.prototype,r),l&&el(o,l),h}(Za),ll={getFirstRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.startColumn;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.endColumn;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return null===e?-1:e},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};me(ll,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var sl=ll;function cl(e){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fl(e,p){return(fl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=gl(e);if(t){var r=gl(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return yl(this,n)}}function yl(e,t){return!t||"object"!==cl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gl(e){return(gl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fl(e,t)}(n,e);var t=pl(n);function n(){return hl(this,n),t.apply(this,arguments)}return n}(ja);ye(vl,Ba),ye(vl,sl);var ml=vl;function bl(e){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wl(e,t,n){return(wl=Ol()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&Sl(o,n.prototype),o}).apply(null,arguments)}function Cl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sl(e,p){return(Sl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function kl(e,t){return!t||"object"!==bl(t)&&"function"!=typeof t?Rl(e):t}function Rl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ol(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function El(e){return(El=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sl(e,t)}(h,e);var t,n,o,r,l,c=(t=h,n=Ol(),function(){var e,o=El(t);if(n){var r=El(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return kl(this,e)});function h(e){var t,n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),t=c.call(this,e),n=Rl(t),r=-1,(o="cachedFixedRowsBottom")in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,t.clone=t.makeClone(ai),t.cachedFixedRowsBottom=t.wot.getSetting("fixedRowsBottom"),t}return o=h,l=[{key:"OVERLAY_NAME",get:function(){return ai}}],(r=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wl(ml,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;e.style.top="";var t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"vertical"===n)t=this.getScrollPosition(),this.repositionOverlay();else{var o,r,l=this.wot,c=l.rootDocument,h=l.wtTable,f=h.hider.getBoundingClientRect(),d=Math.ceil(f.bottom),y=c.documentElement.clientHeight;o=""===(o=h.hider.style.left)?0:o,t=r=d>y?d-y:0,r+="px",e.style.left=o,e.style.bottom=r}var v=this.adjustHeaderBordersPosition(t);return this.adjustElementsSize(),v}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,o=this.clone.wtTable.holder.parentNode,r=kn(n);t.holder.clientHeight===t.holder.offsetHeight&&(r=0),o.style.bottom="".concat(r,"px")}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(nn(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,o=n.wtTable,r=n.wtSettings.settings.defaultRowHeight,l=e,c=0;l<t;){var h=o.getRowHeight(l);c+=void 0===h?r:h,l+=1}return c}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,o=e.rootWindow,r=kn(this.wot.rootDocument),l=this.clone.wtTable.holder.parentNode.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===c){var h=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=r),h=Math.min(h,t.wtRootElement.scrollWidth),l.width="".concat(h,"px")}else l.width="";this.clone.wtTable.holder.style.width=l.width;var f=fn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),l.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=0;t&&o.offsetHeight!==o.clientHeight&&(r=kn(this.wot.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e),n+=r,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return on(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,o=this.wot.getSetting("columnHeaders"),r=!1;if((n||0===t)&&o.length>0){var l=this.wot.wtTable.holder.parentNode,c=zt(l,"innerBorderBottom");this.cachedFixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),e||0===this.wot.getSetting("totalRows")?(Yt(l,"innerBorderBottom"),r=!c):(Gt(l,"innerBorderBottom"),r=c)}return r}}])&&Cl(o.prototype,r),l&&Cl(o,l),h}(Za),Al={getFirstRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.startRow;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.startRow;return null===e?-1:e},getLastRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.endRow;return null===e?-1:e},getLastVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.endRow;return null===e?-1:e},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};me(Al,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var Ml=Al;function xl(e){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pl(e,p){return(Pl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Il(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Dl(e);if(t){var r=Dl(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Hl(this,n)}}function Hl(e,t){return!t||"object"!==xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dl(e){return(Dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pl(e,t)}(n,e);var t=Il(n);function n(){return _l(this,n),t.apply(this,arguments)}return n}(ja);ye(Nl,Ml),ye(Nl,Fa);var jl=Nl;function Ll(e){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bl(e,t,n){return(Bl=Ul()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&Fl(o,n.prototype),o}).apply(null,arguments)}function Vl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fl(e,p){return(Fl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Wl(e,t){return!t||"object"!==Ll(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ul(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function zl(e){return(zl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fl(e,t)}(h,e);var t,n,o,r,l,c=(t=h,n=Ul(),function(){var e,o=zl(t);if(n){var r=zl(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return Wl(this,e)});function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=c.call(this,e)).clone=t.makeClone(si),t}return o=h,l=[{key:"OVERLAY_NAME",get:function(){return si}}],(r=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Bl(jl,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(this.needFullRender&&e.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,n=0,o=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||o&&"horizontal"===o)n=this.getScrollPosition(),An(t);else{var r,l,c=e.hider.getBoundingClientRect(),h=Math.ceil(c.left),f=Math.ceil(c.right);l=""===(l=e.hider.style.top)?0:l,n=r=h<0&&f-t.offsetWidth>0?-h:0,En(t,r+="px",l)}var d=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),d}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,tn(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot.wtSettings.defaultColumnWidth,o=e,r=0;o<t;)r+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return r}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,o=e.rootWindow,r=kn(n),l=this.clone.wtTable.holder.parentNode.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===c){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=r),h=Math.min(h,t.wtRootElement.scrollHeight),l.height="".concat(h,"px")}else l.height="";this.clone.wtTable.holder.style.height=l.height;var f=hn(this.clone.wtTable.TABLE);l.width="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalColumns");if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=0;return t&&o.offsetWidth!==o.clientWidth&&(r=kn(this.wot.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=r,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==this.wot.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),o=this.wot.getSetting("fixedColumnsLeft");this.wot.getSetting("totalRows")?Gt(t,"emptyRows"):Yt(t,"emptyRows");var r=!1;if(o&&!n.length)Yt(t,"innerBorderLeft");else if(!o&&n.length){var l=zt(t,"innerBorderLeft");e?(Yt(t,"innerBorderLeft"),r=!l):(Gt(t,"innerBorderLeft"),r=l)}return r}}])&&Vl(o.prototype,r),l&&Vl(o,l),h}(Za),Gl={getFirstRenderedRow:function(){return 0===this.wot.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};me(Gl,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var Kl=Gl;function $l(e){return($l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ql(e,p){return(ql=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Zl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Jl(e);if(t){var r=Jl(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ql(this,n)}}function Ql(e,t){return!t||"object"!==$l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jl(e){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ql(e,t)}(n,e);var t=Zl(n);function n(){return Xl(this,n),t.apply(this,arguments)}return n}(ja);ye(es,Kl),ye(es,Fa);var ts=es;function ns(e){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function os(e,t,n){return(os=ls()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&is(o,n.prototype),o}).apply(null,arguments)}function rs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function is(e,p){return(is=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function as(e,t){return!t||"object"!==ns(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ss(e){return(ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var us=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&is(e,t)}(h,e);var t,n,o,r,l,c=(t=h,n=ls(),function(){var e,o=ss(t);if(n){var r=ss(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return as(this,e)});function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=c.call(this,e)).clone=t.makeClone(ui),t}return o=h,l=[{key:"OVERLAY_NAME",get:function(){return ui}}],(r=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return os(ts,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderTopOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var n=this.wot.wtTable.hider.getBoundingClientRect(),o=Math.ceil(n.top),r=Math.ceil(n.left),l=Math.ceil(n.bottom),c=Math.ceil(n.right),h="0",f="0";t&&"vertical"!==t||r<0&&c-e.offsetWidth>0&&(h="".concat(-r,"px")),t&&"horizontal"!==t||o<0&&l-e.offsetHeight>0&&(f="".concat(-o,"px")),En(e,h,f)}else An(e);var d=fn(this.clone.wtTable.TABLE),y=hn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(d=0),e.style.height="".concat(d,"px"),e.style.width="".concat(y,"px"),!1}}}])&&rs(o.prototype,r),l&&rs(o,l),h}(Za);function cs(e){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fs(e,p){return(fs=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ys(e);if(t){var r=ys(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ps(this,n)}}function ps(e,t){return!t||"object"!==cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ys(e){return(ys=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fs(e,t)}(n,e);var t=ds(n);function n(){return hs(this,n),t.apply(this,arguments)}return n}(ja);ye(gs,Kl),ye(gs,sl);var vs=gs;function ms(e){return(ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bs(e,t,n){return(bs=Rs()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&Cs(o,n.prototype),o}).apply(null,arguments)}function ws(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cs(e,p){return(Cs=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Ss(e,t){return!t||"object"!==ms(t)&&"function"!=typeof t?ks(e):t}function ks(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Os(e){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cs(e,t)}(h,e);var t,n,o,r,l,c=(t=h,n=Rs(),function(){var e,o=Os(t);if(n){var r=Os(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return Ss(this,e)});function h(e){var t,n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),t=c.call(this,e),n=ks(t),r=-1,(o="cachedFixedRowsTop")in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,t.clone=t.makeClone(ii),t.cachedFixedRowsTop=t.wot.getSetting("fixedRowsTop"),t}return o=h,l=[{key:"OVERLAY_NAME",get:function(){return ii}}],(r=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return bs(vs,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==this.wot.rootWindow||t&&"vertical"===t)n=this.getScrollPosition(),An(e);else{var r,l,c=this.wot.wtTable,h=c.hider.getBoundingClientRect(),f=Math.ceil(h.top),d=Math.ceil(h.bottom),y=e.offsetHeight;o=d===y,n=l=f<0&&d-y>0?-f:0,En(e,r=""===(r=c.hider.style.left)?0:r,l+="px")}var v=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),v}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(nn(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot.wtSettings.settings.defaultRowHeight,o=e,r=0;o<t;){var l=this.wot.wtTable.getRowHeight(o);r+=void 0===l?n:l,o+=1}return r}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.rootDocument,o=e.rootWindow,r=kn(n),l=this.clone.wtTable.holder.parentNode.style,c=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===c){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=r),h=Math.min(h,t.wtRootElement.scrollWidth),l.width="".concat(h,"px")}else l.width="";this.clone.wtTable.holder.style.width=l.width;var f=fn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),l.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,r=this.getTableParentOffset(),l=0;if(t&&o.offsetHeight!==o.clientHeight&&(l=kn(n.rootDocument)),t){var c=n.getSetting("fixedRowsBottom"),h=n.getSetting("totalRows");r+=this.sumCellSizes(0,e+1),r-=n.wtViewport.getViewportHeight()-this.sumCellSizes(h-c,h),r+=1}else r+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return r+=l,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return on(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,o=this.wot.getSetting("totalColumns");o?Gt(n,"emptyColumns"):Yt(n,"emptyColumns");var r=!1;if(!t){var l=this.wot.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,h=this.wot.getSetting("columnHeaders");if((c||0===l)&&h.length>0){var f=zt(n,"innerBorderTop");this.cachedFixedRowsTop=this.wot.getSetting("fixedRowsTop"),e||0===this.wot.getSetting("totalRows")?(Yt(n,"innerBorderTop"),r=!f):(Gt(n,"innerBorderTop"),r=f)}}if(0===this.wot.getSetting("rowHeaders").length){var d=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(d)for(var i=0;i<d.length;i++)d[i].style["border-left-width"]=0}return r}}])&&ws(o.prototype,r),l&&ws(o,l),h}(Za);function Ts(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}di(al),di(Tl),di(Yl),di(us),di(Es);var As=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t;var n=this.wot,o=n.rootDocument,r=n.rootWindow,l=n.wtTable,c=parseInt(r.getComputedStyle(o.body).lineHeight,10),h=1.2*parseInt(r.getComputedStyle(o.body).fontSize,10);this.instance=this.wot,this.eventManager=new Po(this.wot),this.scrollbarSize=kn(o),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var f="hidden"===r.getComputedStyle(l.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?l.holder:an(l.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=c||h,this.registerListeners(),this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY}var t,n,o;return t=e,(n=[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=pi(ii,this.wot),yi(ai)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),yi(ci)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=pi(ai,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=pi(si,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=pi(ui,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=pi(ci,this.wot)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.wot,n=t.rootDocument,o=t.rootWindow,r=this.topOverlay.mainTableScrollableElement,l=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(r,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),r!==l&&this.eventManager.addEventListener(l,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var c,h=o.devicePixelRatio&&o.devicePixelRatio>1,f=this.scrollableElement===o,d=this.wot.wtSettings.getSetting("preventWheel"),y={passive:f};(d||h||!xe())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,d)}),y),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,d)}),y)}})),this.eventManager.addEventListener(o,"resize",(function(){clearTimeout(c),c=setTimeout((function(){e.wot.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(o!==t&&r!==t&&!e.target.contains(o)||n!==t&&r!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.wot.rootWindow,o=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,l=e.target,c=r!==n&&l!==n&&!l.contains(r),h=o!==n&&l!==n&&!l.contains(o);if(!this.keyPressed||!c&&!h){var f=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&f)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=Xn(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.browserLineHeight,n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,o=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(o+=o*t,n+=n*t);var r=this.scrollVertically(n),l=this.scrollHorizontally(o);return r||l}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],r=o[0],l=o[1];if(this.horizontalScrolling=t.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==l||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=r;var c=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;c&&(c.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,t=e.rootWindow,n=e.wtTable;"hidden"===t.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=n.holder:this.scrollableElement=an(n.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtTable.spreader,n=t.clientWidth,o=t.clientHeight;n===this.spreaderLastSize.width&&o===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtViewport,o=t.wtTable,r=this.wot.getSetting("totalColumns"),l=this.wot.getSetting("totalRows"),c=n.getRowHeaderWidth(),h=n.getColumnHeaderHeight(),f=o.hider.style;if(f.width="".concat(c+this.leftOverlay.sumCellSizes(0,r),"px"),f.height="".concat(h+this.topOverlay.sumCellSizes(0,l)+1,"px"),this.scrollbarSize>0){var d=o.wtRootElement,y=d.scrollHeight,v=d.scrollWidth,m=o.holder,w=m.scrollHeight,C=m.scrollWidth;this.hasScrollbarRight=y<w,this.hasScrollbarBottom=v<C,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>v?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wot.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(element){if(!element)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],t=null;return X(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(element)&&(t=e.clone)})),t}},{key:"syncOverlayTableClassNames",value:function(){var e=this.instance.wtTable.TABLE;X([this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}])&&Ts(t.prototype,n),o&&Ts(t,o),e}();function Ms(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n,o;return t=e,(n=[{key:"scrollViewport",value:function(e,t,n,o,r){if(e.col<0||e.row<0)return!1;var l=this.scrollViewportHorizontally(e.col,n,r),c=this.scrollViewportVertically(e.row,t,o);return l||c}},{key:"scrollViewportHorizontally",value:function(e,t,n){if(!this.wot.drawn)return!1;var o=this._getVariables(),r=o.fixedColumnsLeft,l=o.leftOverlay,c=o.totalColumns,h=!1;if(e>=0&&e<=Math.max(c-1,0)){var f=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();e>=r&&f>-1&&(e<f||n)?h=l.scrollTo(e):(-1===d||d>-1&&(e>d||t))&&(h=l.scrollTo(e,!0))}return h}},{key:"scrollViewportVertically",value:function(e,t,n){if(!this.wot.drawn)return!1;var o=this._getVariables(),r=o.fixedRowsBottom,l=o.fixedRowsTop,c=o.topOverlay,h=o.totalRows,f=!1;if(e>=0&&e<=Math.max(h-1,0)){var d=this.getFirstVisibleRow(),y=this.getLastVisibleRow();e>=l&&d>-1&&(e<d||t)?f=c.scrollTo(e):(-1===y||y>-1&&(e>y&&e<h-r||n))&&(f=c.scrollTo(e,!0))}return f}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,o=e.wtViewport,r=e.totalRows,l=e.fixedRowsTop,c=this.wot.rootWindow,h=n.getFirstVisibleRow();if(t.mainTableScrollableElement===c){var f=en(n.wtRootElement),d=dn(n.hider),y=dn(c),v=on(c,c);if(f.top+d-y<=v){var m=o.getColumnHeaderHeight();m+=t.sumCellSizes(0,l);for(var w=r;w>0;w--)if(m+=t.sumCellSizes(w-1,w),f.top+d-m<=v){h=w;break}}}return h}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,o=e.wtViewport,r=e.totalRows,l=this.wot.rootWindow,c=n.getLastVisibleRow();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=on(l,l);if(h.top>f)for(var d=dn(l),y=o.getColumnHeaderHeight(),v=1;v<=r;v++)if(y+=t.sumCellSizes(v-1,v),h.top+y-f>=d){c=v-2;break}}return c}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,o=e.wtViewport,r=e.totalColumns,l=this.wot.rootWindow,c=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=pn(n.hider),d=pn(l),y=rn(l,l);if(h.left+f-d<=y)for(var v=o.getRowHeaderWidth(),m=r;m>0;m--)if(v+=t.sumCellSizes(m-1,m),h.left+f-v<=y){c=m;break}}return c}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,o=e.wtViewport,r=e.totalColumns,l=this.wot.rootWindow,c=n.getLastVisibleColumn();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=rn(l,l);if(h.left>f)for(var d=pn(l),y=o.getRowHeaderWidth(),v=1;v<=r;v++)if(y+=t.sumCellSizes(v-1,v),h.left+y-f>=d){c=v-2;break}}return c}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}])&&Ms(t.prototype,n),o&&Ms(t,o),e}();function _s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ps=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderLeftOverlay:function(){return o.getSetting("fixedColumnsLeft")>0||o.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return o.getSetting("fixedRowsTop")>0||o.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return o.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var r=o.getSetting("data",e,t);Qt(n,null==r?"":r)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},be(this.defaults,(function(e,t){if(void 0!==n[t])o.settings[t]=n[t];else{if(void 0===e)throw new Error('A required setting "'.concat(t,'" was not provided'));o.settings[t]=e}}))}var t,n,o;return t=e,(n=[{key:"update",value:function(e,t){var n=this;return void 0===t?be(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this.wot}},{key:"getSetting",value:function(e,t,n,o,r){return"function"==typeof this.settings[e]?this.settings[e](t,n,o,r):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}])&&_s(t.prototype,n),o&&_s(t,o),e}();function Is(e){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ds(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ns(e,p){return(Ns=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function js(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Bs(e);if(t){var r=Bs(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ls(this,n)}}function Ls(e,t){return!t||"object"!==Is(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bs(e){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ns(e,t)}(l,e);var t,n,o,r=js(l);function l(){return Hs(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=ln(this.wtRootElement),t=this.wot.rootWindow;if(e===t)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=e.parentElement,o=sn(e,"height",t),r=sn(e,"overflow",t),l=this.holder.style,c=e.scrollWidth,h=e.scrollHeight,f=e.getBoundingClientRect(),d=f.width,y=f.height;if(n&&["auto","hidden","scroll"].includes(r)){var v=e.cloneNode(!1);v.style.overflow="auto",e.nextElementSibling?n.insertBefore(v,e.nextElementSibling):n.appendChild(v);var m=parseInt(cn(v,t).height,10);n.removeChild(v),0===m&&(y=0)}y=Math.min(y,h),l.height="auto"===o?"auto":"".concat(y,"px"),d=Math.min(d,c),l.width="".concat(d,"px"),l.overflow="",this.hasTableHeight="auto"===l.height||y>0,this.hasTableWidth=d>0}this.isTableVisible=Jt(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot,t=e.getOverlayName(),n=e.getSetting("columnHeaders").length;if(n&&!e.wtViewport.hasOversizedColumnHeadersMarked[t]){for(var o=e.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount(),i=0;i<n;i++)for(var l=-1*o;l<r;l++)this.markIfOversizedColumnHeader(l);e.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}}])&&Ds(t.prototype,n),o&&Ds(t,o),l}(ja);ye(Vs,Ml),ye(Vs,sl);var Fs=Vs;function Ws(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Us(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var zs=new WeakMap,Ys=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,o=t.scrollOffset,r=t.totalItems,l=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,f=t.scrollbarHeight;Ws(this,e),zs.set(this,{viewportHeight:n,scrollOffset:o,totalRows:r,rowHeightFn:l,overrideFn:c,calculationType:h,horizontalScrollbarHeight:f}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var t,n,o;return t=e,o=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],(n=[{key:"calculate",value:function(){for(var t,n=0,o=!0,r=[],l=zs.get(this),c=l.calculationType,h=l.overrideFn,f=l.rowHeightFn,d=l.scrollOffset,y=l.totalRows,v=l.viewportHeight,m=l.horizontalScrollbarHeight||0,i=0;i<y;i++)if(t=f(i),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=d&&2!==c&&(this.startRow=i),n>=d&&n+(2===c?t:0)<=d+v-m&&(null===this.startRow&&(this.startRow=i),this.endRow=i),r.push(n),n+=t,2!==c&&(this.endRow=i),n>=d+v-m){o=!1;break}if(this.endRow===y-1&&o)for(this.startRow=this.endRow;this.startRow>0;){var w=r[this.endRow]+t-r[this.startRow-1];if((w<=v-m||2!==c)&&(this.startRow-=1),w>=v-m)break}1===c&&null!==this.startRow&&h&&h(this),this.startPosition=r[this.startRow],void 0===this.startPosition&&(this.startPosition=null),y<this.endRow&&(this.endRow=y-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}])&&Us(t.prototype,n),o&&Us(t,o),e}();function Gs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ks(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $s=new WeakMap,Xs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,o=t.scrollOffset,r=t.totalItems,l=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,f=t.stretchMode,d=t.stretchingItemWidthFn,y=void 0===d?function(e){return e}:d;Gs(this,e),$s.set(this,{viewportWidth:n,scrollOffset:o,totalColumns:r,columnWidthFn:l,overrideFn:c,calculationType:h,stretchingColumnWidthFn:y}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=f,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var t,n,o;return t=e,o=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],(n=[{key:"calculate",value:function(){for(var e,t=0,n=!0,o=[],r=$s.get(this),l=r.calculationType,c=r.overrideFn,h=r.scrollOffset,f=r.totalColumns,d=r.viewportWidth,i=0;i<f;i++)if(e=this._getColumnWidth(i),t<=h&&2!==l&&(this.startColumn=i),t>=h&&t+(2===l?e:0)<=h+(h>0?d+1:d)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=i),this.endColumn=i),o.push(t),t+=e,2!==l&&(this.endColumn=i),t>=h+d){n=!1;break}if(this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var y=o[this.endColumn]+e-o[this.startColumn-1];if((y<=d||2!==l)&&(this.startColumn-=1),y>d)break}1===l&&null!==this.startColumn&&c&&c(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=$s.get(this),o=n.totalColumns,r=0,i=0;i<o;i++){var l=this._getColumnWidth(i),c=n.stretchingColumnWidthFn(void 0,i);"number"==typeof c?t-=c:r+=l}var h=t-r;if("all"===this.stretch&&h>0)this.stretchAllRatio=t/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var f=this._getColumnWidth(o-1),d=h+f;this.stretchLastWidth=d>=0?d:f}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,o=$s.get(this),r=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var l=Math.round(t*this.stretchAllRatio),c=o.stretchingColumnWidthFn(l,e);this.stretchAllColumnsWidth[e]=void 0===c?l:isNaN(c)?this._getColumnWidth(e):c}if(this.stretchAllColumnsWidth.length===r&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===$s.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=$s.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}])&&Ks(t.prototype,n),o&&Ks(t,o),e}();function qs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Zs=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Po(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",(function(){n.clientHeight=n.getWorkspaceHeight()}))}var t,n,o;return t=e,(n=[{key:"getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,t=this.instance.wtOverlays.topOverlay.trimmingContainer;return t===this.wot.rootWindow?e.documentElement.clientHeight:fn(t)>0&&t.clientHeight>0?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wot,o=n.rootDocument,r=n.rootWindow,l=this.instance.wtOverlays.leftOverlay.trimmingContainer,c=o.documentElement.offsetWidth,h=n.getSetting("totalColumns");if(n.getSetting("preventOverflow"))return hn(this.instance.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(c-this.getWorkspaceOffset().left,c):Math.min(this.getContainerFillWidth(),c-this.getWorkspaceOffset().left,c),l===r&&h>0&&this.sumColumnWidths(0,h-1)>e)return o.documentElement.clientWidth;if(l!==r&&("scroll"===(t=sn(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",r))||"hidden"===t||"auto"===t))return Math.max(e,l.clientWidth);var f=n.getSetting("stretchH");return"none"!==f&&f?e:Math.max(e,hn(this.instance.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=this.wot.wtTable,o=0,r=e;r<t;)o+=n.getColumnWidth(r),r+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,t=this.wot.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return en(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return fn(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return hn(e.TABLE)||hn(e.TBODY)||hn(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.instance.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=fn(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var i=0,n=t.length;i<n;i++)this.rowHeaderWidth+=e[i]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var r=0,l=t.length;r<l;r++)o?(this.rowHeaderWidth+=hn(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.wot,l=r.wtSettings,c=r.wtOverlays,h=r.wtTable,f=r.rootDocument;this.rowHeaderWidth=NaN,e=l.settings.renderAllRows&&1===o?1/0:this.getViewportHeight();var d=c.topOverlay.getScrollPosition()-c.topOverlay.getTableParentOffset();d<0&&(d=0);var y=r.getSetting("fixedRowsTop"),v=r.getSetting("fixedRowsBottom"),m=r.getSetting("totalRows");return y&&(d+=n=c.topOverlay.sumCellSizes(0,y),e-=n),v&&c.bottomOverlay.clone&&(e-=n=c.bottomOverlay.sumCellSizes(m-v,m)),t=h.holder.clientHeight===h.holder.offsetHeight?0:kn(f),new Ys({viewportSize:e,scrollOffset:d,totalItems:r.getSetting("totalRows"),itemSizeFn:function(e){return h.getRowHeight(e)},overrideFn:l.settings.viewportRowCalculatorOverride,calculationType:o,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.wot,n=t.wtSettings,o=t.wtOverlays,r=t.wtTable,l=t.rootDocument,c=this.getViewportWidth(),h=o.leftOverlay.getScrollPosition()-o.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,h<0&&(h=0);var f=t.getSetting("fixedColumnsLeft");if(f){var d=o.leftOverlay.sumCellSizes(0,f);h+=d,c-=d}return r.holder.clientWidth!==r.holder.offsetWidth&&(c-=kn(l)),new Xs({viewportSize:c,scrollOffset:h,totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return t.wtTable.getColumnWidth(e)},overrideFn:n.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(2),o=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow,o=this.rowsRenderCalculator,r=o.startRow,l=o.endRow;return!(t<r||t===r&&t>0||n>l||n===l&&n<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn,o=this.columnsRenderCalculator,r=o.startColumn,l=o.endColumn;return!(t<r||t===r&&t>0||n>l||n===l&&n<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){be(this.hasOversizedColumnHeadersMarked,(function(e,t,object){object[t]=void 0}))}}])&&qs(t.prototype,n),o&&qs(t,o),e}();function Qs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Js=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=[];if(this.guid="wt_".concat(Ot()),this.rootDocument=t.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,t.table),this.wtScroll=new xs(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new ri(this),this.selections=this.cloneSource.selections):(this.wtSettings=new Ps(this,t),this.wtTable=new Fs(this,t.table),this.wtScroll=new xs(this),this.wtViewport=new Zs(this),this.wtEvent=new ri(this),this.selections=this.getSetting("selections"),this.wtOverlays=new As(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var o=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;o<r;o++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[o].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){Qt(t,n[e])}])}this.drawn=!1,this.drawInterrupted=!1}var t,n,o;return t=e,(n=[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<o&&e.col<l)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<l&&e.row>=n-r){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<l)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollViewport",value:function(e,t,n,o,r){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,o,r)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];be({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(o,r){e.getSetting(r).length&&n.push(o),t.push(o)})),Gt(this.wtTable.wtRootElement.parentNode,t),Yt(this.wtTable.wtRootElement.parentNode,n)}},{key:"getSetting",value:function(e,t,n,o,r){return this.wtSettings.getSetting(e,t,n,o,r)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}])&&Qs(t.prototype,n),o&&Qs(t,o),e}();function eu(e){var t=e.isShiftKey,n=e.isLeftClick,o=e.isRightClick,r=e.coords,l=e.selection,c=e.controller,h=l.isSelected()?l.getSelectedRange().current():null,f=l.isSelectedByCorner(),d=l.isSelectedByRowHeader();if(t&&h)r.row>=0&&r.col>=0&&!c.cells?l.setRangeEnd(r):(f||d)&&r.row>=0&&r.col>=0&&!c.cells?l.setRangeEnd(new Wn(r.row,r.col)):f&&r.row<0&&!c.column?l.setRangeEnd(new Wn(h.to.row,r.col)):d&&r.col<0&&!c.row?l.setRangeEnd(new Wn(r.row,h.to.col)):(!f&&!d&&r.col<0||f&&r.col<0)&&!c.row?l.selectRows(Math.max(h.from.row,0),r.row,r.col):(!f&&!d&&r.row<0||d&&r.row<0)&&!c.column&&l.selectColumns(Math.max(h.from.col,0),r.col,r.row);else{var y=!l.inInSelection(r),v=n||o&&y;r.row<0&&r.col>=0&&!c.column?v&&l.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!c.row?v&&l.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!c.cells?v&&l.setRangeStart(r):r.col<0&&r.row<0&&l.selectAll(!0,!0)}}var tu=new Map([["mousedown",eu],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,o=e.selection,r=e.controller;if(t){var l=o.isSelectedByRowHeader(),c=o.isSelectedByColumnHeader(),h=o.tableProps.countCols(),f=o.tableProps.countRows();c&&!r.column?o.setRangeEnd(new Wn(f-1,n.col)):l&&!r.row?o.setRangeEnd(new Wn(n.row,h-1)):r.cell||o.setRangeEnd(n)}}],["touchstart",eu]]);function nu(e,t){var n=t.coords,o=t.selection,r=t.controller;tu.get(e.type)({coords:n,selection:o,controller:r,isShiftKey:e.shiftKey,isLeftClick:Jn(e)||"touchstart"===e.type,isRightClick:Qn(e)})}var ou=new WeakMap,ru=Symbol("rootInstance");function iu(object){ou.set(object,!0)}function au(e){return e===ru}function lu(object){return ou.has(object)}function su(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||du(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uu(e,t,n){return(uu=cu()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&hu(o,n.prototype),o}).apply(null,arguments)}function cu(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function hu(e,p){return(hu=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function fu(e){return function(e){if(Array.isArray(e))return pu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||du(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function du(e,t){if(e){if("string"==typeof e)return pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pu(e,t):void 0}}function pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function yu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var gu=new WeakMap,vu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Po(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,gu.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var t,n,o;return t=e,(n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this.wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var td=this.wt.getCell(e,t);return td<0?null:td}},{key:"scrollViewport",value:function(e,t,n,o,r){return this.wt.scrollViewport(e,t,n,o,r)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this.wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this.wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=gu.get(this),t=this.instance,n=t.rootElement,o=t.rootDocument,r=n.getAttribute("style");r&&n.setAttribute("data-originalstyle",r),Yt(n,"handsontable"),e.table=o.createElement("TABLE"),Yt(e.table,"htCore"),this.instance.getSettings().tableClassName&&Yt(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=gu.get(this),n=this.instance,o=n.rootElement,r=n.rootDocument,l=n.selection,c=r.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var o=e.instance.rootWindow;wn(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&wn(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(c,"keyup",(function(e){l.isInProgress()&&!e.shiftKey&&l.finish()})),this.eventManager.addEventListener(c,"mouseup",(function(n){l.isInProgress()&&Jn(n)&&l.finish(),t.mouseDown=!1,!xn(r.activeElement)&&(l.isSelected()||l.isSelectedByAnyHeader()||o.contains(n.target)||Qn(n))||e.instance.unlisten()})),this.eventManager.addEventListener(c,"contextmenu",(function(e){l.isInProgress()&&Qn(e)&&(l.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(c,"touchend",(function(){l.isInProgress()&&l.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(c,"mousedown",(function(n){var l=n.target,h=n.x||n.clientX,f=n.y||n.clientY,d=n.target;if(!t.mouseDown&&o&&e.instance.view){var y=e.instance.view.wt.wtTable.holder;if(d===y){var v=kn(r);if(r.elementFromPoint(h+v,f)!==y||r.elementFromPoint(h,f+v)!==y)return}else for(;d!==c;){if(null===d){if(n.isTargetWebComponent)break;return}if(d===o)return;d=d.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(l):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||Mn(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t=e.row,col=e.col;return uu(Wn,fu(this.translateFromRenderableToVisualIndex(t,col)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===o&&(o=t),[n,o]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getFirstNotHiddenIndex(n-1,-1);return null===o?0:e.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,o){if(isNaN(e)||e<0)return 0;var r=n.getFirstNotHiddenIndex(e,t),l=n.getRenderableFromVisualIndex(r);if(!Number.isInteger(l))return 0;var c=0;return t<0?c=l+1:t>0&&(c=o-l),c}},{key:"initializeWalkontable",value:function(){var e=this,t=gu.get(this),n={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return lu(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var o;return(o=e.instance).getDataAtCell.apply(o,fu(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsLeft:function(){var t=e.instance.countCols(),n=Math.min(parseInt(e.settings.fixedColumnsLeft,10),t)-1;return e.countNotHiddenColumnIndexes(n,-1)},fixedRowsTop:function(){var t=e.instance.countRows(),n=Math.min(parseInt(e.settings.fixedRowsTop,10),t)-1;return e.countNotHiddenRowIndexes(n,-1)},fixedRowsBottom:function(){var t=e.instance.countRows(),n=Math.max(t-parseInt(e.settings.fixedRowsBottom,10),0);return e.countNotHiddenRowIndexes(n,1)},shouldRenderLeftOverlay:function(){return e.settings.fixedColumnsLeft>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var o=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(o,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var o=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(o,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,o){var r=su(e.translateFromRenderableToVisualIndex(t,n),2),l=r[0],c=r[1],h=e.instance.runHooks("modifyGetCellCoords",l,c),f=l,d=c;if(Array.isArray(h)){var y=su(h,2);f=y[0],d=y[1]}var v=e.instance.getCellMeta(f,d),m=e.instance.colToProp(d),w=e.instance.getDataAtRowProp(f,m);e.instance.hasHook("beforeValueRender")&&(w=e.instance.runHooks("beforeValueRender",w,v)),e.instance.runHooks("beforeRenderer",o,l,c,m,w,v),e.instance.getCellRenderer(v)(e.instance,o,l,c,m,w,v),e.instance.runHooks("afterRenderer",o,l,c,m,w,v)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,o,r,l){var c=e.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=l,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,c,r,h),Zn(n)||(nu(n,{coords:c,selection:e.instance.selection,controller:h}),e.instance.runHooks("afterOnCellMouseDown",n,c,r),e.activeWt=e.wt)},onCellContextMenu:function(n,o,r,l){var c=e.translateFromRenderableToVisualCoords(o);e.activeWt=l,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,c,r),Zn(n)||(e.instance.runHooks("afterOnCellContextMenu",n,c,r),e.activeWt=e.wt)},onCellMouseOut:function(t,n,o,r){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=r,e.instance.runHooks("beforeOnCellMouseOut",t,l,o),Zn(t)||(e.instance.runHooks("afterOnCellMouseOut",t,l,o),e.activeWt=e.wt)},onCellMouseOver:function(n,o,r,l){var c=e.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};e.activeWt=l,e.instance.runHooks("beforeOnCellMouseOver",n,c,r,h),Zn(n)||(t.mouseDown&&nu(n,{coords:c,selection:e.instance.selection,controller:h}),e.instance.runHooks("afterOnCellMouseOver",n,c,r),e.activeWt=e.wt)},onCellMouseUp:function(t,n,o,r){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=r,e.instance.runHooks("beforeOnCellMouseUp",t,l,o),Zn(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,l,o),e.activeWt=e.wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.onDraw(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,o){var r=e.instance.rowIndexMapper,l=r.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingRowHeader",l,n,o);return r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:function(t,n,o){var r=e.instance.columnIndexMapper,l=r.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingColumnHeader",l,n,o);return r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(c,1))},onAfterDrawSelection:function(t,n,o){var r,l=su(e.translateFromRenderableToVisualIndex(t,n),2),c=l[0],h=l[1],f=e.instance.selection.getSelectedRange(),d=f.size();if(d>0){var y=(null!=o?o:0)+1-d,v=f.peekByIndex(y);r=[v.from.row,v.from.col,v.to.row,v.to.col]}return e.instance.runHooks("afterDrawSelection",c,h,r,o)},onBeforeDrawBorders:function(t,n){var o=su(t,4),r=o[0],l=o[1],c=o[2],h=o[3],f=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(r),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l),e.instance.rowIndexMapper.getVisualFromRenderableIndex(c),e.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return e.instance.runHooks("beforeDrawBorders",f,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var o=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,o){var r=e.instance.rowIndexMapper,l=e.instance.columnIndexMapper,c=n>=0?l.getVisualFromRenderableIndex(n):n,h=t>=0?r.getVisualFromRenderableIndex(t):t,f=e.instance.runHooks("modifyGetCellCoords",h,c,o);if(Array.isArray(f)){var d=su(f,4),y=d[0],v=d[1],m=d[2],w=d[3];return[y>=0?r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(y,1)):y,v>=0?l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(v,1)):v,m>=0?r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(m,-1)):m,w>=0?l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var o=e.countRenderableRows(),r=t.startRow,l=t.endRow;if("number"==typeof n)t.startRow=Math.max(r-n,0),t.endRow=Math.min(l+n,o-1);else if("auto"===n){var c=Math.ceil(l/o*12);t.startRow=Math.max(r-c,0),t.endRow=Math.min(l+c,o-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsLeft&&(n=10),n>0||"auto"===n){var o=e.countRenderableColumns(),r=t.startColumn,l=t.endColumn;if("number"==typeof n&&(t.startColumn=Math.max(r-n,0),t.endColumn=Math.min(l+n,o-1)),"auto"===n){var c=Math.ceil(l/o*6);t.startColumn=Math.max(r-c,0),t.endColumn=Math.min(l+c,o-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this.wt=new Js(n),this.activeWt=this.wt;var o=this.wt.wtTable.spreader,r=this.instance.rootElement.getBoundingClientRect(),l=r.width,c=r.height;this.setLastSize(l,c),this.eventManager.addEventListener(o,"mousedown",(function(e){e.target===o&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(o,"contextmenu",(function(e){e.target===o&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e.wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(Mn(e))return!0;var t=Lt(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return gu.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)}},{key:"onDraw",value:function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!zt(n,"relative"))return $t(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,r=o.rootDocument,l=o.getRowHeader,div=r.createElement("div"),span=r.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,e,l),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;zt(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):($t(t),this.appendColHeader(e,t))}else{var o=this.instance.rootDocument,div=o.createElement("div"),span=o.createElement("span");div.className="relative",span.className="colHeader",this.updateCellHeader(span,e,this.instance.getColHeader),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(element,e,content){var t=e,n=this.wt.wtOverlays.getParentOverlay(element)||this.wt;element.parentNode&&(zt(element,"colHeader")?t=n.wtTable.columnFilter.sourceToRendered(e):zt(element,"rowHeader")&&(t=n.wtTable.rowFilter.sourceToRendered(e))),t>-1?Zt(element,content(e)):(Qt(element,String.fromCharCode(160)),Yt(element,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=gu.get(this),o=[e,t];n.lastWidth=o[0],n.lastHeight=o[1]}},{key:"getLastSize",value:function(){var e=gu.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}])&&yu(t.prototype,n),o&&yu(t,o),e}(),mu=vo("cellTypes"),bu=mu.register,wu=mu.getItem,Cu=mu.hasItem,Su=mu.getNames;mu.getValues;function ku(e){if(!Cu(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return wu(e)}function Ru(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var n=t,o=n.editor,r=n.renderer,l=n.validator;o&&To(e,o),r&&$r(e,r),l&&ti(e,l),bu(e,t)}function Ou(e){return(Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Eu="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Tu=Eu.length;function Au(e){for(var t,n=e+1,o="";n>0;)t=(n-1)%Tu,o=String.fromCharCode(65+t)+o,n=parseInt((n-t)/Tu,10);return o}function Mu(label){var e=0;if(label)for(var i=0,t=label.length-1;i<label.length;i+=1,t-=1)e+=Math.pow(Tu,t)*(Eu.indexOf(label[i])+1);return e-=1}function xu(){var i,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(i=0;i<t;i++){var r=[];for(e=0;e<n;e++)r.push(Au(e)+(i+1));o.push(r)}return o}function _u(){var i,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(i=0;i<t;i++){var r={};for(e=0;e<n;e++)r["prop".concat(e)]=Au(e)+(i+1);o.push(r)}return o}function Pu(e,t){for(var n,data=[],i=0;i<e;i++){n=[];for(var o=0;o<t;o++)n.push("");data.push(n)}return data}function Iu(input){var i,e,t,n,output=[],o=0;for(i=0,e=input.length;i<e;i++)for(t=0,n=input[i].length;t<n;t++)t===o&&(output.push([]),o+=1),output[t].push(input[i][t]);return output}function Hu(e,t){var n=void 0===t||t;return function(t,col){return function t(o){if(o){if(Re(o,e)&&void 0!==o[e])return o[e];if(Re(o,"type")&&o.type){if("string"!=typeof o.type)throw new Error('Cell "type" must be a string');var r=ku(o.type);if(Re(r,e))return r[e];if(n)return}return t(Object.getPrototypeOf(o))}}("number"==typeof t?this.getCellMeta(t,col):t)}}function Du(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,o=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,r){o.push([n+t,r,e])})):Object.keys(e).forEach((function(r){o.push([n+t,r,e[r]])}))})),o}function Nu(data){var e=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?e=data[0].length:data[0]&&ve(data[0])&&(e=Se(data[0]))),e}function ju(data){return!!(Array.isArray(data)&&data.length&&data.every((function(e){return Array.isArray(e)})))}function Lu(data){return!!(Array.isArray(data)&&data.length&&data.every((function(e){return"object"===Ou(e)&&!Array.isArray(e)&&null!==e})))}function Bu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Bu(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var t,n,o;return t=e,(n=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(data){this.data=data}},{key:"getAtColumn",value:function(e){var t=this,n=[];return X(this.data,(function(o,r){var l=t.getAtCell(r,e);n.push(l)})),n}},{key:"getAtRow",value:function(e,t,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=void 0===t&&void 0===n,c=null,h=null;if(c=this.modifyRowData(e),Array.isArray(c))h=[],l?c.forEach((function(t,n){h[n]=o.getAtPhysicalCell(e,n,c)})):ur(t,n,(function(n){h[n-t]=o.getAtPhysicalCell(e,n,c)}));else if(ve(c)||In(c))if(h=r?[]:{},!l||r){var f=0,d=this.countFirstRowKeys()-1;ur(f,d,(function(l){var y=o.colToProp(l);if(l>=(t||f)&&l<=(n||d)&&!Number.isInteger(y)){var v=o.getAtPhysicalCell(e,y,c);r?h.push(v):Ce(h,y,v)}}))}else be(c,(function(t,n){Ce(h,n,o.getAtPhysicalCell(e,n,c))}));return h}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=ke(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(t)?this.data[e][t]=n:Ce(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var o=null;if(n&&(o="string"==typeof t?we(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var r=ke(o);this.hot.runHooks("modifySourceData",e,this.colToProp(t),r,"get"),r.isTouched()&&(o=r.value)}return o}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,l=null,c=null,h=null,f=null;null===t||null===n?(r=!0,l=0,h=this.countRows()-1):(l=Math.min(t.row,n.row),c=Math.min(t.col,n.col),h=Math.max(t.row,n.row),f=Math.max(t.col,n.col));var d=[];return ur(l,h,(function(t){d.push(r?e.getAtRow(t,void 0,void 0,o):e.getAtRow(t,c,f,o))})),d}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Nu(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}])&&Vu(t.prototype,n),o&&Vu(t,o),e}(),Wu=(n(287),n(443),n(14),{_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e){for(var t=this,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];this._localHooks[e]&&X(this._localHooks[e],(function(e){return e.apply(t,o)}))},clearLocalHooks:function(){return this._localHooks={},this}});me(Wu,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});var Uu=Wu;function zu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Gu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;zu(this,e),this.indexedValues=[],this.initValueOrFn=t}var t,n,o;return t=e,(n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,In(this.initValueOrFn)?ur(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):ur(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}])&&Yu(t.prototype,n),o&&Yu(t,o),e}();function Ku(e){return function(e){if(Array.isArray(e))return $u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return $u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Xu(e,t,n){return[].concat(Ku(e.slice(0,t)),Ku(n),Ku(e.slice(t)))}function qu(e,t){return K(e,(function(e){return!1===t.includes(e)}))}function Zu(e,t){return $(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function Qu(e,t){var n=t[0],o=t.length;return $(e,(function(e){return e>=n?e+o:e}))}function Ju(e){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ec(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tc(e,t,n){return(tc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=ic(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function nc(e,p){return(nc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function oc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ic(e);if(t){var r=ic(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rc(this,n)}}function rc(e,t){return!t||"object"!==Ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ic(e){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ye(Gu,Uu);var ac=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nc(e,t)}(l,e);var t,n,o,r=oc(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=Qu(this.indexedValues,t);this.indexedValues=Xu(n,e,t),tc(ic(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=qu(this.indexedValues,e);this.indexedValues=Zu(t,e),tc(ic(l.prototype),"remove",this).call(this,e)}}])&&ec(t.prototype,n),o&&ec(t,o),l}(Gu);function lc(e){return function(e){if(Array.isArray(e))return sc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sc(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function uc(e,t,n,o){var r=n.length?n[0]:void 0;return[].concat(lc(e.slice(0,r)),lc(n.map((function(e,t){return In(o)?o(e,t):o}))),lc(void 0===r?[]:e.slice(r)))}function cc(e,t){return K(e,(function(e,n){return!1===t.includes(n)}))}function hc(e){return(hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pc(e,t,n){return(pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=mc(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function yc(e,p){return(yc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function gc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=mc(e);if(t){var r=mc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return vc(this,n)}}function vc(e,t){return!t||"object"!==hc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mc(e){return(mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yc(e,t)}(l,e);var t,n,o,r=gc(l);function l(){return fc(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"insert",value:function(e,t){this.indexedValues=uc(this.indexedValues,0,t,this.initValueOrFn),pc(mc(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=cc(this.indexedValues,e),pc(mc(l.prototype),"remove",this).call(this,e)}}])&&dc(t.prototype,n),o&&dc(t,o),l}(Gu);function wc(e){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kc(e,p){return(kc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Rc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ec(e);if(t){var r=Ec(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Oc(this,n)}}function Oc(e,t){return!t||"object"!==wc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ec(e){return(Ec=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kc(e,t)}(l,e);var t,n,o,r=Rc(l);function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Cc(this,l),r.call(this,e)}return t=l,(n=[{key:"getHiddenIndexes",value:function(){return G(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&Sc(t.prototype,n),o&&Sc(t,o),l}(bc);function Ac(e){return(Ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mc(e){return function(e){if(Array.isArray(e))return xc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return xc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xc(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ic(e,t,n){return(Ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Lc(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Hc(e,p){return(Hc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Dc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Lc(e);if(t){var r=Lc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Nc(this,n)}}function Nc(e,t){return!t||"object"!==Ac(t)&&"function"!=typeof t?jc(e):t}function jc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lc(e){return(Lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hc(e,t)}(l,e);var t,n,o,r=Dc(l);function l(){var e;_c(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Bc(jc(e=r.call.apply(r,[this].concat(n))),"orderOfIndexes",[]),e}return t=l,(n=[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=Mc(Array(e.length).keys()),Ic(Lc(l.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=qu(this.orderOfIndexes,[e]),In(this.initValueOrFn)?Ic(Lc(l.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):Ic(Lc(l.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Ic(Lc(l.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=uc(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=Qu(this.orderOfIndexes,t),Ic(Lc(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=cc(this.indexedValues,e),this.orderOfIndexes=qu(this.orderOfIndexes,e),this.orderOfIndexes=Zu(this.orderOfIndexes,e),Ic(Lc(l.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}])&&Pc(t.prototype,n),o&&Pc(t,o),l}(Gu);function Fc(e){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zc(e,p){return(zc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Yc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Kc(e);if(t){var r=Kc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Gc(this,n)}}function Gc(e,t){return!t||"object"!==Fc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kc(e){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zc(e,t)}(l,e);var t,n,o,r=Yc(l);function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Wc(this,l),r.call(this,e)}return t=l,(n=[{key:"getTrimmedIndexes",value:function(){return G(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&Uc(t.prototype,n),o&&Uc(t,o),l}(bc),Xc=new Map([["hiding",Tc],["index",Gu],["linkedPhysicalIndexToValue",Vc],["physicalIndexToValue",bc],["trimming",$c]]);function qc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Zc=0,Qc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collection=new Map}var t,n,o;return t=e,(n=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),Zc+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);it(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Zc-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return at(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}])&&qc(t.prototype,n),o&&qc(t,o),e}();function Jc(e){return(Jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nh(e,p){return(nh=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function oh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ih(e);if(t){var r=ih(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rh(this,n)}}function rh(e,t){return!t||"object"!==Jc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ih(e){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ye(Qc,Uu);var ah=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nh(e,t)}(l,e);var t,n,o,r=oh(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return t=l,(n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=$(this.get(),(function(map){return map.getValues()})),n=[],o=it(t[0])&&t[0].length||0,r=0;r<o;r+=1){for(var l=[],c=0;c<this.getLength();c+=1)l.push(t[c][r]);n.push(l)}return $(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return it(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}])&&eh(t.prototype,n),o&&eh(t,o),l}(Qc);function lh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sh(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,uh(e,t,"set"),n),n}function uh(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ch=new WeakMap,hh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ch.set(this,{writable:!0,value:[]})}var t,n,o;return t=e,(n=[{key:"subscribe",value:function(e){var t;return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(t=this,uh(t,ch,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){sh(this,ch,e)}}])&&lh(t.prototype,n),o&&lh(t,o),e}();function fh(e,t){for(var n=[],i=0,o=0;i<e.length&&o<t.length;i++,o++)e[i]!==t[o]&&n.push({op:"replace",index:o,oldValue:e[i],newValue:t[o]});for(;i<t.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:t[i]});for(;o<e.length;o++)n.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return n}function dh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ph(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yh(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,vh(e,t,"get"))}function gh(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,vh(e,t,"set"),n),n}function vh(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}ye(hh,Uu);var mh=new WeakMap,bh=new WeakMap,wh=new WeakMap,Ch=new WeakMap,Sh=new WeakMap,kh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;dh(this,e),mh.set(this,{writable:!0,value:new Set}),bh.set(this,{writable:!0,value:[]}),wh.set(this,{writable:!0,value:[]}),Ch.set(this,{writable:!0,value:!1}),Sh.set(this,{writable:!0,value:!1}),gh(this,Sh,null!=n&&n)}var t,n,o;return t=e,(n=[{key:"createObserver",value:function(){var e=this,t=new hh;return yh(this,mh).add(t),t.addLocalHook("unsubscribe",(function(){yh(e,mh).delete(t)})),t._writeInitialChanges(fh(yh(this,bh),yh(this,wh))),t}},{key:"emit",value:function(e){var t=yh(this,wh);yh(this,Ch)&&yh(this,bh).length===e.length||(0===e.length?e=new Array(t.length).fill(yh(this,Sh)):gh(this,bh,new Array(e.length).fill(yh(this,Sh))),yh(this,Ch)||(gh(this,Ch,!0),t=yh(this,bh)));var n=fh(t,e);yh(this,mh).forEach((function(e){return e._write(n)})),gh(this,wh,e)}}])&&ph(t.prototype,n),o&&ph(t,o),e}();function Rh(e){return function(e){if(Array.isArray(e))return Oh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Oh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Eh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Th,Ah=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexesSequence=new ac,this.trimmingMapsCollection=new ah((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new ah((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new Qc,this.hidingChangesObservable=new kh({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}var t,n,o;return t=e,(n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Xc.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Xc.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof $c?this.trimmingMapsCollection.register(e,t):t instanceof Tc?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return it(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return it(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return it(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return it(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t,r=this.getPhysicalFromVisualIndex(e);return null===r?!0===n&&o!==e-t?this.getFirstNotHiddenIndex(o,-t,!1,o):null:!1===this.isHidden(r)?e:this.getFirstNotHiddenIndex(e+t,t,n,o)}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=Rh(new Array(e).keys()),this.notHiddenIndexesCache=Rh(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var o=$(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),r=this.getNotTrimmedIndexesLength(),l=e.length,c=qu(this.getIndexesSequence(),o),h=r-l;if(t+l<r){var f=c.filter((function(e){return!1===n.isTrimmed(e)}))[t];h=c.indexOf(f)}this.setIndexesSequence(Xu(c,h,o))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],o=it(n)?n:this.getNumberOfIndexes(),r=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),l=$(new Array(t).fill(o),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(r,l),this.trimmingMapsCollection.insertToEvery(r,l),this.hidingMapsCollection.insertToEvery(r,l),this.variousMapsCollection.insertToEvery(r,l),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(o,t)}}}])&&Eh(t.prototype,n),o&&Eh(t,o),e}();function Mh(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function xh(e){it(e)&&no(et(Th||(Th=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}ye(Ah,Uu);var _h=vo("phraseFormatters"),Ph=_h.register,Ih=_h.getValues;Ph("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var Hh,Dh="ContextMenu:items",Nh="".concat(Dh,".noItems"),jh="".concat(Dh,".insertRowAbove"),Lh="".concat(Dh,".insertRowBelow"),Bh="".concat(Dh,".insertColumnOnTheLeft"),Vh="".concat(Dh,".insertColumnOnTheRight"),Fh="".concat(Dh,".removeRow"),Wh="".concat(Dh,".removeColumn"),Uh="".concat(Dh,".undo"),zh="".concat(Dh,".redo"),Yh="".concat(Dh,".readOnly"),Gh="".concat(Dh,".clearColumn"),Kh="".concat(Dh,".copy"),$h="".concat(Dh,".cut"),Xh="".concat(Dh,".freezeColumn"),qh="".concat(Dh,".unfreezeColumn"),Zh="".concat(Dh,".mergeCells"),Qh="".concat(Dh,".unmergeCells"),Jh="".concat(Dh,".addComment"),ef="".concat(Dh,".editComment"),tf="".concat(Dh,".removeComment"),nf="".concat(Dh,".readOnlyComment"),of="".concat(Dh,".align"),rf="".concat(Dh,".align.left"),af="".concat(Dh,".align.center"),lf="".concat(Dh,".align.right"),sf="".concat(Dh,".align.justify"),uf="".concat(Dh,".align.top"),cf="".concat(Dh,".align.middle"),hf="".concat(Dh,".align.bottom"),ff="".concat(Dh,".borders"),df="".concat(Dh,".borders.top"),pf="".concat(Dh,".borders.right"),yf="".concat(Dh,".borders.bottom"),gf="".concat(Dh,".borders.left"),vf="".concat(Dh,".borders.remove"),mf="".concat(Dh,".nestedHeaders.insertChildRow"),bf="".concat(Dh,".nestedHeaders.detachFromParent"),wf="".concat(Dh,".hideColumn"),Cf="".concat(Dh,".showColumn"),Sf="".concat(Dh,".hideRow"),kf="".concat(Dh,".showRow"),Rf="Filters:",Of="".concat(Rf,"conditions"),Ef="".concat(Of,".none"),Tf="".concat(Of,".isEmpty"),Af="".concat(Of,".isNotEmpty"),Mf="".concat(Of,".isEqualTo"),xf="".concat(Of,".isNotEqualTo"),_f="".concat(Of,".beginsWith"),Pf="".concat(Of,".endsWith"),If="".concat(Of,".contains"),Hf="".concat(Of,".doesNotContain"),Df="".concat(Of,".byValue"),Nf="".concat(Of,".greaterThan"),jf="".concat(Of,".greaterThanOrEqualTo"),Lf="".concat(Of,".lessThan"),Bf="".concat(Of,".lessThanOrEqualTo"),Vf="".concat(Of,".isBetween"),Ff="".concat(Of,".isNotBetween"),Wf="".concat(Of,".after"),Uf="".concat(Of,".before"),zf="".concat(Of,".today"),Yf="".concat(Of,".tomorrow"),Gf="".concat(Of,".yesterday"),Kf="".concat(Rf,"labels.filterByCondition"),$f="".concat(Rf,"labels.filterByValue"),Xf="".concat(Rf,"labels.conjunction"),qf="".concat(Rf,"labels.disjunction"),Zf="".concat(Rf,"values.blankCells"),Qf="".concat(Rf,"buttons.selectAll"),Jf="".concat(Rf,"buttons.clear"),ed="".concat(Rf,"buttons.ok"),nd="".concat(Rf,"buttons.cancel"),od="".concat(Rf,"buttons.placeholder.search"),rd="".concat(Rf,"buttons.placeholder.value"),id="".concat(Rf,"buttons.placeholder.secondValue");function ad(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ld=(ad(Hh={languageCode:"en-US"},Nh,"No available options"),ad(Hh,jh,"Insert row above"),ad(Hh,Lh,"Insert row below"),ad(Hh,Bh,"Insert column left"),ad(Hh,Vh,"Insert column right"),ad(Hh,Fh,["Remove row","Remove rows"]),ad(Hh,Wh,["Remove column","Remove columns"]),ad(Hh,Uh,"Undo"),ad(Hh,zh,"Redo"),ad(Hh,Yh,"Read only"),ad(Hh,Gh,"Clear column"),ad(Hh,of,"Alignment"),ad(Hh,rf,"Left"),ad(Hh,af,"Center"),ad(Hh,lf,"Right"),ad(Hh,sf,"Justify"),ad(Hh,uf,"Top"),ad(Hh,cf,"Middle"),ad(Hh,hf,"Bottom"),ad(Hh,Xh,"Freeze column"),ad(Hh,qh,"Unfreeze column"),ad(Hh,ff,"Borders"),ad(Hh,df,"Top"),ad(Hh,pf,"Right"),ad(Hh,yf,"Bottom"),ad(Hh,gf,"Left"),ad(Hh,vf,"Remove border(s)"),ad(Hh,Jh,"Add comment"),ad(Hh,ef,"Edit comment"),ad(Hh,tf,"Delete comment"),ad(Hh,nf,"Read-only comment"),ad(Hh,Zh,"Merge cells"),ad(Hh,Qh,"Unmerge cells"),ad(Hh,Kh,"Copy"),ad(Hh,$h,"Cut"),ad(Hh,mf,"Insert child row"),ad(Hh,bf,"Detach from parent"),ad(Hh,wf,["Hide column","Hide columns"]),ad(Hh,Cf,["Show column","Show columns"]),ad(Hh,Sf,["Hide row","Hide rows"]),ad(Hh,kf,["Show row","Show rows"]),ad(Hh,Ef,"None"),ad(Hh,Tf,"Is empty"),ad(Hh,Af,"Is not empty"),ad(Hh,Mf,"Is equal to"),ad(Hh,xf,"Is not equal to"),ad(Hh,_f,"Begins with"),ad(Hh,Pf,"Ends with"),ad(Hh,If,"Contains"),ad(Hh,Hf,"Does not contain"),ad(Hh,Nf,"Greater than"),ad(Hh,jf,"Greater than or equal to"),ad(Hh,Lf,"Less than"),ad(Hh,Bf,"Less than or equal to"),ad(Hh,Vf,"Is between"),ad(Hh,Ff,"Is not between"),ad(Hh,Wf,"After"),ad(Hh,Uf,"Before"),ad(Hh,zf,"Today"),ad(Hh,Yf,"Tomorrow"),ad(Hh,Gf,"Yesterday"),ad(Hh,Zf,"Blank cells"),ad(Hh,Kf,"Filter by condition"),ad(Hh,$f,"Filter by value"),ad(Hh,Xf,"And"),ad(Hh,qf,"Or"),ad(Hh,Qf,"Select all"),ad(Hh,Jf,"Clear"),ad(Hh,ed,"OK"),ad(Hh,nd,"Cancel"),ad(Hh,od,"Search"),ad(Hh,rd,"Value"),ad(Hh,id,"Second value"),Hh),sd=ld.languageCode,ud=vo("languagesDictionaries"),cd=ud.register,hd=ud.getItem,fd=ud.hasItem,pd=ud.getValues;function yd(e,t){var n=e,o=t;return ve(e)&&(n=(o=e).languageCode),function(e,t){e!==sd&&(n=t,be(hd(sd),(function(e,t){at(n[t])&&(n[t]=e)})));var n}(n,o),cd(n,de(o)),de(o)}function gd(e){return vd(e)?de(hd(e)):null}function vd(e){return fd(e)}function md(e,t,n){var o=gd(e);if(null===o)return null;var r=o[t];if(at(r))return null;var l=function(e,t){var n=e;return X(function(){return Ih()}(),(function(o){n=o(e,t)})),n}(r,n);return Array.isArray(l)?l[0]:l}function bd(e){var t=Mh(e);return vd(t)||(t=sd,xh(e)),t}yd(ld);var wd=new Po,Cd=new Set,Sd=0;function kd(e){0===Sd&&(wd.addEventListener(e,"keydown",(function(e){Cd.has(e.keyCode)||Cd.add(e.keyCode)})),wd.addEventListener(e,"keyup",(function(e){Cd.has(e.keyCode)&&Cd.delete(e.keyCode)})),wd.addEventListener(e,"visibilitychange",(function(){e.hidden&&Cd.clear()})),wd.addEventListener(e.defaultView,"blur",(function(){Cd.clear()}))),Sd+=1}function Rd(){Sd>0&&(Sd-=1),0===Sd&&(wd.clearEvents(),Cd.clear(),Sd=0)}function Od(){return Array.from(Cd.values()).some((function(e){return $n(e)}))}n(15);var Ed="active-header",Td="area",Ad="cell",Md="fill",xd="header",_d="custom-selection";function Pd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Id(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Hd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;Pd(this,e),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=o.clone()}var t,n,o;return t=e,(n=[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"includes",value:function(e){var t=e.row,col=e.col,n=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner();return n.row<=t&&o.row>=t&&n.col<=col&&o.col>=col}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopLeftCorner())&&this.includes(e.getOuterBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new Wn(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new Wn(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),o=this.getDirection(),r=e.getOuterTopLeftCorner(),l=e.getOuterBottomRightCorner(),c=Math.min(t.row,r.row),h=Math.min(t.col,r.col),f=Math.max(n.row,l.row),d=Math.max(n.col,l.col),y=new Wn(c,h),v=new Wn(f,d);return this.from=y,this.to=v,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var r=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=r[0],this.to=r[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new Wn(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return new Wn(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return new Wn(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return new Wn(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getOuterTopLeftCorner",value:function(){return new Wn(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return new Wn(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return new Wn(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return new Wn(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(new Wn(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(new Wn(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(new Wn(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(new Wn(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof Wn))return!1;if(t&&t.includes(e)){if(this.getOuterTopLeftCorner().isEqual(new Wn(t.from.row,t.from.col)))return this.getOuterBottomRightCorner();if(this.getOuterTopRightCorner().isEqual(new Wn(t.from.row,t.to.col)))return this.getOuterBottomLeftCorner();if(this.getOuterBottomLeftCorner().isEqual(new Wn(t.to.row,t.from.col)))return this.getOuterTopRightCorner();if(this.getOuterBottomRightCorner().isEqual(new Wn(t.to.row,t.to.col)))return this.getOuterTopLeftCorner()}return e.isEqual(this.getOuterBottomRightCorner())?this.getOuterTopLeftCorner():e.isEqual(this.getOuterTopLeftCorner())?this.getOuterBottomRightCorner():e.isEqual(this.getOuterTopRightCorner())?this.getOuterBottomLeftCorner():e.isEqual(this.getOuterBottomLeftCorner())?this.getOuterTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),o=Math.min(this.from.col,this.to.col),r=Math.max(this.from.col,this.to.col),l=Math.min(e.from.row,e.to.row),c=Math.max(e.from.row,e.to.row),h=Math.min(e.from.col,e.to.col),f=Math.max(e.from.col,e.to.col),d=[];return t===l&&d.push("top"),r===f&&d.push("right"),n===c&&d.push("bottom"),o===h&&d.push("left"),d}},{key:"getInner",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var r=e.col;r<=t.col;r++)this.from.row===o&&this.from.col===r||this.to.row===o&&this.to.col===r||n.push(new Wn(o,r));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var r=e.col;r<=t.col;r++)e.row===o&&e.col===r?n.push(e):t.row===o&&t.col===r?n.push(t):n.push(new Wn(o,r));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),o=t.row;o<=n.row;o++)for(var r=t.col;r<=n.col;r++)if(!1===e(o,r))return}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to)}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}])&&Id(t.prototype,n),o&&Id(t,o),e}();n(202);function Dd(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Nd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nd(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nd(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function jd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ld=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&(this.eventManager=new Po(t),this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var t,n,o;return t=e,(n=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var element=e.main.childNodes[t];e.eventManager.addEventListener(element,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},o=0,r=this.main.childNodes.length;o<r;o++)n(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),qn(e);var n=this,o=this.wot.rootDocument.body,r=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(o,"mousemove",(function e(l){var c;((c=l).clientY<Math.floor(r.top)||c.clientY>Math.ceil(r.top+r.height)||c.clientX<Math.floor(r.left)||c.clientX>Math.ceil(r.left+r.width))&&(n.eventManager.removeEventListener(o,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","left","bottom","right","corner"],style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(var i=0;i<5;i++){var o=n[i],div=t.createElement("div");div.className="wtBorder ".concat(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(div.className+=" hidden"),(style=div.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,style.height=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(e.border.width,"px"),style.width=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(div)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ve()&&this.createMultipleSelectorHandles(),this.disappear();var r=this.wot.wtTable,l=r.bordersHolder;l||((l=t.createElement("div")).className="htBorders",r.bordersHolder=l,r.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={topLeft:t.createElement("DIV"),topLeftHitArea:t.createElement("DIV"),bottomRight:t.createElement("DIV"),bottomRightHitArea:t.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style},be({position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")},(function(t,n){e.selectionHandles.styles.bottomRightHitArea[n]=t,e.selectionHandles.styles.topLeftHitArea[n]=t})),be({position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"},(function(t,n){e.selectionHandles.styles.bottomRight[n]=t,e.selectionHandles.styles.topLeft[n]=t})),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,col){var t=this.wot.selections.createOrGetArea();return!(!t.cellRange||e===t.cellRange.to.row&&col===t.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,col,t,n,o,r){var l=parseInt(this.selectionHandles.styles.topLeft.width,10),c=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(t-l,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(n-l,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(t-c/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(n-c/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(t+r,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(n+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(t+r-c/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(n+o-c/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,col)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,o,r,l,c,h=this.wot,f=h.wtTable,d=h.rootDocument,y=h.rootWindow,v=f.getRenderedRowsCount(),i=0;i<v;i+=1){var s=f.rowFilter.renderedToSource(i);if(s>=e[0]&&s<=e[2]){t=s,l=e[0];break}}for(var m=v-1;m>=0;m-=1){var w=f.rowFilter.renderedToSource(m);if(w>=e[0]&&w<=e[2]){n=w;break}}for(var C=f.getRenderedColumnsCount(),S=0;S<C;S+=1){var k=f.columnFilter.renderedToSource(S);if(k>=e[1]&&k<=e[3]){o=k,c=e[1];break}}for(var R=C-1;R>=0;R-=1){var O=f.columnFilter.renderedToSource(R);if(O>=e[1]&&O<=e[3]){r=O;break}}if(void 0!==t&&void 0!==o){var E=f.getCell(new Wn(t,o)),T=t!==n||o!==r,A=T?f.getCell(new Wn(n,r)):E,M=en(E),x=T?en(A):M,_=en(f.TABLE),P=M.top,I=M.left,H=I-_.left-1,D=x.left+hn(A)-I;if(this.isEntireColumnSelected(t,n)){var N=this.getDimensionsFromHeader("columns",o,r,l,_),j=null;if(N){var L=Dd(N,3);j=L[0],H=L[1],D=L[2]}j&&(E=j)}var B=P-_.top-1,V=x.top+fn(A)-P;if(this.isEntireRowSelected(o,r)){var F=this.getDimensionsFromHeader("rows",t,n,c,_),W=null;if(F){var U=Dd(F,3);W=U[0],B=U[1],V=U[2]}W&&(E=W)}var style=cn(E,y);parseInt(style.borderTopWidth,10)>0&&(B+=1,V=V>0?V-1:0),parseInt(style.borderLeftWidth,10)>0&&(H+=1,D=D>0?D-1:0),this.topStyle.top="".concat(B,"px"),this.topStyle.left="".concat(H,"px"),this.topStyle.width="".concat(D,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(B,"px"),this.leftStyle.left="".concat(H,"px"),this.leftStyle.height="".concat(V,"px"),this.leftStyle.display="block";var z=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(B+V-z,"px"),this.bottomStyle.left="".concat(H,"px"),this.bottomStyle.width="".concat(D,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(B,"px"),this.rightStyle.left="".concat(H+D-z,"px"),this.rightStyle.height="".concat(V+1,"px"),this.rightStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"==typeof Y?Y(this.settings.layerLevel):Y;var G=this.wot.getSetting("onModifyGetCellCoords",n,r),K=n,$=r;if(G&&Array.isArray(G)){var X=Dd(G,4);K=X[2],$=X[3]}if(Ve()||!Y||this.isPartRange(K,$))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(B+V+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.left="".concat(H+D+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Z=ln(f.TABLE),Q=Z===y;Q&&(Z=d.documentElement),r===this.wot.getSetting("totalColumns")-1&&(Q?A.getBoundingClientRect().left:A.offsetLeft)+hn(A)+parseInt(this.cornerDefaultStyle.width,10)/2>=pn(Z)&&(this.cornerStyle.left="".concat(Math.floor(H+D+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0),n===this.wot.getSetting("totalRows")-1&&(Q?A.getBoundingClientRect().top:A.offsetTop)+fn(A)+parseInt(this.cornerDefaultStyle.height,10)/2>=dn(Z)&&(this.cornerStyle.top="".concat(Math.floor(B+V+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ve()&&this.updateMultipleSelectionHandlesPosition(n,r,B,H,D,V)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,o,r){var l=this.wot.wtTable,c=l.wtRootElement.parentNode,h=null,f=null,d=null,y=null,v=null,m=null,w=null,C=null;switch(e){case"rows":h=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return fn.apply(void 0,arguments)},d="ht__selection--rows",m="top";break;case"columns":h=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return hn.apply(void 0,arguments)},d="ht__selection--columns",m="left"}if(c.classList.contains(d)){var S=this.wot.getSetting("columnHeaders").length;if(w=h(t,S-o),C=h(n,S-o),!w||!C)return!1;var k=en(w),R=en(C);return w&&C&&(y=k[m]-r[m]-1,v=R[m]+f(C)-k[m]),[w,y,v]}return!1}},{key:"changeBorderStyle",value:function(e,t){var style=this[e].style,n=t[e];!n||n.hide?Yt(this[e],"hidden"):(zt(this[e],"hidden")&&Gt(this[e],"hidden"),style.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(style.height="".concat(n.width,"px")),"right"!==e&&"left"!==e||(style.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=1,n="#000",style=this[e].style;style.backgroundColor=n,style.width="".concat(t,"px"),style.height="".concat(t,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?Yt(this[e],"hidden"):Gt(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Ve()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}])&&jd(t.prototype,n),o&&jd(t,o),e}();function Bd(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Vd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vd(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vd(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Fd(e){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ud(e){return(Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zd(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Yd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yd(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yd(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Gd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kd(e,t,n){return(Kd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Zd(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function $d(e,p){return($d=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Zd(e);if(t){var r=Zd(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return qd(this,n)}}function qd(e,t){return!t||"object"!==Ud(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zd(e){return(Zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$d(e,t)}(l,e);var t,n,o,r=Xd(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,null)).visualCellRange=t||null,n.commit(),n}return t=l,(n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=new Hd(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,Kd(Zd(l.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,r=this.findVisibleCoordsInRowsRange(e.row,t.row,n);if(null===r)return null;var l=this.findVisibleCoordsInColumnsRange(e.col,t.col,o);return null===l?null:new Wn(r,l)}},{key:"findVisibleCoordsInRowsRange",value:function(e,t,n){var o=this.settings.visualToRenderableCoords({row:e,col:-1}).row;return t===e&&null===o?null:null===o?this.findVisibleCoordsInRowsRange(e+n,t,n):e}},{key:"findVisibleCoordsInColumnsRange",value:function(e,t,n){var o=this.settings.visualToRenderableCoords({row:-1,col:e}).col;return t===e&&null===o?null:null===o?this.findVisibleCoordsInColumnsRange(e+n,t,n):e}},{key:"findVisibleHeaderRange",value:function(e,t,n,o){var r=this.findVisibleCoordsInRowsRange(e.row,t.row,n),l=this.findVisibleCoordsInRowsRange(t.row,e.row,-n),c=this.findVisibleCoordsInColumnsRange(e.col,t.col,o),h=this.findVisibleCoordsInColumnsRange(t.col,e.col,-o);return null===r&&null===l&&null===c&&null===h?null:[new Wn(r,c),new Wn(l,h)]}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.visualCellRange,t=e.from,n=e.to,o=this.getRowSearchDirection(this.visualCellRange),r=this.getColumnSearchDirection(this.visualCellRange),l=this.findVisibleCoordsInRange(t,n,o,r),c=this.findVisibleCoordsInRange(n,t,-o,-r);if(null===l||null===c){var h=null;if("header"===this.settings.type){var f=zd(this.findVisibleHeaderRange(t,n,o,r),2),d=f[0],y=f[1];h=this.createRenderableCellRange(d,y)}this.cellRange=h}else this.cellRange=this.createRenderableCellRange(l,c);return this}},{key:"adjustCoordinates",value:function(e){var t=this.getRowSearchDirection(e),n=this.getColumnSearchDirection(e),o=e.from.clone().normalize(),r=e.to.clone().normalize(),l=this.findVisibleCoordsInRange(o,r,t,n);if(null!==l){if(null===this.cellRange){var c=this.settings.visualToRenderableCoords(l);this.cellRange=new Hd(c)}return e.setHighlight(l),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,o=null===t.row||null===n.row,r=null===t.col||null===n.col,l=new Wn(o?null:Math.min(t.row,n.row),r?null:Math.min(t.col,n.col)),c=new Wn(o?null:Math.max(t.row,n.row),r?null:Math.max(t.col,n.col));return[l.row,l.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return new Hd(n,n,o)}},{key:"getRowSearchDirection",value:function(e){return e.from.row<e.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(e){return e.from.col<e.to.col?1:-1}}])&&Gd(t.prototype,n),o&&Gd(t,o),l}(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n,o;return t=e,(n=[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Ld(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new Hd(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopLeftCorner(),t=this.cellRange.getOuterBottomRightCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=e.wtTable.getCell(new Wn(t,n));if("object"===Fd(l)){var c=o;r&&(c=this.classNameGenerator(l),this.classNames.includes(c)||this.classNames.push(c)),Yt(l,c)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(element){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var r=o>=0?o:t,l=e,c=0==(r-=1)?e:"".concat(e,"-").concat(r);if(zt(element,c)){var h=r+1;l="".concat(e,"-").concat(h)}else l=n(element,r);return l}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),r=Bd(o,4),l=r[0],c=r[1],h=r[2],f=r[3],d=this.settings,y=d.highlightHeaderClassName,v=d.highlightColumnClassName,m=d.highlightRowClassName,w=d.highlightOnlyClosestHeader,C=d.selectionType,S=void 0===C||["active-header","header"].includes(C);if(S&&null!==c&&null!==f)for(var k=0,R=0;R<n;R+=1){var O=e.wtTable.columnFilter.renderedToSource(R);if(O>=c&&O<=f){var E=e.wtTable.getColumnHeaders(O),T=E.length-1;w&&E.length>1&&(E=[E[T]]);for(var A=0;A<E.length;A+=1){var M=[],x=E[A];y&&M.push(y),v&&M.push(v),A=w?T:A;var _=e.getSetting("onBeforeHighlightingColumnHeader",O,A,{selectionType:C,columnCursor:k,selectionWidth:f-c+1,classNames:M});_!==O&&(x=e.wtTable.getColumnHeader(_,A)),Yt(x,M)}k+=1}}if(null!==l&&null!==h)for(var P=0,I=0;I<t;I+=1){var H=e.wtTable.rowFilter.renderedToSource(I);if(S&&H>=l&&H<=h){var D=e.wtTable.getRowHeaders(H),N=D.length-1;w&&D.length>1&&(D=[D[N]]);for(var j=0;j<D.length;j+=1){var L=[],B=D[j];y&&L.push(y),m&&L.push(m),j=w?N:j;var V=e.getSetting("onBeforeHighlightingRowHeader",H,j,{selectionType:C,rowCursor:P,selectionHeight:h-l+1,classNames:L});V!==H&&(B=e.wtTable.getRowHeader(V,j)),Yt(B,L)}P+=1}if(null!==c&&null!==f)for(var F=0;F<n;F+=1){var W=e.wtTable.columnFilter.renderedToSource(F);H>=l&&H<=h&&W>=c&&W<=f?this.settings.className&&this.addClassAtCoords(e,H,W,this.settings.className,this.settings.markIntersections):H>=l&&H<=h?m&&this.addClassAtCoords(e,H,W,m):W>=c&&W<=f&&v&&this.addClassAtCoords(e,H,W,v);var U=e.getSetting("onAfterDrawSelection",H,W,this.settings.layerLevel);"string"==typeof U&&this.addClassAtCoords(e,H,W,U)}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}])&&Wd(t.prototype,n),o&&Wd(t,o),e}()),Jd=["activeHeaderClassName"];function ep(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function tp(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ep(Object(source),!0).forEach((function(t){np(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ep(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function np(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function op(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var ip=function(e){var t=e.activeHeaderClassName,n=op(e,Jd);return new Qd(tp(tp({highlightHeaderClassName:t},n),{},{selectionType:Ed}))},ap=["layerLevel","areaCornerVisible"];function lp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function sp(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?lp(Object(source),!0).forEach((function(t){up(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):lp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function up(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var hp=function(e){var t=e.layerLevel,n=e.areaCornerVisible,o=cp(e,ap);return new Qd(sp(sp({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},o),{},{selectionType:Td}))},fp=["cellCornerVisible"];function dp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function pp(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?dp(Object(source),!0).forEach((function(t){yp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):dp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function yp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var vp=function(e){var t=e.cellCornerVisible,n=gp(e,fp);return new Qd(pp(pp({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:Ad}))},mp=["border","visualCellRange"];function bp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function wp(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?bp(Object(source),!0).forEach((function(t){Cp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):bp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Cp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var kp=function(e){var t=e.border,n=e.visualCellRange,o=Sp(e,mp);return new Qd(wp(wp(wp({},t),o),{},{selectionType:_d}),n)};n(291);function Rp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Op(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Rp(Object(source),!0).forEach((function(t){Ep(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Rp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Ep(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tp=function(e){var t=Object.assign({},e);return new Qd(Op(Op({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:Md}))},Ap=["headerClassName","rowClassName","columnClassName"];function Mp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function xp(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Mp(Object(source),!0).forEach((function(t){_p(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Mp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function _p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var Ip=function(e){var t=e.headerClassName,n=e.rowClassName,o=e.columnClassName,r=Pp(e,Ap);return new Qd(xp(xp({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:o},r),{},{highlightOnlyClosestHeader:!0,selectionType:xd}))};function Hp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Np=vo("highlight/types"),jp=Np.register,Lp=Np.getItem;function Bp(e,t){return Lp(e)(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Hp(Object(source),!0).forEach((function(t){Dp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Hp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({type:e},t))}function Vp(e){return function(e){if(Array.isArray(e))return Fp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fp(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Wp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Up(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Wp(Object(source),!0).forEach((function(t){zp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Wp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function zp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}jp(Ed,ip),jp(Td,hp),jp(Ad,vp),jp(_d,kp),jp(Md,Tp),jp(xd,Ip);var Gp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.layerLevel=0,this.cell=Bp(Ad,t),this.fill=Bp(Md,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var t,n,o;return t=e,(n=[{key:"isEnabledFor",value:function(e,t){var n=e;e===Ad&&(n="current");var o=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var area,e=this.layerLevel;return this.areas.has(e)?area=this.areas.get(e):(area=Bp(Td,Up({layerLevel:e},this.options)),this.areas.set(e,area)),area}},{key:"getAreas",value:function(){return Vp(this.areas.values())}},{key:"createOrGetHeader",value:function(){var header,e=this.layerLevel;return this.headers.has(e)?header=this.headers.get(e):(header=Bp(xd,Up({},this.options)),this.headers.set(e,header)),header}},{key:"getHeaders",value:function(){return Vp(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var header,e=this.layerLevel;return this.activeHeaders.has(e)?header=this.activeHeaders.get(e):(header=Bp(Ed,Up({},this.options)),this.activeHeaders.set(e,header)),header}},{key:"getActiveHeaders",value:function(){return Vp(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Vp(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(Bp(_d,Up(Up({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),X(this.areas.values(),(function(e){e.clear()})),X(this.headers.values(),(function(e){e.clear()})),X(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(Vp(this.areas.values()),Vp(this.headers.values()),Vp(this.activeHeaders.values()),Vp(this.customSelections))[Symbol.iterator]()}}])&&Yp(t.prototype,n),o&&Yp(t,o),e}();function Kp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ranges=[]}var t,n,o;return t=e,(n=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(new Hd(e)),this}},{key:"add",value:function(e){return this.ranges.push(new Hd(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}])&&Kp(t.prototype,n),o&&Kp(t,o),e}();function Xp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qp=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.options=n}var t,n,o;return t=e,(n=[{key:"transformStart",value:function(e,t,n){var o=new Wn(e,t),r=this.range.current().highlight,l=this.options.visualToRenderableCoords(r),c=l.row,h=l.col,f=r,d=0,y=0;if(this.runLocalHooks("beforeTransformStart",o),null!==c&&null!==h){var v=this.options.countRows(),m=this.options.countCols(),w=this.options.fixedRowsBottom(),C=this.options.minSpareRows(),S=this.options.minSpareCols(),k=this.options.autoWrapRow(),R=this.options.autoWrapCol();c+e>v-1?n&&C>0&&!(w&&c>=v-w-1)?(this.runLocalHooks("insertRowRequire",v),v=this.options.countRows()):R&&(o.row=1-v,o.col=h+o.col===m-1?1-m:1):R&&c+o.row<0&&h+o.col>=0&&(o.row=v-1,o.col=h+o.col===0?m-1:-1),h+o.col>m-1?n&&S>0?(this.runLocalHooks("insertColRequire",m),m=this.options.countCols()):k&&(o.row=c+o.row===v-1?1-v:1,o.col=1-m):k&&h+o.col<0&&c+o.row>=0&&(o.row=c+o.row===0?v-1:-1,o.col=m-1);var O=new Wn(c+o.row,h+o.col);d=0,y=0,O.row<0?(d=-1,O.row=0):O.row>0&&O.row>=v&&(d=1,O.row=v-1),O.col<0?(y=-1,O.col=0):O.col>0&&O.col>=m&&(y=1,O.col=m-1),f=this.options.renderableToVisualCoords(O)}return this.runLocalHooks("afterTransformStart",f,d,y),f}},{key:"transformEnd",value:function(e,t){var n=new Wn(e,t),o=this.range.current(),r=o.to,l=0,c=0;this.runLocalHooks("beforeTransformEnd",n);var h=this.options.visualToRenderableCoords(o.highlight),f=h.row,d=h.col;if(null!==f&&null!==d){var y=this.options.countRows(),v=this.options.countCols(),m=this.options.visualToRenderableCoords(o.to),w=m.row,C=m.col,S=new Wn(w+n.row,C+n.col);l=0,c=0,S.row<0?(l=-1,S.row=0):S.row>0&&S.row>=y&&(l=1,S.row=y-1),S.col<0?(c=-1,S.col=0):S.col>0&&S.col>=v&&(c=1,S.col=v-1),r=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformEnd",r,l,c),r}}])&&Xp(t.prototype,n),o&&Xp(t,o),e}();ye(qp,Uu);var Zp=qp;function Qp(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Jp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jp(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ey(e){return(ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ty,ny=[3,2],oy=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],ry=Symbol("root"),iy=Symbol("child");function ay(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ry;if(t!==ry&&t!==iy)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),o=t===ry,r=0;if(n){var l=e[0];if(0===e.length)r=1;else if(o&&l instanceof Hd)r=3;else if(o&&Array.isArray(l))r=ay(l,iy);else if(e.length>=2&&e.length<=4){var c=!e.some((function(e,t){return!oy[t].includes(ey(e))}));c&&(r=2)}}return r}function ly(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,o=void 0!==n&&n,r=t.propToCol;if(!ny.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,l=n?t.from.row:t[0],c=n?t.from.col:t[1],h=n?t.to.row:t[2],f=n?t.to.col:t[3];if("function"==typeof r&&("string"==typeof c&&(c=r(c)),"string"==typeof f&&(f=r(f))),at(h)&&(h=l),at(f)&&(f=c),!o){var d=l,y=c,v=h,m=f;l=Math.min(d,v),c=Math.min(y,m),h=Math.max(d,v),f=Math.max(y,m)}return[l,c,h,f]}}function sy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}function uy(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return cy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cy(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cy(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function hy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fy=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new $p,this.highlight=new Gp({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return o.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return o.isCellCornerVisible.apply(o,arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible.apply(o,arguments)},visualToRenderableCoords:function(e){return o.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return o.tableProps.renderableToVisualCoords(e)}}),this.transformation=new Zp(this.selectedRange,{countRows:function(){return o.tableProps.countRowsTranslated()},countCols:function(){return o.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return o.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return o.tableProps.renderableToVisualCoords(e)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.runLocalHooks.apply(o,["insertColRequire"].concat(t))}))}var t,n,o;return t=e,(n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="multiple"===this.settings.selectionMode,r=at(t)?Od():t,l=e.row<0,c=e.col<0,h=l&&c;this.selectedByCorner=h,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),e),(!o||o&&!r&&at(t))&&this.selectedRange.clear(),this.selectedRange.add(e),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!h&&c&&this.selectedByRowHeader.add(this.getLayerLevel()),!h&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var t=this.selectedRange.current();"single"!==this.settings.selectionMode&&t.setTo(new Wn(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ad,t.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(t);var n=this.getLayerLevel();n<this.highlight.layerLevel&&(X(this.highlight.getAreas(),(function(e){e.clear()})),X(this.highlight.getHeaders(),(function(e){e.clear()})),X(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(n);var o=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),r.clear(),l.clear(),this.highlight.isEnabledFor(Td,t.highlight)&&(this.isMultiple()||n>=1)&&(o.add(t.from).add(t.to).commit(),1===n)){var c=this.selectedRange.previous();this.highlight.useLayerLevel(n-1).createOrGetArea().add(c.from).commit().adjustCoordinates(c),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(xd,t.highlight)){var h=0===this.tableProps.countRowsTranslated(),f=0===this.tableProps.countColsTranslated(),d=t;(h||f)&&(d=t.clone()),h&&(d.from.row=-1),f&&(d.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&d.from.normalize(),r.add(d.from).commit()):r.add(d.from).add(d.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===t.getWidth()&&l.add(new Wn(t.from.row,-1)).add(new Wn(t.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===t.getHeight()&&l.add(new Wn(-1,t.from.col)).add(new Wn(-1,t.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=ke(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t,n){this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),o=this.tableProps.countCols();if(e||t||0!==n&&0!==o){var r=new Wn(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(r),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new Wn(n-1,o-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=ay(e);if(1===n)return!1;if(0===n)throw new Error(et(ty||(ty=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var o=ly(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),r=this.tableProps.countRows(),l=this.tableProps.countCols(),c=!e.some((function(e){var t=uy(o(e),4),n=t[0],c=t[1],h=t[2],f=t[3];return!(sy(n,r)&&sy(c,l)&&sy(h,r)&&sy(f,l))}));return c&&(this.clear(),X(e,(function(e){var n=uy(o(e),4),r=n[0],l=n[1],c=n[2],h=n[3];t.setRangeStartOnly(new Wn(r,l),!1),t.setRangeEnd(new Wn(c,h)),t.finish()}))),c}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o="string"==typeof e?this.tableProps.propToCol(e):e,r="string"==typeof t?this.tableProps.propToCol(t):t,l=this.tableProps.countCols(),c=this.tableProps.countRows(),h=sy(o,l)&&sy(r,l);return h&&(this.setRangeStartOnly(new Wn(n,o)),this.setRangeEnd(new Wn(c-1,r)),this.finish()),h}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=this.tableProps.countRows(),r=this.tableProps.countCols(),l=sy(e,o)&&sy(t,o);return l&&(this.setRangeStartOnly(new Wn(e,n)),this.setRangeEnd(new Wn(t,r-1)),this.finish()),l}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().adjustCoordinates(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var o=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),r.commit(),l.commit()}this.highlight.useLayerLevel(t)}}}])&&hy(t.prototype,n),o&&hy(t,o),e}();ye(fy,Uu);var dy=fy;function py(e,t){var n="string"==typeof e?ku(e):e;if(ve(n)){var o=ve(t),r={};return be(n,(function(e,n){"CELL_TYPE"===n||o&&(!o||Re(t,n))||(r[n]=e)})),r}}function yy(e){return Number.isInteger(e)&&e>=0}function gy(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function vy(e){return null==e}function my(e){return(my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var by=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var col,t,n,meta;for(col=0,t=this.countCols();col<t;col++)if(!1===lt(n=this.getDataAtCell(e,col)))return"object"===my(n)&&(meta=this.getCellMeta(e,col),ge(this.getSchema()[meta.prop],n));return!0},isEmptyCol:function(col){var e,t;for(e=0,t=this.countRows();e<t;e++)if(!1===lt(this.getDataAtCell(e,col)))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0}};function wy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Cy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Sy=function(){function e(){Cy(this,e),this.metaCtor=function e(){Cy(this,e)},this.meta=this.metaCtor.prototype,he(this.meta,by())}var t,n,o;return t=e,(n=[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){he(this.meta,e),he(this.meta,py(e.type,e))}}])&&wy(t.prototype,n),o&&wy(t,o),e}();function ky(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ry=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.getMetaConstructor();this.meta=new n}var t,n,o;return t=e,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){he(this.meta,e),he(this.meta,py(e.type,e))}}])&&ky(t.prototype,n),o&&ky(t,o),e}();function Oy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ey=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}var t,n,o;return t=e,(n=[{key:"obtain",value:function(e){gy((function(){return yy(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=t,this.index[e]=o}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;gy((function(){return yy(e)||vy(e)}),"Expecting an unsigned number or null/undefined argument.");for(var o=[],r=this.data.length,i=0;i<n;i++)o.push(r+i),this.data.push(void 0);(t=this.index).splice.apply(t,[vy(e)?this.index.length:e,0].concat(o))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;gy((function(){return yy(e)||vy(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(vy(e)?this.index.length-t:e,t),i=0;i<n.length;i++){var o=n[i];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return K(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],i=0;i<this.data.length;i++){var t=this._getKeyByStorageIndex(i);-1!==t&&e.push([t,this.data[i]])}var n=0;return{next:function(){if(n<e.length){var t=e[n];return n+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:Symbol.iterator,value:function(){return this.entries()}}])&&Oy(t.prototype,n),o&&Oy(t,o),e}();function Ty(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ay=["data","width"],My=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalMeta=t,this.metas=new Ey((function(){return n._createMeta()}))}var t,n,o;return t=e,(n=[{key:"updateMeta",value:function(e,t){var meta=this.getMeta(e);he(meta,t),he(meta,py(t.type,meta))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}ce(n,e);for(var i=0;i<t.length;i++)n.prototype[t[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),Ay).prototype}}])&&Ty(t.prototype,n),o&&Ty(t,o),e}();function xy(e){return function(e){if(Array.isArray(e))return _y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Py(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Iy=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columnMeta=t,this.metas=new Ey((function(){return n._createRow()}))}var t,n,o;return t=e,(n=[{key:"updateMeta",value:function(e,t,n){var meta=this.getMeta(e,t);he(meta,n),he(meta,py(n.type,meta))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var o=this.metas.obtain(e).obtain(t);return void 0===n?o:o[n]}},{key:"setMeta",value:function(e,t,n,o){this.metas.obtain(e).obtain(t)[n]=o}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,xy(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){gy((function(){return yy(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new Ey((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}])&&Py(t.prototype,n),o&&Py(t,o),e}();function Hy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ny=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Hy(this,e),this.globalMeta=new Sy,this.globalMeta.updateMeta(t),this.tableMeta=new Ry(this.globalMeta),this.columnMeta=new My(this.globalMeta),this.cellMeta=new Iy(this.columnMeta)}var t,n,o;return t=e,(n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,o){this.cellMeta.setMeta(e,t,n,o)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}])&&Dy(t.prototype,n),o&&Dy(t,o),e}(),jy=(n(63),/^(\r\n|\n\r|\r|\n)/),Ly=/^[^\t\r\n]+/,By=/^\t/;function Vy(e){var t,n,o,r,l,c="";for(t=0,n=e.length;t<n;t+=1){for(r=e[t].length,o=0;o<r;o+=1)o>0&&(c+="\t"),"string"==typeof(l=e[t][o])?l.indexOf("\n")>-1?c+='"'.concat(l.replace(/"/g,'""'),'"'):c+=l:c+=null==l?"":l;t!==n-1&&(c+="\n")}return c}function Fy(e){return(Fy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Uy=Hu("copyable",!1),zy=function(){function e(t,data,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.dataSource=data,this.duckSchema=this.dataSource&&this.dataSource[0]?ue(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var t,n,o;return t=e,o=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],(n=[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,t=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,t){var n=0,o=0,r=!1;if("function"==typeof t){var l=Se(e);n=l>0?l:this.countFirstRowKeys(),r=!0}else{var c=this.tableMeta.maxCols;n=Math.min(c,t.length)}for(i=0;i<n;i++){var h=r?t(i):t[i];if(ve(h)){if(void 0!==h.data){var f=r?o:i;this.colToPropCache[f]=h.data,this.propToColCache.set(h.data,f)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Nu(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var o,r=this,l=t,c=n;return void 0===l&&(l=0,c=""),"object"!==Fy(e)||Array.isArray(e)||be(e,(function(e,t){null===e?(o=c+t,r.colToPropCache.push(o),r.propToColCache.set(o,l),l+=1):l=r.recursiveDuckColumns(e,l,"".concat(t,"."))})),l}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&it(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(it(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,o=this.instance.countSourceRows(),r=o,l=0,c=e;("number"!=typeof c||c>=o)&&(c=o),c<this.instance.countRows()&&(r=this.instance.toPhysicalRow(c));var h=this.instance.runHooks("beforeCreateRow",c,n,source);if(!1===h||null===r)return 0;for(var f=this.tableMeta.maxRows,d=this.instance.countCols(),y=[],v=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=de(t.getSchema()):(e=[],ur(d-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c+l):fe(e={},t.getSchema()),y.push(e),l+=1};l<n&&o+l<f;)v();return this.instance.rowIndexMapper.insertIndexes(c,l),this.spliceData.apply(this,[r,0].concat(y)),this.instance.runHooks("afterCreateRow",c,l,source),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.dataSource,o=this.tableMeta.maxCols,r=e;("number"!=typeof r||r>=this.instance.countSourceCols())&&(r=this.instance.countSourceCols());var l=this.instance.runHooks("beforeCreateCol",r,t,source);if(!1===l)return 0;var c=this.instance.countSourceCols();r<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(r));for(var h=this.instance.countSourceRows(),f=this.instance.countCols(),d=0,y=c;d<t&&f<o;){if("number"!=typeof r||r>=f)if(h>0)for(var v=0;v<h;v+=1)void 0===n[v]&&(n[v]=[]),n[v].push(null);else n.push([null]);else for(var m=0;m<h;m++)n[m].splice(y,0,null);d+=1,y+=1,f+=1}return this.instance.columnIndexMapper.insertIndexes(r,d),this.instance.runHooks("afterCreateCol",r,d,source),this.instance.forceFullRender=!0,d}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t,o=this.visualRowsToPhysical(n,t),r=this.instance.countSourceRows();n=(r+n)%r;var l=this.instance.runHooks("beforeRemoveRow",n,o.length,o,source);if(!1===l)return!1;var data=this.dataSource,c=o.length,h=this.filterData(n,c,o);if(h&&(data.length=0,Array.prototype.push.apply(data,h)),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var f=it(this.tableMeta.columns)||it(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===f&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",n,c,o,source),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof e?-t:e;n=(this.instance.countCols()+n)%this.instance.countCols();var o=this.visualColumnsToPhysical(n,t),r=o.slice(0).sort((function(a,b){return b-a})),l=this.instance.runHooks("beforeRemoveCol",n,t,o,source);if(!1===l)return!1;for(var c=!0,h=r.length,data=this.dataSource,f=0;f<h;f++)c&&o[0]!==o[f]-f&&(c=!1);if(c)for(var d=0,y=this.instance.countSourceRows();d<y;d++)data[d].splice(o[0],t);else for(var v=0,m=this.instance.countSourceRows();v<m;v++)for(var w=0;w<h;w++)data[v].splice(r[w],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,t,o,source),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(col,e,t){for(var n=this.instance.getDataAtCol(col),o=n.slice(e,e+t),r=n.slice(e+t),l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];z(c,r);for(var i=0;i<t;)c.push(null),i+=1;return U(c),this.instance.populateFromArray(e,col,c,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var o=this.instance.getSourceDataAtRow(e),r=o.slice(t,t+n),l=o.slice(t+n),c=arguments.length,h=new Array(c>3?c-3:0),f=3;f<c;f++)h[f-3]=arguments[f];z(h,l);for(var i=0;i<n;)h.push(null),i+=1;return this.instance.populateFromArray(e,t,[h],null,null,"spliceRow"),r}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];var l,c=this.instance.runHooks("beforeDataSplice",e,t,o);!1!==c&&(l=this.dataSource).splice.apply(l,[e,t].concat(o))}},{key:"filterData",value:function(e,t,n){if(!1!==this.instance.runHooks("beforeDataFilter",e,t,n))return this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),o=this.dataSource[n],r=this.instance.runHooks("modifyRowData",n),l=null;if((o=isNaN(r)?r:o)&&o.hasOwnProperty&&Re(o,t))l=o[t];else if("string"==typeof t&&t.indexOf(".")>-1){var c=t.split("."),h=o;if(!h)return null;for(var i=0,f=c.length;i<f;i++)if(void 0===(h=h[c[i]]))return null;l=h}else"function"==typeof t&&(l=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var d=ke(l);this.instance.runHooks("modifyData",n,this.propToCol(t),d,"get"),d.isTouched()&&(l=d.value)}return l}},{key:"getCopyable",value:function(e,t){return Uy.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var o=this.instance.toPhysicalRow(e),r=n,l=this.dataSource[o],c=this.instance.runHooks("modifyRowData",o);if(l=isNaN(c)?c:l,this.instance.hasHook("modifyData")){var h=ke(r);this.instance.runHooks("modifyData",o,this.propToCol(t),h,"set"),h.isTouched()&&(r=h.value)}if(l&&l.hasOwnProperty&&Re(l,t))l[t]=r;else if("string"==typeof t&&t.indexOf(".")>-1){var f,d=t.split("."),y=l,i=0;for(i=0,f=d.length-1;i<f;i++)void 0===y[d[i]]&&(y[d[i]]={}),y=y[d[i]];y[d[i]]=r}else"function"==typeof t?t(this.dataSource.slice(o,o+1)[0],r):l[t]=r}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,o=this.instance.countSourceRows(),r=[],l=(o+e)%o,c=t;l<o&&c;)n=this.instance.toPhysicalRow(l),r.push(n),c-=1,l+=1;return r}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),o=[],r=(n+e)%n,l=t;r<n&&l;){var col=this.instance.toPhysicalColumn(r);o.push(col),l-=1,r+=1}return o}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!=0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,o){var r,l,c,output=[],h=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(0===h||0===f)return[];var d=o===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(h-1,0),Math.max(t.row,n.row)),v=Math.min(Math.max(f-1,0),Math.max(t.col,n.col));for(r=Math.min(t.row,n.row);r<=y;r++){c=[];var m=r>=0?this.instance.toPhysicalRow(r):r;for(l=Math.min(t.col,n.col);l<=v&&null!==m;l++)c.push(d.call(this,r,this.colToProp(l)));null!==m&&output.push(c)}return output}},{key:"getText",value:function(t,n){return Vy(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return Vy(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}])&&Wy(t.prototype,n),o&&Wy(t,o),e}();function Yy(e){return(Yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gy(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||$y(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ky(e){return function(e){if(Array.isArray(e))return Xy(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $y(e,t){if(e){if("string"==typeof e)return Xy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xy(e,t):void 0}}function Xy(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var qy=null;function Zy(e,t){var n,o,r,l,c=this,h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=!1,d=this,y=new Po(d),v=!0;t.language=bd(t.language);var m=new Ny(t),w=m.getTableMeta(),C=m.getGlobalMeta(),S=Tr();au(h)&&iu(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0,kd(this.rootDocument),this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),lu(this)&&St(t.licenseKey,e),this.guid="ht_".concat(Ot()),this.columnIndexMapper=new Ah,this.rowIndexMapper=new Ah,o=new Fu(d),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var k=function(e){var t=e.row,n=e.col;return new Wn(t>=0?d.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?d.columnIndexMapper.getRenderableFromVisualIndex(n):n)},R=function(e){var t=e.row,n=e.col;return new Wn(t>=0?d.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?d.columnIndexMapper.getVisualFromRenderableIndex(n):n)},O=new dy(w,{countCols:function(){return d.countCols()},countRows:function(){return d.countRows()},propToCol:function(e){return n.propToCol(e)},isEditorOpened:function(){return!!d.getActiveEditor()&&d.getActiveEditor().isOpened()},countColsTranslated:function(){return c.view.countRenderableColumns()},countRowsTranslated:function(){return c.view.countRenderableRows()},visualToRenderableCoords:k,renderableToVisualCoords:R,isDisabledCellSelection:function(e,t){return d.getCellMeta(e,t).disableVisualSelection}});this.selection=O;var E=function(e){e.hiddenIndexesChanged&&c.selection.refresh()};function T(e){var t=Mh(e);vd(t)?(d.runHooks("beforeLanguageChange",t),C.language=t,d.runHooks("afterLanguageChange",t)):xh(e)}function A(e,t){var element="className"===e?d.rootElement:d.table;if(v)Yt(element,t);else{var n=[],o=[];C[e]&&(n=Array.isArray(C[e])?C[e]:ae(C[e])),t&&(o=Array.isArray(t)?t:ae(t));var r=oe(n,o),l=oe(o,n);r.length&&Gt(element,r),l.length&&Yt(element,l)}C[e]=t}function M(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function x(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function _(e,source,t){if(e.length){var o=d.getActiveEditor(),r=d.runHooks("beforeChange",e,source||"edit"),l=!0;if(!1!==r){var c,h=new M;h.onQueueEmpty=function(e){o&&l&&o.cancelChanges(),t(e)};for(var i=e.length-1;i>=0;i--)if(null===e[i])e.splice(i,1);else{var f=Gy(e[i],4),y=f[0],v=f[1],m=f[3],col=n.propToCol(v),C=d.getCellMeta(y,col);"numeric"===C.type&&"string"==typeof m&&((c=m).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(c))&&(e[i][3]=x(m)),d.getCellValidator(C)&&(h.addValidatorToQueue(),d.validateCell(e[i][3],C,function(t,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){l=!1,e.splice(t,1),n.valid=!0;var r=d.getCell(n.visualRow,n.visualCol);null!==r&&Gt(r,w.invalidCellClassName)}h.removeValidatorFormQueue()}}(i,C),source))}h.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function P(e,source){var i=e.length-1;if(!(i<0)){for(;i>=0;i--){var t=!1;if(null!==e[i]){if(null!==e[i][2]&&void 0!==e[i][2]||null!==e[i][3]&&void 0!==e[i][3]){if(w.allowInsertRow)for(;e[i][0]>d.countRows()-1;){var o=n.createRow(void 0,void 0,source);if(!(o>=1)){t=!0;break}m.createRow(null,o)}if("array"===d.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)for(;n.propToCol(e[i][1])>d.countCols()-1;){var c=n.createCol(void 0,void 0,source);if(!(c>=1)){t=!0;break}m.createColumn(null,c)}t||n.set(e[i][0],e[i][1],e[i][3])}}else e.splice(i,1)}d.forceFullRender=!0,r.adjustRowsAndCols(),d.runHooks("beforeChangeRender",e,source),l.lockEditor(),d._refreshBorders(null),l.unlockEditor(),d.view.adjustElementsSize(),d.runHooks("afterChange",e,source||"edit");var h=d.getActiveEditor();h&&it(h.refreshValue)&&h.refreshValue()}}function I(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",E),this.rowIndexMapper.addLocalHook("cacheUpdated",E),this.selection.addLocalHook("beforeSetRangeStart",(function(e){c.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){c.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){c.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=c.view.wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=c.view.wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=ke(!1),n=c.selection.getSelectedRange(),o=n.current(),r=o.from,l=o.to,h=n.size()-1;c.runHooks("afterSelection",r.row,r.col,l.row,l.col,t,h),c.runHooks("afterSelectionByProp",r.row,d.colToProp(r.col),l.row,d.colToProp(l.col),t,h);var y=c.selection.isSelectedByAnyHeader(),v=c.selection.selectedRange.current(),m=!0;f&&(m=!1),t.isTouched()&&(m=!t.value);var w=c.selection.isSelectedByRowHeader(),C=c.selection.isSelectedByColumnHeader();!1!==m&&(y?w?c.view.scrollViewportVertically(d.rowIndexMapper.getRenderableFromVisualIndex(e.row)):C&&c.view.scrollViewportHorizontally(d.columnIndexMapper.getRenderableFromVisualIndex(e.col)):v&&!c.selection.isMultiple()?c.view.scrollViewport(k(v.from)):c.view.scrollViewport(k(e))),w&&C?Yt(c.rootElement,["ht__selection--rows","ht__selection--columns"]):w?(Gt(c.rootElement,"ht__selection--columns"),Yt(c.rootElement,"ht__selection--rows")):C?(Gt(c.rootElement,"ht__selection--rows"),Yt(c.rootElement,"ht__selection--columns")):Gt(c.rootElement,["ht__selection--rows","ht__selection--columns"]),c._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],o=n.from,r=n.to;c.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,t),c.runHooks("afterSelectionEndByProp",o.row,d.colToProp(o.col),r.row,d.colToProp(r.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=c.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){c.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){c.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){c.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){c.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){l.destroyEditor(),c._refreshBorders(),Gt(c.rootElement,["ht__selection--rows","ht__selection--columns"]),c.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){c.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){c.alter("insert_col",e,1,"auto")})),r={alter:function(e,t){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,h=function(e){if(0===e.length)return[];var t=Ky(e);return t.sort((function(e,t){var n=Gy(e,1)[0],o=Gy(t,1)[0];return n===o?0:n>o?1:-1})),G(t,(function(e,t){var n=Gy(t,2),o=n[0],r=n[1],l=e[e.length-1],c=Gy(l,2),h=c[0]+c[1];if(o<=h){var f=Math.max(r-(h-o),0);l[1]+=f}else e.push([o,r]);return e}),[t[0]])};switch(e){case"insert_row":var f=d.countSourceRows();if(w.maxRows===f)return;if(t=it(t)?t:f,o=n.createRow(t,l,source)){m.createRow(d.toPhysicalRow(t),l);var y=O.selectedRange.current(),v=null==y?void 0:y.from,C=null==v?void 0:v.row;if(it(C)&&C>=t){var S=y.to,k=S.row,R=S.col,E=v.col;O.isSelectedByRowHeader()&&(E=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(new Wn(C+o,E),!0),O.setRangeEnd(new Wn(k+o,R))}else d._refreshBorders()}break;case"insert_col":if(o=n.createCol(t,l,source)){if(m.createColumn(d.toPhysicalColumn(t),l),Array.isArray(w.colHeaders)){var T=[t,0];T.length+=o,Array.prototype.splice.apply(w.colHeaders,T)}var A=O.selectedRange.current(),M=null==A?void 0:A.from,x=null==M?void 0:M.col;if(it(x)&&x>=t){var _=A.to,P=_.row,I=_.col,H=M.row;O.isSelectedByColumnHeader()&&(H=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(new Wn(H,x+o),!0),O.setRangeEnd(new Wn(P,I+o))}else d._refreshBorders()}break;case"remove_row":var D=function(e){var t=0;X(e,(function(e){var o=Gy(e,2),r=o[0],l=o[1],c=lt(r)?d.countRows()-1:Math.max(r-t,0);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),n.removeRow(r,l,source)){m.removeRow(d.toPhysicalRow(c),l);var h=d.countRows(),f=w.fixedRowsTop;f>=c+1&&(w.fixedRowsTop-=Math.min(l,f-c));var y=w.fixedRowsBottom;y&&c>=h-y&&(w.fixedRowsBottom-=Math.min(l,y)),t+=l}}))};Array.isArray(t)?D(h(t)):D([[t,l]]),r.adjustRowsAndCols(),d._refreshBorders();break;case"remove_col":var N=function(e){var t=0;X(e,(function(e){var o=Gy(e,2),r=o[0],l=o[1],c=lt(r)?d.countCols()-1:Math.max(r-t,0),h=d.toPhysicalColumn(c);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),n.removeCol(r,l,source)){m.removeColumn(h,l);var f=w.fixedColumnsLeft;f>=c+1&&(w.fixedColumnsLeft-=Math.min(l,f-c)),Array.isArray(w.colHeaders)&&(void 0===h&&(h=-1),w.colHeaders.splice(h,l)),t+=l}}))};Array.isArray(t)?N(h(t)):N([[t,l]]),r.adjustRowsAndCols(),d._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}c||r.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=w.minRows,o=w.minSpareRows,r=w.minCols,l=w.minSpareCols;if(t){var c=d.countRows();c<t&&n.createRow(c,t-c,"auto")}if(o){var h=d.countEmptyRows(!0);if(h<o){var f=o-h,y=Math.min(f,w.maxRows-d.countSourceRows());n.createRow(d.countRows(),y,"auto")}}(r||l)&&(e=d.countEmptyCols(!0));var v=d.countCols();if(r&&!w.columns&&v<r){var m=r-v;e+=m,n.createCol(v,m,"auto")}if(l&&!w.columns&&"array"===d.dataType&&e<l){v=d.countCols();var C=l-e,S=Math.min(C,w.maxCols-v);n.createCol(v,S,"auto")}var k=d.countRows(),R=d.countCols();0!==k&&0!==R||O.deselect(),O.isSelected()&&X(O.selectedRange,(function(e){var t=!1,n=e.from.row,o=e.from.col,r=e.to.row,l=e.to.col;n>k-1?(t=!0,r>(n=k-1)&&(r=n)):r>k-1&&(t=!0,n>(r=k-1)&&(n=r)),o>R-1?(t=!0,l>(o=R-1)&&(l=o)):l>R-1&&(t=!0,o>(l=R-1)&&(o=l)),t&&d.selectCell(n,o,r,l)})),d.view&&d.view.adjustElementsSize()},populateFromArray:function(e,input,t,source,n,o,r){var l,c,h,f,y,v,m,C,S=[],k={};if(0===(c=input.length))return!1;switch(n){case"shift_down":for(y=t?t.col-e.col+1:0,v=t?t.row-e.row+1:0,h=0,f=(input=Iu(input)).length,m=Math.max(f,y);h<m;h++)if(h<f){var R;for(l=0,c=input[h].length;l<v-c;l++)input[h].push(input[h][l%c]);input[h].unshift(e.col+h,e.row,0),(R=d).spliceCol.apply(R,Ky(input[h]))}else{var O;input[h%f][0]=e.col+h,(O=d).spliceCol.apply(O,Ky(input[h%f]))}break;case"shift_right":for(y=t?t.col-e.col+1:0,v=t?t.row-e.row+1:0,l=0,c=input.length,C=Math.max(c,v);l<C;l++)if(l<c){var E;for(h=0,f=input[l].length;h<y-f;h++)input[l].push(input[l][h%f]);input[l].unshift(e.row+l,e.col,0),(E=d).spliceRow.apply(E,Ky(input[l]))}else{var T;input[l%c][0]=e.row+l,(T=d).spliceRow.apply(T,Ky(input[l%c]))}break;case"overwrite":default:k.row=e.row,k.col=e.col;var A,M={row:t&&e?t.row-e.row+1:1,col:t&&e?t.col-e.col+1:1},x=0,_=0,P=!0,I=function(e){var col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=input[e%input.length];return null!==col?t[col%t.length]:t},H=input.length,D=t?t.row-e.row+1:0;for(c=t?D:Math.max(H,D),l=0;l<c&&!(t&&k.row>t.row&&D>H||!w.allowInsertRow&&k.row>d.countRows()-1||k.row>=w.maxRows);l++){var N=l-x,j=I(N).length,L=t?t.col-e.col+1:0;if(f=t?L:Math.max(j,L),k.col=e.col,A=d.getCellMeta(k.row,k.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!A.skipRowOnPaste){for(_=0,h=0;h<f&&!(t&&k.col>t.col&&L>j||!w.allowInsertColumn&&k.col>d.countCols()-1||k.col>=w.maxCols);h++)if(A=d.getCellMeta(k.row,k.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!A.skipColumnOnPaste)if(A.readOnly&&"UndoRedo.undo"!==source)k.col+=1;else{var B=h-_,V=I(N,B),F=d.getDataAtCell(k.row,k.col),W={row:N,col:B};if("Autofill.fill"===source){var U=d.runHooks("beforeAutofillInsidePopulate",W,o,input,r,{},M);U&&(V=at(U.value)?V:U.value)}if(null!==V&&"object"===Yy(V))if(Array.isArray(V)&&null===F&&(F=[]),null===F||"object"!==Yy(F))P=!1;else ge(ue(Array.isArray(F)?F:F[0]||F),ue(Array.isArray(V)?V:V[0]||V))?V=de(V):P=!1;else null!==F&&"object"===Yy(F)&&(P=!1);P&&S.push([k.row,k.col,V]),P=!0,k.col+=1}else _+=1,k.col+=1,f+=1;k.row+=1}else x+=1,k.row+=1,c+=1}d.setDataAtCell(S,null,null,source||"populateFromArray")}}},this.init=function(){o.setData(w.data),d.runHooks("beforeInit"),(Ve()||We())&&Yt(d.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new vu(this),l=Zo.getInstance(d,w,O),d.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===Yy(v)&&(d.runHooks("afterChange",v[0],v[1]),v=!1),d.runHooks("afterInit")},this.validateCell=function(e,t,n,source){var o,r=d.getCellValidator(t);function l(e){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(o&&!0!==t.hidden){var col=t.visualCol,r=t.visualRow,td=d.getCell(r,col,!0);if(td&&"TH"!==td.nodeName){var l=d.rowIndexMapper.getRenderableFromVisualIndex(r),c=d.columnIndexMapper.getRenderableFromVisualIndex(col);d.view.wt.wtSettings.settings.cellRenderer(l,c,td)}n(e)}else n(e)}st(r)&&(o=r,r=function(e,t){t(o.test(e))}),In(r)?(e=d.runHooks("beforeValidate",e,t.visualRow,t.prop,source),d._registerImmediate((function(){r.call(t,e,(function(n){d&&(n=d.runHooks("afterValidate",n,e,t.visualRow,t.prop,source),t.valid=n,l(n),d.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,source))}))}))):d._registerImmediate((function(){t.valid=!0,l(t.valid,!1)}))},this.setDataAtCell=function(e,t,r,source){var i,l,c,input=I(e,t,r),h=[],f=source;for(i=0,l=input.length;i<l;i++){if("object"!==Yy(input[i]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=input[i][1]>=this.countCols()?input[i][1]:n.colToProp(input[i][1]),h.push([input[i][0],c,o.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}f||"object"!==Yy(e)||(f=t),d.runHooks("afterSetDataAtCell",h,f),_(h,f,(function(){P(h,f)}))},this.setDataAtRowProp=function(e,t,n,source){var i,r,input=I(e,t,n),l=[],c=source;for(i=0,r=input.length;i<r;i++)l.push([input[i][0],input[i][1],o.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);c||"object"!==Yy(e)||(c=t),d.runHooks("afterSetDataAtRowProp",l,c),_(l,c,(function(){P(l,c)}))},this.listen=function(){d&&!d.isListening()&&(qy=d.guid,d.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(qy=null,d.runHooks("afterUnlisten"))},this.isListening=function(){return qy===d.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];d._refreshBorders(e,t)},this.populateFromArray=function(e,t,input,n,o,source,l,c,h){if("object"!==Yy(input)||"object"!==Yy(input[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"==typeof n?new Wn(n,o):null;return r.populateFromArray(new Wn(e,t),input,f,source,l,c,h)},this.spliceCol=function(e,t,o){for(var r,l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];return(r=n).spliceCol.apply(r,[e,t,o].concat(c))},this.spliceRow=function(e,t,o){for(var r,l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];return(r=n).spliceRow.apply(r,[e,t,o].concat(c))},this.getSelected=function(){if(O.isSelected())return $(O.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(source){var e=this;if(O.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var t=[];X(O.getSelectedRange(),(function(n){var o=n.getTopLeftCorner(),r=n.getBottomRightCorner();ur(o.row,r.row,(function(n){ur(o.col,r.col,(function(o){e.getCellMeta(n,o).readOnly||t.push([n,o,null])}))}))})),t.length>0&&this.setDataAtCell(t,source)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(l.lockEditor(),this._refreshBorders(null),l.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(d.view){var e=d.view.getLastSize(),t=e.width,n=e.height,o=d.rootElement.getBoundingClientRect(),r=o.width,l=o.height,c=r!==t||l!==n;!1===d.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:r,height:l},c)||((c||d.view.wt.wtOverlays.scrollableElement===d.rootWindow)&&(d.view.setLastSize(r,l),d.render()),d.runHooks("afterRefreshDimensions",{width:t,height:n},{width:r,height:l},c))}},this.loadData=function(data,source){if(Array.isArray(w.dataSchema)?d.dataType="array":In(w.dataSchema)?d.dataType="function":d.dataType="object",n&&n.destroy(),data=d.runHooks("beforeLoadData",data,v,source),n=new zy(d,data,w),"object"===Yy(data)&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error("loadData only accepts array of objects or array of arrays (".concat(Yy(data)," given)"));var e,t=n.getSchema();data=[];var l,c=0;for(c=0,l=w.startRows;c<l;c++)if("object"!==d.dataType&&"function"!==d.dataType||!w.dataSchema)if("array"===d.dataType)e=de(t[0]),data.push(e);else{e=[];for(var h=0,f=w.startCols;h<f;h++)e.push(null);data.push(e)}else e=de(t),data.push(e)}Array.isArray(data[0])&&(d.dataType="array"),w.data=data,n.dataSource=data,o.data=data,o.dataType=d.dataType,o.colToProp=n.colToProp.bind(n),o.propToCol=n.propToCol.bind(n),o.countCachedColumns=n.countCachedColumns.bind(n),m.clearCellsCache(),d.initIndexMappers(),r.adjustRowsAndCols(),d.runHooks("afterLoadData",data,v,source),v?v=[null,"loadData"]:(d.runHooks("afterChange",null,"loadData"),d.render())},this.initIndexMappers=function(){var e=w.columns,t=0;if(Array.isArray(e))t=e.length;else if(In(e))if("array"===d.dataType)for(var o=this.countSourceCols(),r=0;r<o;r+=1)e(r)&&(t+=1);else"object"!==d.dataType&&"function"!==d.dataType||(t=n.colToPropCache.length);else if(it(w.dataSchema)){var l=n.getSchema();t=Array.isArray(l)?l.length:Se(l)}else t=this.countSourceCols();this.columnIndexMapper.initToLength(t),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,o,r){return at(e)?n.getAll():n.getRange(new Wn(e,t),new Wn(o,r),n.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,o,r){return n.getCopyableText(new Wn(e,t),new Wn(o,r))},this.getCopyableData=function(e,t){return n.getCopyable(e,n.colToProp(t))},this.getSchema=function(){return n.getSchema()},this.updateSettings=function(e){var i,t,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=!1;if(it(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(it(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(it(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in e)"data"!==i&&("language"!==i?"className"===i?A("className",e.className):"tableClassName"===i&&d.table?(A("tableClassName",e.tableClassName),d.view.wt.wtOverlays.syncOverlayTableClassNames()):fo.getSingleton().isRegistered(i)||fo.getSingleton().isDeprecated(i)?(In(e[i])||Array.isArray(e[i]))&&(e[i].initialHook=!0,d.addHook(i,e[i])):!o&&Re(e,i)&&(C[i]=e[i]):T(e.language));void 0===e.data&&void 0===w.data?d.loadData(null,"updateSettings"):void 0!==e.data?d.loadData(e.data,"updateSettings"):void 0!==e.columns&&(n.createMap(),d.initIndexMappers());var h=d.countCols(),f=w.columns;if(f&&In(f)&&(c=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||m.clearCache(),h>0)for(i=0,t=0;i<h;i++){if(f){var y=c?f(i):f[t];y&&m.updateColumnMeta(t,y)}t+=1}it(e.cell)&&be(e.cell,(function(e){d.setCellMetaObject(e.row,e.col,e)})),d.runHooks("afterCellMetaReset");var S=d.rootElement.style.height;""!==S&&(S=parseInt(d.rootElement.style.height,10));var k=e.height;if(In(k)&&(k=k()),o){var R=d.rootElement.getAttribute("style");R&&d.rootElement.setAttribute("data-initialstyle",d.rootElement.getAttribute("style"))}if(null===k){var O=d.rootElement.getAttribute("data-initialstyle");O&&(O.indexOf("height")>-1||O.indexOf("overflow")>-1)?d.rootElement.setAttribute("style",O):(d.rootElement.style.height="",d.rootElement.style.overflow="")}else void 0!==k&&(d.rootElement.style.height=isNaN(k)?"".concat(k):"".concat(k,"px"),d.rootElement.style.overflow="hidden");if(void 0!==e.width){var E=e.width;In(E)&&(E=E()),d.rootElement.style.width=isNaN(E)?"".concat(E):"".concat(E,"px")}o||(d.view&&(d.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),d.view.wt.exportSettingsAsClassNames()),d.runHooks("afterUpdateSettings",e)),r.adjustRowsAndCols(),d.view&&!v&&(d.forceFullRender=!0,l.lockEditor(),d._refreshBorders(null),d.view.wt.wtOverlays.adjustElementsSize(),l.unlockEditor()),o||!d.view||""!==S&&""!==k&&void 0!==k||S===k||d.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=d.getSelectedLast();if(w.getValue){if(In(w.getValue))return w.getValue.call(d);if(e)return d.getData()[e[0][0]][w.getValue]}else if(e)return d.getDataAtCell(e[0],e[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,source,o){r.alter(e,t,n,source,o)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t,r=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;r=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===r||null===o?null:d.view.getCellAtCoords(new Wn(r,o),n)},this.getCoords=function(element){var e=this.view.wt.wtTable.getCoords(element);if(null===e)return null;var t=e.row,n=e.col,o=t,r=n;return t>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(t)),n>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(n)),new Wn(o,r)},this.colToProp=function(e){return n.colToProp(e)},this.propToCol=function(e){return n.propToCol(e)},this.toVisualRow=function(e){return c.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return c.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return c.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return c.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return n.get(e,n.colToProp(t))},this.getDataAtRowProp=function(e,t){return n.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,Ky(n.getRange(new Wn(0,e),new Wn(w.data.length-1,e),n.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,o=n.getRange(new Wn(0,n.propToCol(e)),new Wn(w.data.length-1,n.propToCol(e)),n.DESTINATION_RENDERER);return(t=[]).concat.apply(t,Ky(o))},this.getSourceData=function(e,t,n,r){return void 0===e?o.getData():o.getByRange(new Wn(e,t),new Wn(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?o.getData(!0):o.getByRange(new Wn(e,t),new Wn(n,r),!0)},this.getSourceDataAtCol=function(e){return o.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,source){var input=I(e,t,n),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&X(input,(function(e){var t=Gy(e,3),n=t[0],r=t[1],c=t[2];l.push([n,r,o.getAtCell(n,r),c])})),X(input,(function(e){var t=Gy(e,3),n=t[0],r=t[1],l=t[2];o.setAtCell(n,r,l)})),r&&this.runHooks("afterSetSourceDataAtCell",l,source),this.render();var c=d.getActiveEditor();c&&it(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return o.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return o.getAtCell(e,t)},this.getDataAtRow=function(e){return n.getRange(new Wn(e,0),new Wn(e,this.countCols()-1),n.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,o){var r=this,l=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,o],c=l[0],h=l[1],f=l[2],d=l[3],y=null,v=null;void 0===f&&(f=c),void 0===d&&(d=h);var m="mixed";return ur(Math.max(Math.min(c,f),0),Math.max(c,f),(function(e){var t=!0;return ur(Math.max(Math.min(h,d),0),Math.max(h,d),(function(n){var o=r.getCellMeta(e,n);return v=o.type,y?t=y===v:y=v,t})),m=t?v:"mixed",t})),m},this.removeCellMeta=function(e,t,n){var o=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],r=o[0],l=o[1],c=m.getCellMeta(r,l,n);!1!==d.runHooks("beforeRemoveCellMeta",e,t,n,c)&&(m.removeCellMeta(r,l,n),d.runHooks("afterRemoveCellMeta",e,t,n,c)),c=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length,r=new Array(o>2?o-2:0),l=2;l<o;l++)r[l-2]=arguments[l];if(r.length>0&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&m.removeRow(this.toPhysicalRow(e),n),r.length>0&&X(r.reverse(),(function(n){m.createRow(t.toPhysicalRow(e)),X(n,(function(n,o){return t.setCellMetaObject(e,o,n)}))}))},this.setCellMetaObject=function(e,t,n){var o=this;"object"===Yy(n)&&be(n,(function(n,r){o.setCellMeta(e,t,r,n)}))},this.setCellMeta=function(e,t,n,o){if(!1!==d.runHooks("beforeSetCellMeta",e,t,n,o)){var r=e,l=t;e<this.countRows()&&(r=this.toPhysicalRow(e)),t<this.countCols()&&(l=this.toPhysicalColumn(t)),m.setCellMeta(r,l,n,o),d.runHooks("afterSetCellMeta",e,t,n,o)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(e,t){var o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);null===o&&(o=e),null===r&&(r=t);var l=n.colToProp(t),c=m.getCellMeta(o,r);if(c.row=o,c.col=r,c.visualRow=e,c.visualCol=t,c.prop=l,c.instance=d,d.runHooks("beforeGetCellMeta",e,t,c),d.hasHook("beforeGetCellMeta")&&Re(c,"type")&&m.updateCellMeta(o,r,{type:c.type}),c.cells){var h=c.cells(o,r,l);h&&m.updateCellMeta(o,r,h)}return d.runHooks("afterGetCellMeta",e,t,c),c},this.getCellMetaAtRow=function(e){return m.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===d.dataType||w.columns)};var H=Hu("renderer");this.getCellRenderer=function(e,t){return Kr(H.call(this,e,t))},this.getCellEditor=Hu("editor");var D=Hu("validator");this.getCellValidator=function(e,t){var n=D.call(this,e,t);return"string"==typeof n&&(n=ei(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var o=new M;e&&(o.onQueueEmpty=e);for(var i=d.countRows()-1;i>=0;)if(void 0===t||-1!==t.indexOf(i)){for(var r=d.countCols()-1;r>=0;)void 0===n||-1!==n.indexOf(r)?(o.addValidatorToQueue(),d.validateCell(d.getDataAtCell(i,r),d.getCellMeta(i,r),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(o.valid=!1),o.removeValidatorFormQueue()}),"validateCells"),r-=1):r-=1;i-=1}else i-=1;o.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=w.rowHeaders,n=e;return void 0!==n&&(n=d.runHooks("modifyRowHeader",n)),void 0===n?(t=[],ur(d.countRows()-1,(function(i){t.push(d.getRowHeader(i))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:In(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(var i=0,e=d.countCols();i<e;i++)if(d.getColHeader(i))return!0;return!1},this.getColHeader=function(e){var t=d.runHooks("modifyColHeader",e),n=w.colHeaders;if(void 0===t){for(var o=[],r=d.countCols(),i=0;i<r;i++)o.push(d.getColHeader(i));n=o}else{var l=d.toPhysicalColumn(t),c=function(e){for(var t=[],n=d.countCols(),o=0;o<n;o++)In(w.columns)&&w.columns(o)&&t.push(o);return t[e]}(l);!1===w.colHeaders?n=null:w.columns&&In(w.columns)&&w.columns(c)&&w.columns(c).title?n=w.columns(c).title:w.columns&&w.columns[l]&&w.columns[l].title?n=w.columns[l].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[l]?n=w.colHeaders[l]:In(w.colHeaders)?n=w.colHeaders(l):w.colHeaders&&"string"!=typeof w.colHeaders&&"number"!=typeof w.colHeaders&&(n=Au(t))}return n},this._getColWidthFromSettings=function(col){var e;col>=0&&(e=d.getCellMeta(0,col).width);if(void 0!==e&&e!==w.width||(e=w.colWidths),null!=e){switch(Yy(e)){case"object":e=e[col];break;case"function":e=e(col)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(e){var t=d._getColWidthFromSettings(e);return void 0===(t=d.runHooks("modifyColWidth",t,e))&&(t=Xs.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=w.rowHeights;if(null!=t){switch(Yy(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=d._getRowHeightFromSettings(e);return t=d.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return o.countRows()},this.countSourceCols=function(){return o.countFirstRowKeys()},this.countRows=function(){return n.getLength()},this.countCols=function(){var e=w.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return d.view.wt.drawn?d.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return d.view.wt.drawn?d.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return d.view.wt.drawn?d.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return d.view.wt.drawn?d.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return cr(d.countRows()-1,(function(n){if(d.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d.countRows()<1)return 0;var t=0;return cr(d.countCols()-1,(function(n){if(d.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return w.isEmptyRow.call(d,e)},this.isEmptyCol=function(e){return w.isEmptyCol.call(d,e)},this.selectCell=function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!at(e)&&!at(t)&&this.selectCells([[e,t,n,o]],r,l)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(f=!0);var o=O.selectCells(e);return o&&n&&d.listen(),f=!1,o},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return O.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return O.selectRows(e,t)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();f=!0,O.selectAll(t,n),f=!1};var N=function(e,t){return e.getFirstNotHiddenIndex(t,1,!0)};function j(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!n,c=!o,h=e,f=t;if(r){var y=Number.isInteger(e),v=Number.isInteger(t),m=y?N(this.rowIndexMapper,e):void 0,w=v?N(this.columnIndexMapper,t):void 0;if(null===m||null===w)return!1;h=y?d.rowIndexMapper.getRenderableFromVisualIndex(m):void 0,f=v?d.columnIndexMapper.getRenderableFromVisualIndex(w):void 0}var C=Number.isInteger(h),S=Number.isInteger(f);return C&&S?d.view.scrollViewport(new Wn(h,f),l,o,n,c):C&&!1===S?d.view.scrollViewportVertically(h,l,n):!(!S||!1!==C)&&d.view.scrollViewportHorizontally(f,o,c)},this.destroy=function(){if(d._clearTimeouts(),d._clearImmediates(),d.view&&d.view.destroy(),o&&o.destroy(),o=null,m.clearCache(),Rd(),lu(d)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}$t(d.rootElement),y.destroy(),l&&l.destroy(),d.batchExecution((function(){d.rowIndexMapper.unregisterAll(),d.columnIndexMapper.unregisterAll(),S.getItems().forEach((function(e){Gy(e,2)[1].destroy()})),S.clear(),d.runHooks("afterDestroy")}),!0),fo.getSingleton().destroy(d),be(d,(function(e,t,n){In(e)?n[t]=j(t):"guid"!==t&&(n[t]=null)})),d.isDestroyed=!0,n&&n.destroy(),d.rowIndexMapper=null,d.columnIndexMapper=null,n=null,r=null,O=null,l=null,d=null},this.getActiveEditor=function(){return l.getActiveEditor()},this.getPlugin=function(e){var t=kt(e);return"UndoRedo"===t?this.undoRedo:S.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(e)},this.getInstance=function(){return d},this.addHook=function(e,t){fo.getSingleton().add(e,t,d)},this.hasHook=function(e){return fo.getSingleton().has(e,d)},this.addHookOnce=function(e,t){fo.getSingleton().once(e,t,d)},this.removeHook=function(e,t){fo.getSingleton().remove(e,t,d)},this.runHooks=function(e,t,n,o,r,l,c){return fo.getSingleton().run(d,e,t,n,o,r,l,c)},this.getTranslatedPhrase=function(e,t){return md(w.language,e,t)},this.toHTML=function(){return rr(c)},this.toTableElement=function(){var e=c.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",rr(c)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"==typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){X(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){X(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];l.destroyEditor(e),d.view.render(),t&&O.isSelected()&&l.prepareEditor()},Br().forEach((function(e){var t=Vr(e);S.addItem(e,new t(c))})),fo.getSingleton().run(d,"construct")}function Qy(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),n=function(element,e,t){element.addEventListener(e,t,!1)},o=function(element,e,t){element.removeEventListener(e,t,!1)},r=function(n){var o,r;n?/^[a-zA-Z \.,\\\/\|0-9]$/.test(n)||(n="."):n="",void 0!==text.textContent?text.textContent=e.value+n:text.data=e.value+n,span.style.fontSize=h(e).fontSize,span.style.fontFamily=h(e).fontFamily,span.style.whiteSpace="pre",body.appendChild(span),o=span.clientWidth+2,body.removeChild(span),e.style.height=t.minHeight+"px",t.minWidth>o?e.style.width=t.minWidth+"px":o>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=o+"px",r=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>r?e.style.height=t.minHeight+"px":t.maxHeight<r?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=r+"px"},l=function(){window.setTimeout(r,0)},c=function(o,c,h){e=o,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var o=parseInt(n.minHeight);isNaN(o)||(t.minHeight=o)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var r=parseInt(n.maxHeight);isNaN(r)||(t.maxHeight=r)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var c=parseInt(n.maxWidth);isNaN(c)||(t.maxWidth=c)}span.firstChild||(span.className="autoResize",span.style.display="inline-block",span.appendChild(text))}(c),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),h&&(n(e,"change",r),n(e,"cut",l),n(e,"paste",l),n(e,"drop",l),n(e,"keydown",l),n(e,"focus",r),n(e,"compositionstart",l),n(e,"compositionupdate",l),n(e,"compositionend",l)),r()};function h(element){return element.currentStyle||document.defaultView.getComputedStyle(element)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){o(e,"change",r),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",r),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)},resize:r}}function Jy(e){return(Jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tg(e,t,n){return(tg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=ag(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function ng(e,p){return(ng=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function og(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ag(e);if(t){var r=ag(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rg(this,n)}}function rg(e,t){return!t||"object"!==Jy(t)&&"function"!=typeof t?ig(e):t}function ig(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ag(e){return(ag=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lg="ht_editor_hidden",sg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ng(e,t)}(l,e);var t,n,o,r=og(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(ig(t)),t.autoResize=Qy(),t.TEXTAREA=void 0,t.textareaStyle=void 0,t.TEXTAREA_PARENT=void 0,t.textareaParentStyle=void 0,t.layerClass=void 0,t.createElements(),t.bindEvents(),t.hot.addHookOnce("afterDestroy",(function(){return t.destroy()})),t}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"text"}}],(n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)}))}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(e,col,t,td,n,o){var r=this.state;if(tg(ag(l.prototype),"prepare",this).call(this,e,col,t,td,n,o),!o.readOnly){this.refreshDimensions(!0);var c=o.allowInvalid,h=o.fragmentSelection;c&&(this.TEXTAREA.value=""),r!==zo.FINISHED&&this.hideEditableElement(),!h&&!Ve()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===zo.VIRGIN&&(this.TEXTAREA.value="",tg(ag(l.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),Cn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Yt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Yt(this.TEXTAREA_PARENT,"handsontableInputHolder"),zt(this.TEXTAREA_PARENT,this.layerClass)&&Gt(this.TEXTAREA_PARENT,this.layerClass),Yt(this.TEXTAREA_PARENT,lg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(je()||De())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",zt(this.TEXTAREA_PARENT,this.layerClass)&&Gt(this.TEXTAREA_PARENT,this.layerClass),Yt(this.TEXTAREA_PARENT,lg)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;ur(e.length-1,(function(n){if(zt(e[n],"handsontableEditor"))return t=!0,!1})),zt(this.TEXTAREA_PARENT,lg)&&Gt(this.TEXTAREA_PARENT,lg),t?(this.layerClass="ht_editor_visible",Yt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Yt(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===zo.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t,n=this.hot.view.wt,o=n.wtOverlays,r=n.wtViewport,l=en(this.TD),c=en(this.hot.rootElement),h=o.topOverlay.holder,f=o.leftOverlay.holder,d=h!==this.hot.rootWindow?h.scrollTop:0,y=f!==this.hot.rootWindow?f.scrollLeft:0,v=this.checkEditorSection(),m=["","left"].includes(v)?d:0,w=["","top","bottom"].includes(v)?y:0,C=l.top===c.top?0:1,S=this.TD.style.backgroundColor,k=l.top-c.top-C-m,R=l.left-c.left-1-w;switch(v){case"top":t=Tn(o.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Tn(o.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Tn(o.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Tn(o.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Tn(o.bottomOverlay.clone.wtTable.holder.parentNode)}var O=this.hot.hasColHeaders(),E=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),T=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),A=this.hot.rowIndexMapper.getRenderableIndexesLength(),M=A-this.hot.view.wt.getSetting("fixedRowsBottom");(O&&E<=0||E===M)&&(k+=1),T<=0&&(R+=1),t&&-1!==t?this.textareaParentStyle[t[0]]=t[1]:An(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(k,"px"),this.textareaParentStyle.left="".concat(R,"px"),this.showEditableElement();var x=r.rowsRenderCalculator.startPosition,_=r.columnsRenderCalculator.startPosition,P=o.leftOverlay.getScrollPosition(),I=o.topOverlay.getScrollPosition(),H=kn(this.hot.rootDocument),D=this.TD.offsetTop+x-I,N=this.TD.offsetLeft+_-P,j=pn(this.TD)-8,L=Rn(h)?H:0,B=On(f)?H:0,V=this.hot.view.maximumVisibleElementWidth(N)-9-L,F=this.TD.scrollHeight+1,W=Math.max(this.hot.view.maximumVisibleElementHeight(D)-B,23),U=cn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=U.fontSize,this.TEXTAREA.style.fontFamily=U.fontFamily,this.TEXTAREA.style.backgroundColor=S,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(F,W),maxHeight:W,minWidth:Math.min(j,V),maxWidth:V},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),Fe()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(e){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===this.TEXTAREA&&!Zn(e)){switch(e.keyCode){case Un.ARROW_RIGHT:case Un.ARROW_LEFT:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(e.keyCode)||qn(e));break;case Un.ARROW_UP:case Un.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(e.keyCode)||qn(e));break;case Un.ENTER:var n=this.hot.selection.isMultiple();if(t&&!n||e.altKey){if(this.isOpened()){var o=vn(this.TEXTAREA),r=this.getValue(),l="".concat(r.slice(0,o),"\n").concat(r.slice(o));this.setValue(l),Cn(this.TEXTAREA,o+1)}else this.beginEditing("".concat(this.originalValue,"\n"));qn(e)}e.preventDefault();break;case Un.BACKSPACE:case Un.DELETE:case Un.HOME:case Un.END:qn(e)}-1===[Un.ARROW_UP,Un.ARROW_RIGHT,Un.ARROW_DOWN,Un.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}}])&&eg(t.prototype,n),o&&eg(t,o),l}(Yo);function ug(e,t,n,col,o,r,l){var c=[],h=[];l.className&&Yt(t,l.className),l.readOnly&&c.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?c.push(l.invalidCellClassName):h.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&c.push(l.noWordWrapClassName),!r&&l.placeholder&&c.push(l.placeholderCellClassName),Gt(t,h),Yt(t,c)}ug.RENDERER_TYPE="base";function cg(e,t,n,col,o,r,l){ug.apply(this,[e,t,n,col,o,r,l]);var c=r;if(!c&&l.placeholder&&(c=l.placeholder),c=ot(c),e.getSettings().trimWhitespace&&(c=c.trim()),l.rendererTemplate){$t(t);var h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=l.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(n),t.appendChild(h)}else Qt(t,c)}cg.RENDERER_TYPE="text";var hg={CELL_TYPE:"text",editor:sg,renderer:cg};function fg(e,t){var n=new Zy(e,t||{},ru);return n.init(),n}Ru(hg),fg.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Zy(e,t,ru)},fg.packageName="handsontable",fg.buildDate="28/07/2021 09:12:07",fg.version="9.0.2",fg.languages={dictionaryKeys:k,getLanguageDictionary:gd,getLanguagesDictionaries:function(){return pd()},registerLanguageDictionary:yd,getTranslatedPhrase:md};var dg=fg;function pg(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return yg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yg(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yg(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function gg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var vg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var t,n,o;return t=e,(n=[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!=t){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),X(this.rows,(function(t){e(t.row,fn(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),X(this.columns,(function(t){e(t.col,hn(t.table))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){X(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),th=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,th),o.appendChild(th)),this.samples.forEach((function(r){X(r.strings,(function(r){var l=r.col,c=t.hot.getCellMeta(e,l);c.col=l,c.row=e;var h=t.hot.getCellRenderer(c),td=n.createElement("td");td.setAttribute("ghost-table",1),h(t.hot,td,e,l,t.hot.colToProp(l),r.value,c),o.appendChild(td)}))})),o}},{key:"appendColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var th=t.createElement("th");o.push([-1,th]),n.appendChild(th)}this.samples.forEach((function(e){X(e.strings,(function(e){var r=e.col,th=t.createElement("th");o.push([r,th]),n.appendChild(th)}))})),this.table.tHead.appendChild(n),X(o,(function(t){var n=pg(t,2),o=n[0],th=n[1];e.hot.view.appendColHeader(o,th)}))}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,o=n.createDocumentFragment();return this.samples.forEach((function(r){X(r.strings,(function(r){var l=r.row,c=t.hot.getCellMeta(l,e);c.col=e,c.row=l;var h=t.hot.getCellRenderer(c),td=n.createElement("td"),tr=n.createElement("tr");td.setAttribute("ghost-table",1),h(t.hot,td,l,e,t.hot.colToProp(e),r.value,c),tr.appendChild(td),o.appendChild(tr)}))})),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var col=this.hot.rootDocument.createElement("col");return col.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(e),"px"),col}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),table=t.createElement("table"),o=t.createElement("thead"),r=t.createElement("tbody"),l=t.createElement("colgroup"),tr=t.createElement("tr"),th=t.createElement("th");return this.isVertical()&&table.appendChild(l),this.isHorizontal()&&(tr.appendChild(th),o.appendChild(tr),table.style.tableLayout="auto",table.style.width="auto"),table.appendChild(o),this.isVertical()&&r.appendChild(tr),table.appendChild(r),Yt(table,e),n.appendChild(table),{fragment:n,table:table,tHead:o,tBody:r,colGroup:l,tr:tr,th:th}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),o=t.createElement("div"),r="htGhostTable htAutoSize ".concat(e.trim());return Yt(o,r),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}])&&gg(t.prototype,n),o&&gg(t,o),e}();function mg(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}function bg(e){return(bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sg(e,t,n){return(Sg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Eg(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function kg(e,p){return(kg=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Rg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Eg(e);if(t){var r=Eg(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Og(this,n)}}function Og(e,t){return!t||"object"!==bg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eg(e){return(Eg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kg(e,t)}(l,e);var t,n,o,r=Rg(l);function l(){return wg(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],(n=[{key:"open",value:function(){Sg(Eg(l.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Cn(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Sg(Eg(l.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,col,t,td,n,o){Sg(Eg(l.prototype),"prepare",this).call(this,e,col,t,td,n,o);var r=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&r.setValue(n),r.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&he(c,o.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||Sg(Eg(l.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){Sg(Eg(l.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}Sg(Eg(l.prototype),"finishEditing",this).call(this,e,t,n)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"onBeforeKeyDown",value:function(e){if(!Zn(e)){var t,n,o=this.htEditor.getInstance();if(e.keyCode===Un.ARROW_DOWN)if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)t=o.getSelectedLast()[0]+1;else if(!o.flipped){var r=o.countRows()-1;n=o.getSelectedLast()[0],t=Math.min(r,n+1)}}else t=0;else e.keyCode===Un.ARROW_UP&&(!o.getSelectedLast()&&o.flipped?t=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(n=o.getSelectedLast()[0],t=Math.max(0,n-1)):t=(n=o.getSelectedLast()[0])-1));void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length&&(e.preventDefault(),qn(e),this.hot.listen(),this.TEXTAREA.focus())),Sg(Eg(l.prototype),"onBeforeKeyDown",this).call(this,e)}}}])&&Cg(t.prototype,n),o&&Cg(t,o),l}(sg);function Ag(e){return(Ag="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xg(e,t,n){return(xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Dg(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function _g(e,p){return(_g=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Pg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Dg(e);if(t){var r=Dg(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ig(this,n)}}function Ig(e,t){return!t||"object"!==Ag(t)&&"function"!=typeof t?Hg(e):t}function Hg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dg(e){return(Dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ng=new WeakMap,jg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_g(e,t)}(l,e);var t,n,o,r=Pg(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).query=null,t.strippedChoices=[],t.rawChoices=[],Ng.set(Hg(t),{skipOne:!1,isMacOS:t.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),t}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],(n=[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return it(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){xg(Dg(l.prototype),"createElements",this).call(this),Yt(this.htContainer,"autocompleteEditor"),Yt(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=Ng.get(this);xg(Dg(l.prototype),"open",this).call(this);var n=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var r=kn();0===r&&t.isMacOS&&(r+=15),n.updateSettings({colWidths:o?[hn(this.TEXTAREA)-2]:void 0,width:o?hn(this.TEXTAREA)+r:void 0,renderer:function(t,n,o,col,r,l,c){cg(t,n,o,col,r,l,c);var h,f,d=e.cellProperties,y=d.filteringCaseSensitive,v=d.allowHtml,m=e.query,w=ot(l);w&&!v&&-1!==(h=!0===y?w.indexOf(m):w.toLowerCase().indexOf(m.toLowerCase()))&&(f=w.substr(h,m.length),w=w.replace(f,"<strong>".concat(f,"</strong>"))),n.innerHTML=w},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),xg(Dg(l.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){xg(Dg(l.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,source=this.cellProperties.source;this.query=e,"function"==typeof source?source.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(source)?(this.rawChoices=source,this.updateChoicesList(this.stripValuesIfNeeded(source))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=vn(this.TEXTAREA),n=mn(this.TEXTAREA),o=this.cellProperties.sortByRelevance,r=this.cellProperties.filter,c=null,h=null,f=e;o&&(c=l.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var d=Array.isArray(c)?c.length:0;if(!1===r)d&&(h=c[0]);else{for(var y=[],i=0,v=f.length;i<v&&!(o&&d<=i);i++)d?y.push(f[c[i]]):y.push(f[i]);h=0,f=y}this.strippedChoices=f,this.htEditor.loadData(Y([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(h),this.hot.listen(),Cn(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=en(this.TEXTAREA),t=fn(this.TEXTAREA),n=this.getDropdownHeight(),o=ln(this.hot.view.wt.wtTable.TABLE),r=o.scrollTop,l=fn(this.hot.view.wt.wtTable.THEAD),c={row:0,col:0};o!==this.hot.rootWindow&&(c=en(o));var h=e.top-c.top-l+r,f=o.scrollHeight-h-l-t,d=n>f&&h>f;return d?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:f,n),d}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n,o=0,i=0,r=0;do{o+=r=this.htEditor.getRowHeight(i)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,i+=1}while(o<e);n=o-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-n,"px")),this.setDropdownHeight(o-r)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+kn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=$(e,(function(e){return ot(e)}));return $(n,(function(e){return t?e:At(e)}))}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1,o=!1;return e===Un.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(o=!0),e===Un.ARROW_UP&&n>-1&&(o=!0),o}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=Ng.get(this);if(n.skipOne=!1,Yn(e.keyCode)||e.keyCode===Un.BACKSPACE||e.keyCode===Un.DELETE||e.keyCode===Un.INSERT){var o=0;if(e.keyCode===Un.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),o)}xg(Dg(l.prototype),"onBeforeKeyDown",this).call(this,e)}}])&&Mg(t.prototype,n),o&&Mg(t,o),l}(Tg);function Lg(e){return(Lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fg(e,p){return(Fg=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Wg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=zg(e);if(t){var r=zg(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ug(this,n)}}function Ug(e,t){return!t||"object"!==Lg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zg(e){return(zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}jg.sortByRelevance=function(e,t,n){var o,r,i,l,c=[],h=[],f=e.length,d=t.length;if(0===f){for(i=0;i<d;i++)h.push(i);return h}for(i=0;i<d;i++)r=At(ot(t[i])),-1!==(l=n?r.indexOf(e):r.toLowerCase().indexOf(e.toLowerCase()))&&(o=r.length-l-f,c.push({baseIndex:i,index:l,charsLeft:o,value:r}));for(c.sort((function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index){if(a.charsLeft<b.charsLeft)return-1;if(a.charsLeft>b.charsLeft)return 1}return 0})),i=0,d=c.length;i<d;i++)h.push(c[i].baseIndex);return h};var Yg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fg(e,t)}(l,e);var t,n,o,r=Wg(l);function l(){return Bg(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"checkbox"}}],(n=[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var n=this.TD.querySelector('input[type="checkbox"]');zt(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&Vg(t.prototype,n),o&&Vg(t,o),l}(Yo),Gg=n(662);function Kg(e){return(Kg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xg(e,t,n){return(Xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Jg(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function qg(e,p){return(qg=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Zg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Jg(e);if(t){var r=Jg(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Qg(this,n)}}function Qg(e,t){return!t||"object"!==Kg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jg(e){return(Jg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ev="date",tv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qg(e,t)}(l,e);var t,n,o,r=Zg(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).defaultDateFormat="DD/MM/YYYY",t.isCellEdited=!1,t.parentDestroyed=!1,t}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return ev}}],(n=[{key:"init",value:function(){var e=this;if("function"!=typeof Je)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Gg)throw new Error("You need to include Pikaday to your project.");Xg(Jg(l.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){Xg(Jg(l.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Yt(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.$datePicker=new Gg(this.getDatePickerConfig()),new Po(this).addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()})),this.hideDatepicker()}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,col,t,td,n,o){Xg(Jg(l.prototype),"prepare",this).call(this,e,col,t,td,n,o)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Xg(Jg(l.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e=this;this._opened=!1,this.instance._registerTimeout((function(){e.instance._refreshBorders()})),Xg(Jg(l.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),Xg(Jg(l.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){this.$datePicker.config(this.getDatePickerConfig());var t,n=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.$datePicker.config(),l=this.instance.view.isMouseDown(),c=!!e&&Gn(e.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+fn(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+n.left,"px"),this.$datePicker._onInputFocus=function(){},r.format=o,this.originalValue?(t=this.originalValue,Je(t,o,!0).isValid()&&this.$datePicker.setMoment(Je(t,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),c||l||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,r.defaultDate=t,Je(t,o,!0).isValid()&&this.$datePicker.setMoment(Je(t,o),!0),c||l||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&fe(n,this.cellProperties.datePickerConfig);var o=n.onSelect,r=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=Je(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),o&&o()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),r&&r()},n}}])&&$g(t.prototype,n),o&&$g(t,o),l}(sg);function nv(e){return(nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ov(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function iv(e,t,n){return(iv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=uv(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function av(e,p){return(av=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function lv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=uv(e);if(t){var r=uv(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return sv(this,n)}}function sv(e,t){return!t||"object"!==nv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uv(e){return(uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&av(e,t)}(l,e);var t,n,o,r=lv(l);function l(){return ov(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],(n=[{key:"prepare",value:function(e,col,t,td,n,o){iv(uv(l.prototype),"prepare",this).call(this,e,col,t,td,n,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&rv(t.prototype,n),o&&rv(t,o),l}(jg);function hv(e){return(hv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pv(e,p){return(pv=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function yv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=vv(e);if(t){var r=vv(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return gv(this,n)}}function gv(e,t){return!t||"object"!==hv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vv(e){return(vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().add("beforeValidate",(function(e,t,col){var n=this.getCellMeta(t,this.propToCol(col));n.editor===cv&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));var mv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pv(e,t)}(l,e);var t,n,o,r=yv(l);function l(){return fv(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"numeric"}}],(n=null)&&dv(t.prototype,n),o&&dv(t,o),l}(sg);function bv(e){return(bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sv(e,t,n){return(Sv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Ev(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function kv(e,p){return(kv=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Rv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ev(e);if(t){var r=Ev(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ov(this,n)}}function Ov(e,t){return!t||"object"!==bv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ev(e){return(Ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kv(e,t)}(l,e);var t,n,o,r=Rv(l);function l(){return wv(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"password"}}],(n=[{key:"createElements",value:function(){Sv(Ev(l.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,$t(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&Cv(t.prototype,n),o&&Cv(t,o),l}(sg);function Av(e){return(Av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _v(e,t,n){return(_v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Dv(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Pv(e,p){return(Pv=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Iv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Dv(e);if(t){var r=Dv(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Hv(this,n)}}function Hv(e,t){return!t||"object"!==Av(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dv(e){return(Dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nv="ht_editor_visible",jv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pv(e,t)}(l,e);var t,n,o,r=Iv(l);function l(){return Mv(this,l),r.apply(this,arguments)}return t=l,o=[{key:"EDITOR_TYPE",get:function(){return"select"}}],(n=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Yt(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){var e=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()}))}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",zt(this.select,Nv)&&Gt(this.select,Nv),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,col,t,td,n,o){var r=this;_v(Dv(l.prototype),"prepare",this).call(this,e,col,t,td,n,o);var c,h=this.cellProperties.selectOptions;c="function"==typeof h?this.prepareOptions(h(this.row,this.col,this.prop)):this.prepareOptions(h),$t(this.select),be(c,(function(e,t){var n=r.hot.rootDocument.createElement("OPTION");n.value=t,Zt(n,e),r.select.appendChild(n)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var i=0,n=e.length;i<n;i++)t[e[i]]=e[i];else"object"===Av(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===zo.EDITING)if(this.TD=this.getEditedCell(),this.TD){var e,t=this.hot.view.wt.wtOverlays,n=en(this.TD),o=en(this.hot.rootElement),r=t.scrollableElement,l=this.checkEditorSection(),c=hn(this.TD)+1,h=fn(this.TD)+1,f=n.top-o.top-1-(r.scrollTop||0),d=n.left-o.left-1-(r.scrollLeft||0);switch(l){case"top":e=Tn(t.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=Tn(t.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=Tn(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=Tn(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=Tn(t.bottomOverlay.clone.wtTable.holder.parentNode)}var y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),v=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),m=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view.wt.getSetting("fixedRowsBottom");(y<=0||y===m)&&(f+=1),v<=0&&(d+=1);var w=this.select.style;e&&-1!==e?w[e[0]]=e[1]:An(this.select);var C=cn(this.TD,this.hot.rootWindow);parseInt(C.borderTopWidth,10)>0&&(h-=1),parseInt(C.borderLeftWidth,10)>0&&(c-=1),w.height="".concat(h,"px"),w.minWidth="".concat(c,"px"),w.top="".concat(f,"px"),w.left="".concat(d,"px"),w.margin="0px",Yt(this.select,Nv)}else this.close()}},{key:"onBeforeKeyDown",value:function(){var e=this.select.selectedIndex-1,t=this.select.selectedIndex+1;switch(event.keyCode){case Un.ARROW_UP:e>=0&&(this.select[e].selected=!0),qn(event),event.preventDefault();break;case Un.ARROW_DOWN:t<=this.select.length-1&&(this.select[t].selected=!0),qn(event),event.preventDefault()}}}])&&xv(t.prototype,n),o&&xv(t,o),l}(Yo);function Lv(e,t,n,col,o,r,l){ug.apply(this,[e,t,n,col,o,r,l]),Zt(t,null==r?"":r,!1)}Lv.RENDERER_TYPE="html";function Bv(e,t,n,col,o,r,l){var c=e.rootDocument,h=l.allowHtml?Lv:cg,f=c.createElement("DIV");if(f.className="htAutocompleteArrow",f.appendChild(c.createTextNode(String.fromCharCode(9660))),h.apply(this,[e,t,n,col,o,r,l]),t.firstChild||t.appendChild(c.createTextNode(String.fromCharCode(160))),t.insertBefore(f,t.firstChild),Yt(t,"htAutocomplete"),!e.acArrowListener){var d=new Po(e);e.acArrowListener=function(o){zt(o.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new Wn(n,col),t)},d.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){d.destroy()}))}}Bv.RENDERER_TYPE="autocomplete";var Vv=new WeakMap,Fv=new WeakMap,Wv="data-row",Uv="data-col",zv="checkbox";function Yv(e,t,n,col,o,r,l){var c=e.rootDocument;ug.apply(this,[e,t,n,col,o,r,l]),function(e){var t=Fv.get(e);if(!t){var n=e.rootElement;(t=new Po(e)).addEventListener(n,"click",(function(t){return function(e,t){var n=e.target;if(!Gv(n))return;if(!n.hasAttribute(Wv)||!n.hasAttribute(Uv))return;var o=parseInt(n.getAttribute(Wv),10),col=parseInt(n.getAttribute(Uv),10);t.getCellMeta(o,col).readOnly&&e.preventDefault()}(t,e)})),t.addEventListener(n,"mouseup",(function(t){return function(e,t){var n=e.target;if(!Gv(n))return;if(!n.hasAttribute(Wv)||!n.hasAttribute(Uv))return;setTimeout(t.listen,10)}(t,e)})),t.addEventListener(n,"change",(function(t){return function(e,t){var n=e.target;if(!Gv(n))return;if(!n.hasAttribute(Wv)||!n.hasAttribute(Uv))return;var o=parseInt(n.getAttribute(Wv),10),col=parseInt(n.getAttribute(Uv),10),r=t.getCellMeta(o,col);if(!r.readOnly){var l=null;l=e.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,t.setDataAtCell(o,col,l)}}(t,e)})),Fv.set(e,t)}}(e);var input=function(e){var input=e.createElement("input");return input.className="htCheckboxRendererInput",input.type="checkbox",input.setAttribute("autocomplete","off"),input.setAttribute("tabindex","-1"),input.cloneNode(!1)}(c),h=l.label,f=!1;if(void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1),$t(t),r===l.checkedTemplate||Rt(r,l.checkedTemplate)?input.checked=!0:r===l.uncheckedTemplate||Rt(r,l.uncheckedTemplate)?input.checked=!1:lt(r)?Yt(input,"noValue"):(input.style.display="none",Yt(input,"htBadValue"),f=!0),input.setAttribute(Wv,n),input.setAttribute(Uv,col),!f&&h){var d="";if(h.value)d="function"==typeof h.value?h.value.call(this,n,col,o,r):h.value;else if(h.property){var y=e.getDataAtRowProp(n,h.property);d=null!==y?y:""}var label=function(e,text,t){var label=e.createElement("label");return label.className="htCheckboxRendererLabel ".concat(t?"fullWidth":""),label.appendChild(e.createTextNode(text)),label.cloneNode(!0)}(c,d,!0!==h.separated);"before"===h.position?h.separated?(t.appendChild(label),t.appendChild(input)):(label.appendChild(input),input=label):h.position&&"after"!==h.position||(h.separated?(t.appendChild(input),t.appendChild(label)):(label.insertBefore(input,label.firstChild),input=label))}function v(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n)for(var o=0;o<n.length;o++){for(var r=n[o].getTopLeftCorner(),l=r.row,c=r.col,h=n[o].getBottomRightCorner(),f=h.row,d=h.col,y=[],v=l;v<=f;v+=1)for(var m=c;m<=d;m+=1){var w=e.getCellMeta(v,m);if("checkbox"!==w.type)return;if(!0!==w.readOnly){void 0===w.checkedTemplate&&(w.checkedTemplate=!0),void 0===w.uncheckedTemplate&&(w.uncheckedTemplate=!1);var C=e.getDataAtCell(v,m);!1===t?[w.checkedTemplate,w.checkedTemplate.toString()].includes(C)?y.push([v,m,w.uncheckedTemplate]):[w.uncheckedTemplate,w.uncheckedTemplate.toString(),null,void 0].includes(C)&&y.push([v,m,w.checkedTemplate]):y.push([v,m,w.uncheckedTemplate])}}y.length>0&&e.setDataAtCell(y)}}(!h||h&&!h.separated)&&t.appendChild(input),f&&t.appendChild(c.createTextNode("#bad-value#")),Vv.has(e)||(Vv.set(e,!0),e.addHook("beforeKeyDown",(function(t){var n="SPACE|ENTER",o="DELETE|BACKSPACE",r=Ln(Xn,t.keyCode);if(!e.getSettings().enterBeginsEditing&&r("ENTER"))return;r("".concat(n,"|").concat(o))&&!Zn(t)&&function(t){var n=e.getSelectedRange();if(!n)return;for(var o=0;o<n.length;o++)for(var r=n[o].getTopLeftCorner(),l=n[o].getBottomRightCorner(),c=r.row;c<=l.row;c++)for(var h=r.col;h<=l.col;h++){var f=e.getCellMeta(c,h);if("checkbox"!==f.type)return;var d=e.getCell(c,h);if(null==d)t(c,h,f);else{var y=d.querySelectorAll("input[type=checkbox]");y.length>0&&!f.readOnly&&t(y)}}}((function(){qn(t),t.preventDefault()}));r(n)&&v();r(o)&&v(!0)})))}function Gv(element){return"INPUT"===element.tagName&&"checkbox"===element.getAttribute("type")}fo.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){var label=t.label,o=t.type,r=t.row,l=t.column,c=t.prop;if(o===zv){if(label){var h=label.value,f=label.property,d=n;if(h)d="function"==typeof h?h(r,l,c,n):h;else if(f){var y=this.getDataAtRowProp(r,f);d=null!==y?y:n}e=d}return e}})),Yv.RENDERER_TYPE=zv;var Kv=n(663);function $v(e,t,n,col,o,r,l){var c=r;if(sr(c)){var h=l.numericFormat,f=h&&h.culture||"-",d=h&&h.pattern,y=l.className||"",v=y.length?y.split(" "):[];if(void 0!==f&&!Kv.languages()[f]){var m=f.replace("-",""),w=Kv.allLanguages?Kv.allLanguages[f]:Kv[m];w&&Kv.registerLanguage(w)}Kv.setLanguage(f),c=Kv(c).format(d||"0"),v.indexOf("htLeft")<0&&v.indexOf("htCenter")<0&&v.indexOf("htRight")<0&&v.indexOf("htJustify")<0&&v.push("htRight"),v.indexOf("htNumeric")<0&&v.push("htNumeric"),l.className=v.join(" ")}cg(e,t,n,col,o,c,l)}$v.RENDERER_TYPE="numeric";function Xv(e,t,n,col,o,r,l){cg.apply(this,[e,t,n,col,o,r,l]);var c=l.hashLength||t.innerHTML.length,h=l.hashSymbol||"*",f="";ur(c-1,(function(){f+=h})),Zt(t,f)}Xv.RENDERER_TYPE="password";function qv(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,Zv(n,t)):Zv(n,t)(this.source):t(!0)}function Zv(e,t){var n=e;return function(source){for(var e=!1,s=0,o=source.length;s<o;s++)if(n===source[s]){e=!0;break}t(e)}}qv.VALIDATOR_TYPE="autocomplete";n(199);function Qv(e,t){var n=Oo(ev,this.instance),o=e,r=!0;null==o&&(o="");var l=Je(o,this.dateFormat||n.defaultDateFormat,!0).isValid(),c=Je(new Date(o)).isValid()||l;if(this.allowEmpty&&""===o&&(c=!0,l=!0),c||(r=!1),!c&&l&&(r=!0),c&&!l)if(!0===this.correctFormat){var h=function(e,t){var n,o=Je(mg(e)),r=Je(e,t),l=e.search(/[A-z]/g)>-1;n=o.isValid()&&o.format("x")===r.format("x")||!r.isValid()||l?o:r;return n.format(t)}(o,this.dateFormat),f=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,d,h,"dateValidator"),r=!0}else r=!1;t(r)}Qv.VALIDATOR_TYPE="date";function Jv(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&sr(e))}Jv.VALIDATOR_TYPE="numeric";var tm=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function nm(e,t){var n=this.timeFormat||"h:mm:ss a",o=!0,r=e;null===r&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;var l=/^\d{1,2}$/.test(r);l&&(r+=":00");var c=Je(r,tm,!0).isValid()?Je(r):Je(r,n),h=c.isValid(),f=Je(r,n,!0).isValid()&&!l;if(this.allowEmpty&&""===r&&(h=!0,f=!0),h||(o=!1),!h&&f&&(o=!0),h&&!f)if(!0===this.correctFormat){var d=c.format(n),y=this.instance.toVisualRow(this.row),v=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(y,v,d,"timeValidator"),o=!0}else o=!1;t(o)}nm.VALIDATOR_TYPE="time";var om={CELL_TYPE:"autocomplete",editor:jg,renderer:Bv,validator:qv},rm={CELL_TYPE:"checkbox",editor:Yg,renderer:Yv},im={CELL_TYPE:"date",editor:tv,renderer:Bv,validator:Qv},am={CELL_TYPE:"dropdown",editor:cv,renderer:Bv,validator:qv},lm={CELL_TYPE:"handsontable",editor:Tg,renderer:Bv},sm={CELL_TYPE:"numeric",editor:mv,renderer:$v,validator:Jv,dataType:"number"},um={CELL_TYPE:"password",editor:Tv,renderer:Xv,copyable:!1},cm={CELL_TYPE:"time",editor:sg,renderer:cg,validator:nm};function hm(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return fm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fm(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function dm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pm=new Map([["plugin",function(e){return!!Vr(e)}],["cell-type",Cu],["editor",So],["renderer",Yr],["validator",Qr]]),ym=new WeakMap,gm=[],vm=null,mm=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),me(this,"hot",t,{writable:!1}),ym.set(this,{hooks:{}}),vm=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var t,n,o;return t=e,o=[{key:"PLUGIN_KEY",get:function(){return"base"}}],(n=[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var o=[];if(n.forEach((function(e){var t=hm(e.split(":"),2),n=t[0],r=t[1];if(!pm.has(n))throw new Error('Unknown plugin dependency type "'.concat(n,'" was found.'));pm.get(n)(r)||o.push(" - ".concat(r," (").concat(n,")"))})),o.length>0){var r=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(o.join("\n"),"\n")].join("");gm.push(r)}}if(vm||(vm=Br()),vm.indexOf("UndoRedo")>=0&&vm.splice(vm.indexOf("UndoRedo"),1),vm.indexOf(this.pluginName)>=0&&vm.splice(vm.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()})),0===vm.length){if(gm.length>0){var l=["".concat(gm.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){ym.get(this).hooks[e]=ym.get(this).hooks[e]||[];var n=ym.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),ym.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;X(ym.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=ym.get(this).hooks;be(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){X(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),be(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}])&&dm(t.prototype,n),o&&dm(t,o),e}();function bm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var wm=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}var t,n,o;return t=e,o=[{key:"SAMPLE_COUNT",get:function(){return 3}}],(n=[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var o=this,r=new Map,l="number"==typeof n?{from:n,to:n}:n;return ur(l.from,l.to,(function(n){var l=o.generateSample(e,t,n);r.set(n,l)})),r}},{key:"generateSample",value:function(e,t,n){var o=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var r=new Map,l="row"===e?"col":"row",c=[];return ur(t.from,t.to,(function(t){var h,f="row"===e?o.dataFactory(n,t):o.dataFactory(t,n),d=f.value,y=f.bundleSeed,v="string"==typeof y&&y.length>0;h=v?y:ve(d)?"".concat(Object.keys(d).length):Array.isArray(d)?"".concat(d.length):"".concat(ot(d).length),r.has(h)||r.set(h,{needed:o.getSampleCount(),strings:[]});var m=r.get(h);m.needed&&(!(c.indexOf(d)>-1)||o.allowDuplicates||v)&&(m.strings.push(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({value:d},l,t)),c.push(d),m.needed-=1)})),r}}])&&bm(t.prototype,n),o&&bm(t,o),e}();function Cm(e){return(Cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sm(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return km(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return km(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function km(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Rm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Om(e,t,n){return(Om="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=xm(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Em(e,p){return(Em=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Tm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=xm(e);if(t){var r=xm(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Am(this,n)}}function Am(e,t){return!t||"object"!==Cm(t)&&"function"!=typeof t?Mm(e):t}function Mm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xm(e){return(xm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("modifyAutoColumnSizeSeed");var _m="autoColumnSize",Pm=new WeakMap,Im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Em(e,t)}(l,e);var t,n,o,r=Tm(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e),Pm.set(Mm(t),{cachedColumnHeaders:[]}),t.ghostTable=new vg(t.hot),t.samplesGenerator=new wm((function(e,n){var o=t.hot.getCellMeta(e,n),r="";o.spanned||(r=t.hot.getDataAtCell(e,n));var l="";return t.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=t.hot.runHooks("modifyAutoColumnSizeSeed",l,o,r)),{value:r,bundleSeed:l}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredColumns=0,t.columnWidthsMap=new bc,t.hot.columnIndexMapper.registerMap("autoColumnSize",t.columnWidthsMap),t.addHook("beforeColumnResize",(function(e,n,o){return t.onBeforeColumnResize(e,n,o)})),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return _m}},{key:"PLUGIN_PRIORITY",get:function(){return 10}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}],(n=[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("afterFormulasValuesUpdate",(function(t){return e.onAfterFormulasValuesUpdate(t)})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyColWidth",(function(t,col){return e.getColumnWidth(col,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),Om(xm(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),Om(xm(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;Om(xm(l.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,n,o){return e.onBeforeColumnResize(t,n,o)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var e=this.hot.renderCall,t=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==t&&-1!==n&&this.calculateColumnsWidth({from:t,to:n},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,l="number"==typeof n?{from:n,to:n}:n;ur(r.from,r.to,(function(t){var n=e.hot.toPhysicalColumn(t);null===n&&(n=t),(o||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n))&&X(e.samplesGenerator.generateColumnSamples(t,l),(function(t){var n=Sm(t,2),o=n[0],r=n[1];return e.ghostTable.addColumn(o,r)}))})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){e.ghostTable.getWidths((function(t,n){var o=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(o,n)}))}),!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,o=this.hot.countCols()-1,r=null;this.inProgress=!0;var c=function c(){if(!e.hot)return L(r),void(e.inProgress=!1);e.calculateColumnsWidth({from:n,to:Math.min(n+l.CALCULATION_STEP,o)},t),(n=n+l.CALCULATION_STEP+1)<o?r=H(c):(L(r),e.inProgress=!1,e.hot.view.adjustElementsSize())},h=this.getSyncCalculationLimit();this.firstCalculation&&h>=0&&(this.calculateColumnsWidth({from:0,to:h},t),this.firstCalculation=!1,n=h+1),n<o?c():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&Re(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Re(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoColumnSize,t=l.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return ve(e)&&(Et(t=e.syncLimit)?t=fr(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=t;return void 0===o&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof o&&(o=Math.max(o,Xs.DEFAULT_WIDTH))),o}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=Pm.get(this).cachedColumnHeaders;return G(e,(function(e,n,o){var r=t.length;return(r-1<o||t[o]!==n)&&e.push(o),r-1<o?t.push(n):t[o]=n,e}),[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((function(){X(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!K(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=$(e,(function(e){var n=Sm(e,2)[1];return t.hot.toPhysicalColumn(t.hot.propToCol(n))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var o=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),o=this.getColumnWidth(t,void 0,!1)),o}},{key:"onAfterInit",value:function(){Pm.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(e){var t=$(K(e,(function(e){var t;return it(null===(t=e.address)||void 0===t?void 0:t.col)})),(function(e){return e.address.col}));this.clearCache(Array.from(new Set(t)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Om(xm(l.prototype),"destroy",this).call(this)}}])&&Rm(t.prototype,n),o&&Rm(t,o),l}(mm),Hm={horizontal:"horizontal",vertical:"vertical"};function Dm(e){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nm(e){return function(e){if(Array.isArray(e))return Bm(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Lm(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jm(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||Lm(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lm(e,t){if(e){if("string"==typeof e)return Bm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bm(e,t):void 0}}function Bm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Vm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fm(e,t,n){return(Fm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Gm(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Wm(e,p){return(Wm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Um(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Gm(e);if(t){var r=Gm(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return zm(this,n)}}function zm(e,t){return!t||"object"!==Dm(t)&&"function"!=typeof t?Ym(e):t}function Ym(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gm(e){return(Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("modifyAutofillRange"),fo.getSingleton().register("beforeAutofill"),fo.getSingleton().register("afterAutofill");var Km=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wm(e,t)}(l,e);var t,n,o,r=Um(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(Ym(t)),t.addingStarted=!1,t.mouseDownOnCellCorner=!1,t.mouseDragOutside=!1,t.handleDraggedCells=0,t.directions=[],t.autoInsertRow=!1,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return"autofill"}},{key:"PLUGIN_PRIORITY",get:function(){return 20}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,n){return e.onBeforeCellMouseOver(n)})),Fm(Gm(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Fm(Gm(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Fm(Gm(l.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),n=t.getTopLeftCorner(),o=n.row,r=n.col,l=t.getBottomRightCorner(),c=l.row,h=l.col,f=this.hot.runHooks("modifyCopyableRange",[{startRow:o,startCol:r,endRow:c,endCol:h}]),d=[],y=[],data=[];return X(f,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===d.indexOf(t)&&d.push(t);for(var n=e.startCol;n<=e.endCol;n+=1)-1===y.indexOf(n)&&y.push(n)})),X(d,(function(t){var n=[];X(y,(function(o){n.push(e.hot.getCopyableData(t,o))})),data.push(n)})),data}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=jm(this.hot.selection.highlight.getFill().getVisualCorners(),4),t=e[0],n=e[1],o=e[2],r=e[3],l=this.hot.getSelectedRangeLast(),c=l.getTopLeftCorner(),h=l.getBottomRightCorner();this.resetSelectionOfDraggedArea();var f=[c.row,c.col,h.row,h.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(c.row,t),Math.min(c.col,n),Math.max(h.row,o),Math.max(h.col,r)],f),y=function(e,t){var n,o,r;return t[0]===e[0]&&t[1]<e[1]?(r="left",n=new Wn(t[0],t[1]),o=new Wn(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(r="right",n=new Wn(t[0],e[3]+1),o=new Wn(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(r="up",n=new Wn(t[0],t[1]),o=new Wn(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(r="down",n=new Wn(e[2]+1,t[1]),o=new Wn(t[2],t[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:o}}(f,d),v=y.directionOfDrag,m=y.startOfDragCoords,w=y.endOfDragCoords;if(m&&m.row>-1&&m.col>-1){var C=this.getSelectionData(),S=l.clone(),k=new Hd(m,m,w),R=this.hot.runHooks("beforeAutofill",C,S,k,v);if(!1===R)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var O=S.from,E=S.to,T=!ge(this.hot.getData(O.row,O.col,E.row,E.col),R),A=function(e,t,data,n){var o=data.length,r=data?data[0].length:0,l=[],c=t.row-e.row,h=t.col-e.col;if(-1!==["down","up"].indexOf(n)){for(var f=[],col=0;col<h;col++){var d=parseInt(data[0][col],10),y=parseInt(data[o-1][col],10),v=("down"===n?y-d:d-y)/(o-1)||0;f.push(v)}l.push(f)}if(-1!==["right","left"].indexOf(n))for(var m=0;m<c;m++){var w=parseInt(data[m][0],10),C=parseInt(data[m][r-1],10),S=("right"===n?C-w:w-C)/(r-1)||0;l.push([S])}return l}(m,w,C,v),M=R,x=R;if(["up","left"].indexOf(v)>-1&&(1!==x.length||0!==x[0].length))if(M=[],"up"===v)for(var _=w.row-m.row+1,P=_%x.length,i=0;i<_;i++)M.push(x[(i+(x.length-P))%x.length]);else for(var I=w.col-m.col+1,H=I%x[0].length,D=0;D<x.length;D++){M.push([]);for(var N=0;N<I;N++)M[D].push(x[D][(N+(x[D].length-H))%x[D].length])}this.hot.populateFromArray(m.row,m.col,M,w.row,w.col,"".concat(this.pluginName,".fill"),null,v,A),this.setSelection(d),this.hot.runHooks("afterAutofill",M,S,k,v,T),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomRightCorner(),o=e;if(this.directions.includes(Hm.vertical)&&this.directions.includes(Hm.horizontal)){var r=t.getTopLeftCorner();(n.col<=e.col||r.col>=e.col)&&(o=new Wn(n.row,e.col)),(n.row<e.row||r.row>e.row)&&(o=new Wn(e.row,n.col))}else if(this.directions.includes(Hm.vertical))o=new Wn(e.row,n.col);else{if(!this.directions.includes(Hm.horizontal))return;o=new Wn(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(o)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter("insert_row",void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),200)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,data=this.hot.getData(),n=this.hot.countRows(),o=e[2]+1;o<n;o++){for(var r=e[1];r<=e[3];r++)if(data[o][r])return-1;var l=data[o][e[1]-1],c=data[o][e[3]+1];(l||c)&&(t=o)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(new Wn(e[0],e[1])).add(new Wn(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t;(t=this.hot).selectCell.apply(t,Nm($(e,(function(e){return Math.max(e,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,n=en(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+fn(this.hot.table),o=en(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+hn(this.hot.table);return e.clientY>n&&e.clientX<=o}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=function(e){var t={};return!0===e?(t.directions=Object.keys(Hm),t.autoInsertRow=!0):ve(e)?(it(e.autoInsertRow)?e.direction===Hm.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,it(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Hm)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){Fm(Gm(l.prototype),"destroy",this).call(this)}}])&&Vm(t.prototype,n),o&&Vm(t,o),l}(mm);function $m(e){return($m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xm(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return qm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qm(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qm(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Zm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qm(e,t,n){return(Qm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=nb(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Jm(e,p){return(Jm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function eb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=nb(e);if(t){var r=nb(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return tb(this,n)}}function tb(e,t){return!t||"object"!==$m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nb(e){return(nb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ob="autoRowSize",rb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jm(e,t)}(l,e);var t,n,o,r=eb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).rowHeightsMap=void 0,t.headerHeight=null,t.ghostTable=new vg(t.hot),t.samplesGenerator=new wm((function(e,col){var n;return e>=0?n=t.hot.getDataAtCell(e,col):-1===e&&(n=t.hot.getColHeader(col)),{value:n}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredRows=0,t.rowHeightsMap=new bc,t.hot.rowIndexMapper.registerMap("autoRowSize",t.rowHeightsMap),t.addHook("beforeRowResize",(function(e,n,o){return t.onBeforeRowResize(e,n,o)})),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return ob}},{key:"PLUGIN_PRIORITY",get:function(){return 40}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}],(n=[{key:"isEnabled",value:function(){var e=this.hot.getSettings().autoRowSize;return!0===e||ve(e)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),Qm(nb(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,Qm(nb(l.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,n,o){return e.onBeforeRowResize(t,n,o)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,l="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var c=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(c.get(-1))}ur(r.from,r.to,(function(t){(o||null===e.rowHeightsMap.getValueAtIndex(t))&&X(e.samplesGenerator.generateRowSamples(t,l),(function(t){var n=Xm(t,2),o=n[0],r=n[1];return e.ghostTable.addRow(o,r)}))})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))}),!0),this.measuredRows=r.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,o=this.hot.countRows()-1,r=null;this.inProgress=!0;var c=function c(){if(!e.hot)return L(r),void(e.inProgress=!1);e.calculateRowsHeight({from:n,to:Math.min(n+l.CALCULATION_STEP,o)},t),(n=n+l.CALCULATION_STEP+1)<o?r=H(c):(L(r),e.inProgress=!1,e.hot.view.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},h=this.getSyncCalculationLimit();this.firstCalculation&&h>=0&&(this.calculateRowsHeight({from:0,to:h},t),this.firstCalculation=!1,n=h+1),n<o?c():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&Re(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Re(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Jt(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoRowSize,t=l.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return ve(e)&&(Et(t=e.syncLimit)?t=fr(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),o=t;return null!==n&&n>(t||0)&&(o=n),o}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"==typeof e?{from:e,to:e}:e,o=n.from,r=n.to;this.hot.batchExecution((function(){ur(Math.min(o,r),Math.max(o,r),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!K(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(-1!==n&&-1!==o){if(this.calculateRowsHeight({from:n,to:o},void 0,e),t){var r=this.hot.countRows()-1;this.calculateRowsHeight({from:r-t,to:r})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var o=e;return n&&(this.calculateRowsHeight(t,void 0,!0),o=this.getRowHeight(t)),o}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),Qm(nb(l.prototype),"destroy",this).call(this)}}])&&Zm(t.prototype,n),o&&Zm(t,o),l}(mm),ib=new Map([["indexesSequence",{getListWithInsertedItems:Xu,getListWithRemovedItems:qu}],["physicallyIndexed",{getListWithInsertedItems:uc,getListWithRemovedItems:cc}]]),ab=function(e){if(!1===ib.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return ib.get(e)};function lb(e){return(lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sb(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ub(e,t,n){return(ub="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=db(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function cb(e,p){return(cb=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function hb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=db(e);if(t){var r=db(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return fb(this,n)}}function fb(e,t){return!t||"object"!==lb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function db(e){return(db=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pb=ab("physicallyIndexed"),yb=pb.getListWithInsertedItems,gb=pb.getListWithRemovedItems,vb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cb(e,t)}(l,e);var t,n,o,r=hb(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=Qu(this.indexedValues,t);this.indexedValues=yb(n,e,t,this.initValueOrFn),ub(db(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=gb(this.indexedValues,e);this.indexedValues=Zu(t,e),ub(db(l.prototype),"remove",this).call(this,e)}}])&&sb(t.prototype,n),o&&sb(t,o),l}(Gu);function mb(e){return(mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bb(e){return function(e){if(Array.isArray(e))return wb(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return wb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wb(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wb(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Cb(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sb(e,t,n){return(Sb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Eb(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function kb(e,p){return(kb=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Rb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Eb(e);if(t){var r=Eb(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ob(this,n)}}function Ob(e,t){return!t||"object"!==mb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eb(e){return(Eb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tb=ab("physicallyIndexed"),Ab=Tb.getListWithInsertedItems,Mb=Tb.getListWithRemovedItems;function xb(e){return(xb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pb(e,t,n){return(Pb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Nb(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Ib(e,p){return(Ib=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Hb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Nb(e);if(t){var r=Nb(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Db(this,n)}}function Db(e,t){return!t||"object"!==xb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nb(e){return(Nb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jb="bindRowsWithHeaders",Lb=new Map([["loose",vb],["strict",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kb(e,t)}(l,e);var t,n,o,r=Rb(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=this;this.indexedValues=Ab(this.indexedValues,e,t,(function(e,t){return n.getNextValue(t)})),Sb(Eb(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Mb(this.indexedValues,e),Sb(Eb(l.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,bb(this.getValues()))+1+e}}])&&Cb(t.prototype,n),o&&Cb(t,o),l}(Gu)]]),Bb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ib(e,t)}(l,e);var t,n,o,r=Hb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).headerIndexes=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return jb}},{key:"PLUGIN_PRIORITY",get:function(){return 210}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t="loose");var n=Lb.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),Pb(Nb(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Pb(Nb(l.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){Pb(Nb(l.prototype),"destroy",this).call(this)}}])&&_b(t.prototype,n),o&&_b(t,o),l}(mm);function Vb(e){return(Vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fb(e){return function(e){if(Array.isArray(e))return Wb(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Wb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wb(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wb(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ub(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zb(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yb(e,t,n){return(Yb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=qb(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Gb(e,p){return(Gb=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Kb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=qb(e);if(t){var r=qb(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return $b(this,n)}}function $b(e,t){return!t||"object"!==Vb(t)&&"function"!=typeof t?Xb(e):t}function Xb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qb(e){return(qb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qb(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,ew(e,t,"get"))}function Jb(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,ew(e,t,"set"),n),n}function ew(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var tw="collapsibleColumns",nw=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ow=new WeakMap,rw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gb(e,t)}(l,e);var t,n,o,r=Kb(l);function l(){var e;Ub(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Zb(Xb(e=r.call.apply(r,[this].concat(n))),"nestedHeadersPlugin",null),Zb(Xb(e),"eventManager",new Po(Xb(e))),Zb(Xb(e),"headerStateManager",null),ow.set(Xb(e),{writable:!0,value:null}),e}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return tw}},{key:"PLUGIN_PRIORITY",get:function(){return 290}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.getSettings().nestedHeaders||to("You need to configure the Nested Headers plugin in order to use collapsible headers."),Jb(this,ow,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(col,t){return e.onAfterGetColHeader(col,t)})),this.addHook("beforeOnCellMouseDown",(function(t,n,o){return e.onBeforeOnCellMouseDown(t,n,o)})),Yb(qb(l.prototype),"enablePlugin",this).call(this),this.updatePlugin())}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings().collapsibleColumns;"boolean"==typeof e?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(e)&&this.headerStateManager.mergeStateWith(e)}Yb(qb(l.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Jb(this,ow,null),this.nestedHeadersPlugin=null,this.clearButtons(),Yb(qb(l.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,r=function(button){button&&button.parentNode.removeChild(button)};ur(0,e-1,(function(i){var e=t.childNodes[i],l=n.childNodes[i],c=o?o.childNodes[i]:null;ur(0,e.childNodes.length-1,(function(t){var button=e.childNodes[t].querySelector(".collapsibleIndicator");r(button),l&&l.childNodes[t]&&(button=l.childNodes[t].querySelector(".collapsibleIndicator"),r(button)),o&&c&&c.childNodes[t]&&(button=c.childNodes[t].querySelector(".collapsibleIndicator"),r(button))}))}))}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.headerStateManager.mapNodes((function(e){var n=e.collapsible,o=e.origColspan,r=e.headerLevel,l=e.columnIndex;if(!0===n&&o>1)return{row:t.headerStateManager.levelToRowCoords(r),col:l}}));this.toggleCollapsibleSection(n,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;if(!nw.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var o=K(e,(function(e){return e.row<0})),r=o.length>0;X(o,(function(e){var o,l=e.row,c=e.col,h=null!==(o=n.headerStateManager.getHeaderSettings(l,c))&&void 0!==o?o:{},f=h.collapsible,d=h.isCollapsed;if(!f||d&&"collapse"===t||!d&&"expand"===t)return r=!1,!1}));var l=[],c=[];r&&X(o,(function(e){var o=e.row,r=e.col,h=n.headerStateManager.triggerNodeModification(t,o,r),f=h.colspanCompensation,d=h.affectedColumns,y=h.rollbackModification;f>0&&(c.push.apply(c,Fb(d)),l.push(y))}));var h=this.getCollapsedColumns(),f=[];"collapse"===t?f=ne([].concat(Fb(h),c)):"expand"===t&&(f=K(h,(function(e){return!c.includes(e)})));var d=nw.get(t);if(!1!==this.hot.runHooks(d.beforeHook,h,f,r)){this.hot.batchExecution((function(){X(c,(function(e){Qb(n,ow).setValueAtIndex(n.hot.toPhysicalColumn(e),d.hideColumn)}))}),!0);var y=this.getCollapsedColumns().length!==h.length;this.hot.runHooks(d.afterHook,h,f,r,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else X(l,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return Qb(this,ow).getHiddenIndexes()}},{key:"generateIndicator",value:function(e,t){var n=this.hot.rootDocument.createElement("div"),o=this.headerStateManager.getHeaderSettings(e,t);return Yt(n,"collapsibleIndicator"),o.isCollapsed?(Yt(n,"collapsed"),Qt(n,"+")):(Yt(n,"expanded"),Qt(n,"-")),n}},{key:"onAfterGetColHeader",value:function(e,t){var n,o=t.parentNode,r=o.parentNode,l=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,o),c=null!==(n=this.headerStateManager.getHeaderSettings(l,e))&&void 0!==n?n:{},h=c.collapsible,f=c.origColspan;if(h&&f>1&&e>=this.hot.getSettings().fixedColumnsLeft){var button=this.generateIndicator(l,e);t.querySelector("div:first-child").appendChild(button)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){zt(e.target,"collapsibleIndicator")&&(zt(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):zt(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),qn(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){Jb(this,ow,null),Yb(qb(l.prototype),"destroy",this).call(this)}}])&&zb(t.prototype,n),o&&zb(t,o),l}(mm);function iw(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function aw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lw(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return sw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sw(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function uw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var cw=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],hw=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.sortingStates=new Vc,this.sortEmptyCells=false,this.indicator=true,this.headerAction=true,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}var t,n,o;return t=e,(n=[{key:"updateAllColumnsProperties",value:function(e){var t=this;ve(e)&&be(e,(function(e,n){cw.includes(n)&&(t[n]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((function(t){return lw(t,1)[0]===e}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;return null===this.sortingStates?[]:this.sortingStates.getEntries().map((function(t){var n=lw(t,2),o=n[0],r=n[1];return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?iw(Object(source),!0).forEach((function(t){aw(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):iw(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({column:e.hot.toVisualColumn(o)},r)}))}},{key:"getColumnSortState",value:function(e){var t=this.getSortOrderOfColumn(e);if(it(t))return{column:e,sortOrder:t}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var i=0;i<e.length;i+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[i].column),{sortOrder:e[i].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}])&&uw(t.prototype,n),o&&uw(t,o),e}(),fw="asc",dw="desc";function pw(e){if(e.some((function(e){return!1===function(e){if(!1===ve(e))return!1;var t=e.column,n=e.sortOrder;return Number.isInteger(t)&&[fw,dw].includes(n)}(e)})))return!1;var t=e.map((function(e){return e.column}));return new Set(t).size===t.length}function yw(e){if(e!==dw)return e===fw?dw:fw}function gw(e){return e.querySelector(".".concat("colHeader"))}function vw(e,t){if(e<0||!t.parentNode)return!1;var n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function mw(e,t,n){return-1===e&&t>=0&&!1===Qn(n)}var bw="indicatorDisabled",ww="columnSorting",Cw="sortAction",Sw=new Map([[fw,"ascending"],[dw,"descending"]]);function kw(e,t,n,o){var r=[ww];if(o&&r.push(Cw),!1===n)return r.push(bw),r;var l=e.getSortOrderOfColumn(t);return it(l)&&r.push(Sw.get(l)),r}function Rw(){return Array.from(Sw.values()).concat(Cw,bw,ww)}function Ow(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ew(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Tw=function e(data){Ew(this,e),this.data=data,this.next=null,this.prev=null},Aw=function(){function e(){Ew(this,e),this.first=null,this.last=null}var t,n,o;return t=e,(n=[{key:"push",value:function(data){var e=new Tw(data);if(null===this.first)this.first=e,this.last=e;else{var t=this.last;this.last=e,e.prev=t,t.next=e}}},{key:"unshift",value:function(data){var e=new Tw(data);if(null===this.first)this.first=e,this.last=e;else{var t=this.first;this.first=e,e.next=t,t.prev=e}}},{key:"inorder",value:function(e){for(var t=this.first;t;)e(t),t=t.next}},{key:"remove",value:function(data){if(null===this.first)return!1;for(var e,t,n=this.first;n;){if(n.data===data)return e=n.next,t=n.prev,e&&(e.prev=t),t&&(t.next=e),n===this.first&&(this.first=e),n===this.last&&(this.last=t),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,t=this.first;;){if(null===e)return!1;if(null===(e=e.next))return!1;if((e=e.next)===(t=t.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){if(this.first){!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var e,t=this.first.next,n=this.first;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}}}])&&Ow(t.prototype,n),o&&Ow(t,o),e}(),Mw=function(a,b){var e=a.toString(),t=b.toString();return e===t?0:e<t?-1:1};function xw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mw,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(o-n)<=1)return[];var r=Math.ceil((n+o)/2);return xw(e,t,n,r),xw(e,t,r,o),_w(e,t,n,r,o)}function _w(e,t,n,o,r){for(var l=new Aw,c=new Aw,h=o-n,f=r-o,d=Math.max(h,f),y=r-n,v=0;v<d;v+=1)v<h&&l.push(e[n+v]),v<f&&c.push(e[o+v]);for(var i=0;i<y;)l.first&&c.first?t(l.first.data,c.first.data)>0?e[n+i]=c.shift().data:e[n+i]=l.shift().data:l.first?e[n+i]=l.shift().data:e[n+i]=c.shift().data,i+=1;return e}var Pw=-1;function Iw(e,t,n){return function(t,o){var r=n.sortEmptyCells;return"string"==typeof t&&(t=t.toLowerCase()),"string"==typeof o&&(o=o.toLowerCase()),t===o?0:lt(t)?lt(o)?0:r&&"asc"===e?Pw:1:lt(o)?r&&"asc"===e?1:Pw:isNaN(t)&&!isNaN(o)?"asc"===e?1:Pw:!isNaN(t)&&isNaN(o)?"asc"===e?Pw:1:(isNaN(t)||isNaN(o)||(t=parseFloat(t),o=parseFloat(o)),t<o?"asc"===e?Pw:1:t>o?"asc"===e?1:Pw:0)}}var Hw="default";var Dw=vo("sorting.compareFunctionFactory"),Nw=Dw.register,jw=Dw.getItem,Lw=Dw.hasItem,Bw=vo("sorting.mainSortComparator"),Vw=Bw.register,Fw=Bw.getItem;function Ww(e){return Lw(e)?jw(e):jw(Hw)}function Uw(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zw(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Yw(e){return(Yw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Nw("numeric",(function(e,t,n){return function(t,o){var r=parseFloat(t),l=parseFloat(o),c=n.sortEmptyCells;if(r===l||isNaN(r)&&isNaN(l))return 0;if(c){if(lt(t))return"asc"===e?Pw:1;if(lt(o))return"asc"===e?1:Pw}return isNaN(r)?1:isNaN(l)?Pw:r<l?"asc"===e?Pw:1:r>l?"asc"===e?1:Pw:0}})),Nw("checkbox",(function(e,t,n){var o=t.checkedTemplate,r=t.uncheckedTemplate,l=n.sortEmptyCells;return function(t,c){var h=lt(t),f=lt(c),d=h?r:t,y=f?r:c,v=d===r||d===o,m=y===r||y===o;if(!1===l){if(h&&!1===f)return 1;if(!1===h&&f)return Pw}return!1===v&&m?"asc"===e?Pw:1:v&&!1===m?"asc"===e?1:Pw:!1===v&&!1===m?Iw(e,0,n)(t,c):d===r&&y===o?"asc"===e?Pw:1:d===o&&y===r?"asc"===e?1:Pw:0}})),Nw("date",(function(e,t,n){return function(o,r){var l=n.sortEmptyCells;if(o===r)return 0;if(lt(o))return lt(r)?0:l&&"asc"===e?Pw:1;if(lt(r))return l&&"asc"===e?1:Pw;var c=t.dateFormat,h=Je(o,c),f=Je(r,c);return h.isValid()?f.isValid()?f.isAfter(h)?"asc"===e?Pw:1:f.isBefore(h)?"asc"===e?1:Pw:0:Pw:1}})),Nw(Hw,Iw);var Gw=["column"],Kw=["column"];function $w(e){return function(e){if(Array.isArray(e))return Xw(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Xw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xw(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function qw(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Zw(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?qw(Object(source),!0).forEach((function(t){Qw(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):qw(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Qw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jw(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function eC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tC(e,t,n){return(tC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=iC(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function nC(e,p){return(nC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function oC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=iC(e);if(t){var r=iC(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rC(this,n)}}function rC(e,t){return!t||"object"!==Yw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iC(e){return(iC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aC="columnSorting",lC="append",sC="replace";Vw(aC,(function(e,t){return function(n,o){var r,l,c,h,f,d,y=Uw(n).slice(1),v=Uw(o).slice(1);return l=e[r=0],c=t[r],h=y[r],f=v[r],((d=c.columnSorting).compareFunctionFactory?d.compareFunctionFactory:Ww(c.type))(l,c,d)(h,f)}})),fo.getSingleton().register("beforeColumnSort"),fo.getSingleton().register("afterColumnSort");var uC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nC(e,t)}(l,e);var t,n,o,r=oC(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).columnStatesManager=null,t.columnMetaCache=null,t.pluginKey=aC,t.indexesSequenceCache=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return aC}},{key:"PLUGIN_PRIORITY",get:function(){return 50}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnStatesManager=new hw(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new bc((function(t){var n=e.hot.toVisualColumn(t);return null===n&&(n=t),e.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(t,n,o,r){return e.onBeforeOnCellMouseDown(t,n,o,r)})),this.addHook("afterOnCellMouseDown",(function(t,n){return e.onAfterOnCellMouseDown(t,n)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(t,n){return e.onAfterLoadData(n)})),this.hot.view&&this.loadOrSortBySettings(),tC(iC(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,n){var o=gw(n);!1!==vw(t,n)&&null!==o&&e.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,tC(iC(l.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,o)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new ac),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,o?n:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){return it(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(e){var t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}},{key:"areValidSortConfigs",value:function(e){var t=this.hot.countCols();return pw(e)&&e.every((function(e){var n=e.column;return n<=t&&n>=0}))}},{key:"saveAllSortSettings",value:function(e){var t=this,n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=$(e,(function(e){var n=e.column,o=Jw(e,Gw);return Zw({column:t.hot.toPhysicalColumn(n)},o)})),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var n=t.value;return it(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=$(n.initialConfig,(function(t){var n=t.column,o=Jw(t,Kw);return Zw({column:e.hot.toVisualColumn(n)},o)}))),n}},{key:"getColumnNextConfig",value:function(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);if(it(t)){var n=yw(t);return it(n)?{column:e,sortOrder:n}:void 0}var o=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<o)return{column:e,sortOrder:yw()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lC,n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=-1!==n,r=this.getSortConfig(),l=this.getColumnNextConfig(e);if(o){if(at(l))return[].concat($w(r.slice(0,n)),$w(r.slice(n+1)));if(t===lC)return[].concat($w(r.slice(0,n)),$w(r.slice(n+1)),[l]);if(t===sC)return[].concat($w(r.slice(0,n)),[l],$w(r.slice(n+1)))}return it(l)?r.concat(l):r}},{key:"getPluginColumnConfig",value:function(e){if(ve(e)){var t=e[this.pluginKey];if(ve(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(o);return Array.isArray(r.columns)?Object.assign(n,t,this.getPluginColumnConfig(r.columns[e])):In(r.columns)?Object.assign(n,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(n,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(e){var t=this;if(0!==e.length){for(var n=[],o=this.hot.countRows(),r=function(n){return $(e,(function(e){return t.hot.getDataAtCell(n,e.column)}))},l=0;l<this.getNumberOfRowsToSort(o);l+=1)n.push([this.hot.toPhysicalRow(l)].concat(r(l)));var c=$(n,(function(e){return e[0]}));!function(e,t){for(var n=Fw(t),o=arguments.length,r=new Array(o>2?o-2:0),l=2;l<o;l++)r[l-2]=arguments[l];xw(e,n.apply(void 0,r))}(n,this.pluginKey,$(e,(function(e){return e.sortOrder})),$(e,(function(e){return t.getFirstCellSettings(e.column)})));for(var h=n.length;h<o;h+=1)n.push([h].concat(r(h)));var f=$(n,(function(e){return e[0]})),d=new Map($(c,(function(e,t){return[e,f[t]]}))),y=$(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return d.has(e)?d.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(y)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(ve(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(ve(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||ve(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var n=gw(t);if(!1!==vw(e,t)&&null!==n){var o=this.getFirstCellSettings(e)[this.pluginKey],r=o.indicator,l=o.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,r,l)}}},{key:"updateHeaderClasses",value:function(e){if(Gt(e,Rw()),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];Yt(e,kw.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(e){tC(iC(l.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),it(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,o){!1!==mw(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&Od()&&(o.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==mw(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(Od()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),tC(iC(l.prototype),"destroy",this).call(this)}}])&&eC(t.prototype,n),o&&eC(t,o),l}(mm);n(296);function cC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hC,fC=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}var t,n,o;return t=e,(n=[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[],o=e;if(o||"function"!=typeof this.settings)return o||(o=this.settings),X(o,(function(e){var o={};t.assignSetting(e,o,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,o,"reversedRowCoords",!1),t.assignSetting(e,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,o,"sourceColumn",e.destinationColumn),t.assignSetting(e,o,"type","sum"),t.assignSetting(e,o,"forceNumeric",!1),t.assignSetting(e,o,"suppressDataTypeErrors",!0),t.assignSetting(e,o,"suppressDataTypeErrors",!0),t.assignSetting(e,o,"customFunction",null),t.assignSetting(e,o,"readOnly",!0),t.assignSetting(e,o,"roundFloat",!1),n.push(o)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,n,o){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(o instanceof Error)throw o;t[n]=o}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=o}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n){if("function"===this.settingsType){var o=e.indexOf("row")>-1?"row":"col",r=this.getAllEndpoints();X(r,(function(r){"row"===o&&r.destinationRow>=t&&("insert_row"===e?r.alterRowOffset=n:"remove_row"===e&&(r.alterRowOffset=-1*n)),"col"===o&&r.destinationColumn>=t&&("insert_col"===e?r.alterColumnOffset=n:"remove_col"===e&&(r.alterColumnOffset=-1*n))})),this.resetAllEndpoints(r,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,o,source){var r=this,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var c=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,f=this.getAllEndpoints(),d=0===e.indexOf("move_row"),y=t;X(f,(function(e){"row"===c&&e.destinationRow>=y&&(e.alterRowOffset=h*n),"col"===c&&e.destinationColumn>=y&&(e.alterColumnOffset=h*n)})),this.resetAllEndpoints(f,!d),X(f,d?function(e){r.extendEndpointRanges(e,y,o[0],o.length),r.recreatePhysicalRanges(e),r.clearOffsetInformation(e)}:function(e){r.shiftEndpointCoordinates(e,y)}),l&&this.refreshAllEndpoints()}else{var v=function e(){return r.hot.removeHook("beforeRender",e),r.refreshAllEndpoints()};this.hot.addHookOnce("beforeRender",v)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,o){X(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=o:n<e[0]&&(e[0]-=o):n>=e[0]&&n<=e[1]&&(e[1]-=o,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,o=[],r=[];X(n,(function(e){var n=[];if(e[1])for(var i=e[0];i<=e[1];i++)n.push(t.hot.toPhysicalRow(i));else n.push(t.hot.toPhysicalRow(e[0]));r.push(n)})),X(r,(function(e){var t=[];X(e,(function(n,r){0===r?t.push(n):e[r]!==e[r-1]+1&&(t.push(e[r-1]),o.push(t),(t=[]).push(n)),r===e.length-1&&(t.push(n),o.push(t))}))})),e.ranges=o}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,X(e.ranges,(function(element){X(element,(function(n,o){n>=t&&(element[o]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=t.some((function(t){var n=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+n>=e.hot.countRows()||t.destinationColumn+o>=e.hot.countCols()}));o||(this.cellsToSetCache=[],X(t,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],X(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],X(e,(function(e,o,r){"".concat(e[2]||"")!=="".concat(e[3])&&X(t.getAllEndpoints(),(function(e,l){t.hot.propToCol(r[o][1])===e.sourceColumn&&-1===n.indexOf(l)&&n.push(l)}))})),X(n,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,o=e.alterColumnOffset||0,r=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],l=r[0],c=r[1];if(null!==c&&null!==l){var h=this.hot.getCellMeta(l,c);h.readOnly=!1,h.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}},{key:"setEndpointValue",value:function(e,source){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var l=this.hot.toVisualRow(e.destinationRow+n);if(null!==l){var c=this.hot.getCellMeta(l,e.destinationColumn+o);"init"!==source&&c.readOnly===e.readOnly||(c.readOnly=e.readOnly,c.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),t?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){to("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}])&&cC(t.prototype,n),o&&cC(t,o),e}();function dC(e){return(dC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yC(e,t,n){return(yC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=bC(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function gC(e,p){return(gC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function vC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=bC(e);if(t){var r=bC(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return mC(this,n)}}function mC(e,t){return!t||"object"!==dC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bC(e){return(bC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wC="columnSummary",CC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gC(e,t)}(l,e);var t,n,o,r=vC(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).endpoints=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return wC}},{key:"PLUGIN_PRIORITY",get:function(){return 220}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new fC(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,n,source){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,source)})),this.addHook("beforeCreateCol",(function(t,n,source){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,source)})),this.addHook("beforeRemoveRow",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(o))})),this.addHook("beforeRemoveCol",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(o))})),this.addHook("afterCreateRow",(function(t,n,source){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,source)})),this.addHook("afterCreateCol",(function(t,n,source){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,source)})),this.addHook("afterRemoveRow",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(o))})),this.addHook("afterRemoveCol",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(o))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),yC(bC(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}},{key:"calculateSum",value:function(e){var t=this,n=0;return be(e.ranges,(function(o){n+=t.getPartialSum(o,e.sourceColumn)})),n}},{key:"getPartialSum",value:function(e,col){var t=0,i=e[1]||e[0],n=null,o=0;do{n=this.getCellValue(i,col)||0;var r=("".concat(n).split(".")[1]||[]).length||1;r>o&&(o=r),t+=n||0,i-=1}while(i>=e[0]);return Math.round(t*Math.pow(10,o))/Math.pow(10,o)}},{key:"calculateMinMax",value:function(e,t){var n=this,o=null;return be(e.ranges,(function(r){var l=n.getPartialMinMax(r,e.sourceColumn,t);if(null===o&&null!==l&&(o=l),null!==l)switch(t){case"min":o=Math.min(o,l);break;case"max":o=Math.max(o,l)}})),null===o?"Not enough data":o}},{key:"getPartialMinMax",value:function(e,col,t){var n,o=null,i=e[1]||e[0];do{if(n=this.getCellValue(i,col)||null,null===o)o=n;else if(null!==n)switch(t){case"min":o=Math.min(o,n);break;case"max":o=Math.max(o,n)}i-=1}while(i>=e[0]);return o}},{key:"countEmpty",value:function(e,col){var t=0,i=e[1]||e[0];do{this.getCellValue(i,col)||(t+=1),i-=1}while(i>=e[0]);return t}},{key:"countEntries",value:function(e){var t=this,n=0;return be(e.ranges,(function(o){var r=void 0===o[1]?1:o[1]-o[0]+1,l=t.countEmpty(o,e.sourceColumn);n+=r,n-=l})),n}},{key:"calculateAverage",value:function(e){return this.calculateSum(e)/this.countEntries(e)}},{key:"getCellValue",value:function(e,col){var t=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(col),o=this.hot.getSourceDataAtCell(e,col),r="";if(null!==t&&null!==n&&(r=this.hot.getCellMeta(t,n).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(et(hC||(hC=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,col));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,source){e&&"ColumnSummary.reset"!==source&&"ColumnSummary.set"!==source&&"loadData"!==source&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}])&&pC(t.prototype,n),o&&pC(t,o),l}(mm);function SC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var kC=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=null,this.rootDocument=t,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}var t,n,o;return t=e,o=[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}],(n=[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var input=this.getInputElement();input.style.width="".concat(e,"px"),input.style.height="".concat(t,"px")}}},{key:"resetSize",value:function(){var input=this.getInputElement();input.style.width="",input.style.height=""}},{key:"setReadOnlyState",value:function(e){this.getInputElement().readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.createElement("div"),Yt(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Yt(t,e.CLASS_EDITOR),Yt(n,e.CLASS_INPUT),t.appendChild(n),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}])&&SC(t.prototype,n),o&&SC(t,o),e}(),RC="---------";function OC(e){return zt(e,"htSeparator")}function EC(e){return zt(e,"htDisabled")}function TC(e){return zt(e,"htSelectionDisabled")}function AC(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function MC(e,t){var n={};return X(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&(n[e]||(n[e]=[]),n[e][col]=t(e,col))}))})),n}function xC(e,t,n,o,r){X(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&function(e,col,t,n,o,r){var l=o(e,col),c=n;l.className&&(c="vertical"===t?function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n):function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n));r(e,col,"className",c)}(e,col,t,n,o,r)}))}))}function _C(e,t){var n=!1;return Array.isArray(e)&&X(e,(function(e){return e.forAll((function(e,col){if(e>=0&&col>=0&&t(e,col))return n=!0,!1})),n})),n}function PC(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}function IC(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}function HC(e,t){var n=e.slice(0);return n.reverse(),(n=IC(n,t)).reverse(),n}function DC(e){var t=[];return X(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function NC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var jC=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}var t,n,o;return t=e,(n=[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),250)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Nn((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}])&&NC(t.prototype,n),o&&NC(t,o),e}();ye(jC,Uu);var LC=jC;function BC(e){return(BC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function WC(e,t,n){return(WC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=KC(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function UC(e,p){return(UC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function zC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=KC(e);if(t){var r=KC(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return YC(this,n)}}function YC(e,t){return!t||"object"!==BC(t)&&"function"!=typeof t?GC(e):t}function GC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KC(e){return(KC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $C="comments",XC=new WeakMap,qC="comment",ZC="value",QC="style",JC="readOnly",eS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UC(e,t)}(l,e);var t,n,o,r=zC(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).editor=null,t.displaySwitch=null,t.eventManager=null,t.range={},t.mouseDown=!1,t.contextMenuEvent=!1,t.timer=null,XC.set(GC(t),{tempEditorDimensions:{},cellBelowCursor:null}),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return $C}},{key:"PLUGIN_PRIORITY",get:function(){return 60}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new kC(this.hot.rootDocument)),this.eventManager||(this.eventManager=new Po(this)),this.displaySwitch||(this.displaySwitch=new LC(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,n,col,o,r,l){return e.onAfterRenderer(t,l)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.onAfterBeginEditing()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,col){return e.showAtCell(t,col)})),this.registerListeners(),WC(KC(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),WC(KC(l.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){WC(KC(l.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=Nt(e.target,"TD","TBODY");return!!(t&&zt(t,"htCommentCell")&&Nt(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!=e?n=e:null!=t&&(n=t);var o=this.range.from.row,col=this.range.from.col;this.updateCommentMeta(o,col,VC({},ZC,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:new Wn(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,qC,void 0),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new Wn(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,ZC)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,ZC)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,col=e.col;if(t<0||t>this.hot.countSourceRows()-1||col<0||col>this.hot.countSourceCols()-1)return!1;var meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(meta.comment?meta.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:new Wn(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var o=this.hot,r=o.rowIndexMapper,l=o.columnIndexMapper,c=this.range.from,h=c.row,f=c.col,d=r.getRenderableFromVisualIndex(h),y=l.getRenderableFromVisualIndex(f),v=null===d;null===d&&(d=r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(h,-1))),null===y&&(y=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(f,-1)));var m=null===d,w=null===y;d=null!==(e=d)&&void 0!==e?e:0,y=null!==(t=y)&&void 0!==t?t:0;var C=this.hot,S=C.rootWindow,k=C.view.wt,R=k.wtTable,O=k.wtOverlays,E=k.wtViewport,T=O.scrollableElement,A=R.getCell({row:d,col:y}),M=en(A),x=w?0:R.getStretchedColumnWidth(y),_=v&&!m?fn(A):0,P=M.top,I=M.left;E.hasVerticalScroll()&&T!==S&&(P-=O.topOverlay.getScrollPosition()),E.hasHorizontalScroll()&&T!==S&&(I-=O.leftOverlay.getScrollPosition());var H=I+x,D=P+_,N=this.getCommentMeta(h,f,QC),j=this.getCommentMeta(h,f,JC);N?this.editor.setSize(N.width,N.height):this.editor.resetSize(),this.editor.setReadOnlyState(j),this.editor.setPosition(H,D)}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,n=e.getTopLeftCorner();return this.getCommentMeta(n.row,n.col,ZC)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var o,r=this.hot.getCellMeta(e,t).comment;r?fe(o=de(r),n):o=n,this.hot.setCellMeta(e,t,qC,o)}},{key:"getCommentMeta",value:function(e,t,n){var o=this.hot.getCellMeta(e,t);if(o.comment)return o.comment[n]}},{key:"onMouseDown",value:function(e){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=Nt(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.view.wt.wtTable.getCoords(t),n={row:this.hot.rowIndexMapper.getVisualFromRenderableIndex(n.row),col:this.hot.columnIndexMapper.getVisualFromRenderableIndex(n.col)}),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(e){var t=XC.get(this),n=this.hot.rootDocument;if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),!(this.mouseDown||this.editor.isFocused()||zt(e.target,"wtBorder")||t.cellBelowCursor!==e.target)&&this.editor)if(this.targetIsCellWithComment(e)){var o=this.hot.view.wt.wtTable.getCoords(e.target),r={from:new Wn(this.hot.rowIndexMapper.getVisualFromRenderableIndex(o.row),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o.col))};this.displaySwitch.show(r)}else Lt(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(e,t){t.comment&&t.comment.value&&Yt(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){XC.get(this).tempEditorDimensions={width:hn(e.target),height:fn(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=XC.get(this),n=hn(e.target),o=fn(e.target);n===t.tempEditorDimensions.width+1&&o===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,VC({},QC,{width:n,height:o}))}},{key:"onContextMenuAddComment",value:function(){var e=this;this.displaySwitch.cancelHiding();var t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:t.highlight}),this.show(),setTimeout((function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())}),10)}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,n){t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,n){if(t>=0&&n>=0){var o=!!e.getCommentMeta(t,n,JC);e.updateCommentMeta(t,n,VC({},JC,!o))}}))}},{key:"addToContextMenu",value:function(e){var t=this,n=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(ef):t.hot.getTranslatedPhrase(Jh)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(tf)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,label=this.getTranslatedPhrase(nf);return _C(this.getSelectedRangeLast(),(function(t,col){var n=e.getCellMeta(t,col).comment;if(n&&(n=n.readOnly),n)return!0}))&&(label=PC(label)),label},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner()&&t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings().comments;if(ve(e))return e.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),WC(KC(l.prototype),"destroy",this).call(this)}}])&&FC(t.prototype,n),o&&FC(t,o),l}(mm);function tS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nS(e,t){var n;return X(t,(function(t){var o=t.key?t.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return n=t,!1})),n}var oS=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.commands={},this.commonCallback=null}var t,n,o;return t=e,(n=[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];var l=e.split(":"),c=l[0],h=2===l.length?l[1]:null,f=this.commands[c];if(!f)throw new Error("Menu command '".concat(c,"' not exists."));if(h&&f.submenu&&(f=nS(h,f.submenu.items)),!0!==f.disabled&&("function"!=typeof f.disabled||!0!==f.disabled.call(this.hot))&&!Re(f,"submenu")){var d=[];"function"==typeof f.callback&&d.push(f.callback),"function"==typeof this.commonCallback&&d.push(this.commonCallback),o.unshift(l.join(":")),X(d,(function(e){return e.apply(t.hot,o)}))}}}])&&tS(t.prototype,n),o&&tS(t,o),e}(),rS="alignment";var iS="clear_column";var aS="col_left";var lS="col_right";var sS="make_read_only";var uS="redo";function cS(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return hS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hS(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hS(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var fS="remove_col";function dS(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return pS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pS(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pS(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var yS="remove_row";var gS="row_above";var vS="row_below";var mS="no_items";var bS,wS="undo";function CS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var SS=[gS,vS,aS,lS,iS,yS,fS,wS,uS,sS,rS,RC,mS],kS=(CS(bS={},RC,(function(){return{name:RC}})),CS(bS,mS,(function(){return{key:mS,name:function(){return this.getTranslatedPhrase(Nh)},disabled:!0,isCommand:!1}})),CS(bS,gS,(function(){return{key:gS,name:function(){return this.getTranslatedPhrase(jh)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),o=0;n||(o=t[Math.max(t.length-1,0)].start.row);this.alter("insert_row",o,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){return!AC(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),CS(bS,vS,(function(){return{key:vS,name:function(){return this.getTranslatedPhrase(Lh)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),o=0;if(n)o=this.countRows();else{var r,l=t[Math.max(t.length-1,0)],c=null==l||null===(r=l.end)||void 0===r?void 0:r.row;o=it(c)?c+1:0}this.alter("insert_row",o,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){return!AC(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),CS(bS,aS,(function(){return{key:aS,name:function(){return this.getTranslatedPhrase(Bh)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),o=0;n||(o=t[Math.max(t.length-1,0)].start.col);this.alter("insert_col",o,1,"ContextMenu.columnLeft"),n&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!AC(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),CS(bS,lS,(function(){return{key:lS,name:function(){return this.getTranslatedPhrase(Vh)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),o=0;if(n)o=this.countCols();else{var r,l=t[Math.max(t.length-1,0)],c=null==l||null===(r=l.end)||void 0===r?void 0:r.col;o=it(c)?c+1:0}this.alter("insert_col",o,1,"ContextMenu.columnRight"),n&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!AC(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),CS(bS,iS,(function(){return{key:iS,name:function(){return this.getTranslatedPhrase(Gh)},callback:function(e,t){var n=t[0].start.col,o=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),o,"ContextMenu.clearColumn")},disabled:function(){return!AC(this)||!this.selection.isSelectedByColumnHeader()}}})),CS(bS,yS,(function(){return{key:yS,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=dS(e[0],3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(Fh,t)},callback:function(){this.alter("remove_row",function(e){var t=ay(e);if(0===t||1===t)return[];var n=ly(t),o=new Set;return X(e,(function(e){var t=Qp(n(e),3),r=t[0],l=t[2],c=Math.max(r,0),h=l-c+1;X(Array.from(new Array(h),(function(e,i){return c+i})),(function(e){o.has(e)||o.add(e)}))})),G(Array.from(o).sort((function(a,b){return a-b})),(function(e,t,n,o){return 0!==n&&t===o[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!AC(this))return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}})),CS(bS,fS,(function(){return{key:fS,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=cS(e[0],4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(Wh,t)},callback:function(){this.alter("remove_col",function(e){var t=ay(e);if(0===t||1===t)return[];var n=ly(t),o=new Set;return X(e,(function(e){var t=Qp(n(e),4),r=t[1],l=t[3],c=Math.max(r,0),h=l-c+1;X(Array.from(new Array(h),(function(e,i){return c+i})),(function(e){o.has(e)||o.add(e)}))})),G(Array.from(o).sort((function(a,b){return a-b})),(function(e,t,n,o){return 0!==n&&t===o[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!AC(this))return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}})),CS(bS,wS,(function(){return{key:wS,name:function(){return this.getTranslatedPhrase(Uh)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}})),CS(bS,uS,(function(){return{key:uS,name:function(){return this.getTranslatedPhrase(zh)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}})),CS(bS,sS,(function(){return{key:sS,name:function(){var e=this,label=this.getTranslatedPhrase(Yh);return _C(this.getSelectedRange(),(function(t,col){return e.getCellMeta(t,col).readOnly}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=_C(t,(function(t,col){return e.getCellMeta(t,col).readOnly}));X(t,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&e.setCellMeta(t,col,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}})),CS(bS,rS,(function(){return{key:rS,name:function(){return this.getTranslatedPhrase(of)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(rS,":left"),name:function(){var e=this,label=this.getTranslatedPhrase(rf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{key:"".concat(rS,":center"),name:function(){var e=this,label=this.getTranslatedPhrase(af);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{key:"".concat(rS,":right"),name:function(){var e=this,label=this.getTranslatedPhrase(lf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",r="htRight";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{key:"".concat(rS,":justify"),name:function(){var e=this,label=this.getTranslatedPhrase(sf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{name:RC},{key:"".concat(rS,":top"),name:function(){var e=this,label=this.getTranslatedPhrase(uf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",r="htTop";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{key:"".concat(rS,":middle"),name:function(){var e=this,label=this.getTranslatedPhrase(cf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1},{key:"".concat(rS,":bottom"),name:function(){var e=this,label=this.getTranslatedPhrase(hf);return _C(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(label=PC(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=MC(t,(function(t,col){return e.getCellMeta(t,col).className})),o="vertical",r="htBottom";this.runHooks("beforeCellAlignment",n,t,o,r),xC(t,o,r,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),this.render()},disabled:!1}]}}})),bS);function RS(){var e={};return be(kS,(function(t,n){e[n]=t()})),e}function OS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ES(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function TS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],pattern=e;return pattern&&pattern.items?pattern=pattern.items:Array.isArray(pattern)||(pattern=t),ve(pattern)?be(pattern,(function(e,t){var r=n["string"==typeof e?e:t];r||(r=e),ve(e)?he(r,e):"string"==typeof r&&(r={name:r}),void 0===r.key&&(r.key=t),o.push(r)})):X(pattern,(function(e,t){var r=n[e];!r&&SS.indexOf(e)>=0||(r||(r={name:e,key:"".concat(t)}),ve(e)&&he(r,e),void 0===r.key&&(r.key=t),o.push(r))})),o}var AS=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;OS(this,e),this.hot=t,this.predefinedItems=RS(),this.defaultOrderPattern=n}var t,n,o;return t=e,(n=[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,be(e,(function(e,o){var r="";e.name===RC?(n[RC]=e,r=RC):isNaN(parseInt(o,10))?(e.key=void 0===e.key?o:e.key,n[o]=e,r=e.key):(n[e.key]=e,r=e.key),t.defaultOrderPattern.push(r)})),this.predefinedItems=n}},{key:"getItems",value:function(){var pattern=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return TS(pattern,this.defaultOrderPattern,this.predefinedItems)}}])&&ES(t.prototype,n),o&&ES(t,o),e}();function MS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xS=function(){function e(object,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o,r,l,c,h,f=tn(t),d=nn(t);this.rootWindow=t,this.type=this.getSourceType(object),"literal"===this.type?(n=parseInt(object.top,10),r=parseInt(object.left,10),c=object.height||0,h=object.width||0,o=n,l=r,n+=f,r+=d):"event"===this.type&&(n=parseInt(object.pageY,10),r=parseInt(object.pageX,10),c=object.target.clientHeight,h=object.target.clientWidth,o=n-f,l=r-d),this.top=n,this.topRelative=o,this.left=r,this.leftRelative=l,this.scrollTop=f,this.scrollLeft=d,this.cellHeight=c,this.cellWidth=h}var t,n,o;return t=e,(n=[{key:"getSourceType",value:function(object){var e="literal";return object instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(element){return this.topRelative>=element.offsetHeight}},{key:"fitsBelow",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+element.offsetHeight<=e}},{key:"fitsOnRight",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=e}},{key:"fitsOnLeft",value:function(element){return this.leftRelative>=element.offsetWidth}}])&&MS(t.prototype,n),o&&MS(t,o),e}();function _S(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var PS=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new Po(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var t,n,o;return t=e,(n=[{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=Ht(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(area){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[area]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Nn((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||215,o=!1,r=K(this.menuItems,(function(t){return t.key===mS&&(o=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(t,e.hot)}));if(r.length<1&&!o)r.push(RS().no_items);else if(0===r.length)return;r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RC,n=e.slice(0);return DC(n=HC(n=IC(n,t),t))}(r,RC);var l=!1,c={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return it(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,o,col,r,l){return e.menuItemRenderer(t,n,o,col,r,l)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function(n,o){e.isAllSubMenusClosed()?t(o.row):e.openSubMenu(o.row)},rowHeights:function(e){return r[e].name===RC?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),Ue()&&l&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(l=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){Ue()&&Qn(t)||!l||!e.hasSelectedItem()||(Ve()||We()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Zy(this.container,c),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!function(e){return zt(e,"htSubmenu")}(n))return!1;var o=this.hotMenu.getSourceDataAtRow(t),r=new e(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(o.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[o.key]=r,r}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;X(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),o=n?function(e){return $(e,(function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}))}(n):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,o=e.disabled,r=e.submenu,l=!0===o||"function"==typeof o&&!0===o.call(this.hot);return!1===t||n===RC||!0===l||r}},{key:"setPosition",value:function(e){var cursor=new xS(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(cursor.fitsBelow(this.container)?this.setPositionBelowCursor(cursor):cursor.fitsAbove(this.container)?this.setPositionAboveCursor(cursor):this.setPositionBelowCursor(cursor),cursor.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(cursor):this.setPositionOnLeftOfCursor(cursor)):(this.setPositionBelowCursor(cursor),this.setPositionOnRightOfCursor(cursor))}},{key:"setPositionAboveCursor",value:function(cursor){var e=this.offset.above+cursor.top-this.container.offsetHeight;this.isSubMenu()&&(e=cursor.top+cursor.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(cursor){var e=this.offset.below+cursor.top+1;this.isSubMenu()&&(e=cursor.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(cursor){var e;e=this.isSubMenu()?1+cursor.left+cursor.cellWidth:this.offset.right+1+cursor.left,this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(cursor){var e=kn(this.hot.rootDocument),t=this.offset.left+cursor.left-this.container.offsetWidth+e+4;this.container.style.left="".concat(t,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);OC(e)||EC(e)||TC(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);OC(t)||EC(t)||TC(t)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)}},{key:"selectNextCell",value:function(e,col){var t=e+1,n=t<this.hotMenu.countRows()?this.hotMenu.getCell(t,col):null;n&&(OC(n)||EC(n)||TC(n)?this.selectNextCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"selectPrevCell",value:function(e,col){var t=e-1,n=t>=0?this.hotMenu.getCell(t,col):null;n&&(OC(n)||EC(n)||TC(n)?this.selectPrevCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"menuItemRenderer",value:function(e,t,n,col,o,r){var l,c=this,h=e.getSourceDataAtRow(n),f=this.hot.rootDocument.createElement("div"),d=function(e){return e.disableSelection},y=r;"function"==typeof y&&(y=y.call(this.hot)),$t(t),Yt(f,"htItemWrapper"),t.appendChild(f),l=h,new RegExp(RC,"i").test(l.name)?Yt(t,"htSeparator"):"function"==typeof h.renderer?(Yt(t,"htCustomMenuRenderer"),t.appendChild(h.renderer(e,f,n,col,o,y))):Zt(f,y),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(c.hot)}(h)?(Yt(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):d(h)?(Yt(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):function(e){return Re(e,"submenu")}(h)?(Yt(t,"htSubmenu"),d(h)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)}))):(Gt(t,["htSubmenu","htDisabled"]),d(h)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,o=t;return o&&(In(o)&&(o=null===(o=o.call(this.hot))||at(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o="".concat(this.options.className,"Sub_").concat(o),e=n.querySelector(".".concat(this.options.className,".").concat(o))),e||(Yt(e=n.createElement("div"),"htMenu ".concat(this.options.className)),o&&Yt(e,o),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(e){if(Mn(e.target)&&this.container.contains(e.target))qn(e);else{var t=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,e.keyCode){case Un.ESCAPE:this.close(),n=!0;break;case Un.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?n=!0:(this.executeCommand(e),this.close(!0)));break;case Un.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),n=!0;break;case Un.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),n=!0;break;case Un.ARROW_RIGHT:if(t){var menu=this.openSubMenu(t[0]);menu&&menu.selectFirstCell()}n=!0;break;case Un.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(e.preventDefault(),qn(e)),this.keyEvent=!1}}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view.wt.wtTable,data=this.hotMenu.getSettings().data,t=e.hider.style,n=e.holder.style,o=parseInt(t.width,10),r=G(data,(function(e,t){return e+(t.name===RC?1:26)}),0);n.width="".concat(o+3,"px"),n.height="".concat(r+3,"px"),t.height=n.height}},{key:"onAfterSelection",value:function(e,t,n,o,r){!1===this.keyEvent&&(r.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Lt(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Lt(e.target,".htMenu")||!Lt(e.target,this.container.ownerDocument)&&!Lt(e.target,this.hot.rootDocument)||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&zt(e.target,"htCore")&&Lt(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}])&&_S(t.prototype,n),o&&_S(t,o),e}();ye(PS,Uu);var IS=PS;function HS(e){return(HS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function NS(e,t,n){return(NS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=FS(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function jS(e,p){return(jS=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function LS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=FS(e);if(t){var r=FS(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return BS(this,n)}}function BS(e,t){return!t||"object"!==HS(t)&&"function"!=typeof t?VS(e):t}function VS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FS(e){return(FS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var WS="contextMenu";fo.getSingleton().register("afterContextMenuDefaultOptions"),fo.getSingleton().register("beforeContextMenuShow"),fo.getSingleton().register("afterContextMenuShow"),fo.getSingleton().register("afterContextMenuHide"),fo.getSingleton().register("afterContextMenuExecute");var US=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jS(e,t)}(l,e);var t,n,o,r=LS(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(VS(t)),t.commandExecutor=new oS(t.hot),t.itemsFactory=null,t.menu=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return WS}},{key:"PLUGIN_PRIORITY",get:function(){return 70}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[gS,vS,RC,aS,lS,RC,yS,fS,RC,wS,uS,RC,sS,RC,rS]}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().contextMenu;"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new IS(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.executeCommand).call.apply(t,[e].concat(o))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),NS(FS(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),NS(FS(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),NS(FS(l.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var o=this.hot.rootWindow.frameElement.getBoundingClientRect(),r=o.top,l=o.left;t=r-tn(e.view),n=l-nn(e.view)}else t=-1*tn(this.menu.hotMenu.rootWindow),n=-1*nn(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(t=this.commandExecutor).execute.apply(t,[e].concat(o))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new AS(this.hot,l.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),X(o,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,o=t.colHeaders,element=e.target;this.close(),zt(element,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||o||function(element){return"TD"===element.nodeName||"TD"===element.parentNode.nodeName}(element)||zt(element,"current")&&zt(element,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),NS(FS(l.prototype),"destroy",this).call(this)}}])&&DS(t.prototype,n),o&&DS(t,o),l}(mm);function zS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}US.SEPARATOR={name:RC};var YS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var t,n,o;return t=e,(n=[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}])&&zS(t.prototype,n),o&&zS(t,o),e}();var GS=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clipboardData=new YS};n(669);function KS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $S=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Po(this),this.listenersCount=new WeakSet,this.container=t}var t,n,o;return t=e,(n=[{key:"useSecondaryElement",value:function(){var e=function(e){var t=QS.get(e);if(t)return t.parentElement||e.appendChild(t),t;var element=(e.defaultView?e:e.ownerDocument).createElement("textarea");return QS.set(e,element),element.setAttribute("data-hot-input",""),element.className="HandsontableCopyPaste",element.tabIndex=-1,element.autocomplete="off",element.wrap="hard",element.value=" ",e.appendChild(element),element}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),ZS(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(element){this.listenersCount.has(element)||(this.listenersCount.add(element),ZS(this.eventManager,element,this)),this.mainElement=element}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ve()||_n(this.mainElement)}}])&&KS(t.prototype,n),o&&KS(t,o),e}();ye($S,Uu);var XS=new WeakMap;var qS=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function ZS(e,element,t){e.addEventListener(element,"copy",qS("copy",t)),e.addEventListener(element,"cut",qS("cut",t)),e.addEventListener(element,"paste",qS("paste",t))}var QS=new WeakMap;function JS(e){if(e instanceof $S){var t=XS.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=QS.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),QS.delete(e.container)),e.mainElement=null}XS.set(e.container,t)}}function ek(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return tk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tk(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tk(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function nk(e){return(nk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ok(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rk(e,t,n){return(rk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=uk(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function ik(e,p){return(ik=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ak(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=uk(e);if(t){var r=uk(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return lk(this,n)}}function lk(e,t){return!t||"object"!==nk(t)&&"function"!=typeof t?sk(e):t}function sk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uk(e){return(uk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("afterCopyLimit"),fo.getSingleton().register("modifyCopyableRange"),fo.getSingleton().register("beforeCut"),fo.getSingleton().register("afterCut"),fo.getSingleton().register("beforePaste"),fo.getSingleton().register("afterPaste"),fo.getSingleton().register("beforeCopy"),fo.getSingleton().register("afterCopy");var ck="copyPaste",hk=new WeakMap,fk=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),dk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ik(e,t)}(l,e);var t,n,o,r=ak(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).columnsLimit=1e3,t.copyableRanges=[],t.focusableElement=void 0,t.pasteMode="overwrite",t.rowsLimit=1e3,t.uiContainer=t.hot.rootDocument.body,hk.set(sk(t),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return ck}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,n,o,r=this.hot.getSettings(),c=r.copyPaste,h=r.fragmentSelection;hk.get(this).isFragmentSelectionEnabled=!!h,"object"===nk(c)&&(this.pasteMode=c.pasteMode||this.pasteMode,this.rowsLimit=isNaN(c.rowsLimit)?this.rowsLimit:c.rowsLimit,this.columnsLimit=isNaN(c.columnsLimit)?this.columnsLimit:c.columnsLimit,this.uiContainer=c.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=(t=this.uiContainer,n=new $S(t),o=XS.get(t),o=isNaN(o)?0:o,XS.set(t,o+1),n),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),rk(uk(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),rk(uk(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&JS(this.focusableElement),rk(uk(l.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){hk.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){hk.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],o=[],r=[];return X(e,(function(e){ur(e.startRow,e.endRow,(function(e){-1===o.indexOf(e)&&o.push(e)})),ur(e.startCol,e.endCol,(function(e){-1===r.indexOf(e)&&r.push(e)}))})),X(o,(function(e){var o=[];X(r,(function(n){o.push(t.hot.getCopyableData(e,n))})),n.push(o)})),Vy(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],o=[],r=[];return X(e,(function(e){ur(e.startRow,e.endRow,(function(e){-1===o.indexOf(e)&&o.push(e)})),ur(e.startCol,e.endCol,(function(e){-1===r.indexOf(e)&&r.push(e)}))})),X(o,(function(e){var o=[];X(r,(function(n){o.push(t.hot.getCopyableData(e,n))})),n.push(o)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new GS;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),o=t.row,r=t.col,l=n.row,c=n.col,h=Math.min(l,o+this.rowsLimit-1),f=Math.min(c,r+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:o,startCol:r,endRow:h,endCol:f}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),l===h&&c===f||this.hot.runHooks("afterCopyLimit",l-o+1,c-r+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var n=e.length,o=e[0].length,r=[],l=t.getTopLeftCorner(),c=l.row,h=l.col,f=t.getBottomRightCorner(),d=f.row,y=f.col,v=c,m=h,w=c,C=h;r.length<n||v<=d;){var S=this.hot.getCellMeta(v,h),k=S.skipRowOnPaste,R=S.visualRow;if(v=R+1,!0!==k){w=R,m=h;for(var O=[],E=r.length%n;O.length<o||m<=y;){var T=this.hot.getCellMeta(c,m),A=T.skipColumnOnPaste,M=T.visualCol;if(m=M+1,!0!==A){C=M;var x=O.length%o;O.push(e[E][x])}}r.push(O)}}return this.hot.populateFromArray(c,h,r,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,h,w,C]}}},{key:"onCopy",value:function(e){var t=hk.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var o=Vy(n);if(e&&e.clipboardData){var r=ir(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[fk,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=hk.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var o=Vy(n);if(e&&e.clipboardData){var r=ir(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[fk,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var n=Mt(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=n&&/(<table)|(<TABLE)/g.test(n)?ar(n,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=function(e){var t=[[""]];if(0===e.length)return t;for(var n,o=0,r=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(By))e=e.replace(By,""),o+=1,t[r][o]="";else if(e.match(jy))e=e.replace(jy,""),o=0,t[r+=1]=[""];else{var l="";if(e.startsWith('"')){for(var c=0,h=!0;h;){var f=e.slice(0,1);'"'===f&&(c+=1),l+=f,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&c%2==0)&&(h=!1)}l=l.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var d=e.match(Ly);l=d?d[0]:"",e=e.slice(l.length)}t[r][o]=l}return t}(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var o=ek(this.populateValues(t),4),r=o[0],l=o[1],c=o[2],h=o[3];this.hot.selectCell(r,l,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase(Kh)},callback:function(){t.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}),function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase($h)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=hk.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&bn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(JS(this.focusableElement),this.focusableElement=null),rk(uk(l.prototype),"destroy",this).call(this)}}])&&ok(t.prototype,n),o&&ok(t,o),l}(mm);function pk(e,col){return"border_row".concat(e,"col").concat(col)}function yk(e,col){return{id:pk(e,col),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:col,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function gk(e,t){var n=!1;return X(e.getSelectedRange(),(function(o){o.forAll((function(o,r){if(!(o<0||r<0)){var l=e.getCellMeta(o,r).borders;if(l){if(!t)return n=!0,!1;if(!Re(l[t],"hide")||!1===l[t].hide)return n=!0,!1}}}))})),n}function vk(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}function mk(e){return{key:"borders:right",name:function(){var label=this.getTranslatedPhrase(pf);return gk(this,"right")&&(label=vk(label)),label},callback:function(t,n){var o=gk(this,"right");e.prepareBorder(n,"right",o)}}}function bk(e){return{key:"borders:bottom",name:function(){var label=this.getTranslatedPhrase(yf);return gk(this,"bottom")&&(label=vk(label)),label},callback:function(t,n){var o=gk(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function wk(e){return{key:"borders:left",name:function(){var label=this.getTranslatedPhrase(gf);return gk(this,"left")&&(label=vk(label)),label},callback:function(t,n){var o=gk(this,"left");e.prepareBorder(n,"left",o)}}}function Ck(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(vf)},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!gk(this)}}}function Sk(e){return(Sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kk(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Rk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rk(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rk(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ok(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ek(e,t,n){return(Ek="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=xk(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Tk(e,p){return(Tk=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Ak(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=xk(e);if(t){var r=xk(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Mk(this,n)}}function Mk(e,t){return!t||"object"!==Sk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xk(e){return(xk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _k="customBorders",Pk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tk(e,t)}(l,e);var t,n,o,r=Ak(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).savedBorders=[],t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return _k}},{key:"PLUGIN_PRIORITY",get:function(){return 90}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),Ek(xk(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Ek(xk(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Ek(xk(l.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,o=t?Object.keys(t):["top","right","bottom","left"],r=ly(ay(e));X(e,(function(e){for(var l=kk(r(e),4),c=l[0],h=l[1],f=l[2],d=l[3],y=function(e){for(var r=function(col){X(o,(function(o){n.prepareBorderFromCustomAdded(e,col,t,o)}))},col=h;col<=d;col+=1)r(col)},v=c;v<=f;v+=1)y(v)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=ly(ay(e)),o=[];return X(e,(function(e){for(var r=kk(n(e),4),l=r[0],c=r[1],h=r[2],f=r[3],d=function(e){for(var n=function(col){X(t.savedBorders,(function(t){t.row===e&&t.col===col&&o.push(t)}))},col=c;col<=f;col+=1)n(col)},y=l;y<=h;y+=1)d(y)})),o}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(X(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var n=new Hd(new Wn(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,o){var r=this.hot.countRows(),l=this.hot.countCols();if(!(e>=r||t>=l)){var c,h,f=yk(e,t);n&&(c=f,Re(h=n,"border")&&(c.border=h.border),Re(h,"top")&&(h.top?(ve(h.top)||(h.top={width:1,color:"#000"}),c.top=h.top):(h.top={hide:!0},c.top=h.top)),Re(h,"right")&&(h.right?(ve(h.right)||(h.right={width:1,color:"#000"}),c.right=h.right):(h.right={hide:!0},c.right=h.right)),Re(h,"bottom")&&(h.bottom?(ve(h.bottom)||(h.bottom={width:1,color:"#000"}),c.bottom=h.bottom):(h.bottom={hide:!0},c.bottom=h.bottom)),Re(h,"left")&&(h.left?(ve(h.left)||(h.left={width:1,color:"#000"}),c.left=h.left):(h.left={hide:!0},c.left=h.left)),f=c,X(this.hot.selection.highlight.customSelections,(function(e){if(f.id===e.settings.id)return Object.assign(e.settings,n),f.id=e.settings.id,f.left=e.settings.left,f.right=e.settings.right,f.top=e.settings.top,f.bottom=e.settings.bottom,!1}))),this.hot.setCellMeta(e,t,"borders",f),this.insertBorderIntoSettings(f,o)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e){var t=this,n=e.range,o=Math.min(n.to.row,this.hot.countRows()-1),r=Math.min(n.to.col,this.hot.countCols()-1);ur(n.from.row,o,(function(o){ur(n.from.col,r,(function(r){var l=yk(o,r),c=0;o===n.from.row&&Re(e,"top")&&(c+=1,l.top=e.top),o===n.to.row&&Re(e,"bottom")&&(c+=1,l.bottom=e.bottom),r===n.from.col&&Re(e,"left")&&(c+=1,l.left=e.left),r===n.to.col&&Re(e,"right")&&(c+=1,l.right=e.right),c>0&&(t.hot.setCellMeta(o,r,"borders",l),t.insertBorderIntoSettings(l))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=pk(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,o){var r=this.hot.getCellMeta(e,t).borders;r&&void 0!==r.border||(r=yk(e,t)),o?(r[n]={hide:!0},4===this.countHide(r)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(r,n,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",r))):(r[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(r,n,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",r))}},{key:"prepareBorder",value:function(e,t,n){var o=this;X(e,(function(e){var r=e.start,l=e.end;if(r.row===l.row&&r.col===l.col)"noBorders"===t?o.removeAllBorders(r.row,r.col):o.setBorder(r.row,r.col,t,n);else switch(t){case"noBorders":ur(r.col,l.col,(function(e){ur(r.row,l.row,(function(t){o.removeAllBorders(t,e)}))}));break;case"top":ur(r.col,l.col,(function(e){o.setBorder(r.row,e,t,n)}));break;case"right":ur(r.row,l.row,(function(e){o.setBorder(e,l.col,t,n)}));break;case"bottom":ur(r.col,l.col,(function(e){o.setBorder(l.row,e,t,n)}));break;case"left":ur(r.row,l.row,(function(e){o.setBorder(e,r.col,t,n)}))}}))}},{key:"createCustomBorders",value:function(e){var t=this;X(e,(function(e){e.range?t.prepareBorderFromCustomAddedRange(e):t.prepareBorderFromCustomAdded(e.row,e.col,e)}))}},{key:"countHide",value:function(e){return G(Object.values(e),(function(e,t){var n=e;return t.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=$(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;X(this.hot.selection.highlight.customSelections,(function(t,n){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[n].destroy(),e.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var e=this;X(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=$(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,n=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),n=!0):X(this.savedBorders,(function(o,r){if(e.id===o.id)return t.savedBorders[r]=e,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,n){var o=!1;return X(this.hot.selection.highlight.customSelections,(function(r){if(e.id===r.settings.id)return be(r.instanceBorders,(function(e){e.toggleHiddenClass(t,n)})),o=!0,!1})),o}},{key:"checkCustomSelections",value:function(e,t,n){var o=this.countHide(e),r=!1;return 4===o?(this.removeAllBorders(e.row,e.col),r=!0):X(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return o.visualCellRange=t,o.commit(),n&&be(o.instanceBorders,(function(t){t.changeBorderStyle(n,e)})),r=!0,!1})),r}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings().customBorders;Array.isArray(e)?(e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;this.hot.getSettings().customBorders&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(ff)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name:function(){var label=this.getTranslatedPhrase(df);return gk(this,"top")&&(label=vk(label)),label},callback:function(e,n){var o=gk(this,"top");t.prepareBorder(n,"top",o)}}),mk(this),bk(this),wk(this),Ck(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Ek(xk(l.prototype),"destroy",this).call(this)}}])&&Ok(t.prototype,n),o&&Ok(t,o),l}(mm);function Ik(e){return(Ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dk(e,t,n){return(Dk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Vk(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Nk(e,p){return(Nk=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function jk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Vk(e);if(t){var r=Vk(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Lk(this,n)}}function Lk(e,t){return!t||"object"!==Ik(t)&&"function"!=typeof t?Bk(e):t}function Bk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vk(e){return(Vk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fk="dragToScroll",Wk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nk(e,t)}(l,e);var t,n,o,r=jk(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(Bk(t)),t.boundaries=null,t.callback=null,t.listening=!1,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return Fk}},{key:"PLUGIN_PRIORITY",get:function(){return 100}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),Dk(Vk(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Dk(Vk(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Dk(Vk(l.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mousemove",(function(t){return e.onMouseMove(t)})),t=Ht(t)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!Qn(e)){var t=this.hot.view.wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){Dk(Vk(l.prototype),"destroy",this).call(this)}}])&&Hk(t.prototype,n),o&&Hk(t,o),l}(mm);function Uk(e){return(Uk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yk(e,t,n){return(Yk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=qk(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Gk(e,p){return(Gk=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Kk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=qk(e);if(t){var r=qk(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return $k(this,n)}}function $k(e,t){return!t||"object"!==Uk(t)&&"function"!=typeof t?Xk(e):t}function Xk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qk(e){return(qk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("afterDropdownMenuDefaultOptions"),fo.getSingleton().register("beforeDropdownMenuShow"),fo.getSingleton().register("afterDropdownMenuShow"),fo.getSingleton().register("afterDropdownMenuHide"),fo.getSingleton().register("afterDropdownMenuExecute");var Zk="dropdownMenu",Qk="changeType",Jk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gk(e,t)}(l,e);var t,n,o,r=Kk(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(Xk(t)),t.commandExecutor=new oS(t.hot),t.itemsFactory=null,t.menu=null,t.hot.addHook("afterGetColHeader",(function(col,e){return t.onAfterGetColHeader(col,e)})),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return Zk}},{key:"PLUGIN_PRIORITY",get:function(){return 230}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[aS,lS,RC,fS,RC,iS,RC,sS,RC,rS]}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new AS(this.hot,l.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),Yk(qk(l.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",n),e.itemsFactory.setPredefinedItems(n.items);var o=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new IS(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",o),e.menu.setMenuItems(o),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.executeCommand).call.apply(t,[e].concat(o))})),X(o,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Yk(qk(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Yk(qk(l.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(t=this.commandExecutor).execute.apply(t,[e].concat(o))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),zt(e.target,Qk)&&!this.menu.isOpened()){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var o=this.hot.rootWindow.frameElement.getBoundingClientRect();t=o.top,n=o.left}var rect=e.target.getBoundingClientRect();this.open({left:rect.left+n,top:rect.top+e.target.offsetHeight+3+t,width:rect.width,height:rect.height})}}},{key:"onAfterGetColHeader",value:function(col,e){var t=e.parentNode;if(t){var n=t.parentNode.childNodes,o=Array.prototype.indexOf.call(n,t);if(!(col<0||o!==n.length-1)){var r=e.querySelector(".".concat(Qk));if(!this.enabled||!r)if(this.enabled){var button=this.hot.rootDocument.createElement("button");button.className=Qk,button.onclick=function(){return!1},e.firstChild.insertBefore(button,e.firstChild.firstChild)}else r&&r.parentNode.removeChild(r)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Yk(qk(l.prototype),"destroy",this).call(this)}}])&&zk(t.prototype,n),o&&zk(t,o),l}(mm);function eR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return tR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function nR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Jk.SEPARATOR={name:RC};var oR=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options={}}var t,n,o;return t=e,(n=[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,o=t.startCol,r=t.endRow,l=t.endCol,c=this.options,data=[];return ur(n,r,(function(t){var n=[];!c.exportHiddenRows&&e._isHiddenRow(t)||(ur(o,l,(function(o){!c.exportHiddenColumns&&e._isHiddenColumn(o)||n.push(e.hot.getDataAtCell(t,o))})),data.push(n))})),data}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),o=n.startRow,r=n.endRow,l=this.hot.getRowHeader();ur(o,r,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(l[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),o=n.startCol,r=n.endCol,l=this.hot.getColHeader();ur(o,r,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(l[n])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=eR(this.options.range,4),o=n[0],r=void 0===o?0:o,l=n[1],c=void 0===l?0:l,h=n[2],f=void 0===h?t:h,d=n[3],y=void 0===d?e:d;return{startRow:r=Math.max(r,0),startCol:c=Math.max(c,0),endRow:f=Math.min(f,t),endCol:y=Math.min(y,e)}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}])&&nR(t.prototype,n),o&&nR(t,o),e}();function rR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var iR=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}var t,n,o;return t=e,o=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}],(n=[{key:"_mergeOptions",value:function(t){var n=pe(this.constructor.DEFAULT_OPTIONS),o=new Date;return n=he(pe(e.DEFAULT_OPTIONS),n),(n=he(n,t)).filename=Tt(n.filename,{YYYY:o.getFullYear(),MM:"".concat(o.getMonth()+1).padStart(2,"0"),DD:"".concat(o.getDate()).padStart(2,"0")}),n}}])&&rR(t.prototype,n),o&&rR(t,o),e}();function aR(e){return(aR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uR(e,p){return(uR=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function cR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=fR(e);if(t){var r=fR(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return hR(this,n)}}function hR(e,t){return!t||"object"!==aR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fR(e){return(fR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dR=String.fromCharCode(13),pR=String.fromCharCode(34),yR=String.fromCharCode(10),gR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uR(e,t)}(l,e);var t,n,o,r=cR(l);function l(){return lR(this,l),r.apply(this,arguments)}return t=l,o=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],(n=[{key:"export",value:function(){var e=this,t=this.options,data=this.dataProvider.getData(),n=this.dataProvider.getColumnHeaders(),o=n.length>0,r=this.dataProvider.getRowHeaders(),l=r.length>0,c=t.bom?String.fromCharCode(65279):"";return o&&(n=$(n,(function(t){return e._escapeCell(t,!0)})),l&&(c+=t.columnDelimiter),c+=n.join(t.columnDelimiter),c+=t.rowDelimiter),X(data,(function(n,o){o>0&&(c+=t.rowDelimiter),l&&(c+=e._escapeCell(r[o])+t.columnDelimiter),c+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),c}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ot(e);return""!==n&&(t||n.indexOf(dR)>=0||n.indexOf(pR)>=0||n.indexOf(yR)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}])&&sR(t.prototype,n),o&&sR(t,o),l}(iR);var vR,mR,bR,wR=(bR=gR,(mR="csv")in(vR={})?Object.defineProperty(vR,mR,{value:bR,enumerable:!0,configurable:!0,writable:!0}):vR[mR]=bR,vR);function CR(e,t,n){return"function"==typeof wR[e]?new wR[e](t,n):null}function SR(e){return(SR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function OR(e,p){return(OR=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ER(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=AR(e);if(t){var r=AR(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return TR(this,n)}}function TR(e,t){return!t||"object"!==SR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AR(e){return(AR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OR(e,t)}(l,e);var t,n,o,r=ER(l);function l(){return kR(this,l),r.apply(this,arguments)}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return"exportFile"}},{key:"PLUGIN_PRIORITY",get:function(){return 240}}],(n=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,o=n.rootDocument,r=n.rootWindow,l=this._createTypeFormatter(e,t),c=this._createBlob(l),h=r.URL||r.webkitURL,a=o.createElement("a"),f="".concat(l.options.filename,".").concat(l.options.fileExtension);if(void 0!==a.download){var d=h.createObjectURL(c);a.style.display="none",a.setAttribute("href",d),a.setAttribute("download",f),o.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),o.body.removeChild(a),setTimeout((function(){h.revokeObjectURL(d)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,f)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!wR[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return CR(e,new oR(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}])&&RR(t.prototype,n),o&&RR(t,o),l}(mm);function xR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _R=function(){function e(t,n){var o=n.id,r=n.stateless,l=void 0===r||r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.id=o,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=l?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Vc)}var t,n,o;return t=e,(n=[{key:"reset",value:function(){X(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),X(this.elements,(function(e){return e.destroy()})),this.state=null,this.elements=null,this.hot=null}}])&&xR(t.prototype,n),o&&xR(t,o),e}();ye(_R,Uu);var PR=_R,IR={};function HR(e,t){if(!IR[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var n=IR[e],o=n.condition,r=n.descriptor,l=t;return r.inputValuesDecorator&&(l=r.inputValuesDecorator(l)),function(e){return o.apply(e.meta.instance,[].concat([e],[l]))}}function DR(e){if(!IR[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return IR[e].descriptor}function NR(e,t,n){n.key=e,IR[e]={condition:t,descriptor:n}}var jR="none";NR(jR,(function(){return!0}),{name:Ef,inputsCount:0,showOperators:!1});var LR="empty";NR(LR,(function(e){return lt(e.value)}),{name:Tf,inputsCount:0,showOperators:!0});var BR="not_empty";function VR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return FR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(BR,(function(e,t){return!HR(LR,t)(e)}),{name:Af,inputsCount:0,showOperators:!0});var WR="eq";NR(WR,(function(e,t){var n=VR(t,1)[0];return ot(e.value).toLowerCase()===ot(n)}),{name:Mf,inputsCount:1,showOperators:!0});var UR="neq";function zR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return YR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(UR,(function(e,t){return!HR(WR,t)(e)}),{name:xf,inputsCount:1,showOperators:!0});function GR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return KR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR("gt",(function(e,t){var n=zR(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>n}),{name:Nf,inputsCount:1,showOperators:!0});function $R(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return XR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function XR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR("gte",(function(e,t){var n=GR(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>=n}),{name:jf,inputsCount:1,showOperators:!0});function qR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return ZR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR("lt",(function(e,t){var n=$R(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<n}),{name:Lf,inputsCount:1,showOperators:!0});function QR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return JR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR("lte",(function(e,t){var n=qR(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<=n}),{name:Bf,inputsCount:1,showOperators:!0});var eO="date_after";function tO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return nO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(eO,(function(e,t){var n=QR(t,1)[0],o=Je(e.value,e.meta.dateFormat),r=Je(n,e.meta.dateFormat);return!(!o.isValid()||!r.isValid())&&o.diff(r)>=0}),{name:Wf,inputsCount:1,showOperators:!0});var oO="date_before";function rO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return iO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(oO,(function(e,t){var n=tO(t,1)[0],o=Je(e.value,e.meta.dateFormat),r=Je(n,e.meta.dateFormat);return!(!o.isValid()||!r.isValid())&&o.diff(r)<=0}),{name:Uf,inputsCount:1,showOperators:!0});var aO="between";NR(aO,(function(e,t){var n=rO(t,2),o=n[0],r=n[1];if("numeric"===e.meta.type){var l=parseFloat(o,10),c=parseFloat(r,10);o=Math.min(l,c),r=Math.max(l,c)}else if("date"===e.meta.type){var h=HR(oO,[r]),f=HR(eO,[o]);return h(e)&&f(e)}return e.value>=o&&e.value<=r}),{name:Vf,inputsCount:2,showOperators:!0});var lO="not_between";function sO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return uO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(lO,(function(e,t){return!HR(aO,t)(e)}),{name:Ff,inputsCount:2,showOperators:!0});var cO="begins_with";NR(cO,(function(e,t){var n=sO(t,1)[0];return ot(e.value).toLowerCase().startsWith(ot(n))}),{name:_f,inputsCount:1,showOperators:!0});n(210);function hO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return fO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var dO="ends_with";function pO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return yO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}NR(dO,(function(e,t){var n=hO(t,1)[0];return ot(e.value).toLowerCase().endsWith(ot(n))}),{name:Pf,inputsCount:1,showOperators:!0});var gO="contains";NR(gO,(function(e,t){var n=pO(t,1)[0];return ot(e.value).toLowerCase().indexOf(ot(n))>=0}),{name:If,inputsCount:1,showOperators:!0});var vO="not_contains";NR(vO,(function(e,t){return!HR(gO,t)(e)}),{name:Hf,inputsCount:1,showOperators:!0});var mO="date_tomorrow";NR(mO,(function(e){var t=Je(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Je().subtract(-1,"days").startOf("day"),"d")}),{name:Yf,inputsCount:0});var bO="date_today";NR(bO,(function(e){var t=Je(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Je().startOf("day"),"d")}),{name:zf,inputsCount:0});var wO,CO="date_yesterday";function SO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}NR(CO,(function(e){var t=Je(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Je().subtract(1,"days").startOf("day"),"d")}),{name:Gf,inputsCount:0});var kO="text",RO=(SO(wO={},"numeric",[jR,RC,LR,BR,RC,WR,UR,RC,"gt","gte","lt","lte",aO,lO]),SO(wO,kO,[jR,RC,LR,BR,RC,WR,UR,RC,cO,dO,RC,gO,vO]),SO(wO,"date",[jR,RC,LR,BR,RC,WR,UR,RC,oO,eO,aO,RC,mO,bO,CO]),wO);function OO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var EO="built",TO="building",AO=["click","input","keydown","keypress","keyup","focus","blur","change"],MO=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.eventManager=new Po(this),this.options=he(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}var t,n,o;return t=e,o=[{key:"DEFAULTS",get:function(){return pe({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}],(n=[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===TO?this._element:this.buildState===EO?(this.update(),this._element):(this.buildState=TO,this.build(),this.buildState=EO,this._element)}},{key:"isBuilt",value:function(){return this.buildState===EO}},{key:"translateIfPossible",value:function(e){return"string"==typeof e&&e.startsWith(Rf)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(element,t){e.eventManager.addEventListener(element,t,(function(n){return e.runLocalHooks(t,n,e)}))};if(this.buildState||(this.buildState=TO),this.options.className&&Yt(this._element,this.options.className),this.options.children.length)X(this.options.children,(function(element){return e._element.appendChild(element.element)}));else if(this.options.wrapIt){var element=this.hot.rootDocument.createElement(this.options.tagName);be(this.options,(function(t,n){void 0!==element[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(element[n]=e.translateIfPossible(t))})),this._element.appendChild(element),X(AO,(function(e){return t(element,e)}))}else X(AO,(function(n){return t(e._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}])&&OO(t.prototype,n),o&&OO(t,o),e}();ye(MO,Uu);var xO=MO;function _O(e){return(_O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function IO(e,t,n){return(IO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=LO(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function HO(e,p){return(HO=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function DO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=LO(e);if(t){var r=LO(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return NO(this,n)}}function NO(e,t){return!t||"object"!==_O(t)&&"function"!=typeof t?jO(e):t}function jO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LO(e){return(LO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var BO=new WeakMap,VO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HO(e,t)}(l,e);var t,n,o,r=DO(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,he(l.DEFAULTS,t)),BO.set(jO(n),{}),n.registerHooks(),n}return t=l,o=[{key:"DEFAULTS",get:function(){return pe({placeholder:"",type:"text",tagName:"input"})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){IO(LO(l.prototype),"build",this).call(this);var e=BO.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Yt(this._element,"htUIInput"),Yt(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var input=BO.get(this).input;input.type=this.options.type,input.placeholder=this.translateIfPossible(this.options.placeholder),input.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&BO.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}])&&PO(t.prototype,n),o&&PO(t,o),l}(xO);function FO(e){return(FO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function UO(e,t,n){return(UO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=$O(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function zO(e,p){return(zO=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function YO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=$O(e);if(t){var r=$O(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return GO(this,n)}}function GO(e,t){return!t||"object"!==FO(t)&&"function"!=typeof t?KO(e):t}function KO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $O(e){return($O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var XO=new WeakMap,qO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zO(e,t)}(l,e);var t,n,o,r=YO(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,he(l.DEFAULTS,t)),XO.set(KO(n),{}),n.menu=null,n.items=[],n.registerHooks(),n}return t=l,o=[{key:"DEFAULTS",get:function(){return pe({className:"htUISelect",wrapIt:!1})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return X(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;UO($O(l.prototype),"build",this).call(this),this.menu=new IS(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var caption=new xO(this.hot,{className:"htUISelectCaption"}),t=new xO(this.hot,{className:"htUISelectDropdown"}),n=XO.get(this);n.caption=caption,n.captionElement=caption.element,n.dropdown=t,X([caption,t],(function(element){return e._element.appendChild(element.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(Ef),XO.get(this).captionElement.textContent=e,UO($O(l.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var rect=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:rect.left-5,top:rect.top-1,width:rect.width,height:rect.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==RC&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=XO.get(this),caption=e.caption,t=e.dropdown;caption&&caption.destroy(),t&&t.destroy(),UO($O(l.prototype),"destroy",this).call(this)}}])&&WO(t.prototype,n),o&&WO(t,o),l}(xO);function ZO(e){return(ZO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QO(e){return function(e){if(Array.isArray(e))return JO(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return JO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JO(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function eE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tE(e,t,n){return(tE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=iE(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function nE(e,p){return(nE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function oE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=iE(e);if(t){var r=iE(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rE(this,n)}}function rE(e,t){return!t||"object"!==ZO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iE(e){return(iE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var aE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nE(e,t)}(l,e);var t,n,o,r=oE(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.addSeparator=t.addSeparator,n.elements.push(new qO(n.hot,{menuContainer:t.menuContainer})),n.elements.push(new VO(n.hot,{placeholder:rd})),n.elements.push(new VO(n.hot,{placeholder:id})),n.registerHooks(),n}return t=l,(n=[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),X(this.getInputElements(),(function(input){input.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=pe(e.command);n.name.startsWith(Of)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),X(e.args,(function(e,o){if(o>n.inputsCount-1)return!1;var element=t.getInputElement(o);element.setValue(e),element[n.inputsCount>o?"show":"hide"](),o||setTimeout((function(){return element.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||DR(jR),t=[];return X(this.getInputElements(),(function(element,n){e.inputsCount>n&&t.push(element.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var n=DR(e?e.name:jR);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||X(this.getInputElements(),(function(element){return element.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof qO}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(element){return element instanceof VO}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,o,col,r,l){Yt(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&Yt(n.parentNode,"border");var label=e.hot.rootDocument.createElement("div");return Yt(label,"htFiltersMenuLabel"),label.textContent=l,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||X(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e,t=this.hot.getPlugin("filters").getSelectedColumn(),n=t&&t.visualIndex,o=function(e){var t=[],n=e;return RO[n]||(n=kO),X(RO[n],(function(e){var option;option=e===RC?{name:RC}:pe(DR(e)),t.push(option)})),t}((e=this.hot).getDataType.apply(e,QO(this.hot.getSelectedLast()||[0,n])));X(this.getInputElements(),(function(element){return element.hide()})),this.getSelectElement().setItems(o),tE(iE(l.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(e){X(this.getInputElements(),(function(element,t){element[e.inputsCount>t?"show":"hide"](),0===t&&setTimeout((function(){return element.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){Xn(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),qn(e)):Xn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),qn(e))}}])&&eE(t.prototype,n),o&&eE(t,o),l}(PR),lE={};function sE(e){if(!lE[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=lE[e].func;return function(e,n){return t(e,n)}}function uE(e,t,n){lE[e]={name:t,func:n}}var cE="conjunction";uE(cE,Xf,(function(e,t){return e.every((function(e){return e.func(t)}))}));var hE="disjunction";uE(hE,qf,(function(e,t){return e.some((function(e){return e.func(t)}))}));var fE="disjunctionWithExtraCondition";function dE(e){return(dE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yE(e,t,n){return(yE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=wE(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function gE(e,p){return(gE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function vE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=wE(e);if(t){var r=wE(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return mE(this,n)}}function mE(e,t){return!t||"object"!==dE(t)&&"function"!=typeof t?bE(e):t}function bE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wE(e){return(wE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}uE(fE,qf,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}));var CE,SE=new WeakMap,kE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gE(e,t)}(l,e);var t,n,o,r=vE(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,he(l.DEFAULTS,t)),SE.set(bE(n),{}),n}return t=l,o=[{key:"DEFAULTS",get:function(){return pe({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}],(n=[{key:"build",value:function(){yE(wE(l.prototype),"build",this).call(this);var e=SE.get(this);e.input=this._element.firstChild;var label=this.hot.rootDocument.createElement("label");label.textContent=this.translateIfPossible(this.options.label.textContent),label.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=label,this._element.appendChild(label),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=SE.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&SE.get(this).input.focus()}}])&&pE(t.prototype,n),o&&pE(t,o),l}(xO);function RE(e){return(RE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EE(e,p){return(EE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function TE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ME(e);if(t){var r=ME(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return AE(this,n)}}function AE(e,t){return!t||"object"!==RE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ME(e){return(ME=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EE(e,t)}(l,e);var t,n,o,r=TE(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.buildOperatorsElement(),n}return t=l,(n=[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Yt(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||X(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[cE,hE];X(t,(function(n){var o,r=new kE(e.hot,{name:"operator",label:{htmlFor:n,textContent:(o=n,lE[o].name)},value:n,checked:n===t[0],id:n});r.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(r)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(et(CE||(CE=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Radio button with index "," doesn't exist."])),e));X(this.elements,(function(element,t){element.setChecked(t===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(element){return element instanceof kE&&element.isChecked()}));return e?e.getValue():cE}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&X(this.elements,(function(element){element.setChecked(element.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cE,t=arguments.length>1?arguments[1]:void 0,n=e;n===fE&&(n=hE),this.state.setValueAtIndex(t,n)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}])&&OE(t.prototype,n),o&&OE(t,o),l}(PR);F();function _E(e,t){var n=e;return""===n&&(n="(".concat(t,")")),n}var PE=new Set([1]).has(1),IE=PE&&"function"==typeof Array.from;function HE(e){var t=e;return PE&&(t=new Set(t)),function(e){return PE?t.has(e):!!~t.indexOf(e)}}function DE(e){return null==e?"":e}function NE(e){var t=e;return t=(t=IE?Array.from(new Set(t)):ne(t)).sort((function(a,b){return"number"==typeof a&&"number"==typeof b?a-b:a===b?0:a>b?1:-1}))}function jE(base,e,t,n){var o,r=[],l=base===e;return l||(o=HE(e)),X(base,(function(e){var c=!1;(l||o(e))&&(c=!0);var h={checked:c,value:e,visualValue:_E(e,t)};n&&n(h),r.push(h)})),r}n(297);function LE(e){return(LE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VE(e,t,n){return(VE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=YE(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function FE(e,p){return(FE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function WE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=YE(e);if(t){var r=YE(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return UE(this,n)}}function UE(e,t){return!t||"object"!==LE(t)&&"function"!=typeof t?zE(e):t}function zE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YE(e){return(YE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var GE=new WeakMap,KE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FE(e,t)}(l,e);var t,n,o,r=WE(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,he(l.DEFAULTS,t)),GE.set(zE(n),{}),n}return t=l,o=[{key:"DEFAULTS",get:function(){return pe({href:"#",tagName:"a"})}}],(n=[{key:"build",value:function(){VE(YE(l.prototype),"build",this).call(this),GE.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(GE.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}])&&BE(t.prototype,n),o&&BE(t,o),l}(xO);function $E(e){return($E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XE(e){return function(e){if(Array.isArray(e))return qE(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return qE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qE(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qE(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ZE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QE(e,t,n){return(QE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=oT(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function JE(e,p){return(JE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function eT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=oT(e);if(t){var r=oT(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return tT(this,n)}}function tT(e,t){return!t||"object"!==$E(t)&&"function"!=typeof t?nT(e):t}function nT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oT(e){return(oT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rT=new WeakMap,iT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JE(e,t)}(l,e);var t,n,o,r=eT(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,he(l.DEFAULTS,t)),rT.set(nT(n),{}),n.searchInput=new VO(n.hot,{placeholder:od,className:"htUIMultipleSelectSearch"}),n.selectAllUI=new KE(n.hot,{textContent:Qf,className:"htUISelectAll"}),n.clearAllUI=new KE(n.hot,{textContent:Jf,className:"htUIClearAll"}),n.items=[],n.itemsBox=null,n.registerHooks(),n}return t=l,o=[{key:"DEFAULTS",get:function(){return pe({className:"htUIMultipleSelect",value:[]})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return XE(this.items)}},{key:"getValue",value:function(){return e=this.items,t=[],X(e,(function(e){e.checked&&t.push(e.value)})),t;var e,t}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;QE(oT(l.prototype),"build",this).call(this);var t=this.hot.rootDocument,n=t.createElement("div"),o=new xO(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(n);var r=function(n){e._element&&(e.itemsBox&&e.itemsBox.destroy(),Yt(n,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(n,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,col,n,o,r){e.title=r.instance.getDataAtRowProp(t,r.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-kn(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}),e.itemsBox.init())};r(n),setTimeout((function(){return r(n)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var e,t,n;this.isBuilt()&&(this.itemsBox.loadData((e=this.items,t=this.options.value,n=HE(t),$(e,(function(e){return e.checked=n(e.value),e})))),QE(oT(l.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,QE(oT(l.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,n=e.target.value.toLowerCase();t=""===n?XE(this.items):K(this.items,(function(e){return"".concat(e.value).toLowerCase().indexOf(n)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this),Ln(Xn,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(qn(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(e){var t=Ln(Xn,e.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",e,this),t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(qn(e),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),X(this.itemsBox.getSourceData(),(function(e,n){e.checked=!0,t.push(Du(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),X(this.itemsBox.getSourceData(),(function(e,n){e.checked=!1,t.push(Du(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}])&&ZE(t.prototype,n),o&&ZE(t,o),l}(xO);function aT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return lT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var sT="by_value";function uT(e){return(uT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return hT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function fT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dT(e,t,n){return(dT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=vT(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function pT(e,p){return(pT=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function yT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=vT(e);if(t){var r=vT(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return gT(this,n)}}function gT(e,t){return!t||"object"!==uT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vT(e){return(vT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}NR(sT,(function(e,t){return(0,aT(t,1)[0])(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator:function(e){return[HE(aT(e,1)[0])]},showOperators:!1});var mT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pT(e,t)}(l,e);var t,n,o,r=yT(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.elements.push(new iT(n.hot)),n.registerHooks(),n}return t=l,(n=[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===sT){var select=this.getMultipleSelectElement();select.setItems(e.itemsSnapshot),select.setValue(e.args[0])}}},{key:"getState",value:function(){var select=this.getMultipleSelectElement(),e=select.getItems();return{command:{key:select.isSelectedAllValues()||!e.length?jR:sT},args:[select.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(e){var t=this,n=function(e,n,o,r,l){var c=cT(K(n,(function(e){return e.name===sT})),1)[0],h={},f=t.hot.getTranslatedPhrase(Zf);if(c){var d=NE($(r(e,l),(function(e){return e.value})));o&&(c.args[0]=o);var y=[],v=jE(d,c.args[0],f,(function(e){e.checked&&y.push(e.value)}));h.args=[y],h.command=DR(sT),h.itemsSnapshot=v}else h.args=[],h.command=DR(jR);t.state.setValueAtIndex(e,h)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof iT}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,o,col,r,l){Yt(n.parentNode,"htFiltersMenuValue");var label=e.hot.rootDocument.createElement("div");return Yt(label,"htFiltersMenuLabel"),label.textContent=l,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||X(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(Zf),t=NE(this._getColumnVisibleValues()),n=jE(t,t,e);this.getMultipleSelectElement().setItems(n),dT(vT(l.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t)}},{key:"onInputKeyDown",value:function(e){Xn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),qn(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=e&&e.visualIndex;return $(this.hot.getDataAtCol(t),(function(e){return DE(e)}))}}])&&fT(t.prototype,n),o&&fT(t,o),l}(PR);function bT(e){return(bT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CT(e,p){return(CT=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ST(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=RT(e);if(t){var r=RT(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return kT(this,n)}}function kT(e,t){return!t||"object"!==bT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RT(e){return(RT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var OT,ET,TT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CT(e,t)}(l,e);var t,n,o,r=ST(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,{id:t.id,stateless:!0})).name=t.name,n.elements.push(new VO(n.hot,{type:"button",value:ed,className:"htUIButton htUIButtonOK",identifier:l.BUTTON_OK})),n.elements.push(new VO(n.hot,{type:"button",value:nd,className:"htUIButton htUIButtonCancel",identifier:l.BUTTON_CANCEL})),n.registerHooks(),n}return t=l,o=[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}],(n=[{key:"registerHooks",value:function(){var e=this;X(this.elements,(function(element){element.addLocalHook("click",(function(t,button){return e.onButtonClick(t,button)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Yt(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||X(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,button){button.options.identifier===l.BUTTON_OK?this.accept():this.cancel()}}])&&wT(t.prototype,n),o&&wT(t,o),l}(PR);function AT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return MT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xT(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var IT="ConditionCollection.filteringStates",HT=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_T(this,e),this.hot=t,this.isMapRegistrable=n,this.filteringStates=new Vc,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(IT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}var t,n,o;return t=e,(n=[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(e,t){var n,o=this.filteringStates.getValueAtIndex(t),r=null!==(n=null==o?void 0:o.conditions)&&void 0!==n?n:[],l=null==o?void 0:o.operation;return this.isMatchInConditions(r,e,l)}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cE;return!e.length||sE(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cE,o=arguments.length>3?arguments[3]:void 0,r=$(t.args,(function(e){return"string"==typeof e?e.toLowerCase():e})),l=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);var c=this.getOperation(e);if(c){if(c!==n)throw Error(et(OT||(OT=xT(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,c))}else if(at(lE[n]))throw new Error(et(ET||(ET=xT(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var h=this.getConditions(e);0===h.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:l,args:r,func:HR(l,r)}]},o):h.push({name:l,args:r,func:HR(l,r)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}},{key:"getOperation",value:function(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(e){return AT(e,1)[0]}))}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return G(this.filteringStates.getEntries(),(function(e,t){var n=AT(t,2),o=n[0],r=n[1],l=r.operation,c=r.conditions;return e.push({column:o,operation:l,conditions:$(c,(function(e){return{name:e.name,args:e.args}}))}),e}),[])}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),X(e,(function(e){X(e.conditions,(function(n){return t.addCondition(e.column,n)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,t){var n=this.getConditions(e);return t?n.some((function(e){return e.name===t})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(IT),this.filteringStates=null,this.clearLocalHooks()}}])&&PT(t.prototype,n),o&&PT(t,o),e}();ye(HT,Uu);var DT=HT;function NT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var LT=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};NT(this,e),this.conditionCollection=t,this.columnDataFactory=n}var t,n,o;return t=e,(n=[{key:"filter",value:function(){var e=this,t=[];return X(this.conditionCollection.getFilteredColumns(),(function(n,o){var r=e.columnDataFactory(n);o&&(r=e._getIntersectData(r,t)),t=e.filterByColumn(n,r)})),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];return X(n,(function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&o.push(n)})),o}},{key:"_getIntersectData",value:function(data,e){var t=[];return X(e,(function(e){var n=e.meta.visualRow;void 0!==data[n]&&(t[n]=data[n])})),t}}])&&jT(t.prototype,n),o&&jT(t,o),e}();function BT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var FT=function(){function e(t,n){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};BT(this,e),this.hot=t,this.conditionCollection=n,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return o._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterRemove",(function(e){return o.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return o.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return o._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return o._onConditionAfterClean()}))}var t,n,o;return t=e,(n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,X(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var o=this.conditionCollection.exportAllConditions(),r=this.conditionCollection.getColumnStackPosition(e);-1===r&&(r=this.latestEditedColumnPosition);var l=o.slice(0,r),c=o.slice(r);c.length&&c[0].column===e&&c.shift();var h=Bn((function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=new DT(n.hot,!1),l=[].concat(e,o);r.importAllConditions(l);var c=n.columnDataFactory(t),h=HE($(r.isEmpty()?c:new LT(r,(function(e){return n.columnDataFactory(e)})).filter(),(function(e){return e.meta.visualRow})));return r.destroy(),K(c,(function(e){return h(e.meta.visualRow)}))}))(l),f=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:f},dependentConditionStacks:c,filteredRowsFactory:h,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;X(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),be(this,(function(t,n){e[n]=null}))}}])&&VT(t.prototype,n),o&&VT(t,o),e}();ye(FT,Uu);var WT,UT=FT;function zT(e){return(zT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return GT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function KT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $T(e,t,n){return($T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=JT(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function XT(e,p){return(XT=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function qT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=JT(e);if(t){var r=JT(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ZT(this,n)}}function ZT(e,t){return!t||"object"!==zT(t)&&"function"!=typeof t?QT(e):t}function QT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JT(e){return(JT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eA="filters",tA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XT(e,t)}(l,e);var t,n,o,r=qT(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).eventManager=new Po(QT(t)),t.dropdownMenuPlugin=null,t.conditionCollection=null,t.conditionUpdateObserver=null,t.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),t.lastSelectedColumn=null,t.filtersRowsMap=null,t.hot.addHook("afterGetColHeader",(function(col,e){return t.onAfterGetColHeader(col,e)})),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return eA}},{key:"PLUGIN_PRIORITY",get:function(){return 250}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new $c),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,o=function(component){return component.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),component.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),component.addLocalHook("change",(function(t){return e.onComponentChange(component,t)})),component};if(!this.components.get("filter_by_condition")){var r=new aE(this.hot,{id:"filter_by_condition",name:function(){return"".concat(e.hot.getTranslatedPhrase(Kf),":")},addSeparator:!1,menuContainer:n});r.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",o(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new xE(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new aE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});c.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new mT(this.hot,{id:"filter_by_value",name:function(){return"".concat(e.hot.getTranslatedPhrase($f),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new TT(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new DT(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new UT(this.hot,this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(component){return component.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),$T(JT(l.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"disablePlugin",value:function(){var e,t=this;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(component,e){component.destroy(),t.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),$T(JT(l.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:cE,r=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(r,{command:{key:t},args:n},o)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),o=[],r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(n){var l=[];this.hot.batchExecution((function(){e.filtersRowsMap.clear();var n=HE(o=$(t.filter(),(function(e){return e.meta.visualRow})));ur(e.hot.countSourceRows()-1,(function(e){n(e)||l.push(e)})),X(l,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),o.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",r),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.getTopLeftCorner();void 0!==t&&this.hot.selectCell(t.row,t.col)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.hot.toVisualColumn(e),data=[];return X(this.hot.getSourceDataAtCol(n),(function(e,o){var r=t.hot.getCellMeta(o,n),l=r.row,col=r.col,c=r.visualCol,h=r.visualRow,f=r.type,d=r.instance,y=r.dateFormat;data.push({meta:{row:l,col:col,visualCol:c,visualRow:h,type:f,instance:d,dateFormat:y},value:DE(e)})})),data}},{key:"onAfterChange",value:function(e){var t=this;e&&X(e,(function(e){var n=YT(e,2)[1],o=t.hot.propToCol(n);t.conditionCollection.hasConditions(o)&&t.updateValueComponentCondition(o)}))}},{key:"updateValueComponentCondition",value:function(e){var t=NE(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}},{key:"restoreComponents",value:function(e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((function(component){component.isHidden()||component.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var e=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:RC}),this.components.forEach((function(component){e.items.push(component.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,n,o){var r=e;return r===hE&&t.command.key!==jR&&n.command.key!==jR&&o.command.key!==jR?r=fE:o.command.key!==jR&&(t.command.key!==jR&&n.command.key!==jR||(r=cE)),r}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex,o=this.components.get("filter_by_condition").getState(),r=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,r,l);this.conditionUpdateObserver.groupChanges();var h=this.conditionCollection.getColumnStackPosition(n);-1===h&&(h=void 0),this.conditionCollection.removeConditions(n),o.command.key!==jR&&(this.conditionCollection.addCondition(n,o,c,h),r.command.key!==jR&&this.conditionCollection.addCondition(n,r,c,h)),l.command.key!==jR&&this.conditionCollection.addCondition(n,l,c,h),this.conditionUpdateObserver.flush(),this.components.forEach((function(component){return component.saveState(n)})),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(component,e){this.updateDependentComponentsVisibility(),component.constructor!==aE||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var e=this.components.get("filter_by_condition").getState().command,t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents.apply(this,t):this.hideComponents.apply(this,t)}},{key:"onAfterGetColHeader",value:function(col,e){var t=this.hot.toPhysicalColumn(col);this.enabled&&this.conditionCollection.hasConditions(t)?Yt(e,"htFiltersActive"):Gt(e,"htFiltersActive")}},{key:"onTableClick",value:function(e){var th=Nt(e.target,"TH");if(th){var t=this.hot.getCoords(th).col,n=this.hot.toPhysicalColumn(t);this.lastSelectedColumn={visualIndex:t,physicalIndex:n}}}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new LT(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){var t;if(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled){var n=e.editedConditionStack,o=n.conditions,r=n.column,l=o.filter((function(e){return e.name===sT})),c=o.filter((function(e){return e.name!==sT}));if(l.length>=2||c.length>=3)to(et(WT||(WT=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var h=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(c[0],r),this.components.get("filter_by_condition2").updateState(c[1],r),this.components.get("filter_operators").updateState(h,r),this.components.get("filter_by_value").updateState(e)}}}},{key:"getIndexesOfComponents",value:function(){var e=[];if(!this.dropdownMenuPlugin)return e;for(var menu=this.dropdownMenuPlugin.menu,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return X(n,(function(component){X(menu.menuItems,(function(t,n){t.key===component.getMenuItemDescriptor().key&&e.push(n)}))})),e}},{key:"changeComponentsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var menu=this.dropdownMenuPlugin.menu,t=menu.hotMenu,n=t.getPlugin("hiddenRows"),o=arguments.length,r=new Array(o>1?o-1:0),l=1;l<o;l++)r[l-1]=arguments[l];var c=this.getIndexesOfComponents.apply(this,r);e?n.showRows(c):n.hideRows(c),t.render()}}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){var e=this;this.enabled&&(this.components.forEach((function(component,t){null!==component&&(component.destroy(),e.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),$T(JT(l.prototype),"destroy",this).call(this)}}])&&KT(t.prototype,n),o&&KT(t,o),l}(mm);function nA(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function oA(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?nA(Object(source),!0).forEach((function(t){rA(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):nA(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function rA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iA="internal-use-in-handsontable",aA={licenseKey:iA,binarySearchThreshold:20,matrixDetection:!1,matrixDetectionThreshold:100,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function lA(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[HA])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function sA(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function uA(e){return(uA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cA(){var e="engine_relationship",t=vo(HA);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function hA(){var e="shared_engine_usage",t=vo(HA);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function fA(e){var t,n=e.getSettings(),o=n[HA],r=null==o?void 0:o.engine;if(!0===o)return null;if(at(r))return null;if("function"==typeof r.hyperformula||"function"==typeof r)return function(e,t,n){var o=t[HA],r=function(e){var t,n=e[HA],o=sA(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),r=lA(e);return oA(oA(oA({},aA),o),r)}(t),l=cA(),c=hA();(function(e,t){t&&t.forEach((function(t){var n=t.name,o=t.plugin,r=t.translations;try{e.registerFunction(n,o,r)}catch(e){to(e.message)}}))})(e,o.functions),function(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(e){to(e.message)}}}(e,o.language);var h=e.buildEmpty(r);return l.set(h,[n]),c.set(h,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,o=t.expression,r=t.scope,l=t.options;try{e.addNamedExpression(n,o,r,l)}catch(e){to(e.message)}})),e.resumeEvaluation())}(h,o.namedExpressions),h.on("sheetAdded",(function(){h.rebuildAndRecalculate()})),h.on("sheetRemoved",(function(){h.rebuildAndRecalculate()})),h}(null!==(t=r.hyperformula)&&void 0!==t?t:r,n,e);if("object"===uA(r)&&at(r.hyperformula)){var l=cA(),c=hA().get(r);return l.has(r)||l.set(r,[]),l.get(r).push(e),c&&c.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:iA}),r}return null}function dA(e){var t,n=cA(),o=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(o.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function pA(e,t){if(e){var n=cA(),o=n.get(e),r=hA(),l=r.get(e);o&&o.includes(t)&&(o.splice(o.indexOf(t),1),0===o.length&&n.delete(e)),l&&l.includes(t.guid)&&(l.splice(l.indexOf(t.guid),1),0===l.length&&(r.delete(e),e.destroy()))}}function yA(e,t){return!at(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}function gA(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function vA(e){return function(e){if(Array.isArray(e))return CA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||wA(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mA(e){return(mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bA(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||wA(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wA(e,t){if(e){if("string"==typeof e)return CA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CA(e,t):void 0}}function CA(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function SA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RA(e,t,n){return(RA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=MA(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function OA(e,p){return(OA=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function EA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=MA(e);if(t){var r=MA(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return TA(this,n)}}function TA(e,t){return!t||"object"!==mA(t)&&"function"!=typeof t?AA(e):t}function AA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MA(e){return(MA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _A(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,IA(e,t,"set"),n),n}function PA(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,IA(e,t,"get"))}function IA(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var HA="formulas";fo.getSingleton().register("afterNamedExpressionAdded"),fo.getSingleton().register("afterNamedExpressionRemoved"),fo.getSingleton().register("afterSheetAdded"),fo.getSingleton().register("afterSheetRemoved"),fo.getSingleton().register("afterSheetRenamed"),fo.getSingleton().register("afterFormulasValuesUpdate");var DA=new WeakMap,NA=new WeakMap,jA=new WeakMap,LA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OA(e,t)}(l,e);var t,n,o,r=EA(l);function l(){var e;SA(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),DA.set(AA(e),{writable:!0,value:!1}),NA.set(AA(e),{writable:!0,value:!1}),jA.set(AA(e),{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),xA(AA(e),"staticRegister",vo("formulas")),xA(AA(e),"engine",null),xA(AA(e),"sheetName",null),e}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return HA}},{key:"PLUGIN_PRIORITY",get:function(){return 260}}],(n=[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[HA]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=fA(this.hot))&&void 0!==e?e:this.engine,this.engine){null===this.sheetName||this.engine.doesSheetExist(this.sheetName)||(this.sheetName=this.addSheet(this.sheetName,this.hot.getSourceDataArray())),this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)}));var n,o=(n=this,{beforeAutofill:function(e,t,o){var r=o.getWidth(),l=o.getHeight(),c=o.from.row,col=o.from.col;if(!n.engine.isItPossibleToSetCellContents({sheet:n.sheetId,row:c,col:col},r,l))return!1},afterAutofill:function(e,source,t,o,r){if(!r){var l={width:source.getWidth(),height:source.getHeight()},c=t.getWidth(),h=t.getHeight(),f=[];switch(o){case"right":for(var d=source.from.row,y=t.from.col;y<=t.to.col;y+=l.width){var v=t.to.col-y+1,m=Math.min(l.width,v);f.push({copy:{row:source.from.row,col:source.from.col,width:m,height:l.height},paste:{row:d,col:y}})}break;case"down":for(var w=source.from.col,C=t.from.row;C<=t.to.row;C+=l.height){var S=t.to.row-C+1,k=Math.min(l.height,S);f.push({copy:{row:source.from.row,col:source.from.col,width:l.width,height:k},paste:{row:C,col:w}})}break;case"left":for(var R=source.from.row,O=t.from.col;O<=t.to.col;O++){var E=(l.width-c%l.width+(O-t.from.col))%l.width+source.from.col;f.push({copy:{row:source.from.row,col:E,width:1,height:l.height},paste:{row:R,col:O}})}break;case"up":for(var T=source.from.col,A=t.from.row;A<=t.to.row;A++){var M=(l.height-h%l.height+(A-t.from.row))%l.height+source.from.row;f.push({copy:{row:M,col:source.from.col,width:l.width,height:1},paste:{row:A,col:T}})}break;default:throw new Error("Unexpected direction parameter")}var x=n.sheetId;f.reduce((function(e,t){return ge(e,t.copy)||n.engine.copy({sheet:x,row:t.copy.row,col:t.copy.col},t.copy.width,t.copy.height),n.engine.paste({sheet:x,row:t.paste.row,col:t.paste.col}),t.copy}),{})}}});this.addHook("beforeAutofill",o.beforeAutofill),this.addHook("afterAutofill",o.afterAutofill),PA(this,jA).forEach((function(e){var n=bA(e,2),o=n[0],r=n[1];return t.engine.on(o,r)})),RA(MA(l.prototype),"enablePlugin",this).call(this)}else to("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;PA(this,jA).forEach((function(t){var n=bA(t,2),o=n[0],r=n[1];return e.engine.off(o,r)})),pA(this.engine,this.hot),RA(MA(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(function(e){var t,n=e[HA],o=sA(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),r=lA(e);return oA(oA({},o),r)}(this.hot.getSettings()));var t=this.hot.getSettings()[HA];if(it(t)&&it(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var n=this.hot.getSettings()[HA].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=n?n:void 0,this.hot.getSourceDataArray())}RA(MA(l.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;PA(this,jA).forEach((function(t){var n,o=bA(t,2),r=o[0],l=o[1];return null===(n=e.engine)||void 0===n?void 0:n.off(r,l)})),_A(this,jA,null),pA(this.engine,this.hot),RA(MA(l.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,o,r){return!r&&e>=n?o+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(it(t)&&!ju(t))return to("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return to("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(n,t),n}catch(e){return to(e.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(kt(HA),".switchSheet"))}else no("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.getCellType({sheet:n,row:this.hot.toPhysicalRow(e),col:this.hot.toPhysicalColumn(t)})}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,o=this.getCellType(e,t,n);return"FORMULA"===o||"MATRIX"===o}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new Set;e.forEach((function(e){var t,n=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(o.has(n)||o.add(n))})),dA(this.engine).forEach((function(e,r){var l;(n||r!==t.sheetId)&&o.has(r)&&(e.render(),null===(l=e.view)||void 0===l||l.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(e){var t,n=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{},o=n.row,col=n.col,r=n.sheet;return it(r)?"".concat(r,":").concat(o,"x").concat(col):""},r=new Set(n.map((function(e){return o(e)})));e.forEach((function(e){var n,l,c=null!==(n=e.address)&&void 0!==n?n:{},h=c.row,col=c.col,f=it(h)?t.hot.toVisualRow(h):null,d=it(col)?t.hot.toVisualColumn(col):null;if(null!==f&&null!==d){var y=null==e||null===(l=e.address)||void 0===l?void 0:l.sheet,v=o(e);if(void 0!==y&&!r.has(v)){var m=dA(t.engine).get(y);m.validateCell(m.getDataAtCell(f,d),m.getCellMeta(f,d),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var address={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(address))return this.engine.setCellContents(address,n);to("Not possible to set cell data at ".concat(JSON.stringify(address)))}},{key:"onBeforeValidate",value:function(e,t,n){var o=this.hot.propToCol(n);if(this.isFormulaCellType(t,o)){var address={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(o),sheet:this.sheetId},r=this.engine.getCellValue(address);return"object"===mA(r)&&null!==r?r.value:r}return e}},{key:"onBeforeLoadData",value:function(e,t){var source=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";source.includes(kt(HA))||_A(this,NA,at(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var source=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!source.includes(kt(HA)))if(this.sheetName=yA(this.engine,this.hot.getSettings()[HA].sheetName),PA(this,NA))this.switchSheet(this.sheetName);else{var n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetName,n)){_A(this,DA,!0);var o=this.engine.setSheetContent(this.sheetName,this.hot.getSourceDataArray());this.renderDependentSheets(o),_A(this,DA,!1)}}}},{key:"onModifyData",value:function(e,t,n,o){if("get"===o&&!PA(this,DA)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName))if(this.isFormulaCellType(this.hot.toVisualRow(e),t)){var r,address={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},l=this.engine.getCellValue(address),c="object"===mA(l)&&null!==l?l.value:l;n.value=c}else gA(n.value)&&(n.value=gA(r=n.value)?r.substr(1):r)}},{key:"onModifySourceData",value:function(e,t,n,o){if("get"===o&&!PA(this,DA)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var r=this.hot.propToCol(t);if(this.isFormulaCellType(this.hot.toVisualRow(e),r)){var l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==l.width||0!==l.height){var address={row:e,col:this.toPhysicalColumnPosition(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(address)}}}}},{key:"onAfterSetDataAtCell",value:function(e){var t=this,n=[],o=[],r=[];e.forEach((function(e){var l=bA(e,4),c=l[0],h=l[1],f=l[3],d=t.hot.propToCol(h),y=t.hot.toPhysicalRow(c),v=t.hot.toPhysicalColumn(d),address={row:y,col:v,sheet:t.sheetId};null!==y&&null!==v?n.push.apply(n,vA(t.syncChangeWithEngine(c,d,f))):o.push([c,d,f]),r.push({address:address})})),o.length&&this.hot.addHookOnce("afterChange",(function(){var e=[];o.forEach((function(n){var o=bA(n,3),r=o[0],l=o[1],c=o[2];e.push.apply(e,vA(t.syncChangeWithEngine(r,l,c)))})),t.renderDependentSheets(e,!0)})),this.renderDependentSheets(n),this.validateDependentCells(n,r)}},{key:"onAfterSetSourceDataAtCell",value:function(e){var t=this,n=[],o=[];e.forEach((function(e){var r=bA(e,4),l=r[0],c=r[1],h=r[3],address={row:l,col:t.toPhysicalColumnPosition(c),sheet:t.sheetId};t.engine.isItPossibleToSetCellContents(address)?(o.push({address:address}),n.push.apply(n,vA(t.engine.setCellContents(address,h)))):to("Not possible to set source cell data at ".concat(JSON.stringify(address)))})),this.renderDependentSheets(n),this.validateDependentCells(n,o)}},{key:"onBeforeCreateRow",value:function(e,t){if(!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(col,e){if(!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(col),e]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var o=this;return!1!==n.every((function(e){return o.engine.isItPossibleToRemoveRows(o.sheetId,[e,1])}))&&void 0}},{key:"onBeforeRemoveCol",value:function(col,e,t){var n=this;return!1!==t.every((function(e){return n.engine.isItPossibleToRemoveColumns(n.sheetId,[e,1])}))&&void 0}},{key:"onAfterCreateRow",value:function(e,t){var n=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(n)}},{key:"onAfterCreateCol",value:function(col,e){var t=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(col),e]);this.renderDependentSheets(t)}},{key:"onAfterRemoveRow",value:function(e,t,n){var o=this,r=n.sort().reverse(),l=this.engine.batch((function(){r.forEach((function(e){o.engine.removeRows(o.sheetId,[e,1])}))}));this.renderDependentSheets(l)}},{key:"onAfterRemoveCol",value:function(col,e,t){var n=this,o=t.sort().reverse(),r=this.engine.batch((function(){o.forEach((function(e){n.engine.removeColumns(n.sheetId,[e,1])}))}));this.renderDependentSheets(r)}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}])&&kA(t.prototype,n),o&&kA(t,o),l}(mm);function BA(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return VA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VA(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VA(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function FA(e){return function(e){if(Array.isArray(e))return WA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return WA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WA(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WA(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function UA(e){return(UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function GA(e,t,n){return(GA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=ZA(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function KA(e,p){return(KA=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function $A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ZA(e);if(t){var r=ZA(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return XA(this,n)}}function XA(e,t){return!t||"object"!==UA(t)&&"function"!=typeof t?qA(e):t}function qA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZA(e){return(ZA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QA(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,eM(e,t,"get"))}function JA(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,eM(e,t,"set"),n),n}function eM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}fo.getSingleton().register("beforeHideColumns"),fo.getSingleton().register("afterHideColumns"),fo.getSingleton().register("beforeUnhideColumns"),fo.getSingleton().register("afterUnhideColumns");var tM="hiddenColumns",nM=new WeakMap,oM=new WeakMap,rM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KA(e,t)}(l,e);var t,n,o,r=$A(l);function l(){var e;zA(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),nM.set(qA(e),{writable:!0,value:{}}),oM.set(qA(e),{writable:!0,value:null}),e}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return tM}},{key:"PLUGIN_PRIORITY",get:function(){return 310}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenColumns;ve(t)&&(JA(this,nM,t),at(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),JA(this,oM,new Tc),QA(this,oM).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,QA(this,oM)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,col,n){return e.onAfterGetCellMeta(t,col,n)})),this.addHook("modifyColWidth",(function(t,col){return e.onModifyColWidth(t,col)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),GA(ZA(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),GA(ZA(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),JA(this,nM,{}),GA(ZA(l.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),o=this.isValidConfig(e),r=n,l=QA(this,oM).getValues().slice(),c=e.length>0;o&&c&&(X(e.map((function(e){return t.hot.toPhysicalColumn(e)})),(function(e){l[e]=!1})),r=G(l,(function(e,n,o){return n&&e.push(t.hot.toVisualColumn(o)),e}),[])),!1!==this.hot.runHooks("beforeUnhideColumns",n,r,o&&c)&&(o&&c&&QA(this,oM).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,o&&c,o&&r.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),o=this.isValidConfig(e),r=n;o&&(r=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",n,r,o)&&(o&&this.hot.batchExecution((function(){X(e,(function(e){QA(t,oM).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,r,o,o&&r.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return $(QA(this,oM).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return QA(this,oM).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){X(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:QA(this,nM).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===QA(this,nM).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var o=n.className.split(" ");if(o.length>0){var r=o.indexOf("afterHiddenColumn");r>-1&&o.splice(r,1),n.className=o.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(QA(this,nM).copyPasteEnabled)return e;var n=[],o=function(e,t,o,r){n.push({startRow:e,endRow:t,startCol:o,endCol:r})};return X(e,(function(e){var n=!0,r=0;ur(e.startCol,e.endCol,(function(l){t.isHidden(l)?(n||o(e.startRow,e.endRow,r,l-1),n=!0):(n&&(r=l),l===e.endCol&&o(e.startRow,e.endRow,r,l),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(QA(this,nM).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Yt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:RC},(t=this,{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=BA(e,4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(wf,t)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,o=e.to,r=Math.max(Math.min(n.col,o.col),0),l=Math.max(n.col,o.col),c=[],h=r;h<=l;h+=1)c.push(h);var f=c[0],d=c[c.length-1],y=this.columnIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,f-1);t.hideColumns(c),Number.isInteger(y)&&y>=0?this.selectColumns(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(Cf,e)},callback:function(){var n,o;if(0!==t.length){var r=t[0],l=t[t.length-1];r=null!==(n=this.columnIndexMapper.getFirstNotHiddenIndex(r-1,-1))&&void 0!==n?n:0,l=null!==(o=this.columnIndexMapper.getFirstNotHiddenIndex(l+1,1))&&void 0!==o?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0),l-r+1===this.countCols()||this.selectColumns(r,l)}},disabled:!1,hidden:function(){var n=this,o=$(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;t.length=0;var r=this.getSelectedRangeLast(),l=r.getTopLeftCorner().col,c=r.getBottomRightCorner().col,h=this.columnIndexMapper,f=h.getRenderableFromVisualIndex(l),d=h.getRenderableFromVisualIndex(c),y=h.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-f+1){var m=y.slice(l,c+1);v.push.apply(v,FA(m.filter((function(e){return o.includes(e)}))))}}else if(0===f&&f<l)v.push.apply(v,FA(y.slice(0,l)));else if(null===f)v.push.apply(v,FA(y.slice(0,this.countCols())));else{var w=this.countCols()-1;d===h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,FA(y.slice(c+1)))}return X(v,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(QA(this,nM).columns)&&this.hideColumns(QA(this,nM).columns)}},{key:"destroy",value:function(){JA(this,nM,null),JA(this,oM,null),GA(ZA(l.prototype),"destroy",this).call(this)}}])&&YA(t.prototype,n),o&&YA(t,o),l}(mm);function iM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return aM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function lM(e){return function(e){if(Array.isArray(e))return sM(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sM(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function uM(e){return(uM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fM(e,t,n){return(fM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=vM(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function dM(e,p){return(dM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function pM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=vM(e);if(t){var r=vM(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return yM(this,n)}}function yM(e,t){return!t||"object"!==uM(t)&&"function"!=typeof t?gM(e):t}function gM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vM(e){return(vM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mM(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,wM(e,t,"get"))}function bM(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,wM(e,t,"set"),n),n}function wM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}fo.getSingleton().register("beforeHideRows"),fo.getSingleton().register("afterHideRows"),fo.getSingleton().register("beforeUnhideRows"),fo.getSingleton().register("afterUnhideRows");var CM="hiddenRows",SM=new WeakMap,kM=new WeakMap,RM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dM(e,t)}(l,e);var t,n,o,r=pM(l);function l(){var e;cM(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),SM.set(gM(e),{writable:!0,value:{}}),kM.set(gM(e),{writable:!0,value:null}),e}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return CM}},{key:"PLUGIN_PRIORITY",get:function(){return 320}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenRows;ve(t)&&(bM(this,SM,t),at(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),bM(this,kM,new Tc),mM(this,kM).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,mM(this,kM)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,col,n){return e.onAfterGetCellMeta(t,col,n)})),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),fM(vM(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fM(vM(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),bM(this,SM,{}),fM(vM(l.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,n=this.getHiddenRows(),o=this.isValidConfig(e),r=n,l=mM(this,kM).getValues().slice(),c=e.length>0;o&&c&&(X(e.map((function(e){return t.hot.toPhysicalRow(e)})),(function(e){l[e]=!1})),r=G(l,(function(e,n,o){return n&&e.push(t.hot.toVisualRow(o)),e}),[])),!1!==this.hot.runHooks("beforeUnhideRows",n,r,o&&c)&&(o&&c&&mM(this,kM).setValues(l),this.hot.runHooks("afterUnhideRows",n,r,o&&c,o&&r.length<n.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,n=this.getHiddenRows(),o=this.isValidConfig(e),r=n;o&&(r=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",n,r,o)&&(o&&this.hot.batchExecution((function(){X(e,(function(e){mM(t,kM).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,r,o,o&&r.length>n.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return $(mM(this,kM).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return mM(this,kM).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){X(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===mM(this,SM).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var o=n.className.split(" ");if(o.length>0){var r=o.indexOf("afterHiddenRow");r>-1&&o.splice(r,1),n.className=o.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(mM(this,SM).copyPasteEnabled)return e;var n=[],o=function(e,t,o,r){n.push({startRow:e,endRow:t,startCol:o,endCol:r})};return X(e,(function(e){var n=!0,r=0;ur(e.startRow,e.endRow,(function(l){t.isHidden(l)?(n||o(r,l-1,e.startCol,e.endCol),n=!0):(n&&(r=l),l===e.endRow&&o(r,l,e.startCol,e.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(e,t){if(mM(this,SM).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Yt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:RC},(t=this,{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=iM(e,3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(Sf,t)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,o=e.to,r=Math.max(Math.min(n.row,o.row),0),l=Math.max(n.row,o.row),c=[],h=r;h<=l;h+=1)c.push(h);var f=c[0],d=c[c.length-1],y=this.rowIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,f-1);t.hideRows(c),Number.isInteger(y)&&y>=0?this.selectRows(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(kf,e)},callback:function(){var n,o;if(0!==t.length){var r=t[0],l=t[t.length-1];r=null!==(n=this.rowIndexMapper.getFirstNotHiddenIndex(r-1,-1))&&void 0!==n?n:0,l=null!==(o=this.rowIndexMapper.getFirstNotHiddenIndex(l+1,1))&&void 0!==o?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0),l-r+1===this.countRows()||this.selectRows(r,l)}},disabled:!1,hidden:function(){var n=this,o=$(e.getHiddenRows(),(function(e){return n.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;t.length=0;var r=this.getSelectedRangeLast(),l=r.getTopLeftCorner().row,c=r.getBottomRightCorner().row,h=this.rowIndexMapper,f=h.getRenderableFromVisualIndex(l),d=h.getRenderableFromVisualIndex(c),y=h.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-f+1){var m=y.slice(l,c+1);v.push.apply(v,lM(m.filter((function(e){return o.includes(e)}))))}}else if(0===f&&f<l)v.push.apply(v,lM(y.slice(0,l)));else if(null===f)v.push.apply(v,lM(y.slice(0,this.countRows())));else{var w=this.countRows()-1;d===h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,lM(y.slice(c+1)))}return X(v,(function(e){t.push(n.toVisualRow(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(mM(this,SM).rows)&&this.hideRows(mM(this,SM).rows)}},{key:"destroy",value:function(){bM(this,SM,null),bM(this,kM,null),fM(vM(l.prototype),"destroy",this).call(this)}}])&&hM(t.prototype,n),o&&hM(t,o),l}(mm);function OM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return EM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function EM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function TM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return AM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function MM(e){return(MM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _M(e,t,n){return(_M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=NM(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function PM(e,p){return(PM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function IM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=NM(e);if(t){var r=NM(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return HM(this,n)}}function HM(e,t){return!t||"object"!==MM(t)&&"function"!=typeof t?DM(e):t}function DM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NM(e){return(NM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jM="manualColumnFreeze",LM=new WeakMap,BM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PM(e,t)}(l,e);var t,n,o,r=IM(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e),LM.set(DM(t),{afterFirstUse:!1}),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return jM}},{key:"PLUGIN_PRIORITY",get:function(){return 110}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,n){return e.onBeforeColumnMove(t,n)})),_M(NM(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){LM.get(this).afterFirstUse=!1,_M(NM(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_M(NM(l.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=LM.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||e<=n.fixedColumnsLeft-1||(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsLeft),n.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(e){var t=LM.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft<=0||e>n.fixedColumnsLeft-1||(n.fixedColumnsLeft-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsLeft))}},{key:"addContextMenuEntry",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(Xh)},callback:function(e,n){var o=OM(n,1)[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(qh)},callback:function(t,n){var o=TM(n,1)[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}(this))}},{key:"onBeforeColumnMove",value:function(e,t){if(LM.get(this).afterFirstUse){var n=this.hot.getSettings().fixedColumnsLeft;if(t<n)return!1;if(e.some((function(e){return e<n})))return!1}}}])&&xM(t.prototype,n),o&&xM(t,o),l}(mm);function VM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var FM="px",WM=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0}var t,n,o;return t=e,(n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){sr(e)&&(this._element.style.top=e+FM),sr(t)&&(this._element.style.left=t+FM)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){sr(e)&&(this._element.style.width=e+FM),sr(t)&&(this._element.style.height=t+FM)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){sr(e)&&(this._element.style.marginTop=e+FM),sr(t)&&(this._element.style.marginLeft=t+FM)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&VM(t.prototype,n),o&&VM(t,o),e}();function UM(e){return(UM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function GM(e,t,n){return(GM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=qM(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function KM(e,p){return(KM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function $M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=qM(e);if(t){var r=qM(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return XM(this,n)}}function XM(e,t){return!t||"object"!==UM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qM(e){return(qM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ZM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KM(e,t)}(l,e);var t,n,o,r=$M(l);function l(){return zM(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){GM(qM(l.prototype),"build",this).call(this),Yt(this._element,"ht__manualColumnMove--backlight")}}])&&YM(t.prototype,n),o&&YM(t,o),l}(WM);function QM(e){return(QM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ex(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tx(e,t,n){return(tx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=ix(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function nx(e,p){return(nx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ox(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ix(e);if(t){var r=ix(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return rx(this,n)}}function rx(e,t){return!t||"object"!==QM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ix(e){return(ix=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ax=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nx(e,t)}(l,e);var t,n,o,r=ox(l);function l(){return JM(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){tx(ix(l.prototype),"build",this).call(this),Yt(this._element,"ht__manualColumnMove--guideline")}}])&&ex(t.prototype,n),o&&ex(t,o),l}(WM);function lx(e){return(lx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ux(e,t,n){return(ux="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=px(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function cx(e,p){return(cx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function hx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=px(e);if(t){var r=px(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return fx(this,n)}}function fx(e,t){return!t||"object"!==lx(t)&&"function"!=typeof t?dx(e):t}function dx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function px(e){return(px=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("beforeColumnMove"),fo.getSingleton().register("afterColumnMove");var yx="manualColumnMove",gx=new WeakMap,vx="ht__manualColumnMove",mx="show-ui",bx="on-moving--columns",wx="after-selection--columns",Cx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cx(e,t)}(l,e);var t,n,o,r=hx(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e),gx.set(dx(t),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),t.eventManager=new Po(dx(t)),t.backlight=new ZM(e),t.guideline=new ax(e),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return yx}},{key:"PLUGIN_PRIORITY",get:function(){return 120}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(t,n,o,r){return e.onBeforeOnCellMouseDown(t,n,o,r)})),this.addHook("beforeOnCellMouseOver",(function(t,n,o,r){return e.onBeforeOnCellMouseOver(t,n,o,r)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),Yt(this.hot.rootElement,vx),ux(px(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ux(px(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gt(this.hot.rootElement,vx),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ux(px(l.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=gx.get(this),o=n.cachedDropIndex,r=this.isMovePossible(e,t),l=this.hot.runHooks("beforeColumnMove",e,t,o,r);if(n.cachedDropIndex=void 0,!1!==l){r&&this.hot.columnIndexMapper.moveIndexes(e,t);var c=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,r,c),c}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var n=this.countFinalIndex(e,t);return gx.get(this).cachedDropIndex=t,this.moveColumns(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,r=t<0,l=e.some((function(e){return e<0})),c=e.some((function(e){return e>=n}));return!(o||r||l||c)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=G(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getColumnsWidth",value:function(e,t){for(var n=this.hot.columnIndexMapper,o=0,r=e;r<=t;r+=1){var l=n.getRenderableFromVisualIndex(r);r<0?o+=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:null!==l&&(o+=this.hot.view.wt.wtTable.getStretchedColumnWidth(l)||0)}return o}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsLeft",value:function(e){return e<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return ur(e,t,(function(i){n.push(i)})),n}},{key:"refreshPositions",value:function(){var e=gx.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),o=this.hot.view.wt.wtTable,r=this.hot.view.wt.wtOverlays.scrollableElement,l="number"==typeof r.scrollX?r.scrollX:r.scrollLeft,c=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coords-1),h=e.target.eventPageX-(e.rootElementOffset-(void 0===r.scrollX?l:0)),f=o.hider.offsetWidth,d=o.TBODY.offsetLeft,y=this.backlight.getOffset().left,v=this.backlight.getSize().width,m=0;if(e.rootElementOffset+o.holder.offsetWidth+l<e.target.eventPageX&&e.coords<e.countCols&&(e.coords+=1),e.hasRowHeaders&&(m=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(e.coords)&&(c+=l),c+=m,e.coords<0)e.fixedColumns>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+c<=h){var w=e.coords>=e.countCols?e.countCols-1:e.coords;e.target.col=w+1,c+=e.target.TD.offsetWidth,e.target.col>n&&n<e.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else e.target.col=e.coords,e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);var C=h,S=c;h+v+y>=f?C=f-v-y:h+y<d+m&&(C=d+m+Math.abs(y)),c>=f-1?S=f-1:0===S?S=1:void 0!==r.scrollX&&e.coords<e.fixedColumns&&(S-=e.rootElementOffset<=r.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,C),this.guideline.setPosition(null,S)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,o){var r=this.hot.view.wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),h=gx.get(this),f=zt(e.target,"sortAction");if(!c||!l||h.pressed||0!==e.button||f)return h.pressed=!1,h.columnsToMove.length=0,void Gt(this.hot.rootElement,[bx,mx]);var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&y&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));var v=c.from,m=c.to,w=Math.min(v.col,m.col),C=Math.max(v.col,m.col);if(t.row<0&&t.col>=w&&t.col<=C){o.column=!0,h.pressed=!0,h.target.eventPageX=e.pageX,h.coords=t.col,h.target.TD=n,h.target.col=t.col,h.columnsToMove=this.prepareColumnsToMoving(w,C),h.hasRowHeaders=!!this.hot.getSettings().rowHeaders,h.countCols=this.hot.countCols(),h.fixedColumns=this.hot.getSettings().fixedColumnsLeft,h.rootElementOffset=en(this.hot.rootElement).left;var S=h.hasRowHeaders?-1:0,k=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,R=t.col<h.fixedColumns,O=this.hot.view.wt.wtOverlays.scrollableElement,E=O.scrollX?O.scrollX-h.rootElementOffset:0,T=e.offsetX-(R?E:0),A=Math.abs(this.getColumnsWidth(w,t.col-1)+T);this.backlight.setPosition(k,this.getColumnsWidth(S,w-1)+A),this.backlight.setSize(this.getColumnsWidth(w,C),r.hider.offsetHeight-k),this.backlight.setOffset(null,-1*A),Yt(this.hot.rootElement,bx)}else Gt(this.hot.rootElement,wx),h.pressed=!1,h.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=gx.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,o){var r=this.hot.getSelectedRangeLast(),l=gx.get(this);r&&l.pressed&&(l.columnsToMove.indexOf(t.col)>-1?Gt(this.hot.rootElement,mx):Yt(this.hot.rootElement,mx),o.row=!0,o.column=!0,o.cell=!0,l.coords=t.col,l.target.TD=n)}},{key:"onMouseUp",value:function(){var e=gx.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.coords=void 0,e.pressed=!1,e.backlightWidth=0,Gt(this.hot.rootElement,[bx,mx,wx]),this.hot.selection.isSelectedByColumnHeader()&&Yt(this.hot.rootElement,wx),!(n<1||void 0===t)){var o=e.columnsToMove[0],r=this.hot.toPhysicalColumn(o),l=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===l){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(r),h=c+n-1;this.hot.selectColumns(c,h)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ux(px(l.prototype),"destroy",this).call(this)}}])&&sx(t.prototype,n),o&&sx(t,o),l}(mm);function Sx(e){return(Sx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rx(e,t,n){return(Rx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Mx(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Ox(e,p){return(Ox=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Ex(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Mx(e);if(t){var r=Mx(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Tx(this,n)}}function Tx(e,t){return!t||"object"!==Sx(t)&&"function"!=typeof t?Ax(e):t}function Ax(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mx(e){return(Mx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xx="manualColumnResize",_x="manualColumnWidths",Px=new WeakMap,Ix=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ox(e,t)}(l,e);var t,n,o,r=Ex(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(t=r.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentCol=null,t.selectedCols=[],t.currentWidth=null,t.newSize=null,t.startY=null,t.startWidth=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Po(Ax(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.columnWidthsMap=void 0,Px.set(Ax(t),{config:void 0}),Yt(t.handle,"manualColumnResizer"),Yt(t.guide,"manualColumnResizerGuide"),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return xx}},{key:"PLUGIN_PRIORITY",get:function(){return 130}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new bc,this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,col){return e.onModifyColWidth(t,col)})),this.addHook("beforeStretchingColumnWidth",(function(t,n){return e.onBeforeStretchingColumnWidth(t,n)})),this.addHook("beforeColumnResize",(function(t,n,o){return e.onBeforeColumnResize(t,n,o)})),this.bindEvents(),Rx(Mx(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Rx(Mx(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Px.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Rx(Mx(l.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",_x,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",_x,e),e.value}},{key:"setManualSize",value:function(e,t){var n=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,n),n}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=Px.get(this),n=this.hot.getSettings().manualColumnResize,o=this.loadManualColumnWidths();void 0!==o?this.hot.batchExecution((function(){o.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),t.config=n):!0===n&&Array.isArray(t.config)&&this.hot.batchExecution((function(){t.config.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var n=this.hot.view.wt,o=n.wtTable.getCoords(this.currentTH),col=o.col;if(!(col<0)){var r,l=fn(this.currentTH),c=this.currentTH.getBoundingClientRect();col<n.getSetting("fixedColumnsLeft")&&(r=n.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),r||(r=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(col),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&h&&X(this.hot.getSelectedRange(),(function(e){ur(e.getTopLeftCorner().col,e.getBottomRightCorner().col,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))})),this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=r.left-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(r.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(fn(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Yt(this.handle,"active"),Yt(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Gt(this.handle,"active"),Gt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(element){return!!Nt(element,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"onMouseOver",value:function(e){if(!Pn(e.target)&&this.checkIfColumnHeader(e.target)){var th=this.getClosestTHParent(e.target);if(!th)return;var t=th.getAttribute("colspan");!th||null!==t&&1!==t||this.pressed||this.setupHandlePosition(th)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,o){var r=e.hot.runHooks("beforeColumnResize",e.newSize,n,!0);void 0!==r&&(e.newSize=r),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!0),o&&t()};this.dblclick>=2&&(this.selectedCols.length>1?(X(this.selectedCols,(function(e){n(e)})),t()):X(this.selectedCols,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;zt(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(e.pageX-this.startX),X(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,o){e.hot.runHooks("beforeColumnResize",e.newSize,n,!1),o&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(X(this.selectedCols,(function(e){n(e)})),t()):X(this.selectedCols,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootWindow,o=t.rootElement;this.eventManager.addEventListener(o,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(o,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var n=e;if(this.enabled){var o=this.hot.toPhysicalColumn(t),r=this.columnWidthsMap.getValueAtIndex(o);this.hot.getSettings().manualColumnResize&&r&&(n=r)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Rx(Mx(l.prototype),"destroy",this).call(this)}}])&&kx(t.prototype,n),o&&kx(t,o),l}(mm);function Hx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dx="px",Nx=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0}var t,n,o;return t=e,(n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+Dx),void 0!==t&&(this._element.style.left=t+Dx)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+Dx),t&&(this._element.style.height=t+Dx)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+Dx),t&&(this._element.style.marginLeft=t+Dx)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&Hx(t.prototype,n),o&&Hx(t,o),e}();function jx(e){return(jx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vx(e,t,n){return(Vx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=zx(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function Fx(e,p){return(Fx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Wx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=zx(e);if(t){var r=zx(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ux(this,n)}}function Ux(e,t){return!t||"object"!==jx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zx(e){return(zx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fx(e,t)}(l,e);var t,n,o,r=Wx(l);function l(){return Lx(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){Vx(zx(l.prototype),"build",this).call(this),Yt(this._element,"ht__manualRowMove--backlight")}}])&&Bx(t.prototype,n),o&&Bx(t,o),l}(Nx);function Gx(e){return(Gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xx(e,t,n){return(Xx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Jx(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function qx(e,p){return(qx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function Zx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Jx(e);if(t){var r=Jx(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Qx(this,n)}}function Qx(e,t){return!t||"object"!==Gx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jx(e){return(Jx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qx(e,t)}(l,e);var t,n,o,r=Zx(l);function l(){return Kx(this,l),r.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){Xx(Jx(l.prototype),"build",this).call(this),Yt(this._element,"ht__manualRowMove--guideline")}}])&&$x(t.prototype,n),o&&$x(t,o),l}(Nx);function t_(e){return(t_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o_(e,t,n){return(o_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=s_(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function r_(e,p){return(r_=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function i_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=s_(e);if(t){var r=s_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return a_(this,n)}}function a_(e,t){return!t||"object"!==t_(t)&&"function"!=typeof t?l_(e):t}function l_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s_(e){return(s_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("beforeRowMove"),fo.getSingleton().register("afterRowMove");var u_="manualRowMove",c_=new WeakMap,h_="ht__manualRowMove",f_="show-ui",d_="on-moving--rows",p_="after-selection--rows",y_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r_(e,t)}(l,e);var t,n,o,r=i_(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e),c_.set(l_(t),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),t.eventManager=new Po(l_(t)),t.backlight=new Yx(e),t.guideline=new e_(e),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return u_}},{key:"PLUGIN_PRIORITY",get:function(){return 140}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(t,n,o,r){return e.onBeforeOnCellMouseDown(t,n,o,r)})),this.addHook("beforeOnCellMouseOver",(function(t,n,o,r){return e.onBeforeOnCellMouseOver(t,n,o,r)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),Yt(this.hot.rootElement,h_),o_(s_(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),o_(s_(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gt(this.hot.rootElement,h_),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),o_(s_(l.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=c_.get(this),o=n.cachedDropIndex,r=this.isMovePossible(e,t),l=this.hot.runHooks("beforeRowMove",e,t,o,r);if(n.cachedDropIndex=void 0,!1!==l){r&&this.hot.rowIndexMapper.moveIndexes(e,t);var c=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,r,c),c}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var n=this.countFinalIndex(e,t);return c_.get(this).cachedDropIndex=t,this.moveRows(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,r=t<0,l=e.some((function(e){return e<0})),c=e.some((function(e){return e>=n}));return!(o||r||l||c)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=G(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getRowsHeight",value:function(e,t){for(var n=this.hot.rowIndexMapper,o=0,r=e;r<=t;r++){var l=n.getRenderableFromVisualIndex(r);null!==l&&(o+=this.hot.view.wt.wtTable.getRowHeight(l)||23)}return o}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var n=e.from,o=e.to;return ur(Math.min(n.row,o.row),Math.max(n.row,o.row),(function(i){t.push(i)})),t}},{key:"refreshPositions",value:function(){var e=c_.get(this),t=e.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),o=this.hot.view.wt.wtTable.getLastVisibleRow(),r=this.hot.getSettings().fixedRowsTop,l=this.hot.countRows();t.row<r&&n>0&&this.hot.scrollViewportTo(n-1),t.row>=o&&o<l&&this.hot.scrollViewportTo(o+1,void 0,!0);var c=this.hot.view.wt.wtTable,h=e.target.TD,f=en(this.hot.rootElement),d=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),y=e.target.eventPageY-f.top+c.holder.scrollTop,v=c.hider.offsetHeight,m=c.TBODY.offsetTop,w=this.backlight.getOffset().top,C=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(d+=c.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:h.offsetHeight/2+d<=y?(e.target.row=t.row+1,d+=0===t.row?h.offsetHeight-1:h.offsetHeight):e.target.row=t.row;var S=y,k=d;y+C+w>=v?S=v-C-w:y+w<m&&(S=m+Math.abs(w)),d>=v-1&&(k=v-1);var R=0;this.hot.view.wt.wtOverlays.topOverlay&&(R=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=r&&k-c.holder.scrollTop<R&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(S),this.guideline.setPosition(k)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,o){var r=this.hot.view.wt,l=r.wtTable,c=r.wtViewport,h=this.hot.selection.isSelectedByRowHeader(),f=this.hot.getSelectedRangeLast(),d=c_.get(this);if(!f||!h||d.pressed||0!==e.button)return d.pressed=!1,d.rowsToMove.length=0,void Gt(this.hot.rootElement,[d_,f_]);var y=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=f.from,w=f.to,C=Math.min(m.row,w.row),S=Math.max(m.row,w.row);if(t.col<0&&t.row>=C&&t.row<=S){o.row=!0,d.pressed=!0,d.target.eventPageY=e.pageY,d.target.coords=t,d.target.TD=n,d.rowsToMove=this.prepareRowsToMoving();var k=l.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(l.hider.offsetWidth-k,this.getRowsHeight(C,S)),this.backlight.setOffset(-1*(this.getRowsHeight(C,t.row-1)+e.offsetY),null),Yt(this.hot.rootElement,d_),this.refreshPositions()}else Gt(this.hot.rootElement,p_),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=c_.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,o){var r=this.hot.getSelectedRangeLast(),l=c_.get(this);r&&l.pressed&&(l.rowsToMove.indexOf(t.row)>-1?Gt(this.hot.rootElement,f_):Yt(this.hot.rootElement,f_),o.row=!0,o.column=!0,o.cell=!0,l.target.coords=t,l.target.TD=n)}},{key:"onMouseUp",value:function(){var e=c_.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,Gt(this.hot.rootElement,[d_,f_,p_]),this.hot.selection.isSelectedByRowHeader()&&Yt(this.hot.rootElement,p_),!(n<1||void 0===t)){var o=e.rowsToMove[0],r=this.hot.toPhysicalRow(o),l=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===l){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(r),h=c+n-1;this.hot.selectRows(c,h)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view.wt.wtTable,t=this.hot.view.wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),o_(s_(l.prototype),"destroy",this).call(this)}}])&&n_(t.prototype,n),o&&n_(t,o),l}(mm);function g_(e){return(g_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m_(e,t,n){return(m_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=k_(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function b_(e,p){return(b_=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function w_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=k_(e);if(t){var r=k_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return C_(this,n)}}function C_(e,t){return!t||"object"!==g_(t)&&"function"!=typeof t?S_(e):t}function S_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k_(e){return(k_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R_,O_,E_,T_,A_="manualRowResize",M_="manualRowHeights",x_=new WeakMap,__=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b_(e,t)}(l,e);var t,n,o,r=w_(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(t=r.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentRow=null,t.selectedRows=[],t.currentHeight=null,t.newSize=null,t.startY=null,t.startHeight=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Po(S_(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.rowHeightsMap=void 0,x_.set(S_(t),{config:void 0}),Yt(t.handle,"manualRowResizer"),Yt(t.guide,"manualRowResizerGuide"),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return A_}},{key:"PLUGIN_PRIORITY",get:function(){return 30}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new bc,this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.bindEvents(),m_(k_(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),m_(k_(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){x_.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),m_(k_(l.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",M_,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",M_,e),e.value}},{key:"setManualSize",value:function(e,t){var n=this.hot.toPhysicalRow(e),o=Math.max(t,Ys.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,o),o}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var view=this.hot.view,n=view.wt,o=view.wt.wtTable.getCoords(this.currentTH),r=o.row;if(!(r<0)){var l,c=hn(this.currentTH),h=this.currentTH.getBoundingClientRect(),f=r<n.getSetting("fixedRowsTop"),d=r>=view.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");f?l=n.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):d&&(l=n.wtOverlays.bottomLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),l||(l=n.wtOverlays.leftOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&y&&X(this.hot.getSelectedRange(),(function(e){ur(e.getTopLeftCorner().row,e.getBottomLeftCorner().row,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))})),this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=l.top-6,this.startHeight=parseInt(h.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(l.left,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(hn(this.handle),10),t=parseInt(this.handle.style.left,10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Yt(this.handle,"active"),Yt(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(t,"px"),this.guide.style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Gt(this.handle,"active"),Gt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(element){var e,t;return Nt(element,["TH"],this.hot.rootElement)&&"TBODY"===(null===(e=element.parentNode)||void 0===e||null===(t=e.parentNode)||void 0===t?void 0:t.tagName)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view.wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(!Pn(e.target)&&this.checkIfRowHeader(e.target)){var th=this.getClosestTHParent(e.target);th&&(this.pressed||this.setupHandlePosition(th))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,o){var r=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!0);void 0!==r&&(e.newSize=r),e.setManualSize(n,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!0),o&&t()};this.dblclick>=2&&(this.selectedRows.length>1?(X(this.selectedRows,(function(e){n(e)})),t()):X(this.selectedRows,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;zt(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),X(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,o){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!1),o&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(X(this.selectedRows,(function(e){n(e)})),t()):X(this.selectedRows,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootElement,o=t.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(o,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(o,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var n=e;if(this.enabled){var o=this.hot.toPhysicalRow(t),r=this.rowHeightsMap.getValueAtIndex(o);this.hot.getSettings().manualRowResize&&r&&(n=r)}return n}},{key:"onMapInit",value:function(){var e=this,t=x_.get(this),n=this.hot.getSettings().manualRowResize,o=this.loadManualRowHeights();this.hot.batchExecution((function(){void 0!==o?o.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})):Array.isArray(n)?(n.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})),t.config=n):!0===n&&Array.isArray(t.config)&&t.config.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"destroy",value:function(){m_(k_(l.prototype),"destroy",this).call(this)}}])&&v_(t.prototype,n),o&&v_(t,o),l}(mm);function P_(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function I_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var H_,D_=function(){function e(t,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=n,this.rowspan=o,this.colspan=r,this.removed=!1}var t,n,o;return t=e,o=[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return et(R_||(R_=P_(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return et(O_||(O_=P_(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return et(E_||(E_=P_(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return et(T_||(T_=P_(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}],(n=[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,span=e[0]?"colspan":"rowspan",r=e[0]?"col":"row",l=Math.min(t,o),c=Math.max(t,o),h=this[r],f=this[r]+this[span]-1;if(h>=t&&(this[r]+=n),n>0)t<=f&&t>h&&(this[span]+=n);else if(n<0){if(l<=h&&c>=f)return this.removed=!0,!1;if(h>=l&&h<=c){var d=c-h+1,y=Math.abs(n)-d;this[r]-=y+n,this[span]-=d}else if(h<=l&&f>=c)this[span]+=n;else if(h<=l&&f>=l&&f<c){var v=f-l+1;this[span]-=v}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new Hd(new Wn(this.row,this.col),new Wn(this.row,this.col),new Wn(this.getLastRow(),this.getLastColumn()))}}])&&I_(t.prototype,n),o&&I_(t,o),e}();function N_(e,t,n,col){t?t.row===n&&t.col===col?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function j_(e){return function(e){if(Array.isArray(e))return L_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return L_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L_(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function B_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var V_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}var t,n,o;return t=e,o=[{key:"IS_OVERLAPPING_WARNING",value:function(e){return et(H_||(H_=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),e.row,e.col)}}],(n=[{key:"get",value:function(e,t){var n=this.mergedCells,o=!1;return X(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t&&(o=n,1))})),o}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return X(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t)})),n}},{key:"getWithinRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,o=[],r=e;if(!r.includesRange){var l=new Wn(r.from.row,r.from.col),c=new Wn(r.to.row,r.to.col);r=new Hd(l,l,c)}return X(n,(function(e){var n=new Wn(e.row,e.col),l=new Wn(e.row+e.rowspan-1,e.col+e.colspan-1),c=new Hd(n,n,l);t?r.overlaps(c)&&o.push(e):r.includesRange(c)&&o.push(e)})),!!o.length&&o}},{key:"add",value:function(t){var n=this.mergedCells,o=t.row,r=t.col,l=t.rowspan,c=t.colspan,h=new D_(o,r,l,c),f=this.get(o,r),d=this.isOverlapping(h);return f||d?(to(e.IS_OVERLAPPING_WARNING(h)),!1):(this.hot&&h.normalize(this.hot),n.push(h),h)}},{key:"remove",value:function(e,t){var n=this.mergedCells,o=this.get(e,t),r=o?this.mergedCells.indexOf(o):null;return!(!o||!1===r)&&(n.splice(r,1),o)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],o=[];X(t,(function(t){var o=e.hot.getCell(t.row,t.col);o&&n.push([o,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,X(n,(function(t,i){ur(0,t.rowspan-1,(function(n){ur(0,t.colspan-1,(function(r){if(0!==r||0!==n){var l=e.hot.getCell(t.row+n,t.col+r);l&&o.push([l,null,null,null])}}))})),n[i][1]=null})),X(n,(function(e){N_.apply(void 0,j_(e))})),X(o,(function(e){N_.apply(void 0,j_(e))}))}},{key:"isOverlapping",value:function(e){var t=new Hd(new Wn(0,0),new Wn(e.row,e.col),new Wn(e.row+e.rowspan-1,e.col+e.colspan-1)),n=!1;return X(this.mergedCells,(function(col){return!new Hd(new Wn(0,0),new Wn(col.row,col.col),new Wn(col.row+col.rowspan-1,col.col+col.colspan-1)).overlaps(t)||(n=!0,!1)})),n}},{key:"isFirstRenderableMergedCell",value:function(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return new Wn(e,t);var o=this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1),r=this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1);return new Wn(o,r)}},{key:"shiftCollections",value:function(e,t,n){var o=this,r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}X(this.mergedCells,(function(e){e.shift(r,t)})),cr(this.mergedCells.length-1,0,(function(i){var e=o.mergedCells[i];e&&e.removed&&o.mergedCells.splice(o.mergedCells.indexOf(e),1)}))}}])&&B_(t.prototype,n),o&&B_(t,o),e}();function F_(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return W_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W_(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function U_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var z_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var t,n,o;return t=e,(n=[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,n,o){var r=t.slice(0),l=this.getAutofillSize(e,t,n),c=F_(e,4),h=c[0],f=c[1],d=c[2],y=c[3],v=["up","down"].indexOf(n)>-1?d-h+1:y-f+1,m=l-Math.floor(l/v)*v,w=this.getFarthestCollection(e,t,n,o);if(w)if("down"===n){var C=w.row+w.rowspan-h-m;r[2]+C>=this.plugin.hot.countRows()?r[2]-=m:r[2]+=m?C:0}else if("right"===n){var S=w.col+w.colspan-f-m;r[3]+S>=this.plugin.hot.countCols()?r[3]-=m:r[3]+=m?S:0}else if("up"===n){var k=d-m-w.row+1;r[0]+k<0?r[0]+=m:r[0]-=m?k:0}else if("left"===n){var R=y-m-w.col+1;r[1]+R<0?r[1]+=m:r[1]-=m?R:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:o,fillSize:l,dragArea:r,cycleLength:v}),r}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),he(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var o=F_(e,4),r=o[0],l=o[1],c=o[2],h=o[3],f=F_(t,4),d=f[0],y=f[1],v=f[2],m=f[3];switch(n){case"up":return r-d;case"down":return v-c;case"left":return l-y;case"right":return m-h;default:return null}}},{key:"getDragArea",value:function(e,t,n){var o=F_(e,4),r=o[0],l=o[1],c=o[2],h=o[3],f=F_(t,4),d=f[0],y=f[1],v=f[2],m=f[3];switch(n){case"up":return[d,y,r-1,h];case"down":return[c+1,l,v,h];case"left":return[d,y,c,l-1];case"right":return[r,h+1,v,m];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,o){var r=F_(e,4),l=r[0],c=r[1],h=r[2],f=r[3],d=["up","down"].indexOf(n)>-1,y=d?h:f,v=d?l:c,m=this.getAutofillSize(e,t,n),w=d?h-l+1:f-c+1,C=m-Math.floor(m/w)*w,S=null,k=null,R=null;switch(n){case"up":S="includesVertically",R=y-C+1;break;case"left":S="includesHorizontally",R=y-C+1;break;case"down":S="includesVertically",R=v+C-1;break;case"right":S="includesHorizontally",R=v+C-1}return X(o,(function(e){e[S](R)&&e.isFarther(k,n)&&(k=e)})),k}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,r=function(e,n){switch(o){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},l=0,c=null,h=1;do{for(var f=0;f<n.length;f+=1){if(r(c=n[f],l=h*this.currentFillData.cycleLength))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:c.row-l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:c.row+l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col-l,colspan:c.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col+l,colspan:c.colspan})}f===n.length-1&&(h+=1)}}while(r(c,l));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},o={min:null,max:null};return X(e,(function(e){var r=e[0],l=t.plugin.hot.propToCol(e[1]);(null===n.min||r<n.min)&&(n.min=r),(null===n.max||r>n.max)&&(n.max=r),(null===o.min||l<o.min)&&(o.min=l),(null===o.max||l>o.max)&&(o.max=l)})),{from:{row:n.min,column:o.min},to:{row:n.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var o=F_(this.getDragArea(e,t,n),4),r=o[0],l=o[1],c=o[2],h=o[3],f=new Wn(r,l),d=new Wn(c,h),y=new Hd(f,f,d);return!!this.mergedCellsCollection.getWithinRange(y,!0)}}])&&U_(t.prototype,n),o&&U_(t,o),e}();function Y_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var G_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var t,n,o;return t=e,(n=[{key:"snapDelta",value:function(e,t,n){var o=t.to,r=o.row+e.row,l=o.col+e.col;e.row?this.jumpOverMergedCell(e,n,r):e.col&&this.jumpOverMergedCell(e,n,l)}},{key:"jumpOverMergedCell",value:function(e,t,n){var o=e.row||e.col,r=null,l=null,c=null;e.row?(r=t.includesVertically(n),l=t.row,c=t.getLastRow()):e.col&&(r=t.includesHorizontally(n),l=t.col,c=t.getLastColumn()),0!==o&&(o>0?r&&n!==l&&(o+=c-n+1):r&&n!==c&&(o-=n-l+1),e.row?e.row=o:e.col&&(e.col=o))}},{key:"getUpdatedSelectionRange",value:function(e,t){return new Hd(e.highlight,e.from,new Wn(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,o){var r=Math.min(n[0],n[2]),l=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),h=Math.max(n[1],n[3]);if(void 0!==o&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var f=this.plugin.mergedCellsCollection.get(e,t);if(f){var d=f.getLastRow(),y=f.getLastColumn();return r<=f.row&&l<=f.col&&c>=d&&h>=y?"".concat(this.fullySelectedMergedCellClassName,"-").concat(o):this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var o=0;o<e.rowspan;o+=1)for(var r=0;r<e.colspan;r+=1)n.push(new Wn(e.row+o,e.col+r));for(var i=0;i<n.length;i+=1){for(var l=[],s=0;s<t.length;s+=1)l[s]=t[s].includes(n[i]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],i=0;i<=7;i+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(i));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}])&&Y_(t.prototype,n),o&&Y_(t,o),e}();function K_(e){return(K_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $_(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||q_(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X_(e){return function(e){if(Array.isArray(e))return Z_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q_(e,t){if(e){if("string"==typeof e)return Z_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z_(e,t):void 0}}function Z_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Q_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function J_(e,t,n){return(J_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=rP(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function eP(e,p){return(eP=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function tP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=rP(e);if(t){var r=rP(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return nP(this,n)}}function nP(e,t){return!t||"object"!==K_(t)&&"function"!=typeof t?oP(e):t}function oP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rP(e){return(rP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("beforeMergeCells"),fo.getSingleton().register("afterMergeCells"),fo.getSingleton().register("beforeUnmergeCells"),fo.getSingleton().register("afterUnmergeCells");var iP,aP="mergeCells",lP=new WeakMap,sP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eP(e,t)}(l,e);var t,n,o,r=tP(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e),lP.set(oP(t),{lastDesiredCoords:null}),t.mergedCellsCollection=null,t.autofillCalculations=null,t.selectionCalculations=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return aP}},{key:"PLUGIN_PRIORITY",get:function(){return 150}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new V_(this),this.autofillCalculations=new z_(this),this.selectionCalculations=new G_(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,source){if("MergeCells"===source)return!1})),J_(rP(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),J_(rP(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),J_(rP(l.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(D_.containsNegativeValues(e)?(to(D_.NEGATIVE_VALUES_WARNING(e)),t=!1):D_.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(to(D_.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):D_.isSingleCell(e)?(to(D_.IS_SINGLE_CELL(e)),t=!1):D_.containsZeroSpan(e)&&(to(D_.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n,o=[];X(e,(function(e){if(t.validateSetting(e)){var n=new Wn(e.row,e.col),r=new Wn(e.row+e.rowspan-1,e.col+e.colspan-1),l=new Hd(n,n,r);o.push(t.mergeRange(l,!0,!0))}})),o=o.filter((function(e){return!0!==e}));var r=this.getBulkCollectionData(o);(n=this.hot).populateFromArray.apply(n,X_(r))}}},{key:"getBulkCollectionData",value:function(e){var t,n=this.getBulkCollectionDataRange(e),o=(t=this.hot).getData.apply(t,X_(n)).splice(0);return X(e,(function(e){var t=$_(e,3),r=t[0],l=t[1];X(t[2],(function(e,t){X(e,(function(e,c){o[r-n[0]+t][l-n[1]+c]=e}))}))})),[n[0],n[1],o]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],n=[0,0],o=null,r=null,l=null;return X(e,(function(e){o=e[0],r=e[1],l=e[2],t[0]=Math.min(o,t[0]),t[1]=Math.min(r,t[1]),n[0]=Math.max(o+l.length-1,n[0]),n[1]=Math.max(r+l[0].length-1,n[1])})),[].concat(t,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.getTopLeftCorner(),l=e.getBottomRightCorner(),c={row:r.row,col:r.col,rowspan:l.row-r.row+1,colspan:l.col-r.col+1},h=[],f=null;if(!this.canMergeRange(c,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),ur(0,c.rowspan-1,(function(i){ur(0,c.colspan-1,(function(e){var n=null;h[i]||(h[i]=[]),0===i&&0===e?n=t.hot.getDataAtCell(c.row,c.col):t.hot.setCellMeta(c.row+i,c.col+e,"hidden",!0),h[i][e]=n}))})),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return!d||(o?f=[c.row,c.col,h]:this.hot.populateFromArray(c.row,c.col,h,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,c,n),f)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.mergedCellsCollection.getWithinRange(e);o&&(this.hot.runHooks("beforeUnmergeCells",e,n),X(o,(function(e){t.mergedCellsCollection.remove(e.row,e.col),ur(0,e.rowspan-1,(function(i){ur(0,e.colspan-1,(function(n){t.hot.removeCellMeta(e.row+i,e.col+n,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,o){var r=new Wn(e,t),l=new Wn(n,o);this.mergeRange(new Hd(r,r,l))}},{key:"unmerge",value:function(e,t,n,o){var r=new Wn(e,t),l=new Wn(n,o);this.unmergeRange(new Hd(r,r,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),qn(e))}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),o=0;o<t.length;o+=1)if(n.from.row===t[o].row&&n.from.col===t[o].col&&n.to.row===t[o].row+t[o].rowspan-1&&n.to.col===t[o].col+t[o].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,n=lP.get(this),o=this.hot.getSelectedRangeLast(),r={row:e.row,col:e.col},l=new Wn(o.highlight.row,o.highlight.col),c=this.mergedCellsCollection.get(l.row,l.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new Wn(null,null)),c){var h=new Wn(c.row,c.col),f=new Wn(c.row+c.rowspan-1,c.col+c.colspan-1);new Hd(h,h,f).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new Wn(null,null)),r.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-l.row:r.row,r.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-l.col:r.col,e.row>0?r.row=c.row+c.rowspan-1-l.row+e.row:e.row<0&&(r.row=l.row-c.row+e.row),e.col>0?r.col=c.col+c.colspan-1-l.col+e.col:e.col<0&&(r.col=l.col-c.col+e.col)}t=new Wn(o.highlight.row+r.row,o.highlight.col+r.col);var d=this.mergedCellsCollection.get(t.row,t.col);if(d){var y=this.mergedCellsCollection.getFirstRenderableCoords(d.row,d.col);n.lastDesiredCoords=t,r={row:y.row-l.row,col:y.col-l.col}}0!==r.row&&(e.row=r.row),0!==r.col&&(e.col=r.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),o=pe(e),r=this.selectionCalculations.getUpdatedSelectionRange(n,e),l=pe(o),c=this.mergedCellsCollection.getWithinRange(r,!0);do{l=pe(o),this.selectionCalculations.getUpdatedSelectionRange(n,o),X(c,(function(e){t.selectionCalculations.snapDelta(o,n,e)}))}while(o.row!==l.row||o.col!==l.col);e.row=o.row,e.col=o.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var o=n.row,r=n.col,l=n.colspan;return[o,r,o+n.rowspan-1,r+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Qh)}return this.getTranslatedPhrase(Zh)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||D_.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(e,t,col){var n=this.mergedCellsCollection.get(t,col),o=ve(n)?pe(n):void 0;if(ve(o)){var r=this.hot,l=r.rowIndexMapper,c=r.columnIndexMapper,h=o.row,f=o.col,d=o.colspan,y=o.rowspan,v=$_(this.translateMergedCellToRenderable(h,y,f,d),2),m=v[0],w=v[1],C=m-l.getRenderableFromVisualIndex(t)+1,S=w-c.getRenderableFromVisualIndex(col)+1;o.row=l.getFirstNotHiddenIndex(o.row,1),o.col=c.getFirstNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,C),o.colspan=Math.min(o.colspan,S)}N_(e,o,t,col)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),n=[t.row,t.col];e.row=n[0],e.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=new Wn(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){var o=this.mergedCellsCollection.mergedCells[i].getRange();t.expandByRange(o)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,col,t){var n=this.mergedCellsCollection.get(e,col);n&&(n.row!==e||n.col!==col?t.copyable=!1:(t.rowspan=n.rowspan,t.colspan=n.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.startRow),r=0;r<t;r+=1){var l=this.mergedCellsCollection.get(o,r);if(ve(l)){var c=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l.row,1));if(c<e.startRow)return e.startRow=c,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.endRow),r=0;r<t;r+=1){var l=this.mergedCellsCollection.get(o,r);if(ve(l)){var c=l.row+l.rowspan-1,h=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(c,-1));if(h>e.endRow)return e.endRow=h,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.startColumn),r=0;r<t;r+=1){var l=this.mergedCellsCollection.get(r,o);if(ve(l)){var c=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l.col,1));if(c<e.startColumn)return e.startColumn=c,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.endColumn),r=0;r<t;r+=1){var l=this.mergedCellsCollection.get(r,o);if(ve(l)){var c=l.col+l.colspan-1,h=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(c,-1));if(h>e.endColumn)return e.endColumn=h,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,o){var r,l,c=this.hot,h=c.rowIndexMapper,f=c.columnIndexMapper;return r=0===t?h.getFirstNotHiddenIndex(e,1):h.getFirstNotHiddenIndex(e+t-1,-1),l=0===o?f.getFirstNotHiddenIndex(n,1):f.getFirstNotHiddenIndex(n+o-1,-1),[e>=0?h.getRenderableFromVisualIndex(r):e,n>=0?f.getRenderableFromVisualIndex(l):n]}},{key:"onModifyAutofillRange",value:function(e,select){this.autofillCalculations.correctSelectionAreaSize(select);var t=this.autofillCalculations.getDirection(select,e),n=e;if(this.autofillCalculations.dragAreaOverlapsCollections(select,n,t))return n=select;var o=this.mergedCellsCollection.getWithinRange({from:{row:select[0],col:select[1]},to:{row:select[2],col:select[3]}});return o?n=this.autofillCalculations.snapDragArea(select,n,t,o):n}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,source){"auto"!==source&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,source){"Autofill.fill"===source&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast();X(this.mergedCellsCollection.getWithinRange(n),(function(t){n.getBottomRightCorner().row===t.getLastRow()&&n.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var o=this.mergedCellsCollection.get(e.row,e.col);if(o){var r=t>0,l=t<0,c=n<0,h=n>0,f=o.row+o.rowspan-1==this.hot.countRows()-1,d=0===o.row,y=o.col+o.colspan-1==this.hot.countCols()-1,v=0===o.col;(r&&f||l&&d||h&&y||c&&v)&&(e.row=o.row,e.col=o.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,o)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&Q_(t.prototype,n),o&&Q_(t,o),l}(mm);function uP(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return cP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cP(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cP(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function hP(){to(et(iP||(iP=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var fP="sort";function dP(e,t,n){var o=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&o.push("".concat(fP,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),o}function pP(e){var t=e.className.split(" "),n=new RegExp("^".concat(fP,"-[0-9]{1,2}$"));return t.filter((function(e){return n.test(e)}))}function yP(e){return(yP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vP(e,t,n){return(vP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=CP(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function mP(e,p){return(mP=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function bP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=CP(e);if(t){var r=CP(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return wP(this,n)}}function wP(e,t){return!t||"object"!==yP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CP(e){return(CP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SP="multiColumnSorting";Vw(SP,(function(e,t){return function(n,o){var r=uP(n).slice(1),l=uP(o).slice(1);return function n(o){var c=e[o],h=t[o],f=r[o],d=l[o],y=h.multiColumnSorting,v=(y.compareFunctionFactory?y.compareFunctionFactory:Ww(h.type))(c,h,y)(f,d);if(0===v){var m=o+1;if(void 0!==t[m])return n(m)}return v}(0)}}));var kP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mP(e,t)}(l,e);var t,n,o,r=bP(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).pluginKey=SP,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return SP}},{key:"PLUGIN_PRIORITY",get:function(){return 170}}],(n=[{key:"isEnabled",value:function(){return vP(CP(l.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&hP(),vP(CP(l.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){vP(CP(l.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){vP(CP(l.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){vP(CP(l.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return vP(CP(l.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return vP(CP(l.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){vP(CP(l.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(t=vP(CP(l.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(o)),Gt(e,pP(e)),!1!==this.enabled&&Yt(e,dP.apply(void 0,o))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&hP(),vP(CP(l.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==mw(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(Od()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,"append"))):this.sort(this.getColumnNextConfig(t.col)))}}])&&gP(t.prototype,n),o&&gP(t,o),l}(uC);function RP(e){return(RP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EP(e,t,n){return(EP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=xP(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function TP(e,p){return(TP=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function AP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=xP(e);if(t){var r=xP(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return MP(this,n)}}function MP(e,t){return!t||"object"!==RP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xP(e){return(xP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TP(e,t)}(l,e);var t,n,o,r=AP(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).dragged=[],t.eventManager=null,t.lastSetCell=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return"multipleSelectionHandles"}},{key:"PLUGIN_PRIORITY",get:function(){return 160}}],(n=[{key:"isEnabled",value:function(){return Ve()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Po(this)),this.registerListeners(),EP(xP(l.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,n=this.hot.rootElement;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(e){var n;return zt(e.target,"topLeftSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("topLeft"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):zt(e.target,"bottomRightSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottomRight"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(e){return zt(e.target,"topLeftSelectionHandle-HitArea")?(o.call(t,"topLeft"),t.touchStartRange=void 0,e.preventDefault(),!1):zt(e.target,"bottomRightSelectionHandle-HitArea")?(o.call(t,"bottomRight"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var o,r,l,c,h,f,d=e.hot,y=d.rootWindow,v=d.rootDocument,m=tn(y),w=nn(y);if(0!==t.dragged.length){var C=v.elementFromPoint(n.touches[0].screenX-w,n.touches[0].screenY-m);C&&C!==t.lastSetCell&&("TD"!==C.nodeName&&"TH"!==C.nodeName||(-1===(o=t.hot.getCoords(C)).col&&(o.col=0),l=(r=t.hot.getSelectedRangeLast()).getWidth(),c=r.getHeight(),h=r.getDirection(),1===l&&1===c&&t.hot.selection.setRangeEnd(o),null!==(f=t.getCurrentRangeCoords(r,o,t.touchStartRange.direction,h,t.dragged[0])).start&&t.hot.selection.setRangeStart(f.start),t.hot.selection.setRangeEnd(f.end),t.lastSetCell=C),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,n,o,r){var l=e.getTopLeftCorner(),c=e.getBottomRightCorner(),h=e.getBottomLeftCorner(),f=e.getTopRightCorner(),d={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":d="topLeft"===r?{start:new Wn(t.row,e.highlight.col),end:new Wn(h.row,t.col)}:{start:new Wn(e.highlight.row,t.col),end:new Wn(t.row,l.col)};break;case"SE-NW":"bottomRight"===r&&(d={start:new Wn(c.row,t.col),end:new Wn(t.row,l.col)})}break;case"NW-SE":switch(o){case"NE-SW":"topLeft"===r?d={start:t,end:h}:d.end=t;break;case"NW-SE":"topLeft"===r?d={start:t,end:c}:d.end=t;break;case"SE-NW":"topLeft"===r?d={start:t,end:l}:d.end=t;break;case"SW-NE":"topLeft"===r?d={start:t,end:f}:d.end=t}break;case"SW-NE":switch(o){case"NW-SE":d="bottomRight"===r?{start:new Wn(t.row,l.col),end:new Wn(h.row,t.col)}:{start:new Wn(l.row,t.col),end:new Wn(t.row,c.col)};break;case"SW-NE":d="topLeft"===r?{start:new Wn(e.highlight.row,t.col),end:new Wn(t.row,c.col)}:{start:new Wn(t.row,l.col),end:new Wn(l.row,t.col)};break;case"SE-NW":"bottomRight"===r?d={start:new Wn(t.row,f.col),end:new Wn(l.row,t.col)}:"topLeft"===r&&(d={start:h,end:t})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===r&&(d.end=t);break;case"SE-NW":"topLeft"===r?d.end=t:d={start:t,end:l}}}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}])&&OP(t.prototype,n),o&&OP(t,o),l}(mm);function PP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.label,label=void 0===t?"":t,n=e.colspan,o=void 0===n?1:n,r=e.origColspan,l=void 0===r?1:r,c=e.collapsible,h=void 0!==c&&c,f=e.crossHiddenColumns,d=void 0===f?[]:f,y=e.isCollapsed,v=void 0!==y&&y,m=e.isHidden,w=void 0!==m&&m,C=e.isRoot,S=void 0!==C&&C,k=e.isPlaceholder,R=void 0!==k&&k;return{label:label,colspan:o,origColspan:l,collapsible:h,isCollapsed:v,crossHiddenColumns:d,isHidden:w,isRoot:S,isPlaceholder:R}}function IP(e){return function(e){if(Array.isArray(e))return HP(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return HP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HP(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HP(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function DP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===t)return n;X(e,(function(e){var o=[],r=0;n.push(o),X(e,(function(e){var n=PP();if(ve(e)){var label=e.label,l=e.colspan;n.label=ot(label),"number"==typeof l&&l>1&&(n.colspan=l,n.origColspan=l)}else n.label=ot(e);var c=!1;if((r+=n.origColspan)>=t&&(n.colspan=n.origColspan-(r-t),n.origColspan=n.colspan,c=!0),o.push(n),n.colspan>1)for(var i=0;i<n.colspan-1;i++)o.push({label:"",isPlaceholder:!0});return!c}))}));var o=Math.max.apply(Math,IP($(n,(function(e){return e.length}))));return X(n,(function(e){if(e.length<o){var t=$(new Array(o-e.length),(function(){return PP()}));e.splice.apply(e,[e.length,0].concat(IP(t)))}})),n}var NP=["row","col"];function jP(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function LP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BP(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function VP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FP(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,UP(e,t,"get"))}function WP(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,UP(e,t,"set"),n),n}function UP(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var zP=["label","collapsible"],YP=new WeakMap,GP=new WeakMap,KP=new WeakMap,$P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),YP.set(this,{writable:!0,value:[]}),GP.set(this,{writable:!0,value:0}),KP.set(this,{writable:!0,value:1/0})}var t,n,o;return t=e,(n=[{key:"setColumnsLimit",value:function(e){WP(this,KP,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];WP(this,YP,DP(e,FP(this,KP))),WP(this,GP,FP(this,YP).length)}},{key:"getData",value:function(){return FP(this,YP)}},{key:"mergeWith",value:function(e){var t=this;X(e,(function(e){var n=e.row,col=e.col,o=BP(e,NP),r=t.getHeaderSettings(n,col);null!==r&&he(r,o,zP)}))}},{key:"map",value:function(e){X(FP(this,YP),(function(header){X(header,(function(t){var n=e(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?jP(Object(source),!0).forEach((function(t){LP(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):jP(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},t));ve(n)&&he(t,n,zP)}))}))}},{key:"getHeaderSettings",value:function(e,t){var n;if(e>=FP(this,GP)||e<0)return null;var o=FP(this,YP)[e];return t>=o.length?null:null!==(n=o[t])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=[];if(e>=FP(this,GP)||e<0)return o;for(var r=FP(this,YP)[e],l=0,i=t;i<r.length;i++){var c=r[i];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=c.colspan,o.push(c),c.colspan>1&&(i+=c.colspan-1),l===n)break;if(l>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return FP(this,GP)}},{key:"getColumnsCount",value:function(){return FP(this,GP)>0?FP(this,YP)[0].length:0}},{key:"clear",value:function(){WP(this,YP,[]),WP(this,GP,0)}}])&&VP(t.prototype,n),o&&VP(t,o),e}();function XP(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function qP(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?XP(Object(source),!0).forEach((function(t){QP(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):XP(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function ZP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JP(e){return function(e){if(Array.isArray(e))return eI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return eI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eI(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eI(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var tI=new Map([["DF-pre-order",function e(t,n){for(var o=t.call(n,this),i=0;i<this.childs.length;i++){if(!1===o)return!1;o=e.call(this.childs[i],t,n)}return o}],["DF-post-order",function e(t,n){for(var i=0;i<this.childs.length;i++){if(!1===e.call(this.childs[i],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){var n=[this];!function o(){if(0!==n.length){var r=n.shift();n.push.apply(n,JP(r.childs)),!1!==e.call(t,r)&&o()}}()}]]),nI=function(){function e(data){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),QP(this,"data",{}),QP(this,"parent",null),QP(this,"childs",[]),this.data=data}var t,n,o;return t=e,(n=[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new e(qP({},t.data)),i=0;i<t.childs.length;i++)n.addChild(this.cloneTree(t.childs[i]));return n}},{key:"replaceTreeWith",value:function(e){this.data=qP({},e.data),this.childs=[];for(var i=0;i<e.childs.length;i++)this.addChild(e.childs[i])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!tI.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));tI.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this;!function n(o){!1!==e.call(t,o)&&null!==o.parent&&n(o.parent)}(this)}}])&&ZP(t.prototype,n),o&&ZP(t,o),e}();function oI(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function rI(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?oI(Object(source),!0).forEach((function(t){iI(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):oI(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function iI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aI(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return lI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lI(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lI(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function sI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uI(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,hI(e,t,"get"))}function cI(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,hI(e,t,"set"),n),n}function hI(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var fI,dI,pI=new WeakMap,yI=new WeakMap,gI=new WeakMap,vI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),pI.set(this,{writable:!0,value:new Map}),yI.set(this,{writable:!0,value:new Map}),gI.set(this,{writable:!0,value:null}),cI(this,gI,t)}var t,n,o;return t=e,(n=[{key:"getRoots",value:function(){return Array.from(uI(this,pI).values())}},{key:"getRootByColumn",value:function(e){var t;return uI(this,yI).has(e)&&(t=uI(this,pI).get(uI(this,yI).get(e))),t}},{key:"getNode",value:function(e,t){var n=this.getRootByColumn(t);if(n){var o,r=t-uI(this,yI).get(t),l=0;return n.walkDown((function(t){var n=t.data,c=n.origColspan,h=n.headerLevel;if(e===h){if(r>=l&&r<=l+c-1)return o=t,!1;l+=c}})),o}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;uI(this,yI).clear(),X(uI(this,pI),(function(n){for(var o=aI(n,2)[1].data.colspan,i=t;i<t+o;i++)uI(e,yI).set(i,t);t+=o}))}},{key:"buildTree",value:function(){this.clear();for(var e=uI(this,gI).getColumnsCount(),t=0;t<e;){var n=uI(this,gI).getHeaderSettings(0,t),o=new nI;uI(this,pI).set(t,o),this.buildLeaves(o,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=uI(this,gI).getHeadersSettings(n,t,r);n+=1,X(l,(function(r){var l,c=rI(rI({},r),{},{headerLevel:n-1,columnIndex:t});1===n?(e.data=c,l=e):(l=new nI(c),e.addChild(l)),n<uI(o,gI).getLayersCount()&&o.buildLeaves(l,t,n,r.origColspan),t+=r.origColspan}))}},{key:"clear",value:function(){uI(this,pI).clear(),uI(this,yI).clear()}}])&&sI(t.prototype,n),o&&sI(t,o),e}();function mI(e,t){e.walkDown((function(e){var data=e.data,n=e.childs;if(!data.isHidden&&(t(data.columnIndex),0===n.length))for(var i=1;i<data.colspan;i++)t(data.columnIndex+i)}))}function bI(e,t){var n=e.childs;if(0!==n.length)return n[0].data[t]}function wI(e){return bI(e,"origColspan")===e.data.origColspan}function CI(e){var t=e.data,n=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(wI(e))return CI(n[0]);t.isCollapsed=!1;var o=n.slice(1),r=new Set,l=0;if(o.length>0)X(o,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;l+=t.colspan,mI(e,(function(e){r.add(e)}))}));else{var c=t.colspan,h=t.origColspan,f=t.columnIndex;l=h-c;for(var i=1;i<h;i++)r.add(f+i)}return e.walkUp((function(e){var data=e.data;data.colspan+=l,data.colspan>=data.origColspan?(data.colspan=data.origColspan,data.isCollapsed=!1):wI(e)&&(data.isCollapsed=bI(e,"isCollapsed"))})),{rollbackModification:function(){return SI(e)},affectedColumns:Array.from(r),colspanCompensation:l}}function SI(e){var t,n=e.data,o=e.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(wI(e))return SI(o[0]);n.isCollapsed=!0;var r=o.slice(1),l=new Set;if(r.length>0)X(r,(function(e){mI(e,(function(e){l.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){e.data.isHidden=!0}))}));else for(var c=n.origColspan,h=n.columnIndex,i=1;i<c;i++){var f=h+i;l.add(f)}var d=n.colspan-(null!==(t=bI(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var data=e.data;data.colspan-=d,data.colspan<=1?(data.colspan=1,data.isCollapsed=!0):wI(e)&&(data.isCollapsed=bI(e,"isCollapsed"))})),{rollbackModification:function(){return CI(e)},affectedColumns:Array.from(l),colspanCompensation:d}}var kI=new Map([["collapse",SI],["expand",CI],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(et(fI||(fI=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));if(!e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var data=e.data;data.crossHiddenColumns.push(t),data.colspan>1?data.colspan-=1:data.isHidden=!0}))}}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(et(dI||(dI=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));if(e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var data=e.data;data.crossHiddenColumns.splice(data.crossHiddenColumns.indexOf(t),1),!data.isHidden&&data.colspan<data.origColspan&&(data.colspan+=1),data.isHidden=!1}))}}]]);var RI=["crossHiddenColumns"];function OI(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function EI(e){var t=[];return X(e,(function(e){e.walkDown((function(e){for(var n=e.data,o=n.origColspan,r=n.columnIndex,l=n.headerLevel,c=n.crossHiddenColumns,h=function(e,t){var n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,l),f=!1,i=r;i<r+o;i++){if(c.includes(i)||f)h.push({label:"",isPlaceholder:!0});else{var d=TI(n);d.isRoot=!0,h.push(d),f=!0}}}))})),t}function TI(e){var t=PP(e);t.crossHiddenColumns;return OI(t,RI)}var AI=["row"];function MI(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function xI(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?MI(Object(source),!0).forEach((function(t){_I(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):MI(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function _I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PI(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},o=Object.keys(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)t=o[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function II(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function HI(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,NI(e,t,"set"),n),n}function DI(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,NI(e,t,"get"))}function NI(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var jI=new WeakMap,LI=new WeakMap,BI=new WeakMap,VI=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),jI.set(this,{writable:!0,value:new $P}),LI.set(this,{writable:!0,value:new vI(DI(this,jI))}),BI.set(this,{writable:!0,value:[[]]})}var t,n,o;return t=e,(n=[{key:"setState",value:function(e){DI(this,jI).setData(e);var t=!1;try{DI(this,LI).buildTree()}catch(e){DI(this,LI).clear(),DI(this,jI).clear(),t=!0}return HI(this,BI,EI(DI(this,LI).getRoots())),t}},{key:"setColumnsLimit",value:function(e){DI(this,jI).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,n=$(e,(function(e){var n=e.row,o=PI(e,AI);return xI({row:n<0?t.rowCoordsToLevel(n):n},o)}));DI(this,jI).mergeWith(n),DI(this,LI).buildTree(),HI(this,BI,EI(DI(this,LI).getRoots()))}},{key:"mapState",value:function(e){DI(this,jI).map(e),DI(this,LI).buildTree(),HI(this,BI,EI(DI(this,LI).getRoots()))}},{key:"mapNodes",value:function(e){return G(DI(this,LI).getRoots(),(function(t,n){return n.walkDown((function(n){var o=e(n.data);void 0!==o&&t.push(o)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));var o,r=DI(this,LI).getNode(t,n);return r&&(o=function(e,t,n){if(!kI.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return kI.get(e)(t,n)}(e,r,n),HI(this,BI,EI(DI(this,LI).getRoots()))),o}},{key:"triggerColumnModification",value:function(e,t){return this.triggerNodeModification(e,-1,t)}},{key:"rowCoordsToLevel",value:function(e){var t=Math.max(this.getLayersCount(),1),n=t-1;return Math.min(Math.max(e+t,0),n)}},{key:"levelToRowCoords",value:function(e){var t=Math.max(this.getLayersCount(),1),n=-t;return Math.min(Math.max(e-t,n),-1)}},{key:"getHeaderSettings",value:function(e,t){var n,o;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?null:null!==(n=null===(o=DI(this,BI)[e])||void 0===o?void 0:o[t])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(e,t){e<0&&(e=this.rowCoordsToLevel(e));var n=DI(this,LI).getNode(e,t);return n?xI({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,t){var n;if((null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0}).isRoot)return t;for(var o=t-1;o>=0;){var r;if((null!==(r=this.getHeaderSettings(e,o))&&void 0!==r?r:{isRoot:!0}).isRoot)break;o-=1}return o}},{key:"getLayersCount",value:function(){return DI(this,jI).getLayersCount()}},{key:"getColumnsCount",value:function(){return DI(this,jI).getColumnsCount()}},{key:"clear",value:function(){HI(this,BI,[]),DI(this,jI).clear(),DI(this,LI).clear()}}])&&II(t.prototype,n),o&&II(t,o),e}();function FI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var WI,UI,zI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}var t,n,o;return t=e,(n=[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsCache.length=0;for(var i=0;i<t;i++)this.widthsCache.push(e[i].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var t=this.nestedHeaders.hot.rootDocument,n=t.createDocumentFragment(),table=t.createElement("table"),o=!1,r=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.getLayersCount(),c=this.nestedHeaders.hot.countCols(),h=l-1,f=0;f<l;f++){var tr=t.createElement("tr");o=!1;for(var col=0;col<c;col++){var td=t.createElement("th"),d=pe(this.nestedHeaders.getHeaderSettings(f,col));d&&!d.isHidden&&(f===h&&(d.colspan>1&&(o=!0),r&&(d.label+='<button class="changeType"></button>')),Zt(td,d.label),void 0!==d.colspan&&(td.colSpan=d.colspan),tr.appendChild(td))}table.appendChild(tr)}if(o){for(var y=t.createElement("tr"),v=0;v<c;v++){var m=t.createElement("th");y.appendChild(m)}table.appendChild(y)}n.appendChild(table),e.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}])&&FI(t.prototype,n),o&&FI(t,o),e}();function YI(e){return(YI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GI(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $I(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XI(e,t,n){return(XI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=eH(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function qI(e,p){return(qI=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ZI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=eH(e);if(t){var r=eH(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return QI(this,n)}}function QI(e,t){return!t||"object"!==YI(t)&&"function"!=typeof t?JI(e):t}function JI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eH(e){return(eH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nH(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,rH(e,t,"set"),n),n}function oH(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,rH(e,t,"get"))}function rH(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var iH="nestedHeaders",aH=new WeakMap,lH=new WeakMap,sH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qI(e,t)}(l,e);var t,n,o,r=ZI(l);function l(){var e;KI(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),aH.set(JI(e),{writable:!0,value:new VI}),lH.set(JI(e),{writable:!0,value:null}),tH(JI(e),"ghostTable",new zI(JI(e))),tH(JI(e),"detectedOverlappedHeaders",!1),e}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return iH}},{key:"PLUGIN_PRIORITY",get:function(){return 280}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().nestedHeaders;Array.isArray(t)&&Array.isArray(t[0])||to(et(WI||(WI=GI(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth.apply(e,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),XI(eH(l.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var e=this;if(this.hot.view){var t=this.hot.getSettings().nestedHeaders;oH(this,aH).setColumnsLimit(this.hot.countSourceCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=oH(this,aH).setState(t)),this.detectedOverlappedHeaders&&to(et(UI||(UI=GI(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(t,n){var o=!0===t?"hide-column":"show-column";oH(e,aH).triggerColumnModification(o,n)})),!oH(this,lH)&&this.enabled&&nH(this,lH,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(t){t.forEach((function(t){var n=t.op,o=t.index,r=t.newValue;if("replace"===n){var l=!0===r?"hide-column":"show-column";oH(e,aH).triggerColumnModification(l,o)}}))}))),this.ghostTable.buildWidthsMapper(),XI(eH(l.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),oH(this,aH).clear(),oH(this,lH).unsubscribe(),nH(this,lH,null),this.ghostTable.clear(),XI(eH(l.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return oH(this,aH)}},{key:"getLayersCount",value:function(){return oH(this,aH).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return oH(this,aH).getHeaderSettings(e,t)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view.wt,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,r=e.wtOverlays.topLeftCornerOverlay?e.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var l=n.childNodes[i];if(!l)break;for(var c=o.childNodes[i],h=r?r.childNodes[i]:null,f=0,d=l.childNodes.length;f<d;f++)l.childNodes[f].removeAttribute("colspan"),Gt(l.childNodes[f],"hiddenHeader"),c&&c.childNodes[f]&&(c.childNodes[f].removeAttribute("colspan"),Gt(c.childNodes[f],"hiddenHeader")),r&&h&&h.childNodes[f]&&(h.childNodes[f].removeAttribute("colspan"),Gt(h.childNodes[f],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,n=this.hot.view.wt.getSetting("fixedColumnsLeft");return function(o,r){var l,c=t.hot,h=c.rootDocument,f=c.columnIndexMapper,view=c.view,d=f.getVisualFromRenderableIndex(o);null===d&&(d=o),r.removeAttribute("colspan"),Gt(r,"hiddenHeader");var y=null!==(l=oH(t,aH).getHeaderSettings(e,d))&&void 0!==l?l:{label:""},v=y.colspan,label=y.label,m=y.isHidden;if(y.isPlaceholder||m)Yt(r,"hiddenHeader");else if(v>1){var w,C,S=null===(w=view.wt.wtOverlays.topLeftCornerOverlay)||void 0===w?void 0:w.clone.wtTable.THEAD.contains(r),k=null===(C=view.wt.wtOverlays.leftOverlay)||void 0===C?void 0:C.clone.wtTable.THEAD.contains(r),R=S||k?Math.min(v,n-o):v;R>1&&r.setAttribute("colspan",R)}var O=h.createElement("div"),E=h.createElement("span");Yt(O,"relative"),Yt(E,"colHeader"),Zt(E,label),O.appendChild(E),$t(r),r.appendChild(O),t.hot.runHooks("afterGetColHeader",d,r)}}},{key:"onBeforeHighlightingColumnHeader",value:function(e,t,n){var o=oH(this,aH).getHeaderTreeNodeData(t,e);if(!o)return e;var r=n.classNames,l=n.columnCursor,c=n.selectionType,h=n.selectionWidth,f=oH(this,aH).getHeaderSettings(t,e),d=f.isRoot,y=f.colspan;if(c===xd){if(!d)return o.columnIndex}else c===Ed&&(y>h-l||!d)&&(r.length=0);return e}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,o){this._getHeaderTreeNodeDataByCoords(t)&&(o.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){var n=this._getHeaderTreeNodeDataByCoords(t);if(n){var o=this.hot.selection,r=o.isSelected()?o.getSelectedRange().current():null,l=[],c=n.columnIndex,h=n.origColspan,f=!o.inInSelection(t);e.shiftKey&&r?t.col<r.from.col?l.push(r.getTopRightCorner().col,c,t.row):t.col>r.from.col?l.push(r.getTopLeftCorner().col,c+h-1,t.row):l.push(c,c+h-1,t.row):(Jn(e)||Qn(e)&&f)&&l.push(c,c+h-1,t.row),o.selectColumns.apply(o,l)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,o){var r;if(this.hot.view.isMouseDown()){var l=this._getHeaderTreeNodeDataByCoords(t);if(l){var c=l.columnIndex,h=l.origColspan,f=this.hot.getSelectedRangeLast(),d=f.getTopLeftCorner(),y=f.getBottomRightCorner(),v=f.from;o.column=!0,o.cell=!0;var m=[];t.col<v.col?m.push(y.col,c):t.col>v.col?m.push(d.col,c+h-1):m.push(c,c+h-1),(r=this.hot).selectColumns.apply(r,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=0;t<oH(this,aH).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=oH(this,aH).getLayersCount(),n=e.startColumn,o=!!t,r=0;r<t;r++){var l=oH(this,aH).findLeftMostColumnIndex(r,e.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(o=!1),sr(c)&&c<e.startColumn){n=c;break}}e.startColumn=o?oH(this,aH).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.widthsCache[t];return e>n?e:n}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){nH(this,aH,null),null!==oH(this,lH)&&(oH(this,lH).unsubscribe(),nH(this,lH,null)),XI(eH(l.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(e){if(!(e.row>=0||e.col<0))return oH(this,aH).getHeaderTreeNodeData(e.row,e.col)}}])&&$I(t.prototype,n),o&&$I(t,o),l}(mm);function uH(e){return function(e){if(Array.isArray(e))return cH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return cH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cH(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cH(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function hH(e){return(hH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var dH=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}var t,n,o;return t=e,(n=[{key:"setData",value:function(data){this.data=data}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(data){this.setData(data),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ur(0,this.data.length-1,(function(i){e.cacheNode(e.data[i],0,null)}))}},{key:"cacheNode",value:function(e,t,n){var o=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&X(e.__children,(function(n){o.cacheNode(n,t+1,e)}))}},{key:"getDataObject",value:function(e){return null==e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,o){var r=this,l=!1,c=t;if(isNaN(c)&&c.end)return c;var h=e;return h||(h={__children:this.data},l=!0,c-=1),null!=n&&c===n?{result:h,end:!0}:null!=o&&h===o?{result:c,end:!0}:(c+=1,h.__children&&X(h.__children,(function(e){if(r.parentReference.set(e,l?null:h),c=r.readTreeNodes(e,c,n,o),isNaN(c)&&c.end)return!1})),c)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return be(this.data[0],(function(t,n){e[n]=null})),e}},{key:"getRowIndex",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,n=0,o=e;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(X(o.__children,(function(e){n+=1,e.__children&&(n+=t.countChildren(e))})),n):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===hH(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,element){var t=element;this.hot.runHooks("beforeAddChild",e,t);var n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),t||(t=this.mockNode()),o.__children.push(t),this.rewriteCache();var r=this.getRowIndex(t);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",e,t)}},{key:"addChildAtIndex",value:function(e,t,element){var n=element;n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",e,n,t),e?(this.hot.runHooks("beforeCreateRow",t,1),e.__children.splice(t,null,n),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",t,1)):(this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers()),this.updateWithData(this.getRawSourceData()),n=this.getDataObject(t),this.hot.runHooks("afterAddChild",e,n,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),o=this.getRowParent(n),r=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(o,r+1,null);break;case"above":this.addChildAtIndex(o,r,null)}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],element=null,o=[];Array.isArray(e)?(ur(e[0],e[2],(function(i){var e=t.translateTrimmedRow(i);o.push(t.getDataObject(e))})),ur(0,o.length-2,(function(i){t.detachFromParent(o[i],!1)})),element=o[o.length-1]):element=e;var r=this.getRowIndex(element),l=this.getRowIndexWithinParent(element),c=this.getRowParent(element),h=this.getRowParent(c),f=this.getRowIndex(h),d=null;this.hot.runHooks("beforeDetachChild",c,element),null!=l&&(this.hot.runHooks("beforeRemoveRow",r,1,[r],this.plugin.pluginName),c.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",r,1,[r],this.plugin.pluginName),h?(d=f+this.countChildren(h),this.hot.runHooks("beforeCreateRow",d,1,this.plugin.pluginName),h.__children.push(element)):(d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d,1,this.plugin.pluginName),this.data.push(element))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",d,1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,element),n&&this.hot.render()}},{key:"filterData",value:function(e,t,n){var o=this,r=[];X(n,(function(e){r.push(o.getDataObject(e))})),X(r,(function(e){var t=o.getRowIndexWithinParent(e),n=o.getRowParent(e);null===n?o.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){var o,r=this.getDataObject(e-1),l=null,c=e;if(r&&r.__children&&0===r.__children.length?(l=r,c=0):e<this.countAllRows()&&(l=this.getRowParent(e),c=this.getRowIndexWithinParent(e)),l)n?(o=l.__children).splice.apply(o,[c,t].concat(uH(n))):l.__children.splice(c,t);else if(n){var h;(h=this.data).splice.apply(h,[c,t].concat(uH(n)))}else this.data.splice(c,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,n=null;do{null!==(n=this.getRowParent(n))&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,n,o){var r=t===this.hot.countRows(),l=this.getRowParent(e),c=this.getRowIndexWithinParent(e),h=l.__children.slice(c,c+1),f=e>t,d=r?this.getRowParent(t-1):this.getRowParent(t);null==d&&(d=this.getRowParent(t-1)),null==d&&(d=this.getDataObject(t-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(t)).__children=[];var y=r||n||o?d.__children.length:this.getRowIndexWithinParent(t),v=l===d;d.__children.splice(y,0,h[0]),l.__children.splice(c+(f&&v?1:0),1),this.syncRowWithRawSource(l),v||this.syncRowWithRawSource(d)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}])&&fH(t.prototype,n),o&&fH(t,o),e}();var pH=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.plugin=t};function yH(e){return(yH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vH(e,p){return(vH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function mH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=wH(e);if(t){var r=wH(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return bH(this,n)}}function bH(e,t){return!t||"object"!==yH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wH(e){return(wH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vH(e,t)}(l,e);var t,n,o,r=mH(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsingUI=n.plugin.collapsingUI,n.rowHeaderWidthCache=null,n}return t=l,o=[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}],(n=[{key:"appendLevelIndicators",value:function(e,t){var n=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(n),r=this.dataManager.getDataObject(n),c=t.getElementsByTagName("DIV")[0],h=c.querySelector("span.rowHeader");if(X(c.querySelectorAll('[class^="ht_nesting"]'),(function(e){e&&c.removeChild(e)})),Yt(t,l.CSS_CLASSES.indicatorContainer),o){var f=this.hot.rootDocument,d=h.cloneNode(!0);c.innerHTML="",ur(0,o-1,(function(){var e=f.createElement("SPAN");Yt(e,l.CSS_CLASSES.emptyIndicator),c.appendChild(e)})),c.appendChild(d)}if(this.dataManager.hasChildren(r)){var y=this.hot.rootDocument.createElement("DIV");Yt(t,l.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?Yt(y,"".concat(l.CSS_CLASSES.button," ").concat(l.CSS_CLASSES.expandButton)):Yt(y,"".concat(l.CSS_CLASSES.button," ").concat(l.CSS_CLASSES.collapseButton)),c.appendChild(y)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}])&&gH(t.prototype,n),o&&gH(t,o),l}(pH);function SH(e){return(SH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kH(e){return function(e){if(Array.isArray(e))return RH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return RH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RH(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function RH(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function OH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function EH(e,p){return(EH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function TH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=MH(e);if(t){var r=MH(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return AH(this,n)}}function AH(e,t){return!t||"object"!==SH(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MH(e){return(MH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EH(e,t)}(l,e);var t,n,o,r=TH(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=r.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsedRows=[],n.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),X(n.lastCollapsedRows,(function(r,i){r>=e&&r<t&&(n.lastCollapsedRows[i]=r+o)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:function(e,t){ur(e,e+t-1,(function(i){var e=n.lastCollapsedRows.indexOf(i);e>-1&&n.lastCollapsedRows.splice(e,1)}))}},n}return t=l,(n=[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],l=null,c=null,h=null;return isNaN(e)?(l=e,c=this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(e),c=e),this.dataManager.hasChildren(l)&&X(l.__children,(function(e){r.push(t.dataManager.getRowIndex(e))})),h=this.collapseRows(r,!0,!1),o&&this.trimRows(h),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(c)&&this.collapsedRows.push(c),h}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];X(e,(function(e){r.push.apply(r,kH(t.collapseChildren(e,!1,!1)))})),o&&this.trimRows(r),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return X(e,(function(e){r.push(e),n&&t.collapseChildRows(e,r)})),o&&this.trimRows(r),r}},{key:"collapseChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var r=this.dataManager.getDataObject(e);X(r.__children,(function(e){var o=t.dataManager.getRowIndex(e);n.push(o),t.collapseChildRows(o,n)}))}o&&this.trimRows(n)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return X(e,(function(e){r.push(e),n&&t.expandChildRows(e,r)})),o&&this.untrimRows(r),r}},{key:"expandChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var r=this.dataManager.getDataObject(e);X(r.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var o=t.dataManager.getRowIndex(e);n.push(o),t.expandChildRows(o,n)}}))}o&&this.untrimRows(n)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],l=null,c=null,h=null;return isNaN(e)?(l=e,c=this.dataManager.getRowIndex(e)):(l=this.dataManager.getDataObject(e),c=e),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(l)&&X(l.__children,(function(e){var n=t.dataManager.getRowIndex(e);r.push(n)})),h=this.expandRows(r,!0,!1),o&&this.untrimRows(h),n&&this.renderAndAdjust(),h}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];X(e,(function(e){r.push.apply(r,kH(t.expandChildren(e,!1,!1)))})),o&&this.untrimRows(r),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,data=this.dataManager.getData(),t=[];X(data,(function(n){e.dataManager.hasChildren(n)&&t.push(n)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,data=this.dataManager.getData(),t=[];X(data,(function(n){e.dataManager.hasChildren(n)&&t.push(n)})),this.expandMultipleChildren(t),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batchExecution((function(){X(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"untrimRows",value:function(e){var t=this;this.hot.batchExecution((function(){X(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=isNaN(e)?e:this.dataManager.getDataObject(e),o=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&X(n.__children,(function(e){var n=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(n))return o=!1,!1})),o}},{key:"isAnyParentCollapsed",value:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var n=this.translateTrimmedRow(t.row);zt(e.target,CH.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),qn(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}])&&OH(t.prototype,n),o&&OH(t,o),l}(pH);function _H(e){return(_H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function IH(e,p){return(IH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function HH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=jH(e);if(t){var r=jH(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return DH(this,n)}}function DH(e,t){return!t||"object"!==_H(t)&&"function"!=typeof t?NH(e):t}function NH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jH(e){return(jH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var LH,BH=new WeakMap,VH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IH(e,t)}(l,e);var t,n,o,r=HH(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=r.call(this,e,t),BH.set(NH(n),{row_above:function(e,t){var o=t[t.length-1];n.dataManager.addSibling(o.start.row,"above")},row_below:function(e,t){var o=t[t.length-1];n.dataManager.addSibling(o.start.row,"below")}}),n.dataManager=n.plugin.dataManager,n}return t=l,(n=[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(mf)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(bf)},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),n=t.dataManager.translateTrimmedRow(e[0]);return!t.dataManager.getRowParent(n)||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return ur(0,e.items.length-1,(function(i){if(0===i)return X(n,(function(t,n){e.items.splice(i+n,0,t)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=BH.get(this);return ur(0,e.items.length-1,(function(i){var option=t[e.items[i].key];null!=option&&(e.items[i].callback=option)})),e}}])&&PH(t.prototype,n),o&&PH(t,o),l}(pH);function FH(e){return function(e){if(Array.isArray(e))return WH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return WH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WH(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WH(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function UH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var zH=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}var t,n,o;return t=e,(n=[{key:"onBeforeRowMove",value:function(e,t,n,o){var r=this;if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:o}))return!1;this.movedToCollapsed=!1;var l=n===this.hot.countRows(),c=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),h=!0,f=e.map((function(e){if(!h)return!1;var t=r.dataManager.translateTrimmedRow(e);return h=r.shouldAllowMoving(t,c),t})),d=-1===f.indexOf(c);if(!h||!d)return!1;var y=this.getBaseParent(f),v=this.getTargetParent(l,c),m=y===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,c,m),this.moveRows(f,c,v),this.dataManager.updateWithData(this.dataManager.getRawSourceData()),this.moveCellsMeta(f,c),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,n=e.finalIndex,o=e.dropIndex,r=e.movePossible,l=!1;return at(o)&&(to(et(LH||(LH=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,o,r,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,n){n||(Math.max.apply(Math,FH(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,n){var o=this,r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){e.forEach((function(e){o.dataManager.moveRow(e,t,o.movedToCollapsed,r)}))}))}},{key:"moveCellsMeta",value:function(e,t){var n,o=this,r=[],l=Math.max.apply(Math,FH(e))<t;e.forEach((function(e){r.push(o.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(n=this.hot).spliceCellsMeta.apply(n,[t-(l?r.length:0),0].concat(r))}},{key:"selectCells",value:function(e,t){var n,o=e.length,r=0,l=0,c=null;if(this.movedToCollapsed){var h=null;h=e[o-1]<t?this.dataManager.translateTrimmedRow(t-o):this.dataManager.translateTrimmedRow(t);var f=this.dataManager.getRowParent(null===h?this.hot.countSourceRows()-1:h-1),d=this.dataManager.getRowIndex(f);l=r=this.dataManager.untranslateTrimmedRow(d)}else e[o-1]<t?r=(l=t-1)-o+1:l=(r=t)+o-1;c=this.hot.selection,n=this.hot.countCols()-1,c.setRangeStart(new Wn(r,0)),c.setRangeEnd(new Wn(l,n),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}}])&&UH(t.prototype,n),o&&UH(t,o),e}();function YH(e){return(YH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GH(e){return function(e){if(Array.isArray(e))return KH(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return KH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KH(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KH(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function $H(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XH(e,t,n){return(XH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=eD(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function qH(e,p){return(qH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ZH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=eD(e);if(t){var r=eD(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return QH(this,n)}}function QH(e,t){return!t||"object"!==YH(t)&&"function"!=typeof t?JH(e):t}function JH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eD(e){return(eD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tD="nestedRows",nD=new WeakMap,oD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qH(e,t)}(l,e);var t,n,o,r=ZH(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).dataManager=null,t.headersUI=null,t.collapsedRowsMap=null,nD.set(JH(t),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return tD}},{key:"PLUGIN_PRIORITY",get:function(){return 300}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new $c),this.dataManager=new dH(this,this.hot),this.collapsingUI=new xH(this,this.hot),this.headersUI=new CH(this,this.hot),this.contextMenuUI=new VH(this,this.hot),this.rowMoveController=new zH(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeRender",(function(){return e.onBeforeRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("beforeDataFilter",(function(){return e.onBeforeDataFilter.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(data){return e.onBeforeLoadData(data)})),XH(eD(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),XH(eD(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.hot.getSourceData();this.enablePlugin(),this.dataManager.updateWithData(e),XH(eD(l.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,n,o){return this.rowMoveController.onBeforeRowMove(e,t,n,o)}},{key:"disableCoreAPIModifiers",value:function(){nD.get(this).skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){nD.get(this).skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){if(!nD.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){if(!nD.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,element){return!(!nD.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,element),1))}},{key:"onBeforeDataFilter",value:function(e,t,n){var o=nD.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),o.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,source){var o=this;if(source!==this.pluginName){var r=nD.get(this);setTimeout((function(){r.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,n){var o=this,r=Array.from(n.reduce((function(e,t){if(o.dataManager.isParent(t)){var n=o.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((function(t){return e.add(o.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));n.length=0,n.push.apply(n,GH(r))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,element){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(element)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,element){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(element),null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(e,t,source){source!==this.pluginName&&this.dataManager.updateWithData(this.dataManager.getRawSourceData())}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,GH(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeRender",value:function(e,t){nD.get(this).skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){XH(eD(l.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(data){if(!Lu(data))return no("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),void this.disablePlugin();this.dataManager.setData(data),this.dataManager.rewriteCache()}}])&&$H(t.prototype,n),o&&$H(t,o),l}(mm);function rD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var aD=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;rD(this,e),this.rootWindow=n,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}var t,n,o;return t=e,(n=[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var n=void 0===e?t:e,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===o?void 0:JSON.parse(o)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;X(this.savedKeys,(function(t,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}])&&iD(t.prototype,n),o&&iD(t,o),e}();function lD(e){return(lD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uD(e,t,n){return(uD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=dD(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function cD(e,p){return(cD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function hD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=dD(e);if(t){var r=dD(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return fD(this,n)}}function fD(e,t){return!t||"object"!==lD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dD(e){return(dD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}fo.getSingleton().register("persistentStateSave"),fo.getSingleton().register("persistentStateLoad"),fo.getSingleton().register("persistentStateReset");var pD="persistentState",yD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cD(e,t)}(l,e);var t,n,o,r=hD(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).storage=void 0,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return pD}},{key:"PLUGIN_PRIORITY",get:function(){return 0}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new aD(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,n){return e.saveValue(t,n)})),this.addHook("persistentStateLoad",(function(t,n){return e.loadValue(t,n)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),uD(dD(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,uD(dD(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),uD(dD(l.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){uD(dD(l.prototype),"destroy",this).call(this)}}])&&sD(t.prototype,n),o&&sD(t,o),l}(mm);function gD(e){return(gD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vD(e){return function(e){if(Array.isArray(e))return mD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return mD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mD(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function bD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wD(e,t,n){return(wD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=RD(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function CD(e,p){return(CD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function SD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=RD(e);if(t){var r=RD(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return kD(this,n)}}function kD(e,t){return!t||"object"!==gD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RD(e){return(RD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var OD="search",ED=function(e,t,col,data,n){e.getCellMeta(t,col).isSearchResult=n},TD=function(e,t){return!(at(e)||null===e||!e.toLowerCase||0===e.length)&&(!at(t)&&null!==t&&-1!==t.toString().toLowerCase().indexOf(e.toLowerCase()))},AD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CD(e,t)}(l,e);var t,n,o,r=SD(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).callback=ED,t.queryMethod=TD,t.searchResultClass="htSearchResult",t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return OD}},{key:"PLUGIN_PRIORITY",get:function(){return 190}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().search;this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),wD(RD(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterRender",(function(){e.hot.removeHook("beforeRenderer",t)})),wD(RD(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wD(RD(l.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),r=this.hot.countRows(),l=this.hot.countCols(),c=[],h=this.hot;return ur(0,r-1,(function(r){ur(0,l-1,(function(l){var f=t.hot.getDataAtCell(r,l),d=t.hot.getCellMeta(r,l),y=d.search.callback||n,v=(d.search.queryMethod||o)(e,f,d);if(v){var m={row:r,col:l,data:f};c.push(m)}y&&y(h,r,l,f,v)}))})),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){ve(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,col,n,o,r){var l,c=r.className||[],h=[];"string"==typeof c?h=c.split(" "):(l=h).push.apply(l,vD(c)),this.isEnabled()&&r.isSearchResult?h.includes(this.searchResultClass)||h.push("".concat(this.searchResultClass)):h.includes(this.searchResultClass)&&h.splice(h.indexOf(this.searchResultClass),1),r.className=h.join(" ")}},{key:"destroy",value:function(){wD(RD(l.prototype),"destroy",this).call(this)}}])&&bD(t.prototype,n),o&&bD(t,o),l}(mm);function MD(e){return(MD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _D(e,t,n){return(_D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=DD(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function PD(e,p){return(PD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function ID(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=DD(e);if(t){var r=DD(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return HD(this,n)}}function HD(e,t){return!t||"object"!==MD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DD(e){return(DD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ND=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PD(e,t)}(l,e);var t,n,o,r=ID(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).scrollbars=[],t.clones=[],t.lockedCollection=!1,t.freezeOverlays=!1,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return"touchScroll"}},{key:"PLUGIN_PRIORITY",get:function(){return 200}}],(n=[{key:"isEnabled",value:function(){return B()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterRender",(function(){return e.onAfterRender()})),this.registerEvents(),_D(DD(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,_D(DD(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_D(DD(l.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,o=e.leftOverlay,r=e.topLeftCornerOverlay,l=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(o),r&&this.scrollbars.push(r),l&&l.clone&&this.scrollbars.push(l),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,X(this.clones,(function(e){Yt(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,X(this.clones,(function(e){Gt(e,"hide-tween"),Yt(e,"show-tween")})),setTimeout((function(){X(e.clones,(function(e){Gt(e,"show-tween")}))}),400),X(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}])&&xD(t.prototype,n),o&&xD(t,o),l}(mm);function jD(e){return(jD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BD(e,t,n){return(BD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=UD(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function VD(e,p){return(VD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function FD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=UD(e);if(t){var r=UD(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return WD(this,n)}}function WD(e,t){return!t||"object"!==jD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UD(e){return(UD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zD="trimRows",YD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VD(e,t)}(l,e);var t,n,o,r=FD(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=r.call(this,e)).trimmedRowsMap=null,t}return t=l,o=[{key:"PLUGIN_KEY",get:function(){return zD}},{key:"PLUGIN_PRIORITY",get:function(){return 330}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new $c),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),BD(UD(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){e.trimmedRowsMap.clear(),X(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),BD(UD(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),BD(UD(l.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,n=this.getTrimmedRows(),o=this.isValidConfig(e),r=n;o&&(r=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",n,r,o)&&(o&&this.hot.batchExecution((function(){X(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,r,o,o&&r.length>n.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e),o=t,r=this.trimmedRowsMap.getValues().slice(),l=e.length>0;n&&l&&(X(e,(function(e){r[e]=!1})),o=G(r,(function(e,t,n){return t&&e.push(n),e}),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,o,n&&l)&&(n&&l&&this.trimmedRowsMap.setValues(r),this.hot.runHooks("afterUntrimRow",t,o,n&&l,n&&o.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){X(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"destroy",value:function(){BD(UD(l.prototype),"destroy",this).call(this)}}])&&LD(t.prototype,n),o&&LD(t,o),l}(mm);function GD(e){return(GD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $D(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XD(e,t,n){return t&&$D(e.prototype,t),n&&$D(e,n),e}function qD(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZD(e,t)}function ZD(e,p){return(ZD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function QD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=eN(e);if(t){var r=eN(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return JD(this,n)}}function JD(e,t){return!t||"object"!==GD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eN(e){return(eN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tN(e){return function(e){if(Array.isArray(e))return rN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||oN(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nN(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,r=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(r.push(n.value),!i||r.length!==i);l=!0);}catch(e){c=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw o}}return r}(e,i)||oN(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oN(e,t){if(e){if("string"==typeof e)return rN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rN(e,t):void 0}}function rN(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function iN(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,source){var o=this,r=n&&n.length;if(r&&n.find((function(e){var t=nN(e,4);return t[2]!==t[3]}))){t.done((function(){var t=n.reduce((function(e,t){return e.push(tN(t)),e}),[]);X(t,(function(t){t[1]=e.propToCol(t[1])}));var l=r>1?o.getSelected():[[t[0][0],t[0][1]]];return new iN.ChangeAction(t,l)}),source)}})),e.addHook("afterCreateRow",(function(e,n,source){t.done((function(){return new iN.CreateRowAction(e,n)}),source)})),e.addHook("beforeRemoveRow",(function(n,o,r,source){t.done((function(){var r=t.instance.getSourceDataArray(),l=(r.length+n)%r.length,c=e.toPhysicalRow(l),h=de(r.slice(c,c+o));return new iN.RemoveRowAction(l,h,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)}),source)})),e.addHook("afterCreateCol",(function(e,n,source){t.done((function(){return new iN.CreateColumnAction(e,n)}),source)})),e.addHook("beforeRemoveCol",(function(n,o,r,source){t.done((function(){var r=t.instance.getSourceDataArray(),l=(t.instance.countCols()+n)%t.instance.countCols(),c=[],h=[],f=[];ur(r.length-1,(function(i){var t=[],n=r[i];ur(l,l+(o-1),(function(o){t.push(n[e.toPhysicalColumn(o)])})),c.push(t)})),ur(o-1,(function(i){f.push(e.toPhysicalColumn(l+i))})),Array.isArray(e.getSettings().colHeaders)&&ur(o-1,(function(i){h.push(e.getSettings().colHeaders[e.toPhysicalColumn(l+i)]||null)}));var d=e.columnIndexMapper.getIndexesSequence(),y=e.rowIndexMapper.getIndexesSequence();return new iN.RemoveColumnAction(l,f,c,h,d,y,e.getSettings().fixedColumnsLeft)}),source)})),e.addHook("beforeCellAlignment",(function(e,n,o,r){t.done((function(){return new iN.CellAlignmentAction(e,n,o,r)}))})),e.addHook("beforeFilter",(function(e){t.done((function(){return new iN.FiltersAction(e)}))})),e.addHook("beforeRowMove",(function(e,n){!1!==e&&t.done((function(){return new iN.RowMoveAction(e,n)}))})),e.addHook("beforeMergeCells",(function(n,o){o||t.done((function(){return new iN.MergeCellsAction(e,n)}))})),e.addHook("afterUnmergeCells",(function(n,o){o||t.done((function(){return new iN.UnmergeCellsAction(e,n)}))})),e.addHook("afterInit",(function(){t.init()}))}iN.prototype.done=function(e,source){if(!this.ignoreNewActions&&!("UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source)){var t=this.doneActions.slice();if(!1!==this.instance.runHooks("beforeUndoStackChange",t,source)){var n=e(),o=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}},iN.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var n=de(t);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;var o=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),t.undo(this.instance,(function(){o.ignoreNewActions=!1,o.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},iN.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var n=de(t);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;var o=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),t.redo(this.instance,(function(){o.ignoreNewActions=!1,o.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},iN.prototype.isUndoAvailable=function(){return this.doneActions.length>0},iN.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},iN.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},iN.prototype.isEnabled=function(){return this.enabled},iN.prototype.enable=function(){if(!this.isEnabled()){var e,t=this.instance;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},t.addHook("beforeKeyDown",sN),t.addHook("afterChange",uN)}},iN.prototype.disable=function(){if(this.isEnabled()){var e,t=this.instance;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,t.removeHook("beforeKeyDown",sN),t.removeHook("afterChange",uN)}},iN.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},iN.Action=function(){},iN.Action.prototype.undo=function(){},iN.Action.prototype.redo=function(){},iN.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},ce(iN.ChangeAction,iN.Action),iN.ChangeAction.prototype.undo=function(e,t){for(var data=de(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,r=data.length;i<r;i++)data[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(data,null,null,"UndoRedo.undo");for(var l=0,c=data.length;l<c;l++){var h=nN(data[l],2),f=h[0],d=h[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&d+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(d+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},iN.ChangeAction.prototype.redo=function(e,t){for(var data=de(this.changes),i=0,n=data.length;i<n;i++)data[i].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(data,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},iN.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},ce(iN.CreateRowAction,iN.Action),iN.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),o=e.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},iN.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},iN.RemoveRowAction=function(e,data,t,n){this.index=e,this.data=data,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=n},ce(iN.RemoveRowAction,iN.Action),iN.RemoveRowAction.prototype.undo=function(e,t){var n=e.getSettings();n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},iN.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},iN.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},ce(iN.CreateColumnAction,iN.Action),iN.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},iN.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},iN.RemoveColumnAction=function(e,t,data,n,o,r,l){this.index=e,this.indexes=t,this.data=data,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsLeft=l},ce(iN.RemoveColumnAction,iN.Action),iN.RemoveColumnAction.prototype.undo=function(e,t){var n=this;e.getSettings().fixedColumnsLeft=this.fixedColumnsLeft;for(var o=this.indexes.slice(0).sort(),r=function(e,t,r){return r[n.indexes.indexOf(o[t])]},l=this.data.length,c=[],h=0;h<l;h++)c.push($(this.data[h],r));var f=$(this.headers,r),d=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),X(e.getSourceDataArray(),(function(e,t){X(o,(function(n,o){e[n]=c[t][o],d.push([t,n,e[n]])}))})),e.setSourceDataAtCell(d),e.columnIndexMapper.insertIndexes(o[0],o.length),void 0!==this.headers&&X(f,(function(t,n){e.getSettings().colHeaders[o[n]]=t})),e.batchExecution((function(){e.rowIndexMapper.setIndexesSequence(n.rowPositions),e.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),e.addHookOnce("afterRender",t),e.render()},iN.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},iN.CellAlignmentAction=function(e,t,n,o){this.stateBefore=e,this.range=t,this.type=n,this.alignment=o},iN.CellAlignmentAction.prototype.undo=function(e,t){var n=this;X(this.range,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&e.setCellMeta(t,col,"className",n.stateBefore[t][col]||" htLeft")}))})),e.addHookOnce("afterRender",t),e.render()},iN.CellAlignmentAction.prototype.redo=function(e,t){xC(this.range,this.type,this.alignment,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,o){return e.setCellMeta(t,col,n,o)})),e.addHookOnce("afterRender",t),e.render()},iN.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},ce(iN.FiltersAction,iN.Action),iN.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},iN.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var aN=function(e){qD(n,e);var t=QD(n);function n(e,o){var r;KD(this,n),(r=t.call(this)).cellRange=o;var l=r.cellRange.getTopLeftCorner(),c=r.cellRange.getBottomRightCorner();return r.rangeData=e.getData(l.row,l.col,c.row,c.col),r}return XD(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),n.unmergeRange(this.cellRange,!0);var o=this.cellRange.getTopLeftCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),n.mergeRange(this.cellRange)}}]),n}(iN.Action);iN.MergeCellsAction=aN;var lN=function(e){qD(n,e);var t=QD(n);function n(e,o){var r;return KD(this,n),(r=t.call(this)).cellRange=o,r}return XD(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}]),n}(iN.Action);function sN(e){if(!Zn(e)){var t=this,n=t.getActiveEditor();if(!n||!n.isOpened()){var o=e.altKey,r=e.ctrlKey,l=e.keyCode,c=e.metaKey,h=e.shiftKey;if((r||c)&&!o)89===l||h&&90===l?(t.undoRedo.redo(),qn(e)):90===l&&(t.undoRedo.undo(),qn(e))}}}function uN(e,source){if("loadData"===source)return this.undoRedo.clear()}iN.UnmergeCellsAction=lN,iN.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t},ce(iN.RowMoveAction,iN.Action),iN.RowMoveAction.prototype.undo=function(e,t){var n=this,o=e.getPlugin("manualRowMove"),r=[].concat(this.rows),l=r.filter((function(a){return a>n.finalIndex})),c=r.filter((function(a){return a<=n.finalIndex})),h=l.sort((function(a,b){return b-a})).concat(c.sort((function(a,b){return a-b})));e.addHookOnce("afterRender",t);for(var i=0;i<h.length;i+=1){var f=e.toVisualRow(h[i]);o.moveRow(f,h[i])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},iN.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},iN.prototype.init=function(){var e=this.instance.getSettings().undo,t=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};var cN=fo.getSingleton();cN.add("afterUpdateSettings",(function(){this.getPlugin("undoRedo").init()})),cN.register("beforeUndo"),cN.register("afterUndo"),cN.register("beforeRedo"),cN.register("afterRedo"),iN.PLUGIN_KEY="undoRedo";var hN=iN;To(Yo),To(jg),To(Yg),To(tv),To(cv),To(Tg),To(mv),To(Tv),To(jv),To(sg),$r(ug),$r(Bv),$r(Yv),$r(Lv),$r($v),$r(Xv),$r(cg),ti(qv),ti(Qv),ti(Jv),ti(nm),Ru(om),Ru(rm),Ru(im),Ru(am),Ru(lm),Ru(sm),Ru(um),Ru(cm),Ru(hg),function(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var output,n=this.first(),o=n.data("handsontable");if("string"!=typeof t){var r=t||{};return o?o.updateSettings(r):(o=new e.Core(n[0],r),n.data("handsontable",o),o.init()),n}if(o){if(void 0===o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var l,c=arguments.length,h=new Array(c>1?c-1:0),f=1;f<c;f++)h[f-1]=arguments[f];output=(l=o[t]).call.apply(l,[o].concat(h)),"destroy"===t&&n.removeData()}return output})}(dg),Fr(Im),Fr(Km),Fr(rb),Fr(Bb),Fr(rw),Fr(uC),Fr(CC),Fr(eS),Fr(US),Fr(dk),Fr(Pk),Fr(Wk),Fr(Jk),Fr(MR),Fr(tA),Fr(LA),Fr(rM),Fr(RM),Fr(BM),Fr(Cx),Fr(Ix),Fr(y_),Fr(__),Fr(sP),Fr(kP),Fr(_P),Fr(sH),Fr(oD),Fr(yD),Fr(AD),Fr(ND),Fr(YD),Fr(hN),dg.__GhostTable=vg,dg._getListenersCounter=function(){return xo},dg._getRegisteredMapsCounter=function(){return Zc},dg.DefaultSettings=by(),dg.EventManager=Po,dg.hooks=fo.getSingleton();var fN=[r,c,S,R,o,y,h,C,l,f,v,w],dN=[d,m];dg.helper={},dg.dom={},X(fN,(function(e){X(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(dg.helper[t]=e[t])}))})),X(dN,(function(e){X(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(dg.dom[t]=e[t])}))})),dg.cellTypes={},X(Su(),(function(e){dg.cellTypes[e]=ku(e)})),dg.cellTypes.registerCellType=Ru,dg.cellTypes.getCellType=ku,dg.editors={},X(ko(),(function(e){dg.editors["".concat(kt(e),"Editor")]=Eo(e)})),dg.editors.registerEditor=To,dg.editors.getEditor=Eo,dg.renderers={},X(Gr(),(function(e){var t=Kr(e);"base"===e&&(dg.renderers.cellDecorator=t),dg.renderers["".concat(kt(e),"Renderer")]=t})),dg.renderers.registerRenderer=$r,dg.renderers.getRenderer=Kr,dg.validators={},X(Jr(),(function(e){dg.validators["".concat(kt(e),"Validator")]=ei(e)})),dg.validators.registerValidator=ti,dg.validators.getValidator=ei,dg.plugins={},X(Br(),(function(e){dg.plugins[e]=Vr(e)})),dg.plugins["".concat(kt(mm.PLUGIN_KEY),"Plugin")]=mm,dg.plugins.registerPlugin=Fr,dg.plugins.getPlugin=Vr;t.a=dg},660:function(e,t,n){e.exports=function(){"use strict";function e(e){if(Array.isArray(e)){for(var i=0,t=Array(e.length);i<e.length;i++)t[i]=e[i];return t}return Array.from(e)}var t=Object.hasOwnProperty,n=Object.setPrototypeOf,o=Object.isFrozen,r=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,c=Object.freeze,h=Object.seal,f=Object.create,d="undefined"!=typeof Reflect&&Reflect,y=d.apply,v=d.construct;y||(y=function(e,t,n){return e.apply(t,n)}),c||(c=function(e){return e}),h||(h=function(e){return e}),v||(v=function(t,n){return new(Function.prototype.bind.apply(t,[null].concat(e(n))))});var m=M(Array.prototype.forEach),w=M(Array.prototype.pop),C=M(Array.prototype.push),S=M(String.prototype.toLowerCase),k=M(String.prototype.match),R=M(String.prototype.replace),O=M(String.prototype.indexOf),E=M(String.prototype.trim),T=M(RegExp.prototype.test),A=x(TypeError);function M(e){return function(t){for(var n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return y(e,t,o)}}function x(e){return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return v(e,n)}}function _(e,t){n&&n(e,null);for(var r=t.length;r--;){var element=t[r];if("string"==typeof element){var l=S(element);l!==element&&(o(t)||(t[r]=l),element=l)}e[element]=!0}return e}function P(object){var e=f(null),n=void 0;for(n in object)y(t,object,[n])&&(e[n]=object[n]);return e}function I(object,e){for(;null!==object;){var desc=l(object,e);if(desc){if(desc.get)return M(desc.get);if("function"==typeof desc.value)return M(desc.value)}object=r(object)}function t(element){return console.warn("fallback value for",element),null}return t}var html=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),H=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=c(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),j=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=c(["#text"]),L=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),F=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W=h(/\{\{[\s\S]*|[\s\S]*\}\}/gm),U=h(/<%[\s\S]*|[\s\S]*%>/gm),z=h(/^data-[\-\w.\u00B7-\uFFFF]/),Y=h(/^aria-[\-\w]+$/),G=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=h(/^(?:\w+script|data):/i),$=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Z(e){if(Array.isArray(e)){for(var i=0,t=Array(e.length);i<e.length;i++)t[i]=e[i];return t}return Array.from(e)}var Q=function(){return"undefined"==typeof window?null:window},J=function(e,t){if("object"!==(void 0===e?"undefined":X(e))||"function"!=typeof e.createPolicy)return null;var n=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(n=t.currentScript.getAttribute(o));var r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q(),t=function(e){return ee(e)};if(t.version="2.3.1",t.removed=[],!e||!e.document||9!==e.document.nodeType)return t.isSupported=!1,t;var n=e.document,o=e.document,r=e.DocumentFragment,l=e.HTMLTemplateElement,h=e.Node,f=e.Element,d=e.NodeFilter,y=e.NamedNodeMap,v=void 0===y?e.NamedNodeMap||e.MozNamedAttrMap:y,M=e.Text,x=e.Comment,te=e.DOMParser,ne=e.trustedTypes,oe=f.prototype,re=I(oe,"cloneNode"),ie=I(oe,"nextSibling"),ae=I(oe,"childNodes"),le=I(oe,"parentNode");if("function"==typeof l){var template=o.createElement("template");template.content&&template.content.ownerDocument&&(o=template.content.ownerDocument)}var se=J(ne,n),ue=se&&Fe?se.createHTML(""):"",ce=o,he=ce.implementation,fe=ce.createNodeIterator,de=ce.createDocumentFragment,pe=ce.getElementsByTagName,ye=n.importNode,ge={};try{ge=P(o).documentMode?o.documentMode:{}}catch(e){}var ve={};t.isSupported="function"==typeof le&&he&&void 0!==he.createHTMLDocument&&9!==ge;var me=W,be=U,we=z,Ce=Y,Se=K,ke=$,Re=G,Oe=null,Ee=_({},[].concat(Z(html),Z(svg),Z(H),Z(N),Z(text))),Te=null,Ae=_({},[].concat(Z(L),Z(B),Z(V),Z(F))),Me=null,xe=null,_e=!0,Pe=!0,Ie=!1,He=!1,De=!1,Ne=!1,je=!1,Le=!1,Be=!1,Ve=!0,Fe=!1,We=!0,Ue=!0,ze=!1,Ye={},Ge=null,Ke=_({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),$e=null,Xe=_({},["audio","video","img","source","image","track"]),qe=null,Ze=_({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Qe="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",et="http://www.w3.org/1999/xhtml",tt=et,nt=!1,ot=null,it=o.createElement("form"),at=function(e){ot&&ot===e||(e&&"object"===(void 0===e?"undefined":X(e))||(e={}),e=P(e),Oe="ALLOWED_TAGS"in e?_({},e.ALLOWED_TAGS):Ee,Te="ALLOWED_ATTR"in e?_({},e.ALLOWED_ATTR):Ae,qe="ADD_URI_SAFE_ATTR"in e?_(P(Ze),e.ADD_URI_SAFE_ATTR):Ze,$e="ADD_DATA_URI_TAGS"in e?_(P(Xe),e.ADD_DATA_URI_TAGS):Xe,Ge="FORBID_CONTENTS"in e?_({},e.FORBID_CONTENTS):Ke,Me="FORBID_TAGS"in e?_({},e.FORBID_TAGS):{},xe="FORBID_ATTR"in e?_({},e.FORBID_ATTR):{},Ye="USE_PROFILES"in e&&e.USE_PROFILES,_e=!1!==e.ALLOW_ARIA_ATTR,Pe=!1!==e.ALLOW_DATA_ATTR,Ie=e.ALLOW_UNKNOWN_PROTOCOLS||!1,He=e.SAFE_FOR_TEMPLATES||!1,De=e.WHOLE_DOCUMENT||!1,Le=e.RETURN_DOM||!1,Be=e.RETURN_DOM_FRAGMENT||!1,Ve=!1!==e.RETURN_DOM_IMPORT,Fe=e.RETURN_TRUSTED_TYPE||!1,je=e.FORCE_BODY||!1,We=!1!==e.SANITIZE_DOM,Ue=!1!==e.KEEP_CONTENT,ze=e.IN_PLACE||!1,Re=e.ALLOWED_URI_REGEXP||Re,tt=e.NAMESPACE||et,He&&(Pe=!1),Be&&(Le=!0),Ye&&(Oe=_({},[].concat(Z(text))),Te=[],!0===Ye.html&&(_(Oe,html),_(Te,L)),!0===Ye.svg&&(_(Oe,svg),_(Te,B),_(Te,F)),!0===Ye.svgFilters&&(_(Oe,H),_(Te,B),_(Te,F)),!0===Ye.mathMl&&(_(Oe,N),_(Te,V),_(Te,F))),e.ADD_TAGS&&(Oe===Ee&&(Oe=P(Oe)),_(Oe,e.ADD_TAGS)),e.ADD_ATTR&&(Te===Ae&&(Te=P(Te)),_(Te,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&_(qe,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(Ge===Ke&&(Ge=P(Ge)),_(Ge,e.FORBID_CONTENTS)),Ue&&(Oe["#text"]=!0),De&&_(Oe,["html","head","body"]),Oe.table&&(_(Oe,["tbody"]),delete Me.tbody),c&&c(e),ot=e)},lt=_({},["mi","mo","mn","ms","mtext"]),st=_({},["foreignobject","desc","title","annotation-xml"]),ut=_({},svg);_(ut,H),_(ut,D);var ct=_({},N);_(ct,j);var ht=function(element){var e=le(element);e&&e.tagName||(e={namespaceURI:et,tagName:"template"});var t=S(element.tagName),n=S(e.tagName);if(element.namespaceURI===Je)return e.namespaceURI===et?"svg"===t:e.namespaceURI===Qe?"svg"===t&&("annotation-xml"===n||lt[n]):Boolean(ut[t]);if(element.namespaceURI===Qe)return e.namespaceURI===et?"math"===t:e.namespaceURI===Je?"math"===t&&st[n]:Boolean(ct[t]);if(element.namespaceURI===et){if(e.namespaceURI===Je&&!st[n])return!1;if(e.namespaceURI===Qe&&!lt[n])return!1;var o=_({},["title","style","font","a","script"]);return!ct[t]&&(o[t]||!ut[t])}return!1},ft=function(e){C(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ue}catch(t){e.remove()}}},pt=function(e,n){try{C(t.removed,{attribute:n.getAttributeNode(e),from:n})}catch(e){C(t.removed,{attribute:null,from:n})}if(n.removeAttribute(e),"is"===e&&!Te[e])if(Le||Be)try{ft(n)}catch(e){}else try{n.setAttribute(e,"")}catch(e){}},yt=function(e){var t=void 0,n=void 0;if(je)e="<remove></remove>"+e;else{var r=k(e,/^[\r\n\t ]+/);n=r&&r[0]}var l=se?se.createHTML(e):e;if(tt===et)try{t=(new te).parseFromString(l,"text/html")}catch(e){}if(!t||!t.documentElement){t=he.createDocument(tt,"template",null);try{t.documentElement.innerHTML=nt?"":l}catch(e){}}var body=t.body||t.documentElement;return e&&n&&body.insertBefore(o.createTextNode(n),body.childNodes[0]||null),tt===et?pe.call(t,De?"html":"body")[0]:De?t.documentElement:body},gt=function(e){return fe.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},vt=function(e){return!(e instanceof M||e instanceof x||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof v&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore)},mt=function(object){return"object"===(void 0===h?"undefined":X(h))?object instanceof h:object&&"object"===(void 0===object?"undefined":X(object))&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},bt=function(e,n,data){ve[e]&&m(ve[e],(function(e){e.call(t,n,data,ot)}))},wt=function(e){var content=void 0;if(bt("beforeSanitizeElements",e,null),vt(e))return ft(e),!0;if(k(e.nodeName,/[\u0080-\uFFFF]/))return ft(e),!0;var n=S(e.nodeName);if(bt("uponSanitizeElement",e,{tagName:n,allowedTags:Oe}),!mt(e.firstElementChild)&&(!mt(e.content)||!mt(e.content.firstElementChild))&&T(/<[/\w]/g,e.innerHTML)&&T(/<[/\w]/g,e.textContent))return ft(e),!0;if("select"===n&&T(/<template/i,e.innerHTML))return ft(e),!0;if(!Oe[n]||Me[n]){if(Ue&&!Ge[n]){var o=le(e)||e.parentNode,r=ae(e)||e.childNodes;if(r&&o)for(var i=r.length-1;i>=0;--i)o.insertBefore(re(r[i],!0),ie(e))}return ft(e),!0}return e instanceof f&&!ht(e)?(ft(e),!0):"noscript"!==n&&"noembed"!==n||!T(/<\/no(script|embed)/i,e.innerHTML)?(He&&3===e.nodeType&&(content=e.textContent,content=R(content,me," "),content=R(content,be," "),e.textContent!==content&&(C(t.removed,{element:e.cloneNode()}),e.textContent=content)),bt("afterSanitizeElements",e,null),!1):(ft(e),!0)},Ct=function(e,t,n){if(We&&("id"===t||"name"===t)&&(n in o||n in it))return!1;if(Pe&&!xe[t]&&T(we,t));else if(_e&&T(Ce,t));else{if(!Te[t]||xe[t])return!1;if(qe[t]);else if(T(Re,R(n,ke,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==O(n,"data:")||!$e[e])if(Ie&&!T(Se,R(n,ke,"")));else if(n)return!1}return!0},St=function(e){var n=void 0,o=void 0,r=void 0,l=void 0;bt("beforeSanitizeAttributes",e,null);var c=e.attributes;if(c){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(l=c.length;l--;){var f=n=c[l],d=f.name,y=f.namespaceURI;if(o=E(n.value),r=S(d),h.attrName=r,h.attrValue=o,h.keepAttr=!0,h.forceKeepAttr=void 0,bt("uponSanitizeAttribute",e,h),o=h.attrValue,!h.forceKeepAttr&&(pt(d,e),h.keepAttr))if(T(/\/>/i,o))pt(d,e);else{He&&(o=R(o,me," "),o=R(o,be," "));var v=e.nodeName.toLowerCase();if(Ct(v,r,o))try{y?e.setAttributeNS(y,d,o):e.setAttribute(d,o),w(t.removed)}catch(e){}}}bt("afterSanitizeAttributes",e,null)}},kt=function e(t){var n=void 0,o=gt(t);for(bt("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)bt("uponSanitizeShadowNode",n,null),wt(n)||(n.content instanceof r&&e(n.content),St(n));bt("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(o,l){var body=void 0,c=void 0,f=void 0,d=void 0,y=void 0;if((nt=!o)&&(o="\x3c!--\x3e"),"string"!=typeof o&&!mt(o)){if("function"!=typeof o.toString)throw A("toString is not a function");if("string"!=typeof(o=o.toString()))throw A("dirty is not a string, aborting")}if(!t.isSupported){if("object"===X(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof o)return e.toStaticHTML(o);if(mt(o))return e.toStaticHTML(o.outerHTML)}return o}if(Ne||at(l),t.removed=[],"string"==typeof o&&(ze=!1),ze);else if(o instanceof h)1===(c=(body=yt("\x3c!----\x3e")).ownerDocument.importNode(o,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?body=c:body.appendChild(c);else{if(!Le&&!He&&!De&&-1===o.indexOf("<"))return se&&Fe?se.createHTML(o):o;if(!(body=yt(o)))return Le?null:ue}body&&je&&ft(body.firstChild);for(var v=gt(ze?o:body);f=v.nextNode();)3===f.nodeType&&f===d||wt(f)||(f.content instanceof r&&kt(f.content),St(f),d=f);if(d=null,ze)return o;if(Le){if(Be)for(y=de.call(body.ownerDocument);body.firstChild;)y.appendChild(body.firstChild);else y=body;return Ve&&(y=ye.call(n,y,!0)),y}var m=De?body.outerHTML:body.innerHTML;return He&&(m=R(m,me," "),m=R(m,be," ")),se&&Fe?se.createHTML(m):m},t.setConfig=function(e){at(e),Ne=!0},t.clearConfig=function(){ot=null,Ne=!1},t.isValidAttribute=function(e,t,n){ot||at({});var o=S(e),r=S(t);return Ct(o,r,n)},t.addHook=function(e,t){"function"==typeof t&&(ve[e]=ve[e]||[],C(ve[e],t))},t.removeHook=function(e){ve[e]&&w(ve[e])},t.removeHooks=function(e){ve[e]&&(ve[e]=[])},t.removeAllHooks=function(){ve={}},t}return ee()}()},662:function(e,t,n){!function(t,o){"use strict";var r;try{r=n(187)}catch(e){}e.exports=function(e){var t="function"==typeof e,n=!!window.addEventListener,o=window.document,r=window.setTimeout,l=function(e,t,o,r){n?e.addEventListener(t,o,!!r):e.attachEvent("on"+t,o)},c=function(e,t,o,r){n?e.removeEventListener(t,o,!!r):e.detachEvent("on"+t,o)},h=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},f=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},d=function(e,t){f(e,t)||(e.className=""===e.className?t:e.className+" "+t)},y=function(e,t){e.className=h((" "+e.className+" ").replace(" "+t+" "," "))},v=function(e){return/Array/.test(Object.prototype.toString.call(e))},m=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},w=function(e){var t=e.getDay();return 0===t||6===t},C=function(e){return e%4==0&&e%100!=0||e%400==0},S=function(e,t){return[31,C(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},k=function(e){m(e)&&e.setHours(0,0,0,0)},R=function(a,b){return a.getTime()===b.getTime()},O=function(e,t,n){var o,r;for(o in t)(r=void 0!==e[o])&&"object"==typeof t[o]&&null!==t[o]&&void 0===t[o].nodeName?m(t[o])?n&&(e[o]=new Date(t[o].getTime())):v(t[o])?n&&(e[o]=t[o].slice(0)):e[o]=O({},t[o],n):!n&&r||(e[o]=t[o]);return e},E=function(e,t,data){var n;o.createEvent?((n=o.createEvent("HTMLEvents")).initEvent(t,!0,!1),n=O(n,data),e.dispatchEvent(n)):o.createEventObject&&(n=o.createEventObject(),n=O(n,data),e.fireEvent("on"+t,n))},T=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},A={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},M=function(e,t,abbr){for(t+=e.firstDay;t>=7;)t-=7;return abbr?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},x=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},_=function(e,t,n){var o=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,t,e)-o)/864e5+o.getDay()+1)/7)+"</td>"},P=function(e,t,n,o){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},I=function(e){return"<tbody>"+e.join("")+"</tbody>"},H=function(e){var i,t=[];for(e.showWeekNumber&&t.push("<th></th>"),i=0;i<7;i++)t.push('<th scope="col"><abbr title="'+M(e,i)+'">'+M(e,i,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?t.reverse():t).join("")+"</tr></thead>"},D=function(e,t,n,o,r,l){var i,c,h,f,d,y=e._o,m=n===y.minYear,w=n===y.maxYear,html='<div id="'+l+'" class="pika-title" role="heading" aria-live="assertive">',C=!0,S=!0;for(h=[],i=0;i<12;i++)h.push('<option value="'+(n===r?i-t:12+i-t)+'"'+(i===o?' selected="selected"':"")+(m&&i<y.minMonth||w&&i>y.maxMonth?'disabled="disabled"':"")+">"+y.i18n.months[i]+"</option>");for(f='<div class="pika-label">'+y.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",v(y.yearRange)?(i=y.yearRange[0],c=y.yearRange[1]+1):(i=n-y.yearRange,c=1+n+y.yearRange),h=[];i<c&&i<=y.maxYear;i++)i>=y.minYear&&h.push('<option value="'+i+'"'+(i===n?' selected="selected"':"")+">"+i+"</option>");return d='<div class="pika-label">'+n+y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",y.showMonthAfterYear?html+=d+f:html+=f+d,m&&(0===o||y.minMonth>=o)&&(C=!1),w&&(11===o||y.maxMonth<=o)&&(S=!1),0===t&&(html+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+y.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(html+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+y.i18n.nextMonth+"</button>"),html+"</div>"},N=function(e,data,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+H(e)+I(data)+"</table>"},j=function(c){var h=this,d=h.config(c);h._onMouseDown=function(e){if(h._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(f(t,"is-disabled")||(!f(t,"pika-button")||f(t,"is-empty")||f(t.parentNode,"is-disabled")?f(t,"pika-prev")?h.prevMonth():f(t,"pika-next")&&h.nextMonth():(h.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),d.bound&&r((function(){h.hide(),d.blurFieldOnSelect&&d.field&&d.field.blur()}),100))),f(t,"pika-select"))h._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},h._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(f(t,"pika-select-month")?h.gotoMonth(t.value):f(t,"pika-select-year")&&h.gotoYear(t.value))},h._onKeyChange=function(e){if(e=e||window.event,h.isVisible())switch(e.keyCode){case 13:case 27:d.field&&d.field.blur();break;case 37:e.preventDefault(),h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7)}},h._onInputChange=function(n){var o;n.firedBy!==h&&(o=d.parse?d.parse(d.field.value,d.format):t?(o=e(d.field.value,d.format,d.formatStrict))&&o.isValid()?o.toDate():null:new Date(Date.parse(d.field.value)),m(o)&&h.setDate(o),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var e=o.activeElement;do{if(f(e,"pika-single"))return}while(e=e.parentNode);h._c||(h._b=r((function(){h.hide()}),50)),h._c=!1},h._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,o=t;if(t){!n&&f(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),l(t,"change",h._onChange)));do{if(f(o,"pika-single")||o===d.trigger)return}while(o=o.parentNode);h._v&&t!==d.trigger&&o!==d.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(d.isRTL?" is-rtl":"")+(d.theme?" "+d.theme:""),l(h.el,"mousedown",h._onMouseDown,!0),l(h.el,"touchend",h._onMouseDown,!0),l(h.el,"change",h._onChange),d.keyboardInput&&l(o,"keydown",h._onKeyChange),d.field&&(d.container?d.container.appendChild(h.el):d.bound?o.body.appendChild(h.el):d.field.parentNode.insertBefore(h.el,d.field.nextSibling),l(d.field,"change",h._onInputChange),d.defaultDate||(t&&d.field.value?d.defaultDate=e(d.field.value,d.format).toDate():d.defaultDate=new Date(Date.parse(d.field.value)),d.setDefaultDate=!0));var y=d.defaultDate;m(y)?d.setDefaultDate?h.setDate(y,!0):h.gotoDate(y):h.gotoDate(new Date),d.bound?(this.hide(),h.el.className+=" is-bound",l(d.trigger,"click",h._onInputClick),l(d.trigger,"focus",h._onInputFocus),l(d.trigger,"blur",h._onInputBlur)):this.show()};return j.prototype={config:function(e){this._o||(this._o=O({},A,!0));var t=O(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,m(t.minDate)||(t.minDate=!1),m(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),v(t.yearRange)){var o=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||o,t.yearRange[1]=parseInt(t.yearRange[1],10)||o}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||A.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,m(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,o){t&&e.isMoment(n)&&this.setDate(n.toDate(),o)},getDate:function(){return m(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),m(e)){var n=this._o.minDate,o=this._o.maxDate;m(n)&&e<n?e=n:m(o)&&e>o&&(e=o),this._d=new Date(e.getTime()),k(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(m(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=e.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),t=r<n.getTime()||o.getTime()<r}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,o=this.getDate()||new Date,r=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(o.valueOf()+r):"subtract"===e&&(n=new Date(o.valueOf()-r)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=T(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=T({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(k(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=A.minDate,this._o.minYear=A.minYear,this._o.minMonth=A.minMonth,this._o.startRange=A.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(k(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=A.maxDate,this._o.maxYear=A.maxYear,this._o.maxMonth=A.maxMonth,this._o.endRange=A.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,o=n.minYear,l=n.maxYear,c=n.minMonth,h=n.maxMonth,html="";this._y<=o&&(this._y=o,!isNaN(c)&&this._m<c&&(this._m=c)),this._y>=l&&(this._y=l,!isNaN(h)&&this._m>h&&(this._m=h)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var f=0;f<n.numberOfMonths;f++)html+='<div class="pika-lendar">'+D(this,f,this.calendars[f].year,this.calendars[f].month,this.calendars[0].year,t)+this.render(this.calendars[f].year,this.calendars[f].month,t)+"</div>";this.el.innerHTML=html,n.bound&&"hidden"!==n.field.type&&r((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,r,l,c,h,f,v,m,w,C;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,r=this.el.offsetHeight,l=window.innerWidth||o.documentElement.clientWidth,c=window.innerHeight||o.documentElement.clientHeight,h=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,w=!0,C=!0,"function"==typeof e.getBoundingClientRect)f=(m=e.getBoundingClientRect()).left+window.pageXOffset,v=m.bottom+window.pageYOffset;else for(f=t.offsetLeft,v=t.offsetTop+t.offsetHeight;t=t.offsetParent;)f+=t.offsetLeft,v+=t.offsetTop;(this._o.reposition&&f+n>l||this._o.position.indexOf("right")>-1&&f-n+e.offsetWidth>0)&&(f=f-n+e.offsetWidth,w=!1),(this._o.reposition&&v+r>c+h||this._o.position.indexOf("top")>-1&&v-r-e.offsetHeight>0)&&(v=v-r-e.offsetHeight,C=!1),this.el.style.left=f+"px",this.el.style.top=v+"px",d(this.el,w?"left-aligned":"right-aligned"),d(this.el,C?"bottom-aligned":"top-aligned"),y(this.el,w?"right-aligned":"left-aligned"),y(this.el,C?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var o=this._o,r=new Date,l=S(e,t),c=new Date(e,t,1).getDay(),data=[],h=[];k(r),o.firstDay>0&&(c-=o.firstDay)<0&&(c+=7);for(var f=0===t?11:t-1,d=11===t?0:t+1,y=0===t?e-1:e,v=11===t?e+1:e,C=S(y,f),O=l+c,E=O;E>7;)E-=7;O+=7-E;for(var T=!1,i=0,A=0;i<O;i++){var M=new Date(e,t,i-c+1),I=!!m(this._d)&&R(M,this._d),H=R(M,r),D=-1!==o.events.indexOf(M.toDateString()),j=i<c||i>=l+c,L=i-c+1,B=t,V=e,F=o.startRange&&R(o.startRange,M),W=o.endRange&&R(o.endRange,M),U=o.startRange&&o.endRange&&o.startRange<M&&M<o.endRange;j&&(i<c?(L=C+L,B=f,V=y):(L-=l,B=d,V=v));var z={day:L,month:B,year:V,hasEvent:D,isSelected:I,isToday:H,isDisabled:o.minDate&&M<o.minDate||o.maxDate&&M>o.maxDate||o.disableWeekends&&w(M)||o.disableDayFn&&o.disableDayFn(M),isEmpty:j,isStartRange:F,isEndRange:W,isInRange:U,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&I&&(T=!0),h.push(x(z)),7==++A&&(o.showWeekNumber&&h.unshift(_(i-c,t,e)),data.push(P(h,o.isRTL,o.pickWholeWeek,T)),h=[],A=0,T=!1)}return N(o,data,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),y(this.el,"is-hidden"),this._o.bound&&(l(o,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&c(o,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",d(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),c(this.el,"mousedown",this._onMouseDown,!0),c(this.el,"touchend",this._onMouseDown,!0),c(this.el,"change",this._onChange),e.keyboardInput&&c(o,"keydown",this._onKeyChange),e.field&&(c(e.field,"change",this._onInputChange),e.bound&&(c(e.trigger,"click",this._onInputClick),c(e.trigger,"focus",this._onInputFocus),c(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},j}(r)}()},663:function(e,t,n){e.exports=function a(e,u,t){function s(o,r){if(!u[o]){if(!e[o]){if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var i=u[o]={exports:{}};e[o][0].call(i.exports,(function(t){return s(e[o][1][t]||t)}),i,i.exports,a,e,u,t)}return u[o].exports}for(var n=!1,o=0;o<t.length;o++)s(t[o]);return s}({1:[function(e,t,n){!function(e){"use strict";var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,l=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,d=14,y=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function C(e){var t=0|e;return 0<e||e===t?t:t-1}function S(e){for(var t,n,o=1,i=e.length,a=e[0]+"";o<i;){for(t=e[o++]+"",n=d-t.length;n--;t="0"+t);a+=t}for(i=a.length;48===a.charCodeAt(--i););return a.slice(0,i+1||1)}function q(e,t){var n,o,i=e.c,a=t.c,r=e.s,u=t.s,l=e.e,s=t.e;if(!r||!u)return null;if(n=i&&!i[0],o=a&&!a[0],n||o)return n?o?0:-u:r;if(r!=u)return r;if(n=r<0,o=l==s,!i||!a)return o?0:!i^n?1:-1;if(!o)return s<l^n?1:-1;for(u=(l=i.length)<(s=a.length)?l:s,r=0;r<u;r++)if(i[r]!=a[r])return i[r]>a[r]^n?1:-1;return l==s?0:s<l^n?1:-1}function k(e,t,n,o){if(e<t||n<e||e!==(e<0?r(e):l(e)))throw Error(c+(o||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function R(e){var t=e.c.length-1;return C(e.e/d)==t&&e.c[t]%2!=0}function O(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function E(e,t,n){var o,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(o=e.length)){for(i=n,t-=o;--t;i+=n);e+=i}else t<o&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var n,T,p,A,s,M,u,x,_,g,P=U.prototype={constructor:U,toString:null,valueOf:null},I=new U(1),b=20,H=4,D=-7,N=21,j=-1e7,L=1e7,B=!1,a=1,V=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz";function U(e,t){var n,r,i,a,c,u,f,s,v=this;if(!(v instanceof U))return new U(e,t);if(null==t){if(e instanceof U)return v.s=e.s,v.e=e.e,void(v.c=(e=e.c)?e.slice():e);if((u="number"==typeof e)&&0*e==0){if(v.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,c=e;10<=c;c/=10,a++);return v.e=a,void(v.c=[e])}s=String(e)}else{if(s=String(e),!o.test(s))return p(v,s,u);v.s=45==s.charCodeAt(0)?(s=s.slice(1),-1):1}-1<(a=s.indexOf("."))&&(s=s.replace(".","")),0<(c=s.search(/e/i))?(a<0&&(a=c),a+=+s.slice(c+1),s=s.substring(0,c)):a<0&&(a=s.length)}else{if(k(t,2,W.length,"Base"),s=String(e),10==t)return G(v=new U(e instanceof U?e:s),b+v.e+1,H);if(u="number"==typeof e){if(0*e!=0)return p(v,s,u,t);if(v.s=1/e<0?(s=s.slice(1),-1):1,U.DEBUG&&15<s.replace(/^0\.0*|\./,"").length)throw Error(h+e);u=!1}else v.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1;for(n=W.slice(0,t),a=c=0,f=s.length;c<f;c++)if(n.indexOf(r=s.charAt(c))<0){if("."==r){if(a<c){a=f;continue}}else if(!i&&(s==s.toUpperCase()&&(s=s.toLowerCase())||s==s.toLowerCase()&&(s=s.toUpperCase()))){i=!0,c=-1,a=0;continue}return p(v,String(e),u,t)}-1<(a=(s=T(s,t,10,v.s)).indexOf("."))?s=s.replace(".",""):a=s.length}for(c=0;48===s.charCodeAt(c);c++);for(f=s.length;48===s.charCodeAt(--f););if(s=s.slice(c,++f)){if(f-=c,u&&U.DEBUG&&15<f&&(y<e||e!==l(e)))throw Error(h+v.s*e);if(L<(a=a-c-1))v.c=v.e=null;else if(a<j)v.c=[v.e=0];else{if(v.e=a,v.c=[],c=(a+1)%d,a<0&&(c+=d),c<f){for(c&&v.c.push(+s.slice(0,c)),f-=d;c<f;)v.c.push(+s.slice(c,c+=d));s=s.slice(c),c=d-s.length}else c-=f;for(;c--;s+="0");v.c.push(+s)}}else v.c=[v.e=0]}function i(e,t,n,o){var i,a,r,u,l;if(null==n?n=H:k(n,0,8),!e.c)return e.toString();if(i=e.c[0],r=e.e,null==t)l=S(e.c),l=1==o||2==o&&(r<=D||N<=r)?O(l,r):E(l,r,"0");else if(a=(e=G(new U(e),t,n)).e,u=(l=S(e.c)).length,1==o||2==o&&(t<=a||a<=D)){for(;u<t;l+="0",u++);l=O(l,a)}else if(t-=r,l=E(l,a,"0"),u<a+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=a-u))for(a+1==u&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function z(e,t){for(var n,o=1,i=new U(e[0]);o<e.length;o++){if(!(n=new U(e[o])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function Y(e,t,n){for(var o=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,o++);return(n=o+n*d-1)>L?e.c=e.e=null:e.c=n<j?[e.e=0]:(e.e=n,t),e}function G(e,t,n,o){var i,a,c,u,h,s,y,m=e.c,p=v;if(m){e:{for(i=1,u=m[0];10<=u;u/=10,i++);if((a=t-i)<0)a+=d,c=t,y=(h=m[s=0])/p[i-c-1]%10|0;else if((s=r((a+1)/d))>=m.length){if(!o)break e;for(;m.length<=s;m.push(0));h=y=0,c=(a%=d)-d+(i=1)}else{for(h=u=m[s],i=1;10<=u;u/=10,i++);y=(c=(a%=d)-d+i)<0?0:h/p[i-c-1]%10|0}if(o=o||t<0||null!=m[s+1]||(c<0?h:h%p[i-c-1]),o=n<4?(y||o)&&(0==n||n==(e.s<0?3:2)):5<y||5==y&&(4==n||o||6==n&&(0<a?0<c?h/p[i-c]:0:m[s-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,o?(t-=e.e+1,m[0]=p[(d-t%d)%d],e.e=-t||0):m[0]=e.e=0,e;if(0==a?(m.length=s,u=1,s--):(m.length=s+1,u=p[d-a],m[s]=0<c?l(h/p[i-c]%p[c])*u:0),o)for(;;){if(0==s){for(a=1,c=m[0];10<=c;c/=10,a++);for(c=m[0]+=u,u=1;10<=c;c/=10,u++);a!=u&&(e.e++,m[0]==f&&(m[0]=1));break}if(m[s]+=u,m[s]!=f)break;m[s--]=0,u=1}for(a=m.length;0===m[--a];m.pop());}e.e>L?e.c=e.e=null:e.e<j&&(e.c=[e.e=0])}return e}function K(e){var t,n=e.e;return null===n?e.toString():(t=S(e.c),t=n<=D||N<=n?O(t,n):E(t,n,"0"),e.s<0?"-"+t:t)}return U.clone=e,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(c+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(k(n=e[t],0,w,t),b=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(k(n=e[t],0,8,t),H=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(k(n[0],-w,0,t),k(n[1],0,w,t),D=n[0],N=n[1]):(k(n,-w,w,t),D=-(N=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)k(n[0],-w,-1,t),k(n[1],1,w,t),j=n[0],L=n[1];else{if(k(n,-w,w,t),!n)throw Error(c+t+" cannot be zero: "+n);j=-(L=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(c+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!n,Error(c+"crypto unavailable");B=n}else B=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(k(n=e[t],0,9,t),a=n),e.hasOwnProperty(t="POW_PRECISION")&&(k(n=e[t],0,w,t),V=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(c+t+" not an object: "+n);F=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(c+t+" invalid: "+n);W=n}}return{DECIMAL_PLACES:b,ROUNDING_MODE:H,EXPONENTIAL_AT:[D,N],RANGE:[j,L],CRYPTO:B,MODULO_MODE:a,POW_PRECISION:V,FORMAT:F,ALPHABET:W}},U.isBigNumber=function(e){return e instanceof U||e&&!0===e._isBigNumber||!1},U.maximum=U.max=function(){return z(arguments,P.lt)},U.minimum=U.min=function(){return z(arguments,P.gt)},U.random=(A=9007199254740992,s=Math.random()*A&2097151?function(){return l(Math.random()*A)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,o,i,a,h=0,u=[],f=new U(I);if(null==e?e=b:k(e,0,w),i=r(e/d),B)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));h<i;)9e15<=(a=131072*t[h]+(t[h+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[h]=n[0],t[h+1]=n[1]):(u.push(a%1e14),h+=2);h=i/2}else{if(!crypto.randomBytes)throw B=!1,Error(c+"crypto unavailable");for(t=crypto.randomBytes(i*=7);h<i;)9e15<=(a=281474976710656*(31&t[h])+1099511627776*t[h+1]+4294967296*t[h+2]+16777216*t[h+3]+(t[h+4]<<16)+(t[h+5]<<8)+t[h+6])?crypto.randomBytes(7).copy(t,h):(u.push(a%1e14),h+=7);h=i/7}if(!B)for(;h<i;)(a=s())<9e15&&(u[h++]=a%1e14);for(i=u[--h],e%=d,i&&e&&(a=v[d-e],u[h]=l(i/a)*a);0===u[h];u.pop(),h--);if(h<0)u=[o=0];else{for(o=-1;0===u[0];u.splice(0,1),o-=d);for(h=1,a=u[0];10<=a;a/=10,h++);h<d&&(o-=d-h)}return f.e=o,f.c=u,f}),U.sum=function(){for(var e=1,t=arguments,n=new U(t[0]);e<t.length;)n=n.plus(t[e++]);return n},T=function(){var e="0123456789";function t(e,t,n,o){for(var i,a,r=[0],u=0,l=e.length;u<l;){for(a=r.length;a--;r[a]*=t);for(r[0]+=o.indexOf(e.charAt(u++)),i=0;i<r.length;i++)r[i]>n-1&&(null==r[i+1]&&(r[i+1]=0),r[i+1]+=r[i]/n|0,r[i]%=n)}return r.reverse()}return function(o,r,l,c,i){var a,h,u,f,s,d,y,p,g=o.indexOf("."),v=b,m=H;for(0<=g&&(f=V,V=0,o=o.replace(".",""),d=(p=new U(r)).pow(o.length-g),V=f,p.c=t(E(S(d.c),d.e,"0"),10,l,e),p.e=p.c.length),u=f=(y=t(o,r,l,i?(a=W,e):(a=e,W))).length;0==y[--f];y.pop());if(!y[0])return a.charAt(0);if(g<0?--u:(d.c=y,d.e=u,d.s=c,y=(d=n(d,p,v,m,l)).c,s=d.r,u=d.e),g=y[h=u+v+1],f=l/2,s=s||h<0||null!=y[h+1],s=m<4?(null!=g||s)&&(0==m||m==(d.s<0?3:2)):f<g||g==f&&(4==m||s||6==m&&1&y[h-1]||m==(d.s<0?8:7)),h<1||!y[0])o=s?E(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(y.length=h,s)for(--l;++y[--h]>l;)y[h]=0,h||(++u,y=[1].concat(y));for(f=y.length;!y[--f];);for(g=0,o="";g<=f;o+=a.charAt(y[g++]));o=E(o,u,a.charAt(0))}return o}}(),n=function(){function e(e,t,n){var o,i,a,r,u=0,l=e.length,s=t%m,c=t/m|0;for(e=e.slice();l--;)u=((i=s*(a=e[l]%m)+(o=c*a+(r=e[l]/m|0)*s)%m*m+u)/n|0)+(o/m|0)+c*r,e[l]=i%n;return u&&(e=[u].concat(e)),e}function t(e,t,n,o){var i,a;if(n!=o)a=o<n?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n,o){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*o+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(o,r,c,h,i){var a,y,u,v,s,m,w,p,g,S,k,R,O,E,b,T,A,M=o.s==r.s?1:-1,x=o.c,_=r.c;if(!(x&&x[0]&&_&&_[0]))return new U(o.s&&r.s&&(x?!_||x[0]!=_[0]:_)?x&&0==x[0]||!_?0*M:M/0:NaN);for(g=(p=new U(M)).c=[],M=c+(y=o.e-r.e)+1,i||(i=f,y=C(o.e/d)-C(r.e/d),M=M/d|0),u=0;_[u]==(x[u]||0);u++);if(_[u]>(x[u]||0)&&y--,M<0)g.push(1),v=!0;else{for(E=x.length,T=_.length,M+=2,1<(s=l(i/(_[u=0]+1)))&&(_=e(_,s,i),x=e(x,s,i),T=_.length,E=x.length),O=T,k=(S=x.slice(0,T)).length;k<T;S[k++]=0);A=_.slice(),A=[0].concat(A),b=_[0],_[1]>=i/2&&b++;do{if(s=0,(a=t(_,S,T,k))<0){if(R=S[0],T!=k&&(R=R*i+(S[1]||0)),1<(s=l(R/b)))for(i<=s&&(s=i-1),w=(m=e(_,s,i)).length,k=S.length;1==t(m,S,w,k);)s--,n(m,T<w?A:_,w,i),w=m.length,a=1;else 0==s&&(a=s=1),w=(m=_.slice()).length;if(w<k&&(m=[0].concat(m)),n(S,m,k,i),k=S.length,-1==a)for(;t(_,S,T,k)<1;)s++,n(S,T<k?A:_,k,i),k=S.length}else 0===a&&(s++,S=[0]);g[u++]=s,S[0]?S[k++]=x[O]||0:(S=[x[O]],k=1)}while((O++<E||null!=S[0])&&M--);v=null!=S[0],g[0]||g.splice(0,1)}if(i==f){for(u=1,M=g[0];10<=M;M/=10,u++);G(p,c+(p.e=u+y*d-1)+1,h,v)}else p.e=y,p.r=+v;return p}}(),M=/^(-?)0([xbo])(?=\w[\w.]*$)/i,u=/^([^.]+)\.$/,x=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,p=function(e,t,n,o){var i,a=n?t:t.replace(g,"");if(_.test(a))e.s=isNaN(a)?null:a<0?-1:1,e.c=e.e=null;else{if(!n&&(a=a.replace(M,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,o&&o!=i?e:t})),o&&(i=o,a=a.replace(u,"$1").replace(x,"0.$1")),t!=a))return new U(a,i);if(U.DEBUG)throw Error(c+"Not a"+(o?" base "+o:"")+" number: "+t);e.c=e.e=e.s=null}},P.absoluteValue=P.abs=function(){var e=new U(this);return e.s<0&&(e.s=1),e},P.comparedTo=function(e,t){return q(this,new U(e,t))},P.decimalPlaces=P.dp=function(e,t){var n,o,i;if(null!=e)return k(e,0,w),null==t?t=H:k(t,0,8),G(new U(this),e+this.e+1,t);if(!(n=this.c))return null;if(o=((i=n.length-1)-C(this.e/d))*d,i=n[i])for(;i%10==0;i/=10,o--);return o<0&&(o=0),o},P.dividedBy=P.div=function(e,t){return n(this,new U(e,t),b,H)},P.dividedToIntegerBy=P.idiv=function(e,t){return n(this,new U(e,t),0,1)},P.exponentiatedBy=P.pow=function(e,t){var n,o,i,a,h,u,f,s,y=this;if((e=new U(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+K(e));if(null!=t&&(t=new U(t)),h=14<e.e,!y.c||!y.c[0]||1==y.c[0]&&!y.e&&1==y.c.length||!e.c||!e.c[0])return s=new U(Math.pow(+K(y),h?2-R(e):+K(e))),t?s.mod(t):s;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new U(NaN);(o=!u&&y.isInteger()&&t.isInteger())&&(y=y.mod(t))}else{if(9<e.e&&(0<y.e||y.e<-1||(0==y.e?1<y.c[0]||h&&24e7<=y.c[1]:y.c[0]<8e13||h&&y.c[0]<=9999975e7)))return a=y.s<0&&R(e)?-0:0,-1<y.e&&(a=1/a),new U(u?1/a:a);V&&(a=r(V/d+2))}for(f=h?(n=new U(.5),u&&(e.s=1),R(e)):(i=Math.abs(+K(e)))%2,s=new U(I);;){if(f){if(!(s=s.times(y)).c)break;a?s.c.length>a&&(s.c.length=a):o&&(s=s.mod(t))}if(i){if(0===(i=l(i/2)))break;f=i%2}else if(G(e=e.times(n),e.e+1,1),14<e.e)f=R(e);else{if(0==(i=+K(e)))break;f=i%2}y=y.times(y),a?y.c&&y.c.length>a&&(y.c.length=a):o&&(y=y.mod(t))}return o?s:(u&&(s=I.div(s)),t?s.mod(t):a?G(s,V,H,void 0):s)},P.integerValue=function(e){var t=new U(this);return null==e?e=H:k(e,0,8),G(t,t.e+1,e)},P.isEqualTo=P.eq=function(e,t){return 0===q(this,new U(e,t))},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(e,t){return 0<q(this,new U(e,t))},P.isGreaterThanOrEqualTo=P.gte=function(e,t){return 1===(t=q(this,new U(e,t)))||0===t},P.isInteger=function(){return!!this.c&&C(this.e/d)>this.c.length-2},P.isLessThan=P.lt=function(e,t){return q(this,new U(e,t))<0},P.isLessThanOrEqualTo=P.lte=function(e,t){return-1===(t=q(this,new U(e,t)))||0===t},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return 0<this.s},P.isZero=function(){return!!this.c&&0==this.c[0]},P.minus=function(e,t){var n,o,i,a,r=this,u=r.s;if(t=(e=new U(e,t)).s,!u||!t)return new U(NaN);if(u!=t)return e.s=-t,r.plus(e);var l=r.e/d,s=e.e/d,c=r.c,h=e.c;if(!l||!s){if(!c||!h)return c?(e.s=-t,e):new U(h?r:NaN);if(!c[0]||!h[0])return h[0]?(e.s=-t,e):new U(c[0]?r:3==H?-0:0)}if(l=C(l),s=C(s),c=c.slice(),u=l-s){for((i=(a=u<0)?(u=-u,c):(s=l,h)).reverse(),t=u;t--;i.push(0));i.reverse()}else for(o=(a=(u=c.length)<(t=h.length))?u:t,u=t=0;t<o;t++)if(c[t]!=h[t]){a=c[t]<h[t];break}if(a&&(i=c,c=h,h=i,e.s=-e.s),0<(t=(o=h.length)-(n=c.length)))for(;t--;c[n++]=0);for(t=f-1;u<o;){if(c[--o]<h[o]){for(n=o;n&&!c[--n];c[n]=t);--c[n],c[o]+=f}c[o]-=h[o]}for(;0==c[0];c.splice(0,1),--s);return c[0]?Y(e,c,s):(e.s=3==H?-1:1,e.c=[e.e=0],e)},P.modulo=P.mod=function(e,t){var o,r,i=this;return e=new U(e,t),!i.c||!e.s||e.c&&!e.c[0]?new U(NaN):!e.c||i.c&&!i.c[0]?new U(i):(9==a?(r=e.s,e.s=1,o=n(i,e,0,3),e.s=r,o.s*=r):o=n(i,e,0,a),(e=i.minus(o.times(e))).c[0]||1!=a||(e.s=i.s),e)},P.multipliedBy=P.times=function(e,t){var n,o,i,a,r,u,l,s,c,h,p,g,y,v,w,S=this,k=S.c,b=(e=new U(e,t)).c;if(!(k&&b&&k[0]&&b[0]))return!S.s||!e.s||k&&!k[0]&&!b||b&&!b[0]&&!k?e.c=e.e=e.s=null:(e.s*=S.s,k&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(o=C(S.e/d)+C(e.e/d),e.s*=S.s,(l=k.length)<(h=b.length)&&(y=k,k=b,b=y,i=l,l=h,h=i),i=l+h,y=[];i--;y.push(0));for(v=f,w=m,i=h;0<=--i;){for(n=0,p=b[i]%w,g=b[i]/w|0,a=i+(r=l);i<a;)n=((s=p*(s=k[--r]%w)+(u=g*s+(c=k[r]/w|0)*p)%w*w+y[a]+n)/v|0)+(u/w|0)+g*c,y[a--]=s%v;y[a]=n}return n?++o:y.splice(0,1),Y(e,y,o)},P.negated=function(){var e=new U(this);return e.s=-e.s||null,e},P.plus=function(e,t){var n,o=this,i=o.s;if(t=(e=new U(e,t)).s,!i||!t)return new U(NaN);if(i!=t)return e.s=-t,o.minus(e);var a=o.e/d,r=e.e/d,u=o.c,l=e.c;if(!a||!r){if(!u||!l)return new U(i/0);if(!u[0]||!l[0])return l[0]?e:new U(u[0]?o:0*i)}if(a=C(a),r=C(r),u=u.slice(),i=a-r){for((n=0<i?(r=a,l):(i=-i,u)).reverse();i--;n.push(0));n.reverse()}for((i=u.length)-(t=l.length)<0&&(n=l,l=u,u=n,t=i),i=0;t;)i=(u[--t]=u[t]+l[t]+i)/f|0,u[t]=f===u[t]?0:u[t]%f;return i&&(u=[i].concat(u),++r),Y(e,u,r)},P.precision=P.sd=function(e,t){var n,o,i;if(null!=e&&e!==!!e)return k(e,1,w),null==t?t=H:k(t,0,8),G(new U(this),e,t);if(!(n=this.c))return null;if(o=(i=n.length-1)*d+1,i=n[i]){for(;i%10==0;i/=10,o--);for(i=n[0];10<=i;i/=10,o++);}return e&&this.e+1>o&&(o=this.e+1),o},P.shiftedBy=function(e){return k(e,-y,y),this.times("1e"+e)},P.squareRoot=P.sqrt=function(){var e,t,o,r,i,a=this,l=a.c,u=a.s,c=a.e,s=b+4,h=new U("0.5");if(1!==u||!l||!l[0])return new U(!u||u<0&&(!l||l[0])?NaN:l?a:1/0);if((o=0==(u=Math.sqrt(+K(a)))||u==1/0?(((t=S(l)).length+c)%2==0&&(t+="0"),u=Math.sqrt(+t),c=C((c+1)/2)-(c<0||c%2),new U(t=u==1/0?"1e"+c:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+c)):new U(u+"")).c[0])for((u=(c=o.e)+s)<3&&(u=0);;)if(i=o,o=h.times(i.plus(n(a,i,s,1))),S(i.c).slice(0,u)===(t=S(o.c)).slice(0,u)){if(o.e<c&&--u,"9999"!=(t=t.slice(u-3,u+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(G(o,o.e+b+2,1),e=!o.times(o).eq(a));break}if(!r&&(G(i,i.e+b+2,0),i.times(i).eq(a))){o=i;break}s+=4,u+=4,r=1}return G(o,o.e+b+1,H,e)},P.toExponential=function(e,t){return null!=e&&(k(e,0,w),e++),i(this,e,t,1)},P.toFixed=function(e,t){return null!=e&&(k(e,0,w),e=e+this.e+1),i(this,e,t)},P.toFormat=function(e,t,n){var o;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=F;else if("object"!=typeof n)throw Error(c+"Argument not an object: "+n);if(o=this.toFixed(e,t),this.c){var i,a=o.split("."),r=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",s=a[0],h=a[1],f=this.s<0,p=f?s.slice(1):s,g=p.length;if(u&&(i=r,r=u,g-=u=i),0<r&&0<g){for(i=g%r||r,s=p.substr(0,i);i<g;i+=r)s+=l+p.substr(i,r);0<u&&(s+=l+p.slice(i)),f&&(s="-"+s)}o=h?s+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):s}return(n.prefix||"")+o+(n.suffix||"")},P.toFraction=function(e){var t,o,r,i,a,l,u,h,s,f,y,p,g=this,m=g.c;if(null!=e&&(!(u=new U(e)).isInteger()&&(u.c||1!==u.s)||u.lt(I)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+K(u));if(!m)return new U(g);for(t=new U(I),s=o=new U(I),r=h=new U(I),p=S(m),a=t.e=p.length-g.e-1,t.c[0]=v[(l=a%d)<0?d+l:l],e=!e||0<u.comparedTo(t)?0<a?t:s:u,l=L,L=1/0,u=new U(p),h.c[0]=0;f=n(u,t,0,1),1!=(i=o.plus(f.times(r))).comparedTo(e);)o=r,r=i,s=h.plus(f.times(i=s)),h=i,t=u.minus(f.times(i=t)),u=i;return i=n(e.minus(o),r,0,1),h=h.plus(i.times(s)),o=o.plus(i.times(r)),h.s=s.s=g.s,y=n(s,r,a*=2,H).minus(g).abs().comparedTo(n(h,o,a,H).minus(g).abs())<1?[s,r]:[h,o],L=l,y},P.toNumber=function(){return+K(this)},P.toPrecision=function(e,t){return null!=e&&k(e,1,w),i(this,e,t,2)},P.toString=function(e){var t,n=this,o=n.s,i=n.e;return null===i?o?(t="Infinity",o<0&&(t="-"+t)):t="NaN":(t=null==e?i<=D||N<=i?O(S(n.c),i):E(S(n.c),i,"0"):10===e?E(S((n=G(new U(n),b+i+1,H)).c),n.e,"0"):(k(e,2,W.length,"Base"),T(E(S(n.c),i,"0"),10,e,o,!0)),o<0&&n.c[0]&&(t="-"+t)),t},P.valueOf=P.toJSON=function(){return K(this)},P._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(P[Symbol.toStringTag]="BigNumber",P[Symbol.for("nodejs.util.inspect.custom")]=P.valueOf),null!=t&&U.set(t),U}()).default=n.BigNumber=n,void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)},{}],2:[function(e,t,n){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){"use strict";function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,i=!1,a=void 0;try{for(var r,u=e[Symbol.iterator]();!(o=(r=u.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var r=e("./globalState"),l=e("./validating"),u=e("./parsing"),c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:c,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:c,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=u.parseFormat(t)),!l.validateFormat(t))return"ERROR: invalid format";var o=t.prefix||"",i=t.postfix||"",a=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){var o=n.currentCurrency(),i=Object.assign({},f,t),a=void 0,r="",u=!!i.totalLength||!!i.forceAverage||i.average,l=t.currencyPosition||o.position,s=t.currencySymbol||o.symbol;i.spaceSeparated&&(r=" "),"infix"===l&&(a=r+s+r);var c=v({instance:e,providedFormat:t,state:n,decimalSeparator:a});return"prefix"===l&&(c=e._value<0&&"sign"===i.negative?"-".concat(r).concat(s).concat(c.slice(1)):s+r+c),l&&"postfix"!==l||(c=c+(r=u?"":r)+s),c}(e,t=m(t,r.currentCurrencyDefaultFormat()),r);case"percent":return function(e,t,n,o){var i=t.prefixSymbol,a=v({instance:o(100*e._value),providedFormat:t,state:n}),r=Object.assign({},f,t);return i?"%".concat(r.spaceSeparated?" ":"").concat(a):"".concat(a).concat(r.spaceSeparated?" ":"","%")}(e,t=m(t,r.currentPercentageDefaultFormat()),r,n);case"byte":return t=m(t,r.currentByteDefaultFormat()),C=e,k=r,R=n,O=(S=t).base||"binary",b=h[O],T=(E=d(C._value,b.suffixes,b.scale)).value,A=E.suffix,M=v({instance:R(T),providedFormat:S,state:k,defaults:k.currentByteDefaultFormat()}),x=k.currentAbbreviations(),"".concat(M).concat(x.spaced?" ":"").concat(A);case"time":return t=m(t,r.currentTimeDefaultFormat()),y=e,w=Math.floor(y._value/60/60),p=Math.floor((y._value-60*w*60)/60),g=Math.round(y._value-60*w*60-60*p),"".concat(w,":").concat(p<10?"0":"").concat(p,":").concat(g<10?"0":"").concat(g);case"ordinal":return o=e,i=t=m(t,r.currentOrdinalDefaultFormat()),l=(a=r).currentOrdinal(),u=Object.assign({},f,i),c=v({instance:o,providedFormat:i,state:a}),s=l(o._value),"".concat(c).concat(u.spaceSeparated?" ":"").concat(s);case"number":default:return v({instance:e,providedFormat:t,numbro:n})}var o,i,a,l,u,c,s,y,w,p,g,C,S,k,R,O,b,E,T,A,M,x}(e,t,n);return(a=o+a)+i}function d(e,t,n){var o=t[0],i=Math.abs(e);if(n<=i){for(var a=1;a<t.length;++a){var r=Math.pow(n,a),u=Math.pow(n,a+1);if(r<=i&&i<u){o=t[a],e/=r;break}}o===t[0]&&(e/=Math.pow(n,t.length-1),o=t[t.length-1])}return{value:e,suffix:o}}function p(e){for(var t="",n=0;n<e;n++)t+="0";return t}function y(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var n=e.toString(),r=o(n.split("e"),2),i=r[0],a=r[1],l=o(i.split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(0<+a)n=u+s+p(a-s.length);else{var h=".";h=+u<0?"-0".concat(h):"0".concat(h);var f=(p(-a-1)+Math.abs(u)+s).substr(0,t);f.length<t&&(f+=p(t-f.length)),n=h+f}return 0<+a&&0<t&&(n+=".".concat(p(t))),n}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function v(e){var t=e.instance,n=e.providedFormat,l=e.state,i=void 0===l?r:l,a=e.decimalSeparator,c=e.defaults,u=void 0===c?i.currentDefaults():c,h=t._value;if(0===h&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(h))return h.toString();var s,d,v,p,g,m,w,C,S=Object.assign({},f,u,n),k=S.totalLength,b=k?0:S.characteristic,R=S.optionalCharacteristic,O=S.forceAverage,E=!!k||!!O||S.average,T=k?-1:E&&void 0===n.mantissa?0:S.mantissa,A=!k&&(void 0===n.optionalMantissa?-1===T:S.optionalMantissa),M=S.trimMantissa,x=S.thousandSeparated,_=S.spaceSeparated,P=S.negative,I=S.forceSign,H=S.exponential,D="";if(E){var N=function(e){var t=e.value,n=e.forceAverage,o=e.abbreviations,i=e.spaceSeparated,a=void 0!==i&&i,r=e.totalLength,u=void 0===r?0:r,l="",s=Math.abs(t),c=-1;if(s>=Math.pow(10,12)&&!n||"trillion"===n?(l=o.trillion,t/=Math.pow(10,12)):s<Math.pow(10,12)&&s>=Math.pow(10,9)&&!n||"billion"===n?(l=o.billion,t/=Math.pow(10,9)):s<Math.pow(10,9)&&s>=Math.pow(10,6)&&!n||"million"===n?(l=o.million,t/=Math.pow(10,6)):(s<Math.pow(10,6)&&s>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=o.thousand,t/=Math.pow(10,3)),l&&(l=(a?" ":"")+l),u){var h=t.toString().split(".")[0];c=Math.max(u-h.length,0)}return{value:t,abbreviation:l,mantissaPrecision:c}}({value:h,forceAverage:O,abbreviations:i.currentAbbreviations(),spaceSeparated:_,totalLength:k});h=N.value,D+=N.abbreviation,k&&(T=N.mantissaPrecision)}if(H){var j=(d=(s={value:h,characteristicPrecision:b}).value,p=void 0===(v=s.characteristicPrecision)?0:v,m=(g=o(d.toExponential().split("e"),2))[0],w=g[1],C=+m,p&&1<p&&(C*=Math.pow(10,p-1),w=0<=(w=+w-(p-1))?"+".concat(w):w),{value:C,abbreviation:"e".concat(w)});h=j.value,D=j.abbreviation+D}var L,B,V,F=function(e,t,n,r,i){if(-1===r)return e;var a=y(t,r),l=o(a.toString().split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(s.match(/^0+$/)&&(n||i))return u;var h=s.match(/0+$/);return i&&h?"".concat(u,".").concat(s.toString().slice(0,h.index)):a.toString()}(h.toString(),h,A,T,M);return F=function(e,t,n,o,i){var a=o.currentDelimiters(),r=a.thousands;i=i||a.decimal;var u=a.thousandsSize||3,l=e.toString(),s=l.split(".")[0],c=l.split(".")[1];return n&&(t<0&&(s=s.slice(1)),function(e,t){for(var n=[],o=0,i=e;0<i;i--)o===t&&(n.unshift(i),o=0),o++;return n}(s.length,u).forEach((function(e,t){s=s.slice(0,e+t)+r+s.slice(e+t)})),t<0&&(s="-".concat(s))),c?s+i+c:s}(F=function(e,t,n,r){var i=e,a=o(i.toString().split("."),2),l=a[0],u=a[1];if(l.match(/^-?0$/)&&n)return u?"".concat(l.replace("0",""),".").concat(u):l.replace("0","");if(l.length<r)for(var c=r-l.length,s=0;s<c;s++)i="0".concat(i);return i.toString()}(F,0,R,b),h,x,i,a),(E||H)&&(F+=D),(I||h<0)&&(L=F,V=P,F=0===(B=h)?L:0==+L?L.replace("-",""):0<B?"+".concat(L):"sign"===V?L:"(".concat(L.replace("-",""),")")),F}function m(e,t){if(!e)return t;var n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return i.apply(void 0,n.concat([e]))},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=h.general;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=h.binary;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=h.decimal;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){"use strict";var i=e("./en-US"),o=e("./validating"),a=e("./parsing"),r={},u=void 0,l={},s=null,c={};function h(e){u=e}function p(){return l[u]}r.languages=function(){return Object.assign({},l)},r.currentLanguage=function(){return u},r.currentCurrency=function(){return p().currency},r.currentAbbreviations=function(){return p().abbreviations},r.currentDelimiters=function(){return p().delimiters},r.currentOrdinal=function(){return p().ordinal},r.currentDefaults=function(){return Object.assign({},p().defaults,c)},r.currentOrdinalDefaultFormat=function(){return Object.assign({},r.currentDefaults(),p().ordinalFormat)},r.currentByteDefaultFormat=function(){return Object.assign({},r.currentDefaults(),p().byteFormat)},r.currentPercentageDefaultFormat=function(){return Object.assign({},r.currentDefaults(),p().percentageFormat)},r.currentCurrencyDefaultFormat=function(){return Object.assign({},r.currentDefaults(),p().currencyFormat)},r.currentTimeDefaultFormat=function(){return Object.assign({},r.currentDefaults(),p().timeFormat)},r.setDefaults=function(e){e=a.parseFormat(e),o.validateFormat(e)&&(c=e)},r.getZeroFormat=function(){return s},r.setZeroFormat=function(e){return s="string"==typeof e?e:null},r.hasZeroFormat=function(){return null!==s},r.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return p()},r.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&h(e.languageTag)},r.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[e]){var n=e.split("-")[0],o=Object.keys(l).find((function(e){return e.split("-")[0]===n}));return l[o]?void h(o):void h(t)}h(e)},r.registerLanguage(i),u=i.languageTag,t.exports=r},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,n){"use strict";t.exports=function(t){return{loadLanguagesInNode:function(n){return o=t,void n.forEach((function(t){var n=void 0;try{n=e("../languages/".concat(t))}catch(n){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}n&&o.registerLanguage(n)}));var o}}}},{}],6:[function(e,t,n){"use strict";var o=e("bignumber.js");function a(e,t,n){var r=new o(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new o(i),e._value=r.minus(i).toNumber(),e}t.exports=function(u){return{add:function(e,t){return r=t,i=u,a=new o((n=e)._value),l=r,i.isNumbro(r)&&(l=r._value),l=new o(l),n._value=a.plus(l).toNumber(),n;var n,r,i,a,l},subtract:function(e,t){return a(e,t,u)},multiply:function(e,t){return r=t,i=u,a=new o((n=e)._value),l=r,i.isNumbro(r)&&(l=r._value),l=new o(l),n._value=a.times(l).toNumber(),n;var n,r,i,a,l},divide:function(e,t){return r=t,i=u,a=new o((n=e)._value),l=r,i.isNumbro(r)&&(l=r._value),l=new o(l),n._value=a.dividedBy(l).toNumber(),n;var n,r,i,a,l},set:function(e,t){return n=e,i=o=t,u.isNumbro(o)&&(i=o._value),n._value=i,n;var n,o,i},difference:function(e,t){return n=t,a(i=(o=u)(e._value),n,o),Math.abs(i._value);var n,o,i}}}},{"bignumber.js":1}],7:[function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=e("./globalState"),o=e("./validating"),r=e("./loading")(g),u=e("./unformatting"),l=e("./formatting")(g),s=e("./manipulating")(g),c=e("./parsing"),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t,n,o;return t=e,(n=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=l.formatOrDefault(e,a.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return s.difference(this,e)}},{key:"add",value:function(e){return s.add(this,e)}},{key:"subtract",value:function(e){return s.subtract(this,e)}},{key:"multiply",value:function(e){return s.multiply(this,e)}},{key:"divide",value:function(e){return s.divide(this,e)}},{key:"set",value:function(e){return s.set(this,p(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(t.prototype,n),o&&i(t,o),e}();function p(e){var t=e;return g.isNumbro(e)?t=e._value:"string"==typeof e?t=g.unformat(e):isNaN(e)&&(t=NaN),t}function g(e){return new h(p(e))}g.version="2.1.2",g.isNumbro=function(e){return e instanceof h},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=o.validate,g.loadLanguagesInNode=r.loadLanguagesInNode,g.unformat=u.unformat,t.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){"use strict";t.exports={parseFormat:function(e){var t,n,o,i,a,r,u,l,s,c,h,p,g,f,d,y,v,m,b,w,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(n=C,a=C,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(r=(i=e=(o=(t=e).match(/^{([^}]*)}/))?(n.prefix=o[1],t.slice(o[0].length)):t).match(/{([^}]*)}$/))?(a.postfix=r[1],i.slice(0,-r[0].length)):i,C),u=C,(l=e.match(/[1-9]+[0-9]*/))&&(u.totalLength=+l[0]),s=C,(c=e.split(".")[0].match(/0+/))&&(s.characteristic=c[0].length),function(e,t){if(-1!==e.indexOf(".")){var n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,C),h=C,-1!==e.indexOf("a")&&(h.average=!0),g=C,-1!==(p=e).indexOf("K")?g.forceAverage="thousand":-1!==p.indexOf("M")?g.forceAverage="million":-1!==p.indexOf("B")?g.forceAverage="billion":-1!==p.indexOf("T")&&(g.forceAverage="trillion"),function(e,t){var n=e.split(".")[1];if(n){var o=n.match(/0+/);o&&(t.mantissa=o[0].length)}}(e,C),d=C,(f=e).match(/\[\.]/)?d.optionalMantissa=!0:f.match(/\./)&&(d.optionalMantissa=!1),y=C,-1!==e.indexOf(",")&&(y.thousandSeparated=!0),v=C,-1!==e.indexOf(" ")&&(v.spaceSeparated=!0),b=C,(m=e).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),m.match(/^\+?-/)&&(b.negative="sign"),w=C,e.match(/^\+/)&&(w.forceSign=!0),C)}}},{}],9:[function(p,e,t){"use strict";var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function g(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",l=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,c=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===i?0:function e(t,r){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,c=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var h="",s=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(s!==t)return-1*e(s,r,l,i,a,c,u);for(var f=0;f<n.length;f++){var d=n[f];if((h=t.replace(d.key,""))!==t)return e(h,r,l,i,a,c,u)*d.factor}if((h=t.replace("%",""))!==t)return e(h,r,l,i,a,c,u)/100;var p=parseFloat(t);if(!isNaN(p)){var g=i(p);if(g&&"."!==g&&(h=t.replace(new RegExp("".concat(o(g),"$")),""))!==t)return e(h,r,l,i,a,c,u);var y={};Object.keys(c).forEach((function(e){y[c[e]]=e}));for(var v=Object.keys(y).sort().reverse(),m=v.length,w=0;w<m;w++){var C=v[w],b=y[C];if((h=t.replace(C,""))!==t){var S=void 0;switch(b){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return e(h,r,l,i,a,c,u)*S}}}}(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=e.replace(n,"");return(r=r.replace(new RegExp("([0-9])".concat(o(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,r),t,r,l,i,a,c)}e.exports={unformat:function(e,t){var n,o,i,a=p("./globalState"),r=a.currentDelimiters(),u=a.currentCurrency().symbol,l=a.currentOrdinal(),s=a.getZeroFormat(),c=a.currentAbbreviations(),h=void 0;if("string"==typeof e)h=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var n=e.split(":");if(3!==n.length)return!1;var o=+n[0],i=+n[1],a=+n[2];return!isNaN(o)&&!isNaN(i)&&!isNaN(a)}(e,r)?(o=+(n=e.split(":"))[0],i=+n[1],+n[2]+60*i+3600*o):g(e,r,u,l,s,c,t);else{if("number"!=typeof e)return;h=e}if(void 0!==h)return h}}},{"./globalState":4}],10:[function(e,t,n){"use strict";function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(e){return!!i.unformat(e)}function g(e,s,t){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(e).map((function(n){if(!s[n])return console.error("".concat(t," Invalid key: ").concat(n)),!1;var o=e[n],l=s[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!g(o,p,"[Validate ".concat(n,"]"),!0))return!1}else if(r(o)!==l.type)return console.error("".concat(t," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(r(o),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var c=l.restrictions.length,i=0;i<c;i++){var a=l.restrictions[i],h=a.restriction,u=a.message;if(!h(o,e))return console.error("".concat(t," ").concat(n," invalid value: ").concat(u)),!1}return l.restriction&&!l.restriction(o,e)?(console.error("".concat(t," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(o)?(console.error("".concat(t," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(o,'" provided')),!1):!(l.children&&!g(o,l.children,"[Validate ".concat(n,"]")))}));return n||l.push.apply(l,o(Object.keys(s).map((function(n){var o=s[n];if("string"==typeof o&&(o={type:o}),o.mandatory){var r=o.mandatory;if("function"==typeof r&&(r=r(e)),r&&void 0===e[n])return console.error("".concat(t,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),l.reduce((function(e,t){return e&&t}),!0)}function c(e){return g(e,p,"[Validate format]")}t.exports={validate:function(e,t){var n=u(e),o=c(t);return n&&o},validateFormat:c,validateInput:u,validateLanguage:function(e){return g(e,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},670:function(e,t,n){var o=n(12)(!1);o.push([e.i,'@charset "UTF-8";\n/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o.,\n * a Polish corporation, based in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,\n * registered with the National Court Register under number 538651,\n * EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including\n * international treaties, and dual-licensed – depending on whether\n * your use is intended for or may result in commercial advantage\n * or monetary compensation (commercial purposes), or not.\n * \n * If your use involves only such purposes as research, private study,\n * evaluation and the like, you agree to be bound by the terms included\n * in the "handsontable-non-commercial-license.pdf" file, available\n * in the main directory of this software repository.\n * \n * By installing, copying, or otherwise using this software for\n * commercial purposes, you agree to be bound by the terms included\n * in the "handsontable-general-terms.pdf" file, available in the main\n * directory of this software repository.\n * \n * HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND. IN NO EVENT\n * AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE\n * TO YOU FOR DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL,\n * INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING\n * FROM USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 9.0.2\n * Release date: 28/07/2021 (built at 28/07/2021 09:12:20)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;cursor:default;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-wrap}.handsontable td,.handsontable th,.handsontable th:last-child{border-right:1px solid #ccc;border-bottom:1px solid #ccc}.handsontable.htRowHeaders thead tr th:nth-child(2),.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderLeft):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.ht_clone_master{z-index:100}.ht_clone_right{z-index:110}.ht_clone_left{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_right_corner{z-index:140}.ht_clone_bottom_left_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_right_corner{z-index:170}.ht_clone_top_left_corner{z-index:180}.handsontable tbody tr th:nth-last-child(2),.ht_clone_top_left_corner thead tr th:nth-last-child(2){border-right:1px solid #ccc}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_left,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_left thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_left .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{touch-action:manipulation}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}#hot-display-license-info{font-size:10px;color:#323232;padding:5px 0 3px;font-family:Helvetica,Arial,sans-serif;text-align:left}#hot-display-license-info a{font-size:10px}.handsontable .manualColumnResizer{position:absolute;top:0;cursor:col-resize;z-index:210;width:5px;height:25px}.handsontable .manualRowResizer{position:absolute;left:0;cursor:row-resize;z-index:210;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{position:absolute;right:0;top:0;background-color:#34a9db;display:none;width:0;border-right:1px dashed #777;margin-left:5px}.handsontable .manualRowResizerGuide{position:absolute;left:0;bottom:0;background-color:#34a9db;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{text-decoration:underline;cursor:pointer}.handsontable span.colHeader.columnSorting:before{top:50%;margin-top:-6px;padding-left:8px;position:absolute;right:-9px;content:"";height:10px;width:5px;background-size:contain;background-repeat:no-repeat;background-position-x:right}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=")}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;position:relative;padding-right:20px}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;bottom:-100%\\9;background:#005eff}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInput:focus{outline:none}.handsontableInputHolder{position:absolute;top:0;left:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"\\25B6";color:#777;position:absolute;right:5px;font-size:9px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);right:5px;border:1px solid #a6a6a6;line-height:10px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;box-shadow:0 0 0 6px #eee;background:#eee;text-align:center}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{box-shadow:inset 0 0 0 2px #5292f7;-webkit-appearance:none}.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea),.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle){z-index:9999}.bottomRightSelectionHandle,.bottomRightSelectionHandle-HitArea,.topLeftSelectionHandle,.topLeftSelectionHandle-HitArea{left:-10000px;top:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}\n/*!\n * Pikaday\n * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{z-index:9999;display:block;position:relative;color:#333;background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single{*zoom:1}.pika-single.is-hidden{display:none}.pika-single.is-bound{position:absolute;box-shadow:0 5px 15px -5px rgba(0,0,0,.5)}.pika-lendar{float:left;width:240px;margin:8px}.pika-title{position:relative;text-align:center}.pika-label{display:inline-block;*display:inline;position:relative;z-index:9999;overflow:hidden;margin:0;padding:5px 3px;font-size:14px;line-height:20px;font-weight:700;background-color:#fff}.pika-title select{cursor:pointer;position:absolute;z-index:9998;margin:0;left:0;top:5px;filter:alpha(opacity=0);opacity:0}.pika-next,.pika-prev{display:block;cursor:pointer;position:relative;outline:none;border:0;padding:0;width:20px;height:30px;text-indent:20px;white-space:nowrap;overflow:hidden;background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;opacity:.5;*position:absolute;*top:0}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{float:left;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==");*left:0}.is-rtl .pika-prev,.pika-next{float:right;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=");*right:0}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block;*display:inline}.pika-table{width:100%;border-collapse:collapse;border-spacing:0;border:0}.pika-table td,.pika-table th{width:14.285714285714286%;padding:0}.pika-table th{color:#999;font-size:12px;line-height:25px;font-weight:700;text-align:center}.pika-button{cursor:pointer;display:block;box-sizing:border-box;-moz-box-sizing:border-box;outline:none;border:0;margin:0;width:100%;padding:5px;color:#666;font-size:12px;line-height:15px;text-align:right;background:#f5f5f5}.pika-week{font-size:11px;color:#999}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{color:#fff;font-weight:700;background:#3af;box-shadow:inset 0 1px 3px #178fe5;border-radius:3px}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{color:#fff;background:#6cb31d;box-shadow:none;border-radius:3px}.is-endrange .pika-button{color:#fff;background:#3af;box-shadow:none;border-radius:3px}.is-disabled .pika-button{pointer-events:none;cursor:default;color:#999;opacity:.3}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{pointer-events:none;cursor:default}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{color:#fff;background:#ff8000;box-shadow:none;border-radius:3px}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{font-size:inherit;vertical-align:middle;cursor:pointer;display:inline-block}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.htCommentCell{position:relative}.htCommentCell:after{content:"";position:absolute;top:0;right:0;border-left:6px solid transparent;border-top:6px solid #000}.htComments{display:none;z-index:1059;position:absolute}.htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}.htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_corner,.htContextMenu .ht_clone_left,.htContextMenu .ht_clone_top{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_left td:first-of-type,.htRowHeaders .ht_master.innerBorderLeft~.ht_clone_top_left_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;margin-left:-1px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{top:50%;margin-top:-2px;position:absolute;right:-15px;padding-left:5px;font-size:8px;height:8px;line-height:1.1;text-decoration:underline;text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border-radius:2px;border:1px solid #bbb;color:#bbb;font-size:9px;line-height:9px;padding:2px;margin:3px 1px 0 5px;float:right}.handsontable .changeType:before{content:"\\25BC\\ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_corner,.htDropdownMenu .ht_clone_left,.htDropdownMenu .ht_clone_top{display:none}.htDropdownMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htDropdownMenu table tbody tr td:first-child{border:0}.htDropdownMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_corner,.htFiltersConditionsMenu .ht_clone_left,.htFiltersConditionsMenu .ht_clone_top{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htFiltersConditionsMenu table tbody tr td:first-child{border:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{text-align:center;padding-top:10px;padding-bottom:3px}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{font-family:inherit;font-size:.75em;padding:4px;box-sizing:border-box;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{border:1px solid #509272;color:#18804e;background-color:#d2e0d9}.handsontable .htUISelectAll{margin-right:10px}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{color:#3283d8;font-size:.75em}.handsontable .htUISelectionControls{text-align:right}.handsontable .htCheckboxRendererInput{margin:0 5px 0 0;vertical-align:middle;height:1em}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border-radius:2px;border:1px solid #d2d1d1}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.7em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-right:10px}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border-radius:2px;border:1px solid #d2d1d1;font-family:inherit;font-size:.7em;font-weight:700;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"\\25B2";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"\\25BC";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border-radius:2px;border:1px solid #d2d1d1;padding:3px}.handsontable .htUIRadio{display:inline-block;margin-right:5px;height:100%}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-right:.5ex}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{text-align:left;padding-left:7px}.handsontable th div.ht_nestingLevels{display:inline-block;position:absolute;left:11px}.handsontable.innerBorderLeft th div.ht_nestingLevels,.handsontable.innerBorderLeft~.handsontable th div.ht_nestingLevels{right:10px}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;width:10px;height:1px;float:left}.handsontable th span.ht_nestingLevel:after{content:"\\2510";font-size:9px;display:inline-block;position:relative;bottom:3px}.handsontable th div.ht_nestingButton{display:inline-block;position:absolute;right:-2px;cursor:pointer}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"\\002B"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"\\002D"}.handsontable.innerBorderLeft th div.ht_nestingButton,.handsontable.innerBorderLeft~.handsontable th div.ht_nestingButton{right:0}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;position:absolute;top:50%;font-size:5pt;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{right:1px;content:"\\25C0"}.handsontable th.afterHiddenColumn:before{left:1px;content:"\\25B6"}\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;line-height:6pt;position:absolute;left:2px}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{content:"\\25B2";bottom:2px}.handsontable th.afterHiddenRow:after{content:"\\25BC";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}',""]),e.exports=o}}]);