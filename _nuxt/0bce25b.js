(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{732:function(e,t,o){"use strict";o.r(t);var n=o(111),r=o(128),l=o(53),c=o(302),m=o(137),d=o(301),h=o(634),f=o(635),P=(o(34),o(6),{name:"DialogPermission",data:function(){return{loadingPermission:!1,dialogPermission:!1,dialogTitle:"",role:"",userRole:[],form:{},canAddData:!1,type:""}},mounted:function(){this.getPermissionList()},methods:{getPermissionList:function(){var e=this;this.$axios.get("/api/master/permissions").then((function(t){e.$auth.$storage.setLocalStorage("permission_list",JSON.stringify(t.data.data.simple))}))},openDialogPermission:function(e,title){this.dialogTitle=title,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},e),this.canAddData=!0,this.getPermissionUser(e),this.type="user"},getPermissionUser:function(e){var t=this;this.userRole=null,this.$axios.get("/api/master/users/permission",{params:{form:e}}).then((function(e){t.$refs.childDetails.setDataToDetails(e.data.data.rows)})).finally((function(e){t.loadingPermission=!1}))},closeDialogPermission:function(){this.dialogPermission=!1,this.userRole=[],this.canAddData=!1},openRolePermissions:function(e,title,t){var o=this;this.type=t,this.dialogTitle=title,this.dialogPermission=!0,this.loadingPermission=!0,this.form=Object.assign({},e);var n="";"user"===t?n="/api/master/users/roles":(this.canAddData=!0,n="/api/master/permission-role"),this.$axios.get(n,{params:{form:this.form}}).then((function(e){"user"===t?(o.userRole=e.data.data.rows,o.changeTab(o.userRole[0])):(o.$refs.childDetails.setDataToDetails(e.data.data.rows),o.loadingPermission=!1)}))},changeTab:function(e){var t=this;this.loadingPermission=!0,this.$axios.get("/api/master/permission-role",{params:{form:e}}).then((function(e){t.$refs.childDetails.setDataToDetails(e.data.data.rows)})).finally((function(e){t.loadingPermission=!1}))},getRolePermissionUser:function(e){var t=this;this.$axios.get("/api/master/users/role-permission",{params:{item:e}}).then((function(e){t.$refs.childDetails.setDataToDetails(e.data.data.rows)})).finally((function(e){t.loadingPermission=!1}))},getPermissionRole:function(e){var t=this;this.$axios.get("/api/master/permission-role",{params:{form:this.form}}).then((function(e){t.$refs.childDetails.setDataToDetails(e.data.data.rows)})).finally((function(e){t.loadingPermission=!1}))},saveRolePermission:function(){var e=this;this.loadingPermission=!0;var details=this.$refs.childDetails.getAddData(),t="";t="user"===this.type?"/api/master/users/permission":"/api/master/permission-role",this.$axios.post(t,{details:details,form:this.form}).then((function(t){e.$swal({icon:"success",title:"Success",text:t.data.message}),"user"===e.type?e.getPermissionUser(e.form):e.getPermissionRole(e.form)})).catch((function(t){e.$swal({icon:"error",title:"Error",text:t.response.data.message})})).finally((function(t){e.loadingPermission=!1}))}}}),D=o(61),component=Object(D.a)(P,(function(){var e=this,t=e._self._c;return t(c.a,{attrs:{persistent:"","max-width":"1000px"},model:{value:e.dialogPermission,callback:function(t){e.dialogPermission=t},expression:"dialogPermission"}},[t(r.a,{attrs:{loading:e.loadingPermission}},[t(l.d,[t("span",{staticClass:"font-weight-medium"},[e._v("\n          "+e._s(e.dialogTitle)+"\n        ")])]),e._v(" "),t(l.c,[e.userRole?t(f.a,{attrs:{centered:"","slider-color":"green"},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},e._l(e.userRole,(function(o,n){return t(h.a,{key:n,attrs:{href:"#tab-".concat(n)},on:{change:function(t){return e.changeTab(o)}}},[e._v("\n          "+e._s(o.name)+"\n        ")])})),1):e._e(),e._v(" "),t("div",{staticClass:"scroll-container"},[t("LazyMasterPermissionList",{ref:"childDetails"})],1)],1),e._v(" "),t(l.a,[e.canAddData?t(n.a,{staticClass:"white--text",attrs:{"x-small":"",color:"orange darken-1"},on:{click:function(t){return e.$refs.childDetails.addLine()}}},[t(m.a,{attrs:{"x-small":""}},[e._v("\n          mdi-plus\n        ")])],1):e._e(),e._v(" "),t(d.a),e._v(" "),t(n.a,{attrs:{color:"red darken-1",dark:"",small:""},on:{click:e.closeDialogPermission}},[e._v("\n        close\n      ")]),e._v(" "),e.canAddData?t(n.a,{attrs:{color:"green darken-1",dark:"",small:"",loading:e.loadingPermission},on:{click:function(t){return e.saveRolePermission()}}},[e._v("\n        Save\n      ")]):e._e()],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);