(window.webpackJsonp=window.webpackJsonp||[]).push([[21,94],{667:function(t,e,n){"use strict";n(303);var r=n(304);e.a=Object(r.a)("layout")},734:function(t,e,n){"use strict";n.r(e);var r=n(111),o=n(833),c=n(1057),l=n(278),d=n(277),h=n(633),m=(n(33),n(240),n(34),n(85),n(6),n(36),n(12),n(13),{name:"FormTask",props:{title:{type:String,default:""}},data:function(){return{loading:!1,allData:[],documentStatus:[],itemSearch:[],searchStatus:"Y"===this.$auth.user.is_sap_user?"pending":"draft",searchItem:"",search:"",totalData:0,options:{},form:{},listType:"myTicket",headers:[{text:"Task Number",value:"task_number",cellClass:"disable-wrap"},{text:"Title",value:"title",cellClass:"disable-wrap"},{text:"Sub Category",value:"sub_category.category_name",cellClass:"disable-wrap"},{text:"Milestone",value:"section.title",cellClass:"disable-wrap"},{text:"Doc Date",value:"created_at",cellClass:"disable-wrap"},{text:"Due Date",value:"due_date",cellClass:"disable-wrap"},{text:"Assiged To",value:"assignees",cellClass:"disable-wrap"},{text:"Priority",value:"priority.title",cellClass:"disable-wrap"},{text:"Approval",value:"approve",cellClass:"disable-wrap"},{text:"Action",value:"id",align:"center",cellClass:"disable-wrap",sortable:!1,filterable:!1}]}},computed:{batchItems:function(){return"Y"===this.$auth.user.is_sap_user?["Approve","Reject"]:"draft"===this.searchStatus?["Submit Approval","Delete"]:"pending"===this.searchStatus?["Cancel"]:"approved"===this.searchStatus?["Download"]:("canceled"===this.searchStatus||this.searchStatus,[""])}},mounted:function(){this.getDataFromApi()},methods:{changeList:function(t){this.listType=t,this.getDataFromApi()},getInitial:function(t){var e=t.trim().split(" ");return e.reduce((function(t,n,r){return 0!==r&&r!==e.length-1||(t="".concat(t).concat(n.charAt(0).toUpperCase())),t}),"")},newData:function(){this.$emit("newData")},editItem:function(t){this.form=Object.assign({},t),this.statusProcessing="update",this.$emit("editItem",t)},itemRowBackground:function(t){return"Pending"===t.approval?"bg-orange":"bg-white"},batchActions:function(t){if(this.selected.length<1)this.$swal({type:"error",title:"Error",text:"Please select at least 1 row!"});else try{var e=this,n=[];switch(t){case"Submit Approval":e.batchSubmitDocument(this.selected);break;case"Delete":this.selected.forEach((function(t){n.push(t.id)})),e.batchDeleteDocument(n);break;case"Cancel":e.batchCancelDocument(this.selected);break;case"Reject":this.$refs.formApproval.editItem(this.selected,"Reject");break;case"Approve":this.$refs.formApproval.editItem(this.selected,"Approve")}}catch(t){this.$swal({type:"error",title:"Error",text:t})}},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.filters=data.filters,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0,this.$axios.get("/api/tasks/task",{params:{options:this.options,searchItem:this.searchItem,documentStatus:this.documentStatus,searchStatus:this.searchStatus,search:this.search,listType:this.listType}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.$emit("dataForToolbar",{itemSearch:e.data.filter}),t.form=Object.assign({},e.data.data.form),t.defaultItem=Object.assign({},e.data.data.form)})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))}}}),f=n(61),component=Object(f.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e(l.a,{attrs:{value:t.loading}},[e(d.a,{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),e(c.a,{staticClass:"elevation-0",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,"fixed-tabs":"","show-select":"",dense:"","fixed-header":"",height:"70vh","footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"top",fn:function(){return[e("LazyMainToolbar",{attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,title:"Ticket Lists","new-data-text":"New Ticket","show-batch-action":!0,"batch-actions":t.batchItems},on:{emitData:t.emitData,newData:t.newData,batchActions:t.batchActions,getDataFromApi:t.getDataFromApi}})]},proxy:!0},{key:"item.id",fn:function(n){var o=n.item;return[e(r.a,{staticClass:"font-weight-bold text-right",attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.editItem(o)}}},[t._v("\n        Edit\n      ")])]}},{key:"item.assignees",fn:function(n){var o=n.item;return t._l(JSON.parse(o.assignees),(function(n){return e(h.a,{key:n.nik,attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(o){var c=o.on,l=o.attrs;return[e(r.a,t._g(t._b({staticClass:"white--text",attrs:{"x-small":"",color:"green",depressed:"",fab:""}},"v-btn",l,!1),c),[t._v("\n            "+t._s(t.getInitial(n.name))+"\n          ")])]}}],null,!0)},[t._v(" "),e("span",[t._v(t._s(n.name))])])}))}},{key:"item.approve",fn:function(n){var r=n.item;return[e(o.a,{attrs:{color:"0"===r.approve?"orange":"green",label:"",small:"","text-color":"white"}},["0"===r.approve?e("span",{attrs:{left:""}},[t._v("Pending ")]):e("span",{attrs:{left:""}},[t._v("Approve ")])])]}}],null,!0)})],1)}),[],!1,null,null,null);e.default=component.exports},790:function(t,e,n){"use strict";n.r(e);var r=n(128),o=n(416),c=n(647),l=n(667),d=n(415),h={name:"MasterRole",layout:"dashboard",data:function(){return{totalData:0,editedIndex:-1,loading:!0,workspace:[],workspaceAssign:[],allData:[],documentStatus:[],departments:[],itemSearch:[],searchStatus:"",searchItem:"",search:"",displayStyle:"card",form:{},defaultItem:{},options:{},countMyTicket:null,countTeamTicket:null,countAssignTicket:null,listType:"myTicket",headers:[{text:"Role Name",value:"name"},{text:"Description",value:"description"},{text:"Guard",value:"guard_name"},{text:"Action",value:"ACTIONS",align:"center"}]}},head:function(){return{title:"Tasks"}},computed:{formTitle:function(){return-1===this.editedIndex?"New Task":"Edit Task"},buttonTitle:function(){return-1===this.editedIndex?"Save":"Update"}},mounted:function(){this.refreshData()},methods:{refreshData:function(){this.getDepartments(),this.getWorkSpace()},getDataFromApi:function(){this.$refs.taskList.getDataFromApi()},setCountTeamTicket:function(data){this.countTeamTicket=data},setCountAssignTicket:function(data){this.countAssignTicket=data},setCountMyTicket:function(data){this.countMyTicket=data},changeList:function(t){this.listType=t,this.$refs.taskList.changeList(t)},newData:function(){this.editedIndex=-1,this.$refs.formTask.newData(this.form)},editItem:function(t){this.editedIndex=this.allData.indexOf(t),this.$refs.formTask.editItem(t)},getWorkSpace:function(){var t=this;this.loading=!0,this.$axios.get("/api/tasks/workspace",{params:{displayStyle:this.displayStyle}}).then((function(e){t.loading=!1,t.workspace=e.data.data.rows,t.workspaceAssign=e.data.data.assignees,t.form=e.data.data.form,t.countMyTicket=e.data.data.countMyTicket,t.countAssignTicket=e.data.data.countAssignTicket,t.countTeamTicket=e.data.data.countTeamTicket})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},getDepartments:function(){var t=this;this.$axios.get("/api/master/departments").then((function(e){t.$auth.$storage.setLocalStorage("departments",e.data)}))}}},m=n(61),component=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e(l.a,{attrs:{wrap:""}},[e(d.a,[e(o.a,{attrs:{cols:"12"}},[e(r.a,{staticClass:"mx-auto",attrs:{flat:""}},[e(c.a,{attrs:{fluid:""}},[e("TasksFormList",{ref:"taskList",attrs:{loading:t.loading,workspace:t.workspaceAssign},on:{setCountMyTicket:t.setCountMyTicket,setCountAssignTicket:t.setCountAssignTicket,setCountTeamTicket:t.setCountTeamTicket,newData:t.newData,editItem:t.editItem}})],1)],1),t._v(" "),e("LazyTasksFormTask",{ref:"formTask",attrs:{"form-data":t.form,"list-type":t.listType,"form-title":t.formTitle,"button-title":t.buttonTitle},on:{getDataFromApi:t.getDataFromApi}})],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{TasksFormList:n(734).default})}}]);