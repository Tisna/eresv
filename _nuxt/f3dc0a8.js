(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{636:function(t,e,r){"use strict";r.r(e);r(42),r(90),r(83),r(31),r(11),r(228),r(12);var n={name:"FormTask",props:{title:{type:String,default:""}},data:function(){return{loading:!1,allData:[],documentStatus:[],itemSearch:[],searchStatus:"Y"===this.$auth.user.is_sap_user?"pending":"draft",searchItem:"",search:"",totalData:0,options:{},form:{},listType:"myTicket",headers:[{text:"Task Number",value:"task_number",cellClass:"disable-wrap"},{text:"Title",value:"title",cellClass:"disable-wrap"},{text:"Sub Category",value:"sub_category.category_name",cellClass:"disable-wrap"},{text:"Milestone",value:"section.title",cellClass:"disable-wrap"},{text:"Doc Date",value:"created_at",cellClass:"disable-wrap"},{text:"Due Date",value:"due_date",cellClass:"disable-wrap"},{text:"Assiged To",value:"assignees",cellClass:"disable-wrap"},{text:"Priority",value:"priority.title",cellClass:"disable-wrap"},{text:"Approval",value:"approve",cellClass:"disable-wrap"},{text:"Action",value:"id",align:"center",cellClass:"disable-wrap",sortable:!1,filterable:!1}]}},computed:{batchItems:function(){return"Y"===this.$auth.user.is_sap_user?["Approve","Reject"]:"draft"===this.searchStatus?["Submit Approval","Delete"]:"pending"===this.searchStatus?["Cancel"]:"approved"===this.searchStatus?["Download"]:("canceled"===this.searchStatus||this.searchStatus,[""])}},mounted:function(){this.getDataFromApi()},methods:{changeList:function(t){this.listType=t,this.getDataFromApi()},getInitial:function(t){var e=t.trim().split(" ");return e.reduce((function(t,r,n){return 0!==n&&n!==e.length-1||(t="".concat(t).concat(r.charAt(0).toUpperCase())),t}),"")},newData:function(){this.$emit("newData")},editItem:function(t){this.form=Object.assign({},t),this.statusProcessing="update",this.$emit("editItem",t)},itemRowBackground:function(t){switch(t.approval){case"Pending":return"bg-orange";default:return"bg-white"}},batchActions:function(t){if(this.selected.length<1)this.$swal({type:"error",title:"Error",text:"Please select at least 1 row!"});else try{var e=this,r=[];switch(t){case"Submit Approval":e.batchSubmitDocument(this.selected);break;case"Delete":this.selected.forEach((function(t){r.push(t.id)})),e.batchDeleteDocument(r);break;case"Cancel":e.batchCancelDocument(this.selected);break;case"Reject":this.$refs.formApproval.editItem(this.selected,"Reject");break;case"Approve":this.$refs.formApproval.editItem(this.selected,"Approve")}}catch(t){this.$swal({type:"error",title:"Error",text:t})}},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.filters=data.filters,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0,this.$axios.get("/api/tasks/task",{params:{options:this.options,searchItem:this.searchItem,documentStatus:this.documentStatus,searchStatus:this.searchStatus,search:this.search,listType:this.listType}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.$emit("dataForToolbar",{itemSearch:e.data.filter}),t.form=Object.assign({},e.data.data.form),t.defaultItem=Object.assign({},e.data.data.form)})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))}}},o=r(81),l=r(89),c=r.n(l),h=r(106),d=r(709),m=r(854),f=r(261),v=r(257),w=r(562),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("v-overlay",{attrs:{value:t.loading}},[r("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),r("v-data-table",{staticClass:"elevation-0",attrs:{"mobile-breakpoint":0,headers:t.headers,items:t.allData,"items-per-page":20,options:t.options,"server-items-length":t.totalData,"fixed-tabs":"","show-select":"",dense:"","fixed-header":"",height:"70vh","footer-props":{"items-per-page-options":[20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"top",fn:function(){return[r("LazyMainToolbar",{attrs:{"document-status":t.documentStatus,"search-status":t.searchStatus,"item-search":t.itemSearch,"search-item":t.searchItem,search:t.search,title:"Ticket Lists","new-data-text":"New Ticket","show-batch-action":!0,"batch-actions":t.batchItems},on:{emitData:t.emitData,newData:t.newData,batchActions:t.batchActions,getDataFromApi:t.getDataFromApi}})]},proxy:!0},{key:"item.id",fn:function(e){var n=e.item;return[r("v-btn",{staticClass:"font-weight-bold text-right",attrs:{small:"",text:"",color:"primary"},on:{click:function(e){return t.editItem(n)}}},[t._v("\n        Edit\n      ")])]}},{key:"item.assignees",fn:function(e){var n=e.item;return t._l(JSON.parse(n.assignees),(function(e){return r("v-tooltip",{key:e.nik,attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,l=n.attrs;return[r("v-btn",t._g(t._b({staticClass:"white--text",attrs:{"x-small":"",color:"green",depressed:"",fab:""}},"v-btn",l,!1),o),[t._v("\n            "+t._s(t.getInitial(e.name))+"\n          ")])]}}],null,!0)},[t._v(" "),r("span",[t._v(t._s(e.name))])])}))}},{key:"item.approve",fn:function(e){var n=e.item;return[r("v-chip",{attrs:{color:"0"===n.approve?"orange":"green",label:"",small:"","text-color":"white"}},["0"===n.approve?r("span",{attrs:{left:""}},[t._v("Pending ")]):r("span",{attrs:{left:""}},[t._v("Approve ")])])]}}],null,!0)})],1)}),[],!1,null,null,null);e.default=component.exports;c()(component,{VBtn:h.a,VChip:d.a,VDataTable:m.a,VOverlay:f.a,VProgressCircular:v.a,VTooltip:w.a})}}]);