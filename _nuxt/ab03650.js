(window.webpackJsonp=window.webpackJsonp||[]).push([[16,38],{667:function(t,e,n){"use strict";n(303);var r=n(304);e.a=Object(r.a)("layout")},669:function(t,e,n){"use strict";n(303);var r=n(304);e.a=Object(r.a)("flex")},730:function(t,e,n){var content=n(769);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(19).default)("eec7c51e",content,!0,{sourceMap:!1})},750:function(t,e,n){"use strict";n.r(e);var r=n(111),o=n(128),c=n(53),l=n(833),d=n(647),m=n(1057),h=n(302),f=n(638),v=n(137),_=n(301),y=n(71),x=n(113),w=n(633),A=(n(33),n(240),n(13),n(6),n(64),n(245),n(86),n(40),n(44),n(243),n(198),n(54),{name:"ListPaper",props:{paperType:{type:String,default:""},paperName:{type:String,default:""}},data:function(){return{totalData:0,allData:[],dataFilter:[],loading:!0,dialogFilter:!1,loading1:!0,loadingPrint:!1,dialogLoading:!1,options:{},itemSearch:[],documentStatus:[],search:"",searchItem:"",searchStatus:"All",loadNewBtn:!1,defaultForm:{}}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0},search:function(){this.getDataFromApi()},$route:function(t,e){this.getDataFromApi()}},methods:{getHeader:function(){return[{text:"Date",value:"act_date"},{text:"Activity",value:"sub_role_name"},{text:"Problem",value:"problem_desc"},{text:"Problem Date",value:"problem_date"},{text:"Solution",value:"solution_desc"},{text:"Solution Date",value:"solution_date"},{text:"Actions",value:"actions"}]},emitData:function(data){this.documentStatus=data.documentStatus,this.itemSearch=data.itemSearch,this.searchStatus=data.searchStatus,this.searchItem=data.searchItem,this.search=data.search,this.getDataFromApi()},getDataFromApi:function(){var t=this;this.loading=!0;var e=this,n=this.$auth.user.username;this.$axios.get("/api/enviro-activity",{params:{options:e.options,search:e.search,searchItem:e.searchItem,type:e.paperType,user_id:n,status:e.searchStatus,clinic:"N"}}).then((function(e){t.loading=!1,t.allData=e.data.data.rows,t.totalData=e.data.data.total,t.itemSearch=e.data.data.filter,t.defaultForm=e.data.data.form})).catch((function(e){t.loading=!1,t.$swal({type:"error",title:"Error",text:e.response.data.message})}))},cancelDocument:function(t){this.$refs.formActivity.openDialog(this.paperName,"/api/enviro-activity/"+t.id,"put",this.paperType,"Non Karyawan")},sanitizeTitle:function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",i=0,n=e.length;i<n;i++)t=t.replace(new RegExp(e.charAt(i),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},editDocument:function(t){this.$refs.formActivity.openForm("/api/enviro-activity/"+t.id,"patch",t)},printItem:function(t){var e=this;"canceled"===t.status?this.$swal({title:"Error!",text:"Form sudah dicancel!",type:"error"}):(this.loadingPrint=!0,this.$axios.get("/api/enviro-activity/print",{params:{item:t,type:this.paperType},responseType:"arraybuffer"}).then((function(n){e.loadingPrint=!1;var r=new Blob([n.data],{type:"application/pdf"}),o=window.URL.createObjectURL(r),link=document.createElement("a");link.href=window.URL.createObjectURL(r),link.download=e.sanitizeTitle(t.paper_no)+"-"+e.sanitizeTitle(t.user_name)+".pdf",document.body.appendChild(link),link.click(),setTimeout((function(){document.body.removeChild(link),window.URL.revokeObjectURL(o)}),100)})).catch((function(t){e.loadingPrint=!1,e.$swal({type:"error",title:"Error",text:t.response.data.message})})))},newData:function(){this.$refs.formActivity.openForm("/api/enviro-activity","post",this.defaultForm)}}}),D=n(61),component=Object(D.a)(A,(function(){var t=this,e=t._self._c;return e(d.a,[e(y.a,{attrs:{flat:"",color:"white",dense:""}},[e(x.a,[t._v("Activity ")]),t._v(" "),e(f.a,{staticClass:"ml-2",attrs:{inset:"",vertical:""}}),t._v(" "),e(_.a),t._v(" "),e(r.a,{staticClass:"d-md-none d-lg-none d-sm-flex d-xs-flex",attrs:{icon:"",color:"green",dark:""},on:{click:function(e){t.dialogFilter=!0}}},[e(v.a,[t._v("mdi-filter-variant")])],1),t._v(" "),e(r.a,{attrs:{icon:"",loading:t.loadNewBtn,color:"green",dark:""},on:{click:t.newData}},[e(v.a,[t._v("mdi-plus-circle")])],1),t._v(" "),e(r.a,{attrs:{loading:t.loading,icon:""},on:{click:t.getDataFromApi}},[e(v.a,[t._v("mdi-refresh")])],1)],1),t._v(" "),e("div",{staticClass:"mt-2"},[e(m.a,{staticClass:"elevation-1",attrs:{"mobile-breakpoint":0,headers:t.getHeader(),items:t.allData,"items-per-page":10,options:t.options,"server-items-length":t.totalData,loading:t.loading,dense:"","footer-props":{"items-per-page-options":[10,20,50,100,-1]}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.actions",fn:function(n){var o=n.item;return[e("div",{staticClass:"d-flex"},[e(w.a,{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var c=n.on,l=n.attrs;return[e(r.a,t._g(t._b({attrs:{icon:"","x-small":""}},"v-btn",l,!1),c),[e(v.a,{staticClass:"mr-1",attrs:{color:"blue"},on:{click:function(e){return t.editDocument(o)}}},[t._v("\n                  mdi-square-edit-outline\n                ")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Edit Document")])]),t._v(" "),e(w.a,{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(n){var c=n.on,l=n.attrs;return[e(r.a,t._g(t._b({attrs:{icon:""}},"v-btn",l,!1),c),[e(v.a,{staticClass:"mr-2",attrs:{small:"",color:"orange"},on:{click:function(e){return t.$refs.attachment.openAttachment(o.id,"enviro",1)}}},[t._v("\n                  mdi-attachment\n                ")])],1)]}}],null,!0)},[t._v(" "),e("span",[t._v("Attachment")])])],1)]}},{key:"item.status",fn:function(n){var r=n.item;return[e(l.a,{staticClass:"ma-1",attrs:{color:"canceled"===r.status?"red":"active"===r.status?"green":"orange",small:"","text-color":"white"}},[t._v("\n          "+t._s(r.status)+"\n        ")])]}}],null,!0)})],1),t._v(" "),e("LazyEnviroFormActivity",{ref:"formActivity",attrs:{"default-form":t.defaultForm},on:{reload:t.getDataFromApi}}),t._v(" "),e(h.a,{attrs:{persistent:"","max-width":"400px"},model:{value:t.dialogFilter,callback:function(e){t.dialogFilter=e},expression:"dialogFilter"}},[e(o.a,[e(c.d,[t._v("Filter Form")]),t._v(" "),e(c.c,[e("LazyPaperTableFilter",{attrs:{"document-status":t.documentStatus,"item-search":t.itemSearch,"search-status":t.searchStatus,"search-item":t.searchItem,search:t.search},on:{getDataFromApi:t.emitData}})],1),t._v(" "),e(c.a,[e(_.a),t._v(" "),e(r.a,{attrs:{color:"red darken-1",text:"",small:""},on:{click:function(e){t.dialogFilter=!1}}},[t._v("\n          Close\n        ")])],1)],1)],1),t._v(" "),t.loadingPrint?e("LazySpinnerLoading",{ref:"spinnerLoadingImport"}):t._e(),t._v(" "),e("LazyAttachment",{ref:"attachment"}),t._v(" "),e("LazyResvApprovalDetails",{ref:"approvalStages"})],1)}),[],!1,null,null,null);e.default=component.exports},768:function(t,e,n){"use strict";n(730)},769:function(t,e,n){var r=n(18)((function(i){return i[1]}));r.push([t.i,".text-white[data-v-23ed2c81]{color:#fff!important}",""]),r.locals={},t.exports=r},789:function(t,e,n){"use strict";n.r(e);var r=n(416),o=n(647),c=n(669),l=n(667),d=n(415),m={name:"Enviro",data:function(){return{paperType:"",items:[]}},created:function(){this.homeData()},methods:{checkClinic:function(t){return this.$gates.hasAnyRole("Superuser|Admin Klinik")},checkSuperuser:function(t){return this.$gates.hasAnyRole("Superuser")},checkUnlesClinik:function(t){return this.$gates.unlessRole("Admin Klinik")},homeData:function(){var t=this;this.$axios.get("/api/master/papers").then((function(e){t.items=e.data.data.items}))}}},h=(n(768),n(61)),component=Object(h.a)(m,(function(){var t=this._self._c;return t(l.a,[t(c.a,{attrs:{xs12:"",md12:""}},[t(o.a,{attrs:{fluid:""}},[t(d.a,[t(r.a,{staticClass:"mt-4",attrs:{cols:"12"}},[t("EnviroListActivity",{attrs:{"paper-type":this.paperType}})],1)],1)],1)],1)],1)}),[],!1,null,"23ed2c81",null);e.default=component.exports;installComponents(component,{EnviroListActivity:n(750).default})}}]);